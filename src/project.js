require=function r(n,o,l){function c(i,e){if(!o[i]){if(!n[i]){var t="function"==typeof require&&require;if(!e&&t)return t(i,!0);if(h)return h(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var s=o[i]={exports:{}};n[i][0].call(s.exports,function(e){var t=n[i][1][e];return c(t||e)},s,s.exports,r,n,o,l)}return o[i].exports}for(var h="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({AnimalBegin1:[function(e,t,i){"use strict";cc._RF.push(t,"342adSH1TdHsqEJDXEjuW7L","AnimalBegin1");var o,a=e("HHCommon"),s=e("AnimalEngine1");cc.Class({extends:a,properties:{animal_player1:{default:null,type:cc.Prefab},animal_player_board1:{default:null,type:cc.Prefab},selfplayer:{default:null,type:cc.Node},opponentplayer:{default:null,type:cc.Node},selfboard:{default:null,type:cc.Node},opponentboard:{default:null,type:cc.Node},statusboard:{default:null,type:cc.Node},boardclaim:{default:null,type:cc.Sprite},claimatlas:{default:null,type:cc.SpriteAtlas},roomdata:{default:null,type:cc.Node},turntimer:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},observer:{default:null,type:cc.Prefab},observerbench:{default:null,type:cc.Node},emodlg:{default:null,type:cc.Prefab},chat:{default:null,type:cc.Prefab},btn_enter:{default:null,type:cc.Node},btn_giveup:{default:null,type:cc.Node},btn_chat:{default:null,type:cc.Node},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},finishAct:{default:null,type:cc.Node},btnSfx:{default:null,type:cc.Node},lblTurnCount:{default:null,type:cc.Label},gameboard:{default:null,type:cc.Node},gameboard_back:{default:null,type:cc.Node},animalpiece1:{default:null,type:cc.Prefab},emptybutton1:{default:null,type:cc.Prefab},konier:{default:[]},emptykoni:{default:[]},chessArray:{default:null,type:cc.Node},chessArray1:{default:null,type:cc.Node},tip_pan:{default:null,type:cc.Node},score_pan:{default:null,type:cc.Node},finishMask:{default:null,type:cc.Node},matrix_pos:{default:[]},matrix:{default:[]}},onLoad:function(){this.tip_pan.active=!1,this.finishMask.active=!1,!cc.global.isOffline&&this.initEventCallback(),cc.game.setFrameRate(60),cc.global.amObserve="no",this.play_status=0,this.playerlist=new Array,this.playerboardlist=new Array,this.observerlist=new Array,this.posBaseIdx=0,this.inited=!1,this.playerBoardSlotPos=[cc.v2(0,-150),cc.v2(0,150)],this.notReplay=!0,this.startGameTimer=null,this.endGameTimer=null,this.pangolds=0,this.isGamePlaying=!1,this.turnSeat=0,this.isNewRoom=!0,this.sendFlag=!1,this.turnCount={local:0,server:0},null!=cc.global&&(this.initgame(),""!=cc.global.user.roomid&&(this.recovery(),this.isNewRoom=!1)),cc.global.watchReplayData.onReplay&&this.prepareReplay(),this.setEtcKeyBoardEvent();var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==e&&(e=!0),e?(this.btnSfx.children[0].active=!0,this.btnSfx.children[1].active=!1):(this.btnSfx.children[0].active=!1,this.btnSfx.children[1].active=!0),cc.global.audio.playBGM("bgm_koni");for(var t=0;t<8;t++)this.matrix_pos[t]=new Array,this.matrix[t]=new Array,this.emptykoni[t]=new Array,this.konier[t]=new Array;this.emptywidth=this.piecewidth=this.gameboard.width/4,this.emptyheight=this.pieceheight=this.gameboard.height/8,this.boardspace=5;var i=this.emptyheight/2;for(t=0;t<8;t++){for(var a=this.emptywidth/2,s=0;s<4;s++)this.matrix_pos[t][s]=cc.p(a,i),a+=this.emptywidth;i+=this.emptyheight}for(var r=0;r<8;r++)for(t=0;t<4;t++)this.konier[r][t]=cc.instantiate(this.animalpiece1),this.konier[r][t].active=!1,this.konier[r][t].parent=this.gameboard,this.konier[r][t].getComponent("animalpiece1").setGeometry(this.piecewidth,this.pieceheight,this.matrix_pos[r][t]);for(t=0;t<8;t++)for(s=0;s<4;s++){var n=s,o=t;this.emptykoni[o][n]=cc.instantiate(this.emptybutton1),this.emptykoni[o][n].getComponent("emptybutton1").init(100,o,n,this),this.emptykoni[o][n].parent=this.gameboard,this.emptykoni[o][n].getComponent("emptybutton1").setGeometry(this.emptywidth,this.emptyheight,this.matrix_pos[o][n]),this.matrix[o][n]=100}this.lblTurnCount.string="0",this.positive=1,this.currentid=-1,this.currentCol=this.currentRow=-1,this.cntkoni=[],this.cntkoni[0]=[1,2,2,2,2,5,2,0],this.cntkoni[1]=[1,2,2,2,2,5,2,0],this.fun_setCnt();var l=1-cc.global.narrowContentRatio;if(0<l){var c=200*l;this.btn_giveup.y+=c,this.btn_chat.y+=c,c*=1.5,this.selfboard.y-=c,this.opponentboard.y-=c,this.score_pan.y-=c}var h=cc.sys.localStorage.getItem("animal1_help");if(this.gameboard_back.children[1].children[1].active=null==h,1==cc.global.curPlaywayScore){var d={command:"jr",cond:20,event:"command",game:"animal1",id:this.getLanguageText("TRAINING_ROOM_0"),name:"normal",observerlist:[],playerlist:[{avatarurl:cc.global.user.avatarurl,exp:0,explevel:0,gender:0,goldcoins:1e4,id:cc.global.user.id,nickname:cc.global.user.nickname,playcharacter:1,rank:0,seatid:0,texp:0,viplevel:0,vipscore:0},{avatarurl:"",exp:0,explevel:0,gender:0,goldcoins:1e4,id:0,nickname:this.getLanguageText("AI_PLAYER_0"),playcharacter:1,rank:0,seatid:1,texp:0,viplevel:0,vipscore:0}],players:2,playway:"animal1",score:1};this.joinroom_event(d,this)}},initgame:function(){var t=this;if(this.finishAct&&(this.finishAct.active=!1),!cc.global.isOffline){var e=this.socket();this.map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("banker",this.banker_event),this.map("playanimal1",this.playanimal1_event),this.map("rer",this.recovery_event),this.map("selemoticon",this.emoticon_event),this.map("sendchat",this.sendchat_event),this.map("callplayer",this.callplayer_event),this.map("allcards",this.allcards_event),this.map("chpre",this.chpre_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)})}var i={};switch(cc.global.user.roomInType||1<cc.global.curPlaywayScore){case"NormalCreate":null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i);break;case"NormalJoin":i.extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i);break;case"NormalObserve":i.extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i)}this.inited=!0,this.loadding(),(o=new s).init()},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},prepareReplay:function(){var e=this;e.notReplay=!1,cc.global.amObserve="yes",e.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),e.replay_bar.active=!0,e.replayStep="ready_room",e.replaySeq=0,e.replayPrevCmd="",e.goReplay()},stopAllClock:function(){this.turntimer.getComponent("TurnTimer").pauseAllTimer()},resumeAllClock:function(){this.turntimer.getComponent("TurnTimer").resumeAllTimer()},pauseReplayTimer:function(){this.stopAllClock(),clearTimeout(this.replayTimer)},resumeReplayTimer:function(){var e=this;this.resumeAllClock(),this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay/cc.global.watchReplayData.replaySpeedX)},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):this.togglePlayToPause()},togglePlayToPause:function(){this.replayTimer&&clearTimeout(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replay_bar.children[0].opacity=100,this.pauseReplayTimer()},replayPrevMove:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.replayEventProcess(!0))},replayNextMove:function(){this.togglePlayToPause(),this.replayEventProcess(!0)},onClickReplaySpeedUp:function(){var e=this.getLanguageText("REPLAY_TIME");cc.global.watchReplayData.replaySpeedX<5&&(cc.global.watchReplayData.replaySpeedX++,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){var e=this.getLanguageText("REPLAY_TIME");1<cc.global.watchReplayData.replaySpeedX&&(cc.global.watchReplayData.replaySpeedX--,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},cleanAllPlayers:function(){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].destroy(),this.playerboardlist[e].destroy();this.playerlist.splice(0,this.playerlist.length),this.playerboardlist.splice(0,this.playerboardlist.length),this.playerlist=new Array,this.playerboardlist=new Array,this.selfplayer&&(this.selfplayer.destroyAllChildren(),this.selfplayer.removeAllChildren()),this.opponentplayer&&(this.opponentplayer.destroyAllChildren(),this.opponentplayer.removeAllChildren())},replayEventProcess:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.play_history&&this.play_history[this.replaySeq]){this.replayTimeDelay=0;var t=!1;switch(this.replayStep){case"ready_room":this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"playanimal1":t=!0,this.playanimal1_event(i,this);break;case"allcards":t=!0,this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.emoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"players":this.players_event(i,this);break;case"chpre":t=!0,this.chpre_event(i,this)}this.replayPrevCmd=i.command}this.play_history[this.replaySeq+1]&&""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay+=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,e&&!t&&this.replayEventProcess(!0)}},goReplay:function(){var e=this;this.replayEventProcess(),this.play_history[this.replaySeq]?this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay):(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.replayPrevCmd="",this.pauseReplayTimer())},setEtcKeyBoardEvent:function(){var i=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e,t){switch(e){case cc.KEY.space:i.processReadyState();break;case cc.KEY.escape:case cc.KEY.back:if(!i.isemoticon&&!i.ischat)return void i.onclickBack();i.isemoticon&&(null!=i.emoticonpage&&i.emoticonpage.destroy(),i.isemoticon=!1),i.ischat&&(null!=i.chatpage&&i.chatpage.destroy(),i.ischat=!1)}}},i.node)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;e<0||(this.socket().exec("selemoticon",{extparams:{emoticon:e}}),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1))},onCtrlKeyDown:function(e){e.keycode==cc.KEY.space&&2==this.playerlist.length&&(this.endGameTimer||this.sendState())},processReadyState:function(){1!=this.tip_pan.active&&2==this.playerlist.length&&(this.endGameTimer||this.sendState())},joinroom_event:function(e,t){cc.global.user.selplayway=e.name,t.roomid=e.id,t.panScore=cc.global.curPlaywayScore=e.score;var i=t.getLanguageText("ROOM_0"),a=t.getLanguageText("SCORE_0");switch(t.roomdata.children[0].children[0].getComponent(cc.Label).string=e.id+i,t.roomdata.children[0].children[1].getComponent(cc.Label).string="("+t.numformat(e.score)+a+")",cc.global.isOffline&&(t.roomdata.children[0].children[0].getComponent(cc.Label).string=t.getLanguageText("TRAINING_ROOM_0"),t.roomdata.children[0].children[1].getComponent(cc.Label).string=""),cc.global.gamestatus){case"ready":cc.global.gamestatus="waiting",2==e.playerlist.length&&(cc.global.gamestatus="playing"),t.players_event(e,t);break;case"waiting":t.players_event(e,t);break;case"playing":cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)}e.hisdata?t.showMatchCareer(e.hisdata):t.hideMatchCareer(),"yes"==cc.global.amObserve?t.btn_giveup.active=!1:t.btn_giveup.active=!0,t.btn_chat.active=!0,cc.global.isOffline&&(t.btn_giveup.active=!1,t.btn_chat.active=!1),t.closeloadding()},players_event:function(e,t){2==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)if(e.observerlist[a].id==cc.global.user.id){i=!1;break}if(i&&t.notReplay)return cc.global.outReasonMsg=e.msg,void t.exitPlay();t.observer_event(e,t),t.isBoardPlayersChanged(e.playerlist)&&(t.startGameTimer&&(clearTimeout(t.startGameTimer),t.startGameTimer=null),t.endGameTimer&&(clearTimeout(t.endGameTimer),t.endGameTimer=null),t.players_engine(e,t))},players_engine:function(e){this.removeBoardPlayers(e.playerlist);for(var t=this.posBaseIdx,i=0;i<e.playerlist.length;i++){if(e.playerlist[i].seatid=i,"no"==cc.global.amObserve&&e.playerlist[i].id!=cc.global.user.id&&(t=1-this.posBaseIdx),this.playerexist(e.playerlist[i])){var a=this.getPlayer(e.playerlist[i].id),s=this.getPlayerBoard(e.playerlist[i].id);a.init(this,e.playerlist[i],t%2,i),s.init(this,e.playerlist[i],t%2,i),a.seatid=s.seatid=t%2,a.layoutForSeat(),s.layoutForSeat()}else{var r;"yes"!=cc.global.amObserve?(r=cc.instantiate(this.animal_player1),e.playerlist[i].id==cc.global.user.id?r.parent=this.selfplayer:r.parent=this.opponentplayer):(r=cc.instantiate(this.animal_player1)).parent=t%2==0?this.selfplayer:this.opponentplayer,r.getComponent("animalplayer1").init(this,e.playerlist[i],t%2,i),this.playerlist.push(r);var n=cc.instantiate(this.animal_player_board1);n.parent=this.statusboard,n.setPosition(this.playerBoardSlotPos[t%2]),1==cc.global.narrowContentRatio&&(r.getComponent("animalplayer1").passCount.node.opacity=0),n.getComponent("animalplayerBoard").init(this,e.playerlist[i],t%2,i),this.playerboardlist.push(n)}t++}1==e.playerlist.length?(this.setWaitingState(),this.cleanAfterAllCards(),this.hideMatchCareer()):2==e.playerlist.length&&this.setReadyState(),"yes"==cc.global.amObserve&&e.playerlist.length<2?1==cc.global.championMode?this.btn_enter.active=!1:0==cc.global.championMode&&this.notReplay&&(this.btn_enter.active=!0):this.btn_enter.active=!1,this.showWaitingTimer()},setWaitingState:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("animalplayerBoard");t&&t.setState("Pending")}},setReadyState:function(){var e=this.getLanguageText("READY_0")+"?";if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("animalplayerBoard");if(i&&(i.setState(e),1==cc.global.curPlaywayScore&&parseInt(i.userdata.id)<=0)){var a=this.getLanguageText("PREPARED_0");i.setState(a)}}},observer_event:function(e,t){t.observerbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i],t),a.getComponent("Observer").nickname.node.active=!1,a.parent=t.observerbench,t.observerlist[i]=a}},removeBoardPlayers:function(e){for(var t=0;t<this.playerlist.length;t++){for(var i=this.playerlist[t].getComponent("animalplayer1"),a=!1,s=0;s<e.length;s++)if(i.userdata.id==e[s].id){a=!0;break}1!=a&&(this.playerlist[t].destroy(),this.playerlist.splice(t,1),this.playerboardlist[t].destroy(),this.playerboardlist.splice(t,1))}},isBoardPlayersChanged:function(e){if(0==this.playerlist.length&&0!=e.length)return!0;if(this.playerlist.length!=e.length)return!0;for(var t=0;t<e.length;t++)if(!this.getPlayer(e[t].id))return!0;return!1},playerexist:function(e){for(var t=0;t<this.playerlist.length;t++)if(null!=this.playerlist[t]&&this.playerlist[t].getComponent("animalplayer1").userdata.id==e.id)return!0;return!1},initGameboard:function(){this.closeloadding()},changeTurn:function(e){if(0!=this.isGamePlaying){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];0==e?(this.turnSeat=1,t&&this.giveTurn2(this.animal_timer)):1==e&&(this.turnSeat=0,t&&this.giveTurn1(this.animal_timer))}},showMatchCareer:function(e){},hideMatchCareer:function(){},sendState:function(){if(1==cc.global.curPlaywayScore&&cc.global.isOffline){var e=this.getPlayerBoard(cc.global.user.id);if(e){var t=this.getLanguageText("PREPARED_0");e.setState(t)}var i={command:"banker",event:"command",id:cc.global.user.id,timer:60,banker:cc.global.user.id,players:[{curgame:"animal1",playuser:cc.global.user.id,type:0},{curgame:"animal1",playuser:0,type:1}],ratio:1,round:1,status:"playing"};this.banker_event(i,this)}else this.getPlayerBoard(cc.global.user.id).isReady()||this.socket().exec("ready",{extparams:{roomid:this.roomid}})},userready_event:function(e,t){cc.global.audio.playEffectAud("ready");var i=t.getPlayerBoard(e.userid);if(i){var a=t.getLanguageText("PREPARED_0");i.setState(a),i.startTimer(30)}},banker_event:function(e,t){cc.global.isOffline&&o.init(),t.closeConfirm(),t.hideAllStatus(),t.initGameboard(!0),t.isGamePlaying=!0,t.isNewRoom=!1,t.animal_timer=30,t.sendFlag=!1,e.timer&&!isNaN(e.timer)&&(t.animal_timer=parseInt(e.timer));for(var i=t.getPlayer(e.banker),a=0;a<t.playerlist.length;a++)t.playerlist[a].getComponent("animalplayer1").hideBanker();i&&(i.showBanker(),0==i.seatid?(t.turnSeat=0,t.giveTurn1(t.animal_timer)):(t.turnSeat=1,t.giveTurn2(t.animal_timer)));for(a=0;a<e.players.length;a++)0==t.getPlayer(e.players[a].playuser).seatid&&(0==parseInt(e.players[a].type)?t.positive=1:t.positive=-1);for(a=0;a<8;a++)for(var s=0;s<4;s++){t.konier[a][s].getComponent("animalpiece1").init(100,a,s,0,0,t),t.konier[a][s].active=!1,t.konier[a][s].setPosition(t.matrix_pos[a][s]),t.matrix[a][s]=100}t.currentRow=t.currentCol=-1,t.currentid=-1,t.koni_index=1;for(var r=0;r<2;r++)for(a=0;a<8;a++){var n=1;n=0==a?1:5==a?5:7==a?0:2,t.cntkoni[r][a]=n}t.finishMask.active=!1,t.fun_endmove()},playanimal1_event:function(e,t){if(t.sendFlag=!0,cc.global.isOffline||!t.notReplay||parseInt(t.roomid)==parseInt(e.room_id)){if(t.lblTurnCount&&e.extdata&&e.extdata.turncount){var i=t.getLanguageText("MOVE_COUNT");"EN"==cc.global.curLanguage?t.lblTurnCount.string=i+":"+Math.round(parseInt(e.extdata.turncount)/2):t.lblTurnCount.string=Math.round(parseInt(e.extdata.turncount)/2)+i,t.turnCount.server=parseInt(e.extdata.turncount),parseInt(cc.global.user.id)==parseInt(e.userid)&&"p"!=e.extdata.type||(t.turnCount.local+=1)}t.currentRow=t.currentCol=-1,t.currentid=-1,t.animal_timer=30,e.extdata.timer&&!isNaN(e.extdata.timer)&&(t.animal_timer=parseInt(e.extdata.timer)),t.closeConfirm(),t.stopTurnTimerAll();var a=t.getPlayer(e.userid);if(a){t.fun_hideoutline(),e.extdata.passcount&&a.updatePassCount(e.extdata.passcount);var s,r,n,o;s=parseInt(e.extdata.srow),r=parseInt(e.extdata.scol),n=parseInt(e.extdata.erow),o=parseInt(e.extdata.ecol);for(var l=0;l<8;l++)for(var c=0;c<4;c++){var h=parseInt(e.extdata.board[l][c]);Math.abs(h)<=7&&0<Math.abs(h)&&(h*=t.positive),t.matrix[l][c]=h}for(l=0;l<2;l++){var d=0;0!=t.getPlayer(e.extdata.information[l].playuser).seatid&&(d=1);for(c=0;c<7;c++){var u=parseInt(e.extdata.information[l].cnt[c]);t.cntkoni[d][c]=u}t.cntkoni[d][7]=parseInt(e.extdata.information[l].lastcount)}"m"==e.extdata.type?(t.fun_movepiece(s,r,n,o),t.changeTurnTimer=setTimeout(function(){t.changeTurn(a.seatid,!0),t.konier[n][o].getComponent("animalpiece1").show_outline(!0)},700)):"e"==e.extdata.type?(t.emptykoni[n][o].getComponent("emptybutton1").click_animation(),t.konier[n][o].getComponent("animalpiece1").setGeometry(t.piecewidth,t.pieceheight,t.matrix_pos[n][o]),t.konier[n][o].getComponent("animalpiece1").init(t.matrix[n][o],n,o,0,0,t),t.konier[n][o].active=!0,t.changeTurnTimer=setTimeout(function(){t.konier[n][o].getComponent("animalpiece1").show_outline(!0),t.fun_endmove(),t.changeTurn(a.seatid,!0)},300)):"p"==e.extdata.type?(t.fun_endmove(),t.changeTurn(a.seatid,!0)):(t.setTurn(a.userid,t.animal_timer),t.fun_endmove())}t.showBoardClaim(e.extdata.type);var p="";switch(e.extdata.type){case"n":break;case"p":p="pass"}""!=p&&a.speech(p)}},stopTurnTimerAll:function(){this.turntimer&&this.turntimer.getComponent("TurnTimer")&&this.turntimer.getComponent("TurnTimer").stopAllTimer()},showBoardClaim:function(e){if(this.boardclaim){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",i="";switch(e){case"n":break;case"p":i="pass";break;case"w":i="win";break;case"l":i="defeat";break;case"d":i="draw"}if("CH"==cc.global.curLanguage?i+="_ch":"RU"==cc.global.curLanguage?i+="_ru":i+="_en",this.boardclaim.node.children[0].active=!1,"tech"==t&&(this.boardclaim.node.children[0].active=!0,this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string={l:"Lose",w:"Victory"}[e]),"w"==e)this.runFinishAction("dzz_cj_win");else if("l"==e)this.runFinishAction("dzz_cj_lose");else if("p"==e){this.boardclaim.node.children[0].active=!0;var a=this.getLanguageText("PASS_0");this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string=a,this.boardclaim.getComponent(cc.Animation).play()}else this.boardclaim.spriteFrame=this.claimatlas.getSpriteFrame(i),this.boardclaim.getComponent(cc.Animation).play()}},runFinishAction:function(e){if("yes"!=cc.global.amObserve&&this.finishAct&&this.finishAct.getComponent(sp.Skeleton)){var t=cc.callFunc(this.enableFinishAni,this,e),i=cc.callFunc(this.disableFinishAni,this);this.node.runAction(cc.sequence(t,cc.delayTime(3),i))}},enableFinishAni:function(e,t){if(this.finishAct){var i=this.finishAct.getComponent(sp.Skeleton);i&&(this.finishAct.active=!0,i.animation=t)}},disableFinishAni:function(e){this.finishAct&&(this.finishAct.active=!1)},recovery_event:function(e,t){if(t.lblTurnCount&&e.count){var i=t.getLanguageText("MOVE_COUNT");"EN"==cc.global.curLanguage?t.lblTurnCount.string=i+":"+Math.round(parseInt(e.count)/2):t.lblTurnCount.string=Math.round(parseInt(e.count)/2)+i,t.lblTurnCount.string=Math.round(parseInt(e.count)/2)+"Turn",t.turnCount.local=parseInt(e.count),t.turnCount.server=parseInt(e.count)}for(var a=0;a<e.players.length;a++){(s=t.getPlayer(e.players[a].playuser))&&e.players[a].pass&&s.updatePassCount(e.players[a].pass)}t.closeConfirm(),t.hideAllStatus(),t.isGamePlaying=!0,t.isNewRoom=!1,t.animal_timer=30,e.timer&&!isNaN(e.timer)&&(t.animal_timer=parseInt(e.timer));var s=t.getPlayer(e.banker);for(a=0;a<t.playerlist.length;a++)t.playerlist[a].getComponent("animalplayer1").hideBanker();s&&s.showBanker(),(s=t.getPlayer(e.userid))&&(0==s.seatid?(t.turnSeat=0,t.giveTurn1(t.animal_timer)):(t.turnSeat=1,t.giveTurn2(t.animal_timer)));for(a=0;a<e.players.length;a++)0==t.getPlayer(e.players[a].playuser).seatid&&(0==parseInt(e.players[a].type)?t.positive=1:t.positive=-1);for(a=0;a<8;a++)for(var r=0;r<4;r++){var n=parseInt(e.board[a][r]);Math.abs(n)<=7&&0<Math.abs(n)&&(n*=t.positive),t.matrix[a][r]=n}for(a=0;a<2;a++){var o=0;0!=t.getPlayer(e.players[a].playuser).seatid&&(o=1);for(r=0;r<7;r++){var l=parseInt(e.players[a].cnt[r]);t.cntkoni[o][r]=l}t.cntkoni[o][7]=parseInt(e.players[a].lastcount)}t.koni_index=1,t.fun_endmove()},setPanInfo:function(e,t){this.getPlayer(e[0].playuser)},setTurn:function(e,t){var i=this.getPlayer(e);i&&(this.turnSeat=i.seatid),this.stopTurnTimerAll(),0==this.turnSeat?this.giveTurn1(t):1==this.turnSeat&&this.giveTurn2(t)},giveTurn1:function(e){this.sendFlag=!1,this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer1(e),this.togglePcsTurn(0))},giveTurn2:function(e){this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer2(e),this.togglePcsTurn(1)),cc.global.isOffline&&this.delayFun(1)},togglePcsTurn:function(e){},hideAllStatus:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("animalplayerBoard");t&&t.hideStatus()}},multiBetUp:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("animalplayer1");i&&i.betup.getComponent("TetrisBetUp").init(e,i.seatid)}},workOutMatchCareer:function(e){for(var t=0;t<e.players.length;t++){var i=this.getPlayer(e.players[t].userid),a=this.getPlayerBoard(e.players[t].userid);i&&a&&("normal"==cc.global.user.selplayway?0<e.players[t].score&&(this.matchCareerData.tgolds[i.userdata.id]+=e.players[t].score-this.pangolds/2):"diamond"==cc.global.user.selplayway&&0<e.players[t].score&&(this.matchCareerData.tdiamonds[i.userdata.id]+=e.players[t].score-this.pangolds/2),2==e.players[t].win&&(this.matchCareerData.wins[i.userdata.id]++,i.userdata.id))}this.showMatchCareer(this.matchCareerData)},allcards_event:function(i,a){for(var e=0;e<i.players.length;e++)i.players[e].userid==cc.global.user.id&&a.notReplay&&(cc.global.user.goldcoins=i.players[e].gold);clearTimeout(a.changeTurnTimer),a.otherEventCache=[],a.isGamePlaying=!1,a.stopTurnTimerAll(),a.matchCareerData&&a.workOutMatchCareer(i);var t=a.playerlist&&a.playerlist.length==i.players.length;for(e=0;e<i.players.length;e++){var s=a.getPlayer(i.players[e].userid);i.players[e].getout&&(t=!1),a.getPlayerBoard(i.players[e].userid)&&("suicide"!=i.title||i.players[e].win||(s=a.getPlayer(i.players[e].userid))&&s.showEmoticon(-1))}setTimeout(function(){a.finishMask&&(a.finishMask.active=!0),a.fun_showHelp(!1);for(var e=0;e<i.players.length;e++){var t=a.getPlayer(i.players[e].userid);if(t&&("normal"==cc.global.user.selplayway&&(t.userdata.goldcoins=parseInt(i.players[e].gold)),cc.global.isOffline||t.summary(i.players[e])),i.players[e].userid==cc.global.user.id)switch(i.players[e].win){case 0:a.showBoardClaim("l",i.title);break;case 1:a.showBoardClaim("d",i.title);break;case 2:a.showBoardClaim("w",i.title)}}},500),t?a.endGameTimer=setTimeout(function(){a.boardclaim&&(a.endGameTimer=null,a.boardclaim.getComponent(cc.Animation).stop(),a.boardclaim.node.setScale(0,0),a.cleanAfterAllCards(),a.setReadyState())},4e3):setTimeout(function(){a.finishMask&&(a.finishMask.active=!1)},3e3)},cleanAfterAllCards:function(){this.pangolds=0,cc.global.amObserve&&"no"==cc.global.amObserve&&this.showWaitingTimer();for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].getComponent("animalplayer1").hideBanker(),this.playerlist[e].getComponent("animalplayer1").updatePassCount(0);this.lblTurnCount&&(this.lblTurnCount.string="0",this.turnCount.local=0,this.turnCount.server=0);for(var t=0;t<8;t++)for(e=0;e<4;e++)this.konier[t][e].active=!1;this.finishMask.active=!1,this.fun_stopAnim(),this.fun_hideoutline();for(e=0;e<8;e++)for(var i=0;i<4;i++){this.matrix[e][i]=100}this.cntkoni[0]=[1,2,2,2,2,5,2,0],this.cntkoni[1]=[1,2,2,2,2,5,2,0],this.fun_endmove()},updateBetUpBalance:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("animalplayer1");i&&(i.userdata.goldcoins-=e)}this.updatePlayerBalance()},updatePlayerBalance:function(){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("animalplayer1");t&&t.updateBalance()}},showWaitingTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("animalplayerBoard");t&&t.startTimer(30)}},showReadyTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("animalplayerBoard");t&&t.startTimer(3)}},hideTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("animalplayerBoard");t&&t.stopTimer()}},getPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("animalplayer1");if(i.userdata.id==e)return i}},getOtherPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("animalplayer1");if(i.userdata.id!=e)return i}},getPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("animalplayerBoard");if(i.userdata.id==e)return i}},getOtherPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("animalplayerBoard");if(i.userdata.id!=e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},onClickGiveUp:function(){if(1!=this.tip_pan.active&&this.isGamePlaying){if(this.turnSeat)return void this.alert("No your turn.");var e=this;cc.global.audio.playVoiceSpeech("support/12_give_up");var t=this.getLanguageText("ARE_YOU_GIVE_UP");this.checkConfirm(t,function(){e&&e.socket().exec("suicide",{})},null)}},onClickSfx:function(){if(this.btnSfx){var e=this.btnSfx,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},showChatSearch:function(){},showChatDialog:function(){1!=this.tip_pan.active&&this.onclickChat(0)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.notReplay){if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}if(!(e<0)){this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root();var a=this.chatpage.getComponent("Chat");a.init(this,e),a.base.x=a.base.y=0,this.ischat=!0}}},onClickEmoticon:function(){if(this.notReplay){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),this.isemoticon=!1;this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root();var e=this.emoticonpage.getComponent("Emoticon");e.init(this,!1),e.base.x=e.base.y=0,this.isemoticon=!0}},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase,a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg);var s=t.getObserver(e.userid);s&&s.showCallPlayer(i,e.msg)},callplayer_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg);var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg,!1)},emoticon_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg);var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},onClickFindEmptyRoom:function(){},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},onClickChangePiece:function(){1==this.tgpcsbtn.children[0].active&&(this.tgpcsbtn.children[0].active=!1,this.tgpcsbtn.children[1].active=!0,this.togglePieceMode(!0)),1==this.tgpcsbtn.children[1].active&&(this.tgpcsbtn.children[0].active=!0,this.tgpcsbtn.children[1].active=!1,this.togglePieceMode(!1))},onclickBack:function(){var e=this;if(1!=cc.global.curPlaywayScore)if(this.notReplay)if(this.isGamePlaying&&"no"==cc.global.amObserve){if(this.turnSeat)return void this.alert("No your turn.");cc.global.audio.playVoiceSpeech("support/14_roomout"),this.checkConfirm("Are you sure to leave room? You will lose.",function(){e.socket().exec("leave",{})},null)}else this.socket().exec("leave",{});else this.exitPlay();else this.exitPlay()},exitPlay:function(){var e=this;cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),null==this.exitTimer&&(this.exitTimer=setInterval(function(){e.finishAct&&!e.finishAct.active&&(e.returnToHall(),clearInterval(e.exitTimer),e.exitTimer=null)},500))},returnToHall:function(){this.loadding(),clearInterval(this.otherEventInvoker),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.startGameTimer&&clearTimeout(this.startGameTimer),this.endGameTimer&&clearTimeout(this.endGameTimer),this.hideTimer(),this.cleanAllPlayers(),this.scene("hall",this)},chpre_event:function(e,t){t.closeOpenWin(),cc.global.openwin=cc.instantiate(t.roomrankdialog),cc.global.openwin.getComponent("RoomRankDialog").init(e.extdata),cc.global.openwin.parent=t.root(),t.notReplay||setTimeout(function(){null!=cc.global.openwin&&(cc.global.openwin.children[0].active=!1)},500)},fun_stopAnim:function(){for(var e=0;e<8;e++)for(var t=0;t<4;t++)this.emptykoni[e][t].getComponent("emptybutton1").show_flag(!1),this.konier[e][t].getComponent("animalpiece1").show_flag(!1)},fun_hideoutline:function(){for(var e=0;e<8;e++)for(var t=0;t<4;t++)this.konier[e][t].getComponent("animalpiece1").show_outline(!1)},click_selfpiece:function(e,t,i){this.fun_stopAnim(),this.currentid=e,this.currentRow=t,this.currentCol=i;for(var a=0;a<8;a++)for(var s=0;s<4;s++)this.konier[a][s].scaleX=.8,this.konier[a][s].scaleY=.8;this.konier[t][i].scaleX=1;for(a=-(this.konier[t][i].scaleY=1);a<=1;a++)for(s=-1;s<=1;s++)if(Math.abs(a+s)%2!=0){var r=i+s;if(!((h=t+a)<0||7<h||r<0||3<r)&&100!=this.matrix[h][r])if(0==this.matrix[h][r])this.emptykoni[h][r].getComponent("emptybutton1").show_flag(!0);else{if(0<this.matrix[h][r])continue;var n=0;if(this.matrix[t][i]<=Math.abs(this.matrix[h][r])&&(n=1),6==this.matrix[t][i]&&-1==this.matrix[h][r]&&(n=1),1==this.matrix[t][i]&&-6==this.matrix[h][r]&&(n=0),7==this.matrix[t][i])continue;if(0==n)continue;this.konier[h][r].getComponent("animalpiece1").show_flag(!0)}}if(7==this.matrix[t][i]){var o=[[0,2],[2,0],[-2,0],[0,-2]];for(a=0;a<4;a++){var l,c,h=t+o[a][0];r=i+o[a][1];h<0||r<0||7<h||3<r||(0<=this.matrix[h][r]||(0==a?(l=t,c=i+1):1==a?(l=t+1,c=i):2==a?(l=t-1,c=i):(l=t,c=i-1),0!=this.matrix[l][c]&&(0<=this.matrix[h][r]||this.konier[h][r].getComponent("animalpiece1").show_flag(!0))))}}},on_clickEmpty:function(e,t){if(1!=this.turnSeat&&1!=this.sendFlag)if(this.fun_stopAnim(),100==this.matrix[e][t]){if(cc.global.isOffline){var i={srow:-1,scol:-1,erow:e,ecol:t,type:"e",roomid:this.roomid,localturn:this.turnCount.local};return this.play_offline(i,cc.global.user.id),void(this.sendFlag=!0)}this.socket().exec("playanimal1",{extparams:{srow:-1,scol:-1,erow:e,ecol:t,type:"e",roomid:this.roomid,localturn:this.turnCount.local}}),this.sendFlag=!0}else if(0==this.matrix[e][t]){if(-1==this.currentCol||-1==this.currentRow||-1==this.currentid)return;if(Math.abs(this.currentCol-t)+Math.abs(this.currentRow-e)==1){if(cc.global.isOffline){i={srow:this.currentRow,scol:this.currentCol,erow:e,ecol:t,type:"m",roomid:this.roomid,localturn:this.turnCount.local};return this.play_offline(i,cc.global.user.id),void(this.sendFlag=!0)}this.socket().exec("playanimal1",{extparams:{srow:this.currentRow,scol:this.currentCol,erow:e,ecol:t,type:"m",roomid:this.roomid,localturn:this.turnCount.local}}),this.sendFlag=!0}}},on_clickTarget:function(e,t){if(1!=this.turnSeat&&1!=this.sendFlag){this.fun_stopAnim();for(var i=0;i<8;i++)for(var a=0;a<4;a++)this.konier[i][a].scaleX=.8,this.konier[i][a].scaleY=.8;if(-1!=this.currentCol&&-1!=this.currentRow&&-1!=this.currentid){if(7==this.matrix[this.currentRow][this.currentCol]){var s,r,n=0;if(2==Math.abs(this.currentCol-t)&&this.currentRow==e&&(n=1),2==Math.abs(this.currentRow-e)&&this.currentCol==t&&(n=1),0==n)return;if(s=this.currentRow,r=this.currentCol,this.currentCol<t?r++:this.currentRow<e?s++:this.currentRow>e?s--:this.currentCol>t&&r--,0==this.matrix[s][r])return;if(cc.global.isOffline){var o={srow:this.currentRow,scol:this.currentCol,erow:e,ecol:t,type:"m",roomid:this.roomid,localturn:this.turnCount.local};return this.play_offline(o,cc.global.user.id),void(this.sendFlag=!0)}return this.socket().exec("playanimal1",{extparams:{srow:this.currentRow,scol:this.currentCol,erow:e,ecol:t,type:"m",roomid:this.roomid,localturn:this.turnCount.local}}),void(this.sendFlag=!0)}if(Math.abs(this.currentCol-t)+Math.abs(this.currentRow-e)==1){n=0;if(this.matrix[this.currentRow][this.currentCol]<=Math.abs(this.matrix[e][t])&&(n=1),6==this.matrix[this.currentRow][this.currentCol]&&-1==this.matrix[e][t]&&(n=1),1==this.matrix[this.currentRow][this.currentCol]&&-6==this.matrix[e][t]&&(n=0),0==n)return;if(cc.global.isOffline){o={srow:this.currentRow,scol:this.currentCol,erow:e,ecol:t,type:"m",roomid:this.roomid,localturn:this.turnCount.local};return this.play_offline(o,cc.global.user.id),void(this.sendFlag=!0)}return this.socket().exec("playanimal1",{extparams:{srow:this.currentRow,scol:this.currentCol,erow:e,ecol:t,type:"m",roomid:this.roomid,localturn:this.turnCount.local}}),void(this.sendFlag=!0)}}}},fun_movepiece:function(e,t,i,a){var s=Math.abs(this.konier[i][a].getComponent("animalpiece1").id);this.konier[e][t].zIndex=this.koni_index,this.koni_index++,0<s&&s<=7&&1==this.konier[i][a].active?(this.konier[i][a].getComponent("animalpiece1").kill_Piece(),this.konier[e][t].getComponent("animalpiece1").move_kill(i,a)):this.konier[e][t].getComponent("animalpiece1").move(i,a)},fun_endmove:function(){this.fun_stopAnim();for(var e=0;e<8;e++)for(var t=0;t<4;t++){var i=this.matrix[e][t];0<Math.abs(i)&&Math.abs(i)<=7?(this.konier[e][t].getComponent("animalpiece1").setGeometry(this.piecewidth,this.pieceheight,this.matrix_pos[e][t]),this.konier[e][t].getComponent("animalpiece1").init(i,e,t,0,0,this),this.konier[e][t].active=!0,this.emptykoni[e][t].active=!1):0!=i&&100!=i||(this.konier[e][t].active=!1,0==i?(this.emptykoni[e][t].getComponent("emptybutton1").id=0,this.emptykoni[e][t].getComponent("emptybutton1").drawImage(!1)):(this.emptykoni[e][t].getComponent("emptybutton1").id=100,this.emptykoni[e][t].getComponent("emptybutton1").drawImage(!0)))}this.fun_setCnt()},fun_setCnt:function(){for(var e=[0,0],t=0;t<7;t++)this.chessArray.children[t].children[0].children[0].getComponent(cc.Label).string=this.cntkoni[0][t],e[0]+=this.cntkoni[0][t];for(t=0;t<7;t++)this.chessArray1.children[t].children[0].children[0].getComponent(cc.Label).string=this.cntkoni[1][t],e[1]+=this.cntkoni[1][t];this.chessArray.children[7].children[0].children[0].getComponent(cc.Label).string=e[0],this.chessArray1.children[7].children[0].children[0].getComponent(cc.Label).string=e[1],this.score_pan.children[1].getComponent(cc.Label).string=this.cntkoni[0][7],this.score_pan.children[2].getComponent(cc.Label).string=this.cntkoni[1][7]},fun_showHelp:function(e){this.tip_pan&&this.gameboard_back&&(e?(this.tip_pan.active=!0,cc.sys.localStorage.setItem("animal1_help",!0),this.gameboard_back.children[1].children[1].active=!1,this.gameboard_back.active=!1):(this.tip_pan.active=!1,this.gameboard_back.active=!0))},on_click_cancel_help:function(){this.fun_showHelp(!1)},on_click_helpBtn:function(){this.fun_showHelp(!0)},play_offline:function(e,t){t==cc.global.user.id&&o.play_user(e);var i={command:"playanimal1",event:"command",room_id:this.roomid,userid:t,extdata:{type:e.type,timer:60,passcount:0,turncount:o.turncount,srow:e.srow,scol:e.scol,erow:e.erow,ecol:e.ecol,board:o.currentMatrix,information:[{curgame:"animal1",playuser:cc.global.user.id,cnt:o.cntkoni[0],lastcount:o.lastcount[0]},{curgame:"animal1",playuser:0,cnt:o.cntkoni[1],lastcount:o.lastcount[1]}]},status:"playing"};this.playanimal1_event(i,this);for(var a=0;a<2;a++)11<=o.lastcount[a]&&this.finish_offline()},finish_offline:function(){var e=this,t={command:"playanimal1",event:"command",room_id:this.roomid,title:"finish",players:[{curgame:"animal1",userid:cc.global.user.id,gold:1e4,getout:!1,win:0},{curgame:"animal1",userid:0,gold:1e4,getout:!1,win:0}]};11<=o.lastcount[0]&&(t.players[0].win=2),11<=o.lastcount[1]&&(t.players[1].win=2),this.isGamePlaying=!1,this.stopTurnTimerAll(),this.scheduleOnce(function(){e.allcards_event(t,e)},2)},delayFun:function(e){var t=this;this.scheduleOnce(function(){try{o.trainer_play(),o.countRemain();var e=o.result;t.play_offline(e,0)}catch(e){return void console.log(e)}},e)}}),cc._RF.pop()},{AnimalEngine1:"AnimalEngine1",HHCommon:"HHCommon"}],AnimalBegin:[function(e,t,i){"use strict";cc._RF.push(t,"53f8bM2FyVHaJPLbiFGeGxN","AnimalBegin");var a=e("HHCommon");cc.Class({extends:a,properties:{animal_player:{default:null,type:cc.Prefab},animal_player_board:{default:null,type:cc.Prefab},selfplayer:{default:null,type:cc.Node},opponentplayer:{default:null,type:cc.Node},selfboard:{default:null,type:cc.Node},opponentboard:{default:null,type:cc.Node},statusboard:{default:null,type:cc.Node},boardclaim:{default:null,type:cc.Sprite},claimatlas:{default:null,type:cc.SpriteAtlas},roomdata:{default:null,type:cc.Node},turntimer:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},observer:{default:null,type:cc.Prefab},observerbench:{default:null,type:cc.Node},emodlg:{default:null,type:cc.Prefab},chat:{default:null,type:cc.Prefab},btn_enter:{default:null,type:cc.Node},btn_giveup:{default:null,type:cc.Node},btn_chat:{default:null,type:cc.Node},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},finishAct:{default:null,type:cc.Node},btnSfx:{default:null,type:cc.Node},lblTurnCount:{default:null,type:cc.Label},gameboard:{default:null,type:cc.Node},finishMask:{default:null,type:cc.Node},tip_pan:{default:null,type:cc.Node},animalpiece:{default:null,type:cc.Prefab},emptybutton:{default:null,type:cc.Prefab},konier:{default:[]},emptykoni:{default:[]},matrix_pos:{default:[]},matrix:{default:[]}},onLoad:function(){this.tip_pan.active=!1,this.finishMask.active=!1,this.initEventCallback(),cc.game.setFrameRate(60),cc.global.amObserve="no",this.play_status=0,this.playerlist=new Array,this.playerboardlist=new Array,this.observerlist=new Array,this.posBaseIdx=0,this.inited=!1,this.playerBoardSlotPos=[cc.v2(0,-150),cc.v2(0,150)],this.notReplay=!0,this.startGameTimer=null,this.endGameTimer=null,this.pangolds=0,this.isGamePlaying=!1,this.turnSeat=0,this.isNewRoom=!0,this.sendFlag=!1,this.turnCount={local:0,server:0},null!=cc.global&&(this.initgame(),""!=cc.global.user.roomid&&(this.recovery(),this.isNewRoom=!1)),cc.global.watchReplayData.onReplay&&this.prepareReplay(),this.setEtcKeyBoardEvent();var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==e&&(e=!0),e?(this.btnSfx.children[0].active=!0,this.btnSfx.children[1].active=!1):(this.btnSfx.children[0].active=!1,this.btnSfx.children[1].active=!0),cc.global.audio.playBGM("bgm_koni");for(var t=0;t<9;t++)this.matrix_pos[t]=new Array,this.matrix[t]=new Array,this.emptykoni[t]=new Array;this.emptywidth=this.piecewidth=90,this.emptyheight=this.pieceheight=90,this.boardspace=5,this.konier[0]=new Array,this.konier[1]=new Array;var i=this.boardspace+this.emptyheight/2;for(t=0;t<9;t++){var a=this.boardspace+this.emptywidth/2;0==t&&(i+=10);for(var s=0;s<7;s++)0==s&&(a+=15),this.matrix_pos[t][s]=cc.p(a,i),a+=this.emptywidth+this.boardspace;i+=this.emptyheight+this.boardspace}for(t=0;t<63;t++){var r=t%7,n=Math.floor(t/7),o=0;this.emptykoni[n][r]=cc.instantiate(this.emptybutton),3==t||59==t?o=3:2==t||4==t||10==t?o=1:52==t||58==t||60==t?o=1:22==t||23==t||25==t||26==t?o=2:29==t||30==t||32==t||33==t?o=2:36!=t&&37!=t&&39!=t&&40!=t||(o=2),this.emptykoni[n][r].getComponent("emptybutton").init(o+10,n,r,this),this.emptykoni[n][r].parent=this.gameboard,this.emptykoni[n][r].getComponent("emptybutton").setGeometry(this.emptywidth,this.emptyheight,this.matrix_pos[n][r]),this.matrix[n][r]=10+o}this.mymatrix=[[2,0],[0,6],[0,0],[2,4],[2,2],[1,5],[1,1],[2,6]],this.opponentmatrix=[[6,6],[8,0],[8,6],[6,2],[6,4],[7,1],[7,5],[6,0]];for(var l=0;l<2;l++)for(t=0;t<8;t++)this.konier[l][t]=cc.instantiate(this.animalpiece),this.konier[l][t].getComponent("animalpiece").node.active=!1;this.lblTurnCount.string="";var c=1-cc.global.narrowContentRatio;if(0<c){var h=200*c;this.selfboard.y-=h,this.opponentboard.y+=h,this.btn_giveup.y-=h,this.btn_chat.y-=h}var d=cc.sys.localStorage.getItem("animal_help");this.gameboard.children[0].children[1].active=null==d},initgame:function(){var t=this;this.finishAct&&(this.finishAct.active=!1);var e=this.socket();this.map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("banker",this.banker_event),this.map("playanimal",this.playanimal_event),this.map("rer",this.recovery_event),this.map("selemoticon",this.emoticon_event),this.map("sendchat",this.sendchat_event),this.map("callplayer",this.callplayer_event),this.map("sl",this.sendlines_event),this.map("allcards",this.allcards_event),this.map("chpre",this.chpre_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)});var i={};switch(cc.global.user.roomInType){case"NormalCreate":null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i);break;case"NormalJoin":i.extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i);break;case"NormalObserve":i.extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i)}this.inited=!0,this.loadding()},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},prepareReplay:function(){var e=this;e.notReplay=!1,cc.global.amObserve="yes",e.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),e.replay_bar.active=!0,e.replayStep="ready_room",e.replaySeq=0,e.replayPrevCmd="",e.goReplay()},stopAllClock:function(){this.turntimer.getComponent("TurnTimer").pauseAllTimer()},resumeAllClock:function(){this.turntimer.getComponent("TurnTimer").resumeAllTimer()},pauseReplayTimer:function(){this.stopAllClock(),clearTimeout(this.replayTimer)},resumeReplayTimer:function(){var e=this;this.resumeAllClock(),this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay/cc.global.watchReplayData.replaySpeedX)},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):this.togglePlayToPause()},togglePlayToPause:function(){this.replayTimer&&clearTimeout(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replay_bar.children[0].opacity=100,this.pauseReplayTimer()},replayPrevMove:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.replayEventProcess(!0))},replayNextMove:function(){this.togglePlayToPause(),this.replayEventProcess(!0)},onClickReplaySpeedUp:function(){var e=this.getLanguageText("REPLAY_TIME");cc.global.watchReplayData.replaySpeedX<5&&(cc.global.watchReplayData.replaySpeedX++,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){var e=this.getLanguageText("REPLAY_TIME");1<cc.global.watchReplayData.replaySpeedX&&(cc.global.watchReplayData.replaySpeedX--,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},cleanAllPlayers:function(){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].destroy(),this.playerboardlist[e].destroy();this.playerlist.splice(0,this.playerlist.length),this.playerboardlist.splice(0,this.playerboardlist.length),this.playerlist=new Array,this.playerboardlist=new Array,this.selfplayer&&(this.selfplayer.destroyAllChildren(),this.selfplayer.removeAllChildren()),this.opponentplayer&&(this.opponentplayer.destroyAllChildren(),this.opponentplayer.removeAllChildren())},replayEventProcess:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.play_history&&this.play_history[this.replaySeq]){this.replayTimeDelay=0;var t=!1;switch(this.replayStep){case"ready_room":this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"playanimal":t=!0,this.playanimal_event(i,this);break;case"allcards":t=!0,this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.emoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"players":this.players_event(i,this);break;case"chpre":t=!0,this.chpre_event(i,this)}this.replayPrevCmd=i.command}this.play_history[this.replaySeq+1]&&""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay+=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,e&&!t&&this.replayEventProcess(!0)}},goReplay:function(){var e=this;this.replayEventProcess(),this.play_history[this.replaySeq]?this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay):(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.replayPrevCmd="",this.pauseReplayTimer())},setEtcKeyBoardEvent:function(){var i=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e,t){switch(e){case cc.KEY.space:i.processReadyState();break;case cc.KEY.escape:case cc.KEY.back:if(!i.isemoticon&&!i.ischat)return void i.onclickBack();i.isemoticon&&(null!=i.emoticonpage&&i.emoticonpage.destroy(),i.isemoticon=!1),i.ischat&&(null!=i.chatpage&&i.chatpage.destroy(),i.ischat=!1)}}},i.node)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;e<0||(this.socket().exec("selemoticon",{extparams:{emoticon:e}}),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1))},onCtrlKeyDown:function(e){e.keycode==cc.KEY.space&&2==this.playerlist.length&&(this.endGameTimer||this.sendState())},processReadyState:function(){1!=this.tip_pan.active&&2==this.playerlist.length&&(this.endGameTimer||this.sendState())},joinroom_event:function(e,t){cc.global.user.selplayway=e.name,t.roomid=e.id,t.panScore=cc.global.curPlaywayScore=e.score;var i=t.getLanguageText("ROOM_0"),a=t.getLanguageText("SCORE_0");switch(t.roomdata.children[0].children[0].getComponent(cc.Label).string=e.id+i,t.roomdata.children[0].children[1].getComponent(cc.Label).string="("+t.numformat(e.score)+a+")",cc.global.gamestatus){case"ready":cc.global.gamestatus="waiting",2==e.playerlist.length&&(cc.global.gamestatus="playing"),t.players_event(e,t);break;case"waiting":t.players_event(e,t);break;case"playing":cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)}e.hisdata?t.showMatchCareer(e.hisdata):t.hideMatchCareer(),"yes"==cc.global.amObserve?t.btn_giveup.active=!1:t.btn_giveup.active=!0,t.btn_chat.active=!0,t.closeloadding()},players_event:function(e,t){2==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)if(e.observerlist[a].id==cc.global.user.id){i=!1;break}if(i&&t.notReplay)return cc.global.outReasonMsg=e.msg,void t.exitPlay();t.observer_event(e,t),t.isBoardPlayersChanged(e.playerlist)&&(t.startGameTimer&&(clearTimeout(t.startGameTimer),t.startGameTimer=null),t.endGameTimer&&(clearTimeout(t.endGameTimer),t.endGameTimer=null),t.players_engine(e,t))},players_engine:function(e){this.removeBoardPlayers(e.playerlist);for(var t=this.posBaseIdx,i=0;i<e.playerlist.length;i++){if(e.playerlist[i].seatid=i,"no"==cc.global.amObserve&&e.playerlist[i].id!=cc.global.user.id&&(t=1-this.posBaseIdx),this.playerexist(e.playerlist[i])){var a=this.getPlayer(e.playerlist[i].id),s=this.getPlayerBoard(e.playerlist[i].id),r=a.seatid;a.init(this,e.playerlist[i],t%2,i),s.init(this,e.playerlist[i],t%2,i),a.seatid=s.seatid=t%2,a.layoutForSeat(),s.layoutForSeat(),1==e.playerlist.length&&"yes"==cc.global.amObserve&&1==r&&(a.callplayer.scaleX=1,a.callplayer.children[0].scaleX=1,a.userinformationpan.x=80,a.userinformationpan.anchorX=0,a.goldcoin_base.anchorX=0,a.nickname.node.anchorX=0,a.passCount1.anchorX=0,a.banker.x=-65,a.winorlose.x=300)}else{var n;n=cc.instantiate(this.animal_player),"yes"!=cc.global.amObserve?e.playerlist[i].id==cc.global.user.id?n.parent=this.selfplayer:n.parent=this.opponentplayer:n.parent=t%2==0?this.selfplayer:this.opponentplayer,n.getComponent("animalplayer").init(this,e.playerlist[i],t%2,i),this.playerlist.push(n);var o=cc.instantiate(this.animal_player_board);o.parent=this.statusboard,o.setPosition(this.playerBoardSlotPos[t%2]),o.getComponent("animalplayerBoard").init(this,e.playerlist[i],t%2,i),this.playerboardlist.push(o)}t++}1==e.playerlist.length?(this.setWaitingState(),this.cleanAfterAllCards(),this.hideMatchCareer()):2==e.playerlist.length&&this.setReadyState(),"yes"==cc.global.amObserve&&e.playerlist.length<2?1==cc.global.championMode?this.btn_enter.active=!1:0==cc.global.championMode&&this.notReplay&&(this.btn_enter.active=!0):this.btn_enter.active=!1,this.showWaitingTimer()},setWaitingState:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("animalplayerBoard");t&&t.setState("Pending")}},setReadyState:function(){var e=this.getLanguageText("READY_0")+"?";if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("animalplayerBoard");i&&i.setState(e)}},observer_event:function(e,t){t.observerbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i],t),a.getComponent("Observer").nickname.node.active=!1,a.parent=t.observerbench,t.observerlist[i]=a}},removeBoardPlayers:function(e){for(var t=0;t<this.playerlist.length;t++){for(var i=this.playerlist[t].getComponent("animalplayer"),a=!1,s=0;s<e.length;s++)if(i.userdata.id==e[s].id){a=!0;break}1!=a&&(this.playerlist[t].destroy(),this.playerlist.splice(t,1),this.playerboardlist[t].destroy(),this.playerboardlist.splice(t,1))}},isBoardPlayersChanged:function(e){if(0==this.playerlist.length&&0!=e.length)return!0;if(this.playerlist.length!=e.length)return!0;for(var t=0;t<e.length;t++)if(!this.getPlayer(e[t].id))return!0;return!1},playerexist:function(e){for(var t=0;t<this.playerlist.length;t++)if(null!=this.playerlist[t]&&this.playerlist[t].getComponent("animalplayer").userdata.id==e.id)return!0;return!1},initGameboard:function(){this.closeloadding()},changeTurn:function(e){if(0!=this.isGamePlaying){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];0==e?(this.turnSeat=1,t&&this.giveTurn2(this.animal_timer)):1==e&&(this.turnSeat=0,t&&this.giveTurn1(this.animal_timer))}},showMatchCareer:function(e){},hideMatchCareer:function(){},sendState:function(){this.getPlayerBoard(cc.global.user.id).isReady()||this.socket().exec("ready",{extparams:{roomid:this.roomid}})},userready_event:function(e,t){cc.global.audio.playEffectAud("ready");var i=t.getPlayerBoard(e.userid),a=t.getLanguageText("PREPARED_0");i&&(i.setState(a),i.startTimer(30))},banker_event:function(e,t){t.closeConfirm(),t.hideAllStatus(),t.initGameboard(!0),t.sendFlag=!1,t.isGamePlaying=!0,t.isNewRoom=!1,t.animal_timer=30,e.timer&&!isNaN(e.timer)&&(t.animal_timer=parseInt(e.timer));for(var i=t.getPlayer(e.banker),a=0;a<t.playerlist.length;a++)t.playerlist[a].getComponent("animalplayer").hideBanker();i&&(i.showBanker(),0==i.seatid?(t.turnSeat=0,t.giveTurn1(t.animal_timer)):(t.turnSeat=1,t.giveTurn2(t.animal_timer)));for(a=0;a<e.players.length;a++)0==t.getPlayer(e.players[a].playuser).seatid&&(0==parseInt(e.players[a].type)?t.positive=1:t.positive=-1);for(a=0;a<9;a++)for(var s=0;s<7;s++){var r=parseInt(e.board[a][s]);t.matrix[a][s]=r;var n=0;if(0<Math.abs(r)&&Math.abs(r)<9){r<0&&(n=1);var o=Math.abs(r)-1;t.konier[n][o].getComponent("animalpiece").init(o+1,n,a,s,0,0,t),t.konier[n][o].parent=t.gameboard,t.konier[n][o].getComponent("animalpiece").setGeometry(t.piecewidth,t.pieceheight,t.matrix_pos[a][s])}}0==t.turnSeat&&t.show_canmovePiece(!0),t.finishMask.active=!1},playanimal_event:function(e,t){if(t.sendFlag=!0,!t.notReplay||parseInt(t.roomid)==parseInt(e.room_id)){if(t.lblTurnCount&&e.extdata&&e.extdata.turncount){var i=t.getLanguageText("MOVE_COUNT");"EN"==cc.global.curLanguage?t.lblTurnCount.string=i+":"+Math.round(parseInt(e.extdata.turncount)/2):t.lblTurnCount.string=Math.round(parseInt(e.extdata.turncount)/2)+i,t.turnCount.server=parseInt(e.extdata.turncount),parseInt(cc.global.user.id)==parseInt(e.userid)&&"p"!=e.extdata.type||(t.turnCount.local+=1)}t.animal_timer=30,e.extdata.timer&&!isNaN(e.extdata.timer)&&(t.animal_timer=parseInt(e.extdata.timer)),t.closeConfirm(),t.stopTurnTimerAll();for(var a=t.getPlayer(e.userid),s=0;s<2;s++)for(var r=0;r<8;r++)t.konier[s][r].opacity=255;if(a){if(e.extdata.passcount&&a.updatePassCount(e.extdata.passcount),"p"!=e.extdata.type){if("n"==e.extdata.type)return;var n=0;n=0==a.seatid?0:1;var o=0,l=0,c=0,h=0,d=0;o=parseInt(e.extdata.srow),l=parseInt(e.extdata.scol),c=parseInt(e.extdata.erow),h=parseInt(e.extdata.ecol),1==n&&(o=8-o,l=6-l,c=8-c,h=6-h),d=t.matrix[o][l],d=Math.abs(d)-1,t.fun_movepiece(n,d,o,l,c,h);for(r=0;r<9;r++)for(s=0;s<7;s++){var u=parseInt(e.extdata.board[r][s]);t.matrix[r][s]=u}-1==t.positive&&t.fun_convertmatrix(),t.changeTurnTimer=setTimeout(function(){t.changeTurn(a.seatid,!0),1==n&&t.show_canmovePiece(!0)},500)}else 0==a.seatid?t.show_canmovePiece(!1):t.show_canmovePiece(!0),t.changeTurn(a.seatid,!0);for(r=0;r<9;r++)for(s=0;s<7;s++)t.emptykoni[r][s].getComponent("emptybutton").showFlag(!1);for(r=0;r<8;r++)t.konier[1][r].getComponent("animalpiece").showFlag(!1)}t.showBoardClaim(e.extdata.type);var p="";switch(e.extdata.type){case"n":break;case"p":p="pass"}""!=p&&a.speech(p)}},stopTurnTimerAll:function(){this.turntimer&&this.turntimer.getComponent("TurnTimer")&&this.turntimer.getComponent("TurnTimer").stopAllTimer()},showBoardClaim:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",i="";switch(e){case"n":break;case"p":i="pass";break;case"w":i="win";break;case"l":i="defeat";break;case"d":i="draw"}if("CH"==cc.global.curLanguage?i+="_ch":"RU"==cc.global.curLanguage?i+="_ru":i+="_en",this.boardclaim.node.children[0].active=!1,"tech"==t&&(this.boardclaim.node.children[0].active=!0,this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string={l:"Lose",w:"Victory"}[e]),"w"==e)this.runFinishAction("dzz_cj_win");else if("l"==e)this.runFinishAction("dzz_cj_lose");else if("p"==e){this.boardclaim.node.children[0].active=!0;var a=this.getLanguageText("PASS_0");this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string=a,this.boardclaim.getComponent(cc.Animation).play()}else this.boardclaim.spriteFrame=this.claimatlas.getSpriteFrame(i),this.boardclaim.getComponent(cc.Animation).play()},runFinishAction:function(e){if("yes"!=cc.global.amObserve&&this.finishAct&&this.finishAct.getComponent(sp.Skeleton)){var t=cc.callFunc(this.enableFinishAni,this,e),i=cc.callFunc(this.disableFinishAni,this);this.node.runAction(cc.sequence(t,cc.delayTime(3),i))}},enableFinishAni:function(e,t){if(this.finishAct){var i=this.finishAct.getComponent(sp.Skeleton);i&&(this.finishAct.active=!0,i.animation=t)}},disableFinishAni:function(e){this.finishAct&&(this.finishAct.active=!1)},recovery_event:function(e,t){if(t.lblTurnCount&&e.count){var i=t.getLanguageText("MOVE_COUNT");"EN"==cc.global.curLanguage?t.lblTurnCount.string=i+":"+Math.round(parseInt(e.count)/2):t.lblTurnCount.string=Math.round(parseInt(e.count)/2)+i,t.turnCount.local=parseInt(e.count),t.turnCount.server=parseInt(e.count)}for(var a=0;a<e.players.length;a++){(s=t.getPlayer(e.players[a].playuser))&&e.players[a].pass&&s.updatePassCount(e.players[a].pass)}t.closeConfirm(),t.hideAllStatus(),t.isGamePlaying=!0,t.isNewRoom=!1,t.animal_timer=30,e.timer&&!isNaN(e.timer)&&(t.animal_timer=parseInt(e.timer));var s=t.getPlayer(e.banker);for(a=0;a<t.playerlist.length;a++)t.playerlist[a].getComponent("animalplayer").hideBanker();s&&s.showBanker(),(s=t.getPlayer(e.userid))&&(0==s.seatid?(t.turnSeat=0,t.giveTurn1(t.animal_timer)):(t.turnSeat=1,t.giveTurn2(t.animal_timer)));for(a=0;a<e.players.length;a++)0==t.getPlayer(e.players[a].playuser).seatid&&(0==parseInt(e.players[a].type)?t.positive=1:t.positive=-1);for(a=0;a<9;a++)for(var r=0;r<7;r++){var n=parseInt(e.board[a][r]);t.matrix[a][r]=n}-1==t.positive&&t.fun_convertmatrix();for(a=0;a<9;a++)for(r=0;r<7;r++){n=t.matrix[a][r];var o=0;if(0<Math.abs(n)&&Math.abs(n)<9){n<0&&(o=1);var l=Math.abs(n)-1;t.konier[o][l].getComponent("animalpiece").init(l+1,o,a,r,0,0,t),t.konier[o][l].parent=t.gameboard,t.konier[o][l].getComponent("animalpiece").setGeometry(t.piecewidth,t.pieceheight,t.matrix_pos[a][r])}}0==t.turnSeat&&t.show_canmovePiece(!0)},setPanInfo:function(e,t){this.getPlayer(e[0].playuser)},setTurn:function(e,t){var i=this.getPlayer(e);i&&(this.turnSeat=i.seatid),this.stopTurnTimerAll(),0==this.turnSeat?this.giveTurn1(t):1==this.turnSeat&&this.giveTurn2(t)},giveTurn1:function(e){this.sendFlag=!1,this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer1(e),this.togglePcsTurn(0))},giveTurn2:function(e){this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer2(e),this.togglePcsTurn(1))},togglePcsTurn:function(e){},hideAllStatus:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("animalplayerBoard");t&&t.hideStatus()}},multiBetUp:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("animalplayer");i&&i.betup.getComponent("TetrisBetUp").init(e,i.seatid)}},workOutMatchCareer:function(e){for(var t=0;t<e.players.length;t++){var i=this.getPlayer(e.players[t].userid),a=this.getPlayerBoard(e.players[t].userid);i&&a&&("normal"==cc.global.user.selplayway?0<e.players[t].score&&(this.matchCareerData.tgolds[i.userdata.id]+=e.players[t].score-this.pangolds/2):"diamond"==cc.global.user.selplayway&&0<e.players[t].score&&(this.matchCareerData.tdiamonds[i.userdata.id]+=e.players[t].score-this.pangolds/2),2==e.players[t].win&&(this.matchCareerData.wins[i.userdata.id]++,i.userdata.id))}this.showMatchCareer(this.matchCareerData)},allcards_event:function(a,s){for(var e=0;e<a.players.length;e++)a.players[e].userid==cc.global.user.id&&s.notReplay&&(cc.global.user.goldcoins=a.players[e].gold);clearTimeout(s.changeTurnTimer),s.otherEventCache=[],s.isGamePlaying=!1,s.stopTurnTimerAll(),s.matchCareerData&&s.workOutMatchCareer(a);var t=!1;t=s.playerlist.length==a.players.length;for(e=0;e<a.players.length;e++){var i=s.getPlayer(a.players[e].userid);a.players[e].getout&&(t=!1),s.getPlayerBoard(a.players[e].userid)&&("suicide"!=a.title||a.players[e].win||(i=s.getPlayer(a.players[e].userid))&&i.showEmoticon(-1))}setTimeout(function(){if(s.playerlist){s.finishMask.active=!0,s.fun_showHelp(!1);for(var e=0;e<a.players.length;e++){var t=s.getPlayer(a.players[e].userid);if(t&&("normal"==cc.global.user.selplayway&&(t.userdata.goldcoins=parseInt(a.players[e].gold)),t.summary(a.players[e])),a.players[e].userid==cc.global.user.id)switch(a.players[e].win){case 0:s.showBoardClaim("l",a.title);break;case 1:s.showBoardClaim("d",a.title);break;case 2:s.showBoardClaim("w",a.title)}}}if(s.show_canmovePiece(!1),s.emptykoni)for(e=0;e<9;e++)for(var i=0;i<7;i++)s.emptykoni[e][i].getComponent("emptybutton").showFlag(!1),s.emptykoni[e][i].getComponent("emptybutton").showTrack(!1);if(s.konier)for(i=0;i<2;i++)for(e=0;e<8;e++)s.konier[i][e].opacity=255},1e3),t&&s.boardclaim?s.endGameTimer=setTimeout(function(){s.boardclaim&&(s.endGameTimer=null,s.boardclaim.getComponent(cc.Animation).stop(),s.boardclaim.node.setScale(0,0),s.cleanAfterAllCards(),s.setReadyState())},5e3):setTimeout(function(){s.finishMask&&(s.finishMask.active=!1)},3e3)},cleanAfterAllCards:function(){this.pangolds=0,cc.global.amObserve&&"no"==cc.global.amObserve&&this.showWaitingTimer();for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].getComponent("animalplayer").hideBanker(),this.playerlist[e].getComponent("animalplayer").updatePassCount(0);this.lblTurnCount&&(this.lblTurnCount.string="",this.turnCount.local=0,this.turnCount.server=0),this.finishMask.active=!1;for(var t=0;t<2;t++)for(e=0;e<8;e++)this.konier[t][e].getComponent("animalpiece").node.active=!1},updateBetUpBalance:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("animalplayer");i&&(i.userdata.goldcoins-=e)}this.updatePlayerBalance()},updatePlayerBalance:function(){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("animalplayer");t&&t.updateBalance()}},showWaitingTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("animalplayerBoard");t&&t.startTimer(30)}},showReadyTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("animalplayerBoard");t&&t.startTimer(3)}},hideTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("animalplayerBoard");t&&t.stopTimer()}},getPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("animalplayer");if(i.userdata.id==e)return i}},getOtherPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("animalplayer");if(i.userdata.id!=e)return i}},getPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("animalplayerBoard");if(i.userdata.id==e)return i}},getOtherPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("animalplayerBoard");if(i.userdata.id!=e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},onClickGiveUp:function(){if(1!=this.tip_pan.active&&this.isGamePlaying){if(this.turnSeat)return void this.alert("No your turn.");var e=this;cc.global.audio.playVoiceSpeech("support/12_give_up");var t=this.getLanguageText("ARE_YOU_GIVE_UP");this.checkConfirm(t,function(){e&&e.socket().exec("suicide",{})},null)}},onClickSfx:function(){if(this.btnSfx){var e=this.btnSfx,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},showChatSearch:function(){},showChatDialog:function(){1!=this.tip_pan.active&&this.onclickChat(0)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.notReplay){if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}if(!(e<0)){this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root();var a=this.chatpage.getComponent("Chat");a.init(this,e),a.base.x=a.base.y=0,this.ischat=!0}}},onClickEmoticon:function(){if(this.notReplay){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),this.isemoticon=!1;this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root();var e=this.emoticonpage.getComponent("Emoticon");e.init(this,!1),e.base.x=e.base.y=0,this.isemoticon=!0}},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase,a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg);var s=t.getObserver(e.userid);s&&s.showCallPlayer(i,e.msg)},callplayer_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg);var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg,!1)},emoticon_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg);var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},onClickFindEmptyRoom:function(){},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},onClickChangePiece:function(){1==this.tgpcsbtn.children[0].active&&(this.tgpcsbtn.children[0].active=!1,this.tgpcsbtn.children[1].active=!0,this.togglePieceMode(!0)),1==this.tgpcsbtn.children[1].active&&(this.tgpcsbtn.children[0].active=!0,this.tgpcsbtn.children[1].active=!1,this.togglePieceMode(!1))},onclickBack:function(){var e=this;if(this.notReplay)if(this.isGamePlaying&&"no"==cc.global.amObserve){if(this.turnSeat)return void this.alert("No your turn.");cc.global.audio.playVoiceSpeech("support/14_roomout"),this.checkConfirm("Are you sure to leave room? You will lose.",function(){e.socket().exec("leave",{})},null)}else this.socket().exec("leave",{});else this.exitPlay()},exitPlay:function(){var e=this;cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),null==this.exitTimer&&(this.exitTimer=setInterval(function(){e.finishAct&&!e.finishAct.active&&(e.returnToHall(),clearInterval(e.exitTimer),e.exitTimer=null)},500))},returnToHall:function(){this.loadding(),clearInterval(this.otherEventInvoker),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.startGameTimer&&clearTimeout(this.startGameTimer),this.endGameTimer&&clearTimeout(this.endGameTimer),this.hideTimer(),this.cleanAllPlayers(),this.scene("hall",this)},chpre_event:function(e,t){t.closeOpenWin(),cc.global.openwin=cc.instantiate(t.roomrankdialog),cc.global.openwin.getComponent("RoomRankDialog").init(e.extdata),cc.global.openwin.parent=t.root(),t.notReplay||setTimeout(function(){null!=cc.global.openwin&&(cc.global.openwin.children[0].active=!1)},500)},show_canmovePiece:function(e){if(this.konier)if(e)for(var t=0;t<8;t++)this.konier[0][t].getComponent("animalpiece").dead||this.konier[0][t].getComponent(cc.Animation).play("piece_canmove");else for(t=0;t<8;t++)this.konier[0][t].getComponent("animalpiece").dead||(this.konier[0][t].getComponent(cc.Animation).stop("piece_canmove"),this.konier[0][t].getComponent("animalpiece").node.setScale(1,1))},click_selfpiece:function(e,t,i){this.currentid=e;for(var a=0;a<9;a++)for(var s=0;s<7;s++)this.emptykoni[a][s].getComponent("emptybutton").showFlag(!1);for(a=0;a<8;a++)this.konier[1][a].getComponent("animalpiece").showFlag(!1);var r=[],n=[[0,1],[1,0],[-1,0],[0,-1]];for(a=0;a<4;a++){var o=t+n[a][0],l=i+n[a][1],c=[];if((0!=o||3!=l)&&!(o<0||l<0||9<=o||7<=l||1<=this.matrix[o][l]&&this.matrix[o][l]<=8)){if(this.matrix[o][l]<0){if(11==this.emptykoni[o][l].getComponent("emptybutton").id){c[0]=o,c[1]=l,r.push(c);continue}if(1==e&&-8==this.matrix[o][l])continue;if(0<e+this.matrix[o][l]&&(8!=e||-1!=this.matrix[o][l]))continue}8!=e&&12==this.emptykoni[o][l].getComponent("emptybutton").id||8==e&&this.matrix[o][l]<0&&12==this.emptykoni[t][i].getComponent("emptybutton").id||8==e&&-8==this.matrix[o][l]&&12==this.emptykoni[o][l].getComponent("emptybutton").id||(c[0]=o,c[1]=l,r.push(c))}}var h=0;if(2==e||3==e)if(2==t||6==t){if(1==i||2==i||4==i||5==i){for(a=1;a<=3;a++){var d=t+a;if(6==t&&(d=t-a),-8==this.matrix[d][i]||8==this.matrix[d][i]){h=1;break}}if(!h){var u=6;if(6==t&&(u=2),this.matrix[u][i]+e<=0||10==this.matrix[u][i])(c=[])[0]=u,c[1]=i,r.push(c)}}}else if(3<=t&&t<=5){h=0;for(a=1;a<=2;a++){var p;if(0<=i-a&&(8==(p=this.matrix[t][i-a])||-8==p)){h=1;break}}if(!h)if(6==i){if(this.matrix[t][3]+e<=0||10==this.matrix[t][3])(c=[])[0]=t,c[1]=3,r.push(c)}else if(3==i){if(this.matrix[t][0]+e<=0||10==this.matrix[t][0])(c=[])[0]=t,c[1]=0,r.push(c)}h=0;for(a=1;a<=2;a++){var g;if(i+a<=6&&(8==(g=this.matrix[t][i+a])||-8==g)){h=1;break}}if(!h)if(0==i){if(this.matrix[t][3]+e<=0||10==this.matrix[t][3])(c=[])[0]=t,c[1]=3,r.push(c)}else if(3==i){if(this.matrix[t][6]+e<=0||10==this.matrix[t][6])(c=[])[0]=t,c[1]=6,r.push(c)}}for(a=0;a<r.length;a++){t=r[a][0],i=r[a][1];if(10<=this.matrix[t][i])this.emptykoni[t][i].getComponent("emptybutton").showFlag(!0);else if(this.matrix[t][i]<0&&-8<=this.matrix[t][i]){d=Math.abs(this.matrix[t][i])-1;this.konier[1][d].getComponent("animalpiece").showFlag(!0)}}},on_clickTarget:function(e,t){if(1!=this.sendFlag){var i=this.currentid-1;i<0||(this.socket().exec("playanimal",{extparams:{srow:this.konier[0][i].getComponent("animalpiece").row,scol:this.konier[0][i].getComponent("animalpiece").col,erow:e,ecol:t,roomid:this.roomid,localturn:this.turnCount.local}}),this.sendFlag=!0)}},fun_movepiece:function(e,t,i,a,s,r){for(var n=0;n<9;n++)for(var o=0;o<7;o++)this.emptykoni[n][o].getComponent("emptybutton").showFlag(!1),this.emptykoni[n][o].getComponent("emptybutton").showTrack(!1);for(n=0;n<8;n++)this.konier[1][n].getComponent("animalpiece").showFlag(!1);var l=Math.abs(this.matrix[s][r]);if(0<l&&l<=8){var c=l-1;this.konier[(e+1)%2][c].getComponent("animalpiece").kill_Piece(),this.konier[e][t].getComponent("animalpiece").move_kill(s,r)}else this.konier[e][t].getComponent("animalpiece").move(s,r);this.konier[e][t].opacity=222,0==e&&this.show_canmovePiece(!1),this.emptykoni[i][a].getComponent("emptybutton").showTrack(!0)},fun_endmove:function(){for(var e=0;e<9;e++)for(var t=0;t<7;t++){var i=this.matrix[e][t],a=0;if(0<Math.abs(i)&&Math.abs(i)<9){i<0&&(a=1);var s=Math.abs(i)-1;this.konier[a][s].getComponent("animalpiece").setGeometry(this.piecewidth,this.pieceheight,this.matrix_pos[e][t])}}},fun_convertmatrix:function(){if(1!=this.positive){for(var e=[],t=0;t<9;t++)e[t]=new Array;for(t=0;t<9;t++)for(var i=0;i<7;i++){var a=8-t,s=6-i;e[a][s]=this.matrix[t][i];var r=Math.abs(e[a][s]);r<9&&0<r&&(e[a][s]=0-e[a][s])}this.matrix=e}},fun_showHelp:function(e){e?(cc.sys.localStorage.setItem("animal_help",!0),this.gameboard.children[0].children[1].active=!1,this.tip_pan.active=!0):this.tip_pan.active=!1},on_click_cancel_help:function(){this.fun_showHelp(!1)},on_click_helpBtn:function(){this.fun_showHelp(!0)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],AnimalEngine1:[function(e,t,i){"use strict";cc._RF.push(t,"4dbedZRmodC4Js//es2xFTp","AnimalEngine1"),t.exports=function(){this.data={},this.realMatrix=[],this.animalCount=[1,2,2,2,2,5,2],this.randArray=[],this.currentMatrix=[],this.turncount=0,this.cntkoni=[],this.lastcount=[],this.result={},this.init=function(){this.turncount=0,this.randArray=[];for(var e=0;e<2;e++){this.cntkoni[e]=[];for(var t=0;t<7;t++)this.cntkoni[e][t]=this.animalCount[t]}this.lastcount=[0,0];var i=[];for(e=0;e<32;e++)i[e]=0;for(e=0;e<7;e++)for(t=0;t<this.animalCount[e];t++)this.randArray.push(e+1);for(e=0;e<7;e++)for(t=0;t<this.animalCount[e];t++)this.randArray.push(-1*(e+1));for(e=0;e<8;e++)this.realMatrix[e]=[],this.currentMatrix[e]=[];for(e=0;e<8;e++)for(t=0;t<4;t++){for(;;){var a=Math.floor(123*Math.random());if(!i[a%=32]){i[a]=1,this.realMatrix[e][t]=this.randArray[a];break}}this.currentMatrix[e][t]=100}},this.play_user=function(e){var t=e.srow,i=e.scol,a=e.erow,s=e.ecol,r=e.type;"e"==r?this.currentMatrix[a][s]=this.realMatrix[a][s]:"m"==r&&(this.currentMatrix[a][s]=this.currentMatrix[t][i],this.currentMatrix[t][i]=0,this.realMatrix[t][i]=0,this.realMatrix[a][s]=this.currentMatrix[a][s]),this.turncount++,this.countRemain()},this.countRemain=function(){for(var e=[0,0],t=[],i=0;i<2;i++)t[i]=[0,0,0,0,0,0,0];for(i=0;i<8;i++)for(var a=0;a<4;a++)this.realMatrix[i][a]<0?(e[1]++,t[1][Math.abs(this.realMatrix[i][a])-1]++):0<this.realMatrix[i][a]&&(e[0]++,t[0][Math.abs(this.realMatrix[i][a])-1]++);for(i=0;i<2;i++)this.lastcount[i]=16-e[(i+1)%2],this.cntkoni[i]=t[i]},this.trainer_play=function(){this.turncount++;for(var e=1e3,t=[[1,0],[-1,0],[0,1],[0,-1]],i=[[2,0],[-2,0],[0,2],[0,-2]],a=[],s=[],r=0;r<8;r++)for(var n=0;n<4;n++)if(-6==this.currentMatrix[r][n])for(var o=0;o<4;o++){var l=r+t[o][0],c=n+t[o][1];if(!(8<=l||l<0||c<0||4<=c)&&1==this.currentMatrix[l][c])return void this.setResult("m",r,n,l,c)}var h=!1;for(r=0;r<8;r++)for(n=0;n<4;n++)if(-7==this.currentMatrix[r][n])for(o=0;o<4;o++){l=r+i[o][0],c=n+i[o][1];var d=r+t[o][0],u=n+t[o][1];if(!(8<=l||l<0||c<0||4<=c)&&(0!=this.currentMatrix[d][u]&&0<this.currentMatrix[l][c]&&this.currentMatrix[l][c]<=7)){if(0<this.currentMatrix[d][u])return void this.setResult("m",r,n,l,c);this.currentMatrix[l][c]<e&&(a=["m",r,n,l,c],h=!0,e=this.currentMatrix[l][c])}}if(h&&5<=a.length)this.setResult(a[0],a[1],a[2],a[3],a[4]);else{a=[];for(r=0;r<8;r++)for(n=0;n<4;n++)if(this.currentMatrix[r][n]<0&&-7<this.currentMatrix[r][n]&&this.isDanger(r,n)){for(o=0;o<4;o++){l=r+t[o][0],c=n+t[o][1];if(!(8<=l||l<0||c<0||4<=c)&&(!(this.currentMatrix[l][c]<0)&&100!=this.currentMatrix[l][c]&&this.canKill(r,n,l,c)&&0<this.currentMatrix[l][c])){if(!this.moveDanger(r,n,l,c))return void this.setResult("m",r,n,l,c);a=["m",r,n,l,c]}}if(5<=a.length)return void this.setResult(a[0],a[1],a[2],a[3],a[4])}a=[],e=1e3;var p=!1;for(r=0;r<8;r++)for(n=0;n<4;n++)if(this.currentMatrix[r][n]<0&&-7<this.currentMatrix[r][n])for(o=0;o<4;o++){l=r+t[o][0],c=n+t[o][1];if(!(8<=l||l<0||c<0||4<=c)&&(!(this.currentMatrix[l][c]<=0||100==this.currentMatrix[l][c])&&this.canKill(r,n,l,c))){if(10==this.lastcount[1])return void this.setResult("m",r,n,l,c);if(!this.moveDanger(r,n,l,c)&&e>this.currentMatrix[l][c]){if(this.currentMatrix[l][c]+this.currentMatrix[r][n]==0)return void this.setResult("m",r,n,l,c);if(this.isDanger(r,n))return void this.setResult("m",r,n,l,c);a=["m",r,n,l,c],p=!0,e=this.currentMatrix[l][c]}}}if(p&&5<=a.length)this.setResult(a[0],a[1],a[2],a[3],a[4]);else{for(r=0;r<8;r++)for(n=0;n<4;n++)if(this.currentMatrix[r][n]<0&&-3<this.currentMatrix[r][n]&&this.isDanger(r,n))for(o=0;o<4;o++){l=r+t[o][0],c=n+t[o][1];if(!(8<=l||l<0||c<0||4<=c)&&(0==this.currentMatrix[l][c]&&!this.moveDanger(r,n,l,c)))return void this.setResult("m",r,n,l,c)}a=[],p=!1,e=1e3;for(r=0;r<8;r++)for(n=0;n<4;n++)if(this.currentMatrix[r][n]<0&&-7<this.currentMatrix[r][n])for(o=0;o<4;o++){l=r+t[o][0],c=n+t[o][1];8<=l||l<0||c<0||4<=c||0==this.currentMatrix[l][c]&&(this.moveDanger(r,n,l,c)||0<this.moveKill(r,n,l,c)&&this.moveKill(r,n,l,c)<8&&e>this.moveKill(r,n,l,c)&&(a=["m",r,n,l,c],p=!0,e=this.moveKill(r,n,l,c)))}if(p&&5<=a.length)this.setResult(a[0],a[1],a[2],a[3],a[4]);else{for(r=0;r<8;r++)for(n=0;n<4;n++)if(this.currentMatrix[r][n]<0&&this.isDanger(r,n))for(o=0;o<4;o++){l=r+t[o][0],c=n+t[o][1];if(!(8<=l||l<0||c<0||4<=c)&&(0==this.currentMatrix[l][c]&&!this.moveDanger(r,n,l,c)))return void this.setResult("m",r,n,l,c)}s=[];for(r=0;r<8;r++)for(n=0;n<4;n++)if(100==this.currentMatrix[r][n]){if(this.breakDanger(r,n))continue;if(-7==this.realMatrix[r][n]){for(o=0;o<4;o++){l=r+i[o][0],c=n+i[o][1],d=r+t[o][0],u=n+t[o][1];if(!(8<=l||l<0||c<0||4<=c)&&(0!=this.currentMatrix[d][u]&&0<this.currentMatrix[l][c]&&this.currentMatrix[l][c]<7))return void this.setResult("e",-1,-1,r,n)}continue}var g={row:r,col:n};s.push(g)}var m;if(0<(m=s.length)){for(r=0;r<m;r++){var y=s[r].row,f=s[r].col;if(0<this.realMatrix[y][f]&&this.realMatrix[y][f]<7)for(o=0;o<4;o++){l=y+i[o][0],c=f+i[o][1],d=y+t[o][0],u=f+t[o][1];if(!(8<=l||l<0||c<0||4<=c)&&(0!=this.currentMatrix[d][u]&&-7==this.currentMatrix[l][c]))return void this.setResult("e",-1,-1,s[r].row,s[r].col)}}var b=Math.floor(123*Math.random());return b%=m,void this.setResult("e",-1,-1,s[b].row,s[b].col)}s=[];for(r=0;r<8;r++)for(n=0;n<4;n++)if(this.currentMatrix[r][n]<0)for(o=0;o<4;o++){l=r+t[o][0],c=n+t[o][1];if(!(8<=l||l<0||c<0||4<=c)&&(0==this.currentMatrix[l][c]&&!this.moveDanger(r,n,l,c))){g={srow:r,scol:n,erow:l,ecol:c};s.push(g)}}if(0<(m=s.length)){b=Math.floor(12345*Math.random());return b%=m,void this.setResult("m",s[b].srow,s[b].scol,s[b].erow,s[b].ecol)}this.setResult("p",-1,-1,-1,-1)}}}},this.canKill=function(e,t,i,a){var s=this.currentMatrix[e][t],r=this.currentMatrix[i][a];return!(r<=0)&&(100!=r&&0!=r&&((-1!=s||6!=r)&&(-6==s&&1==r||(Math.abs(s)<=r||-7==s&&0<r&&r<8))))},this.moveDanger=function(e,t,i,a){var s=this.currentMatrix[e][t];if(0<=s)return!1;for(var r=[[1,0],[-1,0],[0,1],[0,-1]],n=[[2,0],[-2,0],[0,2],[0,-2]],o=0;o<4;o++){var l=i+r[o][0],c=a+r[o][1];if(!(8<=l||l<0||c<0||4<=c)&&!(100==this.currentMatrix[l][c]||this.currentMatrix[l][c]<=0)){if(-1==s){if(this.currentMatrix[l][c]==Math.abs(s)||6==this.currentMatrix[l][c])return!0}else if(-6==s&&1==this.currentMatrix[l][c])continue;if(Math.abs(s)>=this.currentMatrix[l][c])return!0}}for(o=0;o<4;o++){l=i+n[o][0],c=a+n[o][1];var h=i+r[o][0],d=a+r[o][1];if(!(8<=l||l<0||c<0||4<=c)&&(0!=this.currentMatrix[h][d]&&7==this.currentMatrix[l][c])){if(h==e&&d==t)continue;return!0}}return!1},this.moveKill=function(e,t,i,a){var s=this.currentMatrix[e][t];if(0<=s||-7==s)return 0;for(var r=[[1,0],[-1,0],[0,1],[0,-1]],n=100,o=0;o<4;o++){var l=i+r[o][0],c=a+r[o][1];if(!(8<=l||l<0||c<0||4<=c)&&!(100==this.currentMatrix[l][c]||this.currentMatrix[l][c]<=0)){if(this.currentMatrix[l][c]==Math.abs(s))return 0;if(-1==s){if(6==this.currentMatrix[l][c])return 0}else if(-6==s&&1==this.currentMatrix[l][c]){n=1;continue}if(Math.abs(s)>=this.currentMatrix[l][c])return 0;n>this.currentMatrix[l][c]&&(n=this.currentMatrix[l][c])}}return n},this.isDanger=function(e,t){var i=this.currentMatrix[e][t];if(0<=i)return!1;for(var a=[[1,0],[-1,0],[0,1],[0,-1]],s=[[2,0],[-2,0],[0,2],[0,-2]],r=0;r<4;r++){var n=e+a[r][0],o=t+a[r][1];if(!(8<=n||n<0||o<0||4<=o)&&!(100==this.currentMatrix[n][o]||this.currentMatrix[n][o]<=0)){if(-1==i){if(this.currentMatrix[n][o]==Math.abs(i)||6==this.currentMatrix[n][o])return!0}else if(-6==i&&1==this.currentMatrix[n][o])continue;if(Math.abs(i)>=this.currentMatrix[n][o])return!0}}for(r=0;r<4;r++){n=e+s[r][0],o=t+s[r][1];var l=e+a[r][0],c=t+a[r][1];if(!(8<=n||n<0||o<0||4<=o)&&(0!=this.currentMatrix[l][c]&&7==this.currentMatrix[n][o]))return!0}return!1},this.breakDanger=function(e,t){var i=this.realMatrix[e][t],a=[[1,0],[-1,0],[0,1],[0,-1]],s=[[2,0],[-2,0],[0,2],[0,-2]];if(i<0){for(var r=0;r<4;r++){var n=e+a[r][0],o=t+a[r][1];if(!(8<=n||n<0||o<0||4<=o)&&!(100==this.currentMatrix[n][o]||this.currentMatrix[n][o]<=0)){if(-1==i){if(this.currentMatrix[n][o]==Math.abs(i)||6==this.currentMatrix[n][o])return!0}else if(-6==i&&1==this.currentMatrix[n][o])continue;if(Math.abs(i)>=this.currentMatrix[n][o])return!0}}for(r=0;r<4;r++){n=e+s[r][0],o=t+s[r][1];var l=e+a[r][0],c=t+a[r][1];if(!(8<=n||n<0||o<0||4<=o)&&(0!=this.currentMatrix[l][c]&&7==this.currentMatrix[n][o]))return!0}return!1}if(0<i){for(r=0;r<4;r++){n=e+a[r][0],o=t+a[r][1];if(!(8<=n||n<0||o<0||4<=o)&&!(100==this.currentMatrix[n][o]||0<=this.currentMatrix[n][o])){if(1==i){if(-6==this.currentMatrix[n][o])continue}else if(6==i&&-1==this.currentMatrix[n][o])return!0;if(i+this.currentMatrix[n][o]<=0)return!0}}for(r=0;r<4;r++){n=e+s[r][0],o=t+s[r][1],l=e+a[r][0],c=t+a[r][1];if(!(8<=n||n<0||o<0||4<=o)&&(0!=this.currentMatrix[l][c]&&this.currentMatrix[n][o]<0&&7==i))return!0}return!1}return!1},this.setResult=function(e,t,i,a,s){this.result={type:e,srow:t,scol:i,erow:a,ecol:s},"e"==e?this.currentMatrix[a][s]=this.realMatrix[a][s]:"m"==e&&(this.currentMatrix[a][s]=this.currentMatrix[t][i],this.currentMatrix[t][i]=0,this.realMatrix[t][i]=0,this.realMatrix[a][s]=this.currentMatrix[a][s])}},cc._RF.pop()},{}],ArcheryBeginTrain:[function(e,t,i){"use strict";cc._RF.push(t,"c0752tT8n5H9rox9g++dbir","ArcheryBeginTrain");var a=e("HHCommon"),n=(e("ArcheryEngine"),e("./ArcheryEngine")),o={};cc.Class({extends:a,properties:{desk:{default:null,type:cc.Node},mainBack:{default:null,type:cc.Node},flyingLayer:{default:null,type:cc.Node},backCamera:{default:null,type:cc.Node},bowAtlas:{default:null,type:cc.SpriteAtlas},mainboard:{default:null,type:cc.Node},scoreboard:{default:null,type:cc.Node},windLayer:{default:null,type:cc.Node},targetLayer:{default:null,type:cc.Node},avatarAtlas:{default:null,type:cc.SpriteAtlas}},onLoad:function(){this.initVariables(),this.randY=0,this.randX=0,this.positive=1,this.initPlayer()},update:function(e){this.isMoveable&&!this.fireFlag&&(this.randX=Math.max(Math.random()/10,.1),this.randX*=this.positive,this.easeTargetX-=(this.easeTargetX-(this.targetAimX-this.startAimX))*(5*e),this.easeTargetY-=(this.easeTargetY-(this.targetAimY-this.startAimY))*(5*e),this.dragX=Math.max(Math.min(this.dragX+3*this.easeTargetX*e+this.randX,.15*this.canvas.width),.15*-this.canvas.width),this.dragY=Math.max(Math.min(this.dragY+3*this.easeTargetY*e+this.randY*this.positive*.003,.15*this.canvas.height),.15*-this.canvas.height),this.backCamera.y=this.dragY,this.backCamera.x=this.dragX,50<=this.randY?this.randY++:this.randY+=3,100<=this.randY&&(this.randY=0,this.positive*=-1))},drawBowLine:function(e,t){var i=this.graphics.getComponent(cc.Graphics),a=this.mainboard.getChildByName("Bow");i.clear(),i.moveTo(a.x*this.mainboard.scaleX,t-1e3*this.mainboard.scaleY),i.lineTo(e,t),i.lineTo(a.x*this.mainboard.scaleX,t+1e3*this.mainboard.scaleY),i.stroke()},onMouseDown:function(e){if(this.canFire){e.stopPropagation(),this.targetAimX=this.startAimX=e.getLocationX(),this.targetAimY=this.startAimY=e.getLocationY(),this.isMoveable=!0,this.bow.getComponent(cc.Animation).play("bow");var t=this;this.scheduleOnce(function(){t.isMoveable&&(t.scope.opacity=255,t.zoomIn())},.4)}},onMouseMove:function(e){this.isMoveable&&(e.stopPropagation(),this.targetAimX=e.getLocationX(),this.targetAimY=e.getLocationY())},onMouseUp:function(e){this.isMoveable&&(e.stopPropagation(),this.isMoveable=!1,this.bow.getComponent(cc.Animation).stop(),this.zoomed?(this.startAimX=this.targetAimX=0,this.startAimY=this.targetAimY=0,this.fireArrow(),this.canFire=!1):this.bow.getComponent(cc.Sprite).spriteFrame=this.bowAtlas.getSpriteFrame("bow1"),this.zoomed=!1)},setEnableScale:function(){this.is_scaling=!0},setDisableScale:function(){this.is_scaling=!1},fireArrow:function(){this.scope.opacity=0,this.bow.getComponent(cc.Sprite).spriteFrame=this.bowAtlas.getSpriteFrame("bow1"),this.bow.active=!1,this.fireFlag=!0,this.targetLayer.getComponent(cc.Animation).stop();var e=o.getHitPos(this.backCamera.x,this.backCamera.y,this.targetLayer.x,this.targetLayer.y,this.targetLayer.getScale());this.setScore(this,e[0],e[1],e[2])},zoomIn:function(){this.zoomed=!0,this.backCamera.getComponent(cc.Animation).play("aimzoom")},zoomOut:function(){this.backCamera.getComponent(cc.Camera).zoomRatio=1},getRndInteger:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},initPlayer:function(){var e=this;(o=new n).init(),this.canFire=!0;var t=o.getNewWind(),i=10*(this.getRndInteger(0,3)+3),a=this.getRndInteger(0,4),s=t[0],r=t[1];o.setTargetInfo(i,a),o.setWindInfo(s,r),0!=a&&this.targetLayer.getComponent(cc.Animation).play("targetmove"+a),this.scheduleOnce(function(){e.windLayer.getChildByName("WindSpeed").getComponent(cc.Label).string=" Wind "+o.getWindPower()+"m/s ",e.windLayer.getChildByName("WindArrow").rotation=o.getWindDirection()},1),this.windLayer.runAction(cc.sequence(cc.delayTime(1),cc.moveTo(0,0,240),cc.scaleTo(0,0),cc.scaleTo(.2,1.5*cc.global.narrowContentRatio),cc.scaleTo(.1,.85*cc.global.narrowContentRatio),cc.delayTime(.2),cc.moveTo(.2,260*cc.global.narrowContentRatio,360*cc.global.narrowContentRatio))),this.mainBack.setScale(1,1),this.mainBack.setPosition(0,0),this.bow.opacity=255,this.desk.on(cc.Node.EventType.TOUCH_START,this.onMouseDown,this),this.desk.on(cc.Node.EventType.TOUCH_MOVE,this.onMouseMove,this),this.desk.on(cc.Node.EventType.TOUCH_END,this.onMouseUp,this)},initVariables:function(){this.canvas=cc.director.getScene().getChildByName("Canvas"),this.bow=this.mainboard.getChildByName("Bow"),this.scope=this.mainboard.getChildByName("Scope"),this.dragX=0,this.dragY=0,this.targetAimX=0,this.targetAimY=0,this.scale=.5,this.startAimX=0,this.startAimY=0,this.maxMoveSpeed=10,this.easeTargetX=0,this.easeTargetY=0,this.tempArrowPosX=-1,this.tempArrowPosY=-1,this.fireFlag=!1,this.isMoveable=!1,this.zoomLevel=1.4,this.rot=0,this.currentLevel=1,this.ope=1,this.backCamera.x=0,this.backCamera.y=0,this.backCamera.getComponent(cc.Camera).zoomRatio=1,this.windLayer.setPosition(260*cc.global.narrowContentRatio,360*cc.global.narrowContentRatio),this.canFire=!1,this.zoomFlag=!1,this.zoomLimit=1,this.zoomed=!1,this.bow.active=!0,this.flyingLayer.children[0].opacity=0,this.scope.opacity=0,this.bow.getComponent(cc.Sprite).spriteFrame=this.bowAtlas.getSpriteFrame("bow1"),this.targetLayer.getChildByName("score10").opacity=0,this.targetLayer.getChildByName("score9").opacity=0,this.targetLayer.getChildByName("score8").opacity=0,this.targetLayer.getChildByName("score7").opacity=0,this.targetLayer.getChildByName("score6").opacity=0,this.targetLayer.x=0,this.targetLayer.y=85},setScore:function(e,t,i,a){e.backCamera.x+=i,e.backCamera.y+=a,e.flyingLayer.getComponent(cc.Animation).play(),e.backCamera.getComponent(cc.Animation).play("firezoom"),e.scheduleOnce(function(){e.onShowScore(e,t)},1)},onShowScore:function(e,t){var i=this,a=""+t;0!=t&&e.targetLayer.getChildByName("score"+t).runAction(cc.sequence(cc.fadeTo(.1,200),cc.fadeTo(.1,50),cc.fadeTo(.1,200),cc.fadeTo(.1,50),cc.fadeTo(.1,200),cc.fadeTo(.1,50),cc.fadeTo(.1,200))),e.scoreboard.children[0].getComponent(cc.Label).string=a,e.scoreboard.runAction(cc.sequence(cc.moveTo(0,-370*cc.global.narrowContentRatio,310*cc.global.narrowContentRatio),cc.moveTo(.1,-60*cc.global.narrowContentRatio,310*cc.global.narrowContentRatio),cc.moveTo(.05,-100*cc.global.narrowContentRatio,310*cc.global.narrowContentRatio),cc.delayTime(.6),cc.moveTo(.05,-60*cc.global.narrowContentRatio,310*cc.global.narrowContentRatio),cc.moveTo(.1,-370*cc.global.narrowContentRatio,310*cc.global.narrowContentRatio))),this.scheduleOnce(function(){i.changeTurnPlayer()},1)},changeTurnPlayer:function(){this.initVariables(),this.initPlayer()},onclickBack:function(){this.scene("hall",this)}}),cc._RF.pop()},{"./ArcheryEngine":"ArcheryEngine",ArcheryEngine:"ArcheryEngine",HHCommon:"HHCommon"}],ArcheryBegin:[function(e,t,i){"use strict";cc._RF.push(t,"17e6aF8fEFKvJYZjW47nqxe","ArcheryBegin");var a=e("HHCommon"),s=e("ArcheryEngine"),o={};cc.Class({extends:a,properties:{archery_player:{default:null,type:cc.Prefab},archery_player_board:{default:null,type:cc.Prefab},desk:{default:null,type:cc.Node},mainBack:{default:null,type:cc.Node},flyingLayer:{default:null,type:cc.Node},backCamera:{default:null,type:cc.Node},bowAtlas:{default:null,type:cc.SpriteAtlas},mainboard:{default:null,type:cc.Node},selfboard:{default:null,type:cc.Node},oppboard:{default:null,type:cc.Node},scoreboard:{default:null,type:cc.Node},resultboard:{default:null,type:cc.Node},turnboard:{default:null,type:cc.Node},windLayer:{default:null,type:cc.Node},targetLayer:{default:null,type:cc.Node},selfplayer:{default:null,type:cc.Node},opponentplayer:{default:null,type:cc.Node},scoreContainer:{default:null,type:cc.Node},statusboard:{default:null,type:cc.Node},boardclaim:{default:null,type:cc.Sprite},claimatlas:{default:null,type:cc.SpriteAtlas},roomdata:{default:null,type:cc.Node},turntimer:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},observer:{default:null,type:cc.Prefab},observerbench:{default:null,type:cc.Node},emodlg:{default:null,type:cc.Prefab},chat:{default:null,type:cc.Prefab},btn_enter:{default:null,type:cc.Node},btn_giveup:{default:null,type:cc.Node},btn_chat:{default:null,type:cc.Node},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},roomrankdialog:{default:null,type:cc.Prefab},finishAct:{default:null,type:cc.Node},btnSfx:{default:null,type:cc.Node},lblTurnCount:{default:null,type:cc.Label},pandata:{default:null,type:cc.Node},multi:{default:null,type:cc.Node},avatarAtlas:{default:null,type:cc.SpriteAtlas}},onLoad:function(){this.initEventCallback(),cc.game.setFrameRate(60),cc.global.amObserve="no",this.play_status=0,this.playerlist=new Array,this.playerboardlist=new Array,this.observerlist=new Array,this.posBaseIdx=0,this.inited=!1,this.playerBoardSlotPos=[cc.v2(0,-200),cc.v2(0,320)],this.notReplay=!0,this.startGameTimer=null,this.endGameTimer=null,this.pangolds=0,this.isGamePlaying=!1,this.pickedPiece=null,this.turnSeat=0,this.isNewRoom=!0,this.turnCount={local:0,server:0},(o=new s).init(),null!=cc.global&&(this.initgame(),""!=cc.global.user.roomid&&(this.recovery(),this.isNewRoom=!1)),cc.global.watchReplayData.onReplay&&this.prepareReplay(),this.setEtcKeyBoardEvent();var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==e&&(e=!0),e?(this.btnSfx.children[0].active=!0,this.btnSfx.children[1].active=!1):(this.btnSfx.children[0].active=!1,this.btnSfx.children[1].active=!0),cc.global.audio.playBGM("bgm_archery"),this.initVariables(),this.ratio=0,this.randY=0,this.randX=0,this.positive=1,this.turntimer.getComponent("ArcheryTimer").setParent(this)},initgame:function(){var t=this;this.finishAct&&(this.finishAct.active=!1);var e=this.socket();this.map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("banker",this.banker_event),this.map("playarchery",this.playarchery_event),this.map("rer",this.recovery_event),this.map("selemoticon",this.emoticon_event),this.map("sendchat",this.sendchat_event),this.map("callplayer",this.callplayer_event),this.map("allcards",this.allcards_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)});var i={};switch(cc.global.user.roomInType){case"NormalCreate":null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i);break;case"NormalJoin":i.extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i);break;case"NormalObserve":i.extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i)}this.inited=!0,this.loadding()},setEtcKeyBoardEvent:function(){var i=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e,t){switch(e){case cc.KEY.space:i.processReadyState();break;case cc.KEY.escape:case cc.KEY.back:if(!i.isemoticon&&!i.ischat)return void i.onclickBack();i.isemoticon&&(null!=i.emoticonpage&&i.emoticonpage.destroy(),i.isemoticon=!1),i.ischat&&(null!=i.chatpage&&i.chatpage.destroy(),i.ischat=!1)}}},i.node)},update:function(e){this.isMoveable&&!this.fireFlag&&(this.randX=Math.max(Math.random()/10,.1),this.randX*=this.positive,this.easeTargetX-=(this.easeTargetX-(this.targetAimX-this.startAimX))*(5*e),this.easeTargetY-=(this.easeTargetY-(this.targetAimY-this.startAimY))*(5*e),this.dragX=Math.max(Math.min(this.dragX+3*this.easeTargetX*e+this.randX,.15*this.canvas.width),.15*-this.canvas.width),this.dragY=Math.max(Math.min(this.dragY+3*this.easeTargetY*e+this.randY*this.positive*.003,.15*this.canvas.height),.15*-this.canvas.height),this.backCamera.y=this.dragY,this.backCamera.x=this.dragX,50<=this.randY?this.randY++:this.randY+=3,100<=this.randY&&(this.randY=0,this.positive*=-1))},onMouseDown:function(e){var t=this;if(this.canFire&&this.isGamePlaying&&"yes"!=cc.global.amObserve){e.stopPropagation(),this.targetAimX=this.startAimX=e.getLocationX(),this.targetAimY=this.startAimY=e.getLocationY(),this.isMoveable=!0,cc.global.audio.playEffectAud("archery/bowready"),this.bow.getComponent(cc.Animation).play("bow");var i=this;this.scheduleOnce(function(){i.isMoveable&&i.zoomIn()},.15),this.scheduleOnce(function(){i.isMoveable&&(cc.global.audio.playEffectAud("archery/shootready"),i.scope.opacity=255,t.zoomed=!0)},.3)}},onMouseMove:function(e){this.canFire&&this.isGamePlaying&&"yes"!=cc.global.amObserve&&this.isMoveable&&(e.stopPropagation(),this.targetAimX=e.getLocationX(),this.targetAimY=e.getLocationY())},onMouseUp:function(e){this.canFire&&this.isGamePlaying&&"yes"!=cc.global.amObserve&&this.isMoveable&&(e.stopPropagation(),this.isMoveable=!1,this.bow.getComponent(cc.Animation).stop(),this.zoomed?(this.startAimX=this.targetAimX=0,this.startAimY=this.targetAimY=0,this.fireArrow(),this.canFire=!1):this.bow.getComponent(cc.Sprite).spriteFrame=this.bowAtlas.getSpriteFrame("bow1"),this.zoomed=!1)},fireArrow:function(){this.fireFlag=!0,1<this.turnCount.local-this.turnCount.server||(this.turnCount.local+=1,this.socket().exec("playarchery",{extparams:{cam_x:this.backCamera.x,cam_y:this.backCamera.y,target_x:this.targetLayer.x,target_y:this.targetLayer.y,target_dist:o.targetDist,target_scale:this.targetLayer.getScale(),roomid:this.roomid,localturn:this.turnCount.local}}))},zoomIn:function(){this.backCamera.getComponent(cc.Animation).play("aimzoom")},zoomOut:function(){this.backCamera.getComponent(cc.Camera).zoomRatio=1},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},prepareReplay:function(){var e=this;e.notReplay=!1,cc.global.amObserve="yes",e.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),e.replay_bar.active=!0,e.replayStep="ready_room",e.replaySeq=0,e.replayPrevCmd="",e.goReplay()},stopAllClock:function(){this.turntimer.getComponent("ArcheryTimer").pauseAllTimer()},resumeAllClock:function(){this.turntimer.getComponent("ArcheryTimer").resumeAllTimer()},pauseReplayTimer:function(){this.stopAllClock(),clearTimeout(this.replayTimer)},resumeReplayTimer:function(){var e=this;this.resumeAllClock(),this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay/cc.global.watchReplayData.replaySpeedX)},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):this.togglePlayToPause()},togglePlayToPause:function(){this.replayTimer&&clearTimeout(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replay_bar.children[0].opacity=100,this.pauseReplayTimer()},replayPrevMove:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.replayEventProcess(!0))},replayNextMove:function(){this.togglePlayToPause(),this.replayEventProcess(!0)},onClickReplaySpeedUp:function(){var e=this.getLanguageText("REPLAY_TIME");cc.global.watchReplayData.replaySpeedX<5&&(cc.global.watchReplayData.replaySpeedX++,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){var e=this.getLanguageText("REPLAY_TIME");1<cc.global.watchReplayData.replaySpeedX&&(cc.global.watchReplayData.replaySpeedX--,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},cleanAllPlayers:function(){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].destroy(),this.playerboardlist[e].destroy();this.playerlist.splice(0,this.playerlist.length),this.playerboardlist.splice(0,this.playerboardlist.length),this.playerlist=new Array,this.playerboardlist=new Array,this.selfplayer&&(this.selfplayer.destroyAllChildren(),this.selfplayer.removeAllChildren()),this.opponentplayer&&(this.opponentplayer.destroyAllChildren(),this.opponentplayer.removeAllChildren())},replayEventProcess:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.play_history&&this.play_history[this.replaySeq]){this.replayTimeDelay=0;var t=!1;switch(this.replayStep){case"ready_room":this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"playarchery":t=!0,this.playarchery_event(i,this);break;case"allcards":t=!0,this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.emoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"players":this.players_event(i,this)}this.replayPrevCmd=i.command}this.play_history[this.replaySeq+1]&&""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay+=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,e&&!t&&this.replayEventProcess(!0)}},goReplay:function(){var e=this;this.replayEventProcess(),this.play_history[this.replaySeq]?this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay):(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.replayPrevCmd="",this.pauseReplayTimer())},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;e<0||(this.socket().exec("selemoticon",{extparams:{emoticon:e}}),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1))},onCtrlKeyDown:function(e){e.keycode==cc.KEY.space&&2==this.playerlist.length&&(this.endGameTimer||this.sendState())},processReadyState:function(){2==this.playerlist.length&&(this.endGameTimer||this.sendState())},joinroom_event:function(e,t){cc.global.user.selplayway=e.name,t.roomid=e.id,t.panScore=cc.global.curPlaywayScore=e.score;var i=t.getLanguageText("ROOM_0"),a=t.getLanguageText("SCORE_0");switch(t.roomdata.children[0].getComponent(cc.Label).string=e.id+i,t.roomdata.children[1].getComponent(cc.Label).string="("+t.numformat(e.score)+a+")",cc.global.gamestatus){case"ready":cc.global.gamestatus="waiting",2==e.playerlist.length&&(cc.global.gamestatus="playing"),t.players_event(e,t);break;case"waiting":t.players_event(e,t);break;case"playing":cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)}"yes"==cc.global.amObserve?t.btn_giveup.active=!1:t.btn_giveup.active=!0,t.closeloadding()},players_event:function(e,t){2==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)if(e.observerlist[a].id==cc.global.user.id){i=!1;break}if(i&&t.notReplay)return cc.global.outReasonMsg=e.msg,void t.exitPlay();t.observer_event(e,t),t.isBoardPlayersChanged(e.playerlist)&&(t.startGameTimer&&(clearTimeout(t.startGameTimer),t.startGameTimer=null),t.endGameTimer&&(clearTimeout(t.endGameTimer),t.endGameTimer=null),t.players_engine(e,t))},players_engine:function(e){this.removeBoardPlayers(e.playerlist);for(var t=this.posBaseIdx,i=0;i<e.playerlist.length;i++){if(e.playerlist[i].seatid=i,"no"==cc.global.amObserve&&e.playerlist[i].id!=cc.global.user.id&&(t=1-this.posBaseIdx),this.playerexist(e.playerlist[i])){var a=this.getPlayer(e.playerlist[i].id),s=this.getPlayerBoard(e.playerlist[i].id);a.init(this,e.playerlist[i],t%2,i),s.init(this,e.playerlist[i],t%2,i),s.node.setPosition(this.playerBoardSlotPos[t%2]),a.seatid=s.seatid=t%2,a.layoutForSeat(),s.layoutForSeat()}else{var r=cc.instantiate(this.archery_player);"yes"!=cc.global.amObserve?e.playerlist[i].id==cc.global.user.id?r.parent=this.selfplayer:r.parent=this.opponentplayer:r.parent=t%2==0?this.selfplayer:this.opponentplayer,r.getComponent("ArcheryPlayer").init(this,e.playerlist[i],t%2,i),this.playerlist.push(r);var n=cc.instantiate(this.archery_player_board);n.parent=this.statusboard,n.setPosition(this.playerBoardSlotPos[t%2]),n.getComponent("ArcheryPlayerBoard").init(this,e.playerlist[i],t%2,i),this.playerboardlist.push(n)}t++}1==e.playerlist.length?(this.setWaitingState(),this.cleanAfterAllCards()):2==e.playerlist.length&&this.setReadyState(),"yes"==cc.global.amObserve&&e.playerlist.length<2?1==cc.global.championMode?this.btn_enter.active=!1:0==cc.global.championMode&&this.notReplay&&(this.btn_enter.active=!0):this.btn_enter.active=!1,this.showWaitingTimer()},setWaitingState:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ArcheryPlayerBoard");t&&t.setState("Pending")}},setReadyState:function(){var e=this.getLanguageText("READY_0")+"?";if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("ArcheryPlayerBoard");i&&i.setState(e)}},observer_event:function(e,t){t.observerbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i],t),a.getComponent("Observer").nickname.node.active=!1,a.parent=t.observerbench,t.observerlist[i]=a}},removeBoardPlayers:function(e){for(var t=0;t<this.playerlist.length;t++){for(var i=this.playerlist[t].getComponent("ArcheryPlayer"),a=!1,s=0;s<e.length;s++)if(i.userdata.id==e[s].id){a=!0;break}1!=a&&(this.playerlist[t].destroy(),this.playerlist.splice(t,1),this.playerboardlist[t].destroy(),this.playerboardlist.splice(t,1))}},isBoardPlayersChanged:function(e){if(0==this.playerlist.length&&0!=e.length)return!0;if(this.playerlist.length!=e.length)return!0;for(var t=0;t<e.length;t++)if(!this.getPlayer(e[t].id))return!0;return!1},playerexist:function(e){for(var t=0;t<this.playerlist.length;t++)if(null!=this.playerlist[t]&&this.playerlist[t].getComponent("ArcheryPlayer").userdata.id==e.id)return!0;return!1},initGameboard:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];o.init(e),this.closeloadding()},changeTurn:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];0==e?(this.turnSeat=1,t&&this.giveTurn2(this.archery_timer)):1==e&&(this.turnSeat=0,t&&this.giveTurn1(this.archery_timer))},sendState:function(){this.getPlayerBoard(cc.global.user.id).isReady()||this.socket().exec("ready",{extparams:{roomid:this.roomid}})},userready_event:function(e,t){cc.global.audio.playEffectAud("ready");var i=t.getPlayerBoard(e.userid);if(i){var a=t.getLanguageText("PREPARED_0");i.setState(a),i.startTimer(30)}},initPlayer:function(t,e){var i=this;if(1==t.seatid)this.canFire=!1;else{var a=this;this.scheduleOnce(function(){a.canFire=!0},1.5)}if(e.extdata.timer&&!isNaN(e.extdata.timer)&&(this.archery_timer=parseInt(e.extdata.timer)),o.setTargetInfo(e.extdata.nextboard.dist,e.extdata.nextboard.mode),o.setWindInfo(e.extdata.nextboard.winddir,e.extdata.nextboard.windpower),0!=o.targetMode&&this.targetLayer.getComponent(cc.Animation).play("targetmove"+o.targetMode),this.scheduleOnce(function(){var e=" Wind "+o.getWindPower();0!=o.windPower&&(e+="m/s "),i.windLayer.getChildByName("WindSpeed").getComponent(cc.Label).string=e,i.windLayer.getChildByName("WindArrow").rotation=o.getWindDirection()},1),this.windLayer.runAction(cc.sequence(cc.delayTime(1),cc.moveTo(0,0,240),cc.scaleTo(0,0),cc.scaleTo(.2,1.5*cc.global.narrowContentRatio),cc.scaleTo(.1,.85*cc.global.narrowContentRatio),cc.delayTime(.2),cc.moveTo(.2,260*cc.global.narrowContentRatio,300*cc.global.narrowContentRatio))),this.turnboard.getChildByName("name").getComponent(cc.Label).string=t.userdata.nickname,this.turnboard.getChildByName("round_bg").color=0!=t.seatid?new cc.Color(33,73,165):new cc.Color(160,36,36),this.turnboard.getChildByName("round_bg").getChildByName("turn").getComponent(cc.Label).string=e.extdata.nextboard.step+"/2 ",this.turnboard.getComponent(cc.Animation).play(),(a=this).turnboard.getComponent(cc.Animation).on("finished",function(e){t&&1==a.play_status&&(0==t.seatid?(a.turnSeat=0,a.giveTurn1(a.archery_timer)):(a.turnSeat=1,a.giveTurn2(a.archery_timer)))},a),this.showTurnPlayer(t),this.currentLevel=e.extdata.nextboard.round,this.currentLevel<4?this.scoreContainer.getChildByName("level").getComponent(cc.Label).string=this.currentLevel+"Round":this.scoreContainer.getChildByName("level").getComponent(cc.Label).string="Final",this.mainBack.setScale(1,1),this.mainBack.setPosition(0,0),this.bow.opacity=255,this.desk.on(cc.Node.EventType.TOUCH_START,this.onMouseDown,this),this.desk.on(cc.Node.EventType.TOUCH_MOVE,this.onMouseMove,this),this.desk.on(cc.Node.EventType.TOUCH_END,this.onMouseUp,this),this.desk.on(cc.Node.EventType.TOUCH_CANCEL,this.onMouseUp,this),(1==t.seatid||!this.notReplay)&&1==this.play_status){a=this;this.scheduleOnce(function(){cc.global.audio.playEffectAud("archery/bowready"),a.bow.getComponent(cc.Animation).play("bow")},2)}},showTurnPlayer:function(e){e.setMyTurn()},stopTurnAction:function(){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("ArcheryPlayer");0==t.seatid?(this.selfboard.children[1].stopAllActions(),this.selfboard.children[1].setScale(1,1)):1==t.seatid&&(this.oppboard.children[1].stopAllActions(),this.oppboard.children[1].setScale(1,1)),t.stopTurnAction()}},banker_event:function(e,t){t.closeConfirm(),t.hideAllStatus(),t.initGameboard(!0),t.isGamePlaying=!0,t.isNewRoom=!1;for(var i=0;i<t.playerlist.length;i++)t.playerlist[i].getComponent("ArcheryPlayer").hideBanker();var a=t.getPlayer(e.extdata.banker);t.currentPlayerId=e.extdata.banker,a.showBanker(),t.initPlayer(a,e),t.totalscore=0,t.ratio=1,t.check_betup(1,t,!0)},check_betup:function(e,t,i){var a=parseInt(e);if(1==i){var s=t.panScore*a;return t.updateBetUpBalance(s),t.multiBetUp(s),t.pangolds=t.pangolds+2*s,void(t.pandata.children[1].getComponent(cc.Label).string=t.numformat(t.pangolds))}if(0<a&&a>t.ratio){2<=(t.ratio=a)&&(a/=2,cc.global.audio.playEffectAud("charge"),t.showMultiAni());s=t.panScore*a;var r=0;if("normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway)for(var n=0;n<t.playerlist.length;n++){var o=t.playerlist[n].getComponent("ArcheryPlayer");if(o){if(0==o.userdata.goldcoins)return;0==r?r=o.userdata.goldcoins:r>o.userdata.goldcoins&&(r=o.userdata.goldcoins)}}r<s&&(s=r),t.updateBetUpBalance(s),t.multiBetUp(s),t.pangolds=t.pangolds+2*s,t.pandata.children[1].getComponent(cc.Label).string=t.numformat(t.pangolds)}},showMultiAni:function(){if(this.multi){var e=this;this.multi.active=!0;var t=this.multi.getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"play",!1),setTimeout(function(){e&&e.multi&&(e.multi.active=!1)},2e3)}},initVariables:function(){this.canvas=cc.director.getScene().getChildByName("Canvas"),this.bow=this.mainboard.getChildByName("Bow"),this.scope=this.mainboard.getChildByName("Scope"),this.dragX=0,this.dragY=0,this.targetAimX=0,this.targetAimY=0,this.scale=.5,this.startAimX=0,this.startAimY=0,this.maxMoveSpeed=10,this.easeTargetX=0,this.easeTargetY=0,this.tempArrowPosX=-1,this.tempArrowPosY=-1,this.fireFlag=!1,this.zoomLevel=1.4,this.rot=0,this.currentLevel=1,this.ope=1,this.backCamera.x=0,this.backCamera.y=0,this.backCamera.getComponent(cc.Camera).zoomRatio=1,this.windLayer.setPosition(800*cc.global.narrowContentRatio,300*cc.global.narrowContentRatio),this.canFire=!1,this.zoomFlag=!1,this.zoomLimit=1,this.zoomed=!1,this.isMoveable=!1,this.bow.opacity=255,this.flyingLayer.children[0].opacity=0,this.scope.opacity=0,this.bow.getComponent(cc.Sprite).spriteFrame=this.bowAtlas.getSpriteFrame("bow1"),this.targetLayer.getChildByName("score10").opacity=0,this.targetLayer.getChildByName("score9").opacity=0,this.targetLayer.getChildByName("score8").opacity=0,this.targetLayer.getChildByName("score7").opacity=0,this.targetLayer.getChildByName("score6").opacity=0,this.targetLayer.getComponent(cc.Animation).stop(),this.targetLayer.x=0,this.targetLayer.y=85,this.stopTurnAction()},playarchery_event:function(e,t){if(!t.notReplay||parseInt(t.roomid)==parseInt(e.room_id)){t.lblTurnCount&&e.extdata&&e.extdata.turncount&&(t.lblTurnCount.string="\n"+Math.round(parseInt(e.extdata.turncount)/2)+"Turn",t.turnCount.server=parseInt(e.extdata.turncount),parseInt(cc.global.user.id)==parseInt(e.userid)&&"p"!=e.extdata.type||(t.turnCount.local+=1)),e.extdata.timer&&!isNaN(e.extdata.timer)&&(t.archery_timer=parseInt(e.extdata.timer)),t.closeConfirm(),t.hideAllStatus(),t.stopTurnTimerAll();var i=t.getPlayer(e.extdata.next);t.currentPlayerId=e.extdata.next,t.scope.opacity=0,t.bow.getComponent(cc.Sprite).spriteFrame=t.bowAtlas.getSpriteFrame("bow1"),t.bow.opacity=0,e.extdata.shoot&&(t.targetLayer.getComponent(cc.Animation).stop(),t.targetLayer.x=e.extdata.shoot.target_x,t.targetLayer.y=e.extdata.shoot.target_y),i&&(e.extdata.passcount&&t.getPlayer(e.userid).updatePassCount(e.extdata.passcount),"p"==e.extdata.type?t.onShowScore(t,t.getPlayer(e.userid),i,e):"n"==e.extdata.type&&t.setScore(t,t.getPlayer(e.userid),i,e)),t.showBoardClaim(e.extdata.type);var a="";switch(e.extdata.type){case"n":break;case"p":a="pass"}""!=a&&i.speech(a)}},setScore:function(e,t,i,a){var s,r;e.isMoveable=!1,e.fireFlag=!0,s=a.extdata.shoot.hit_x+a.extdata.shoot.cam_x,r=a.extdata.shoot.hit_y+a.extdata.shoot.cam_y,e.backCamera.x=s,e.backCamera.y=r,cc.global.audio.playEffectAud("archery/arrow"),e.flyingLayer.getComponent(cc.Animation).play(),e.backCamera.getComponent(cc.Animation).play("firezoom"),e.scheduleOnce(function(){cc.global.audio.playEffectAud("archery/target"),e.onShowScore(e,t,i,a)},1)},onShowScore:function(e,t,i,a){if(a.extdata.shoot&&this.currentLevel<4){var s=parseInt(a.extdata.shoot.score),r=""+s;0!=s&&e.targetLayer.getChildByName("score"+s).runAction(cc.sequence(cc.fadeTo(.1,200),cc.fadeTo(.1,50),cc.fadeTo(.1,200),cc.fadeTo(.1,50),cc.fadeTo(.1,200),cc.fadeTo(.1,50),cc.fadeTo(.1,200))),10==s?cc.global.audio.playEffectAud("archery/shake10"):9==s?cc.global.audio.playEffectAud("archery/shake9"):6<=s?cc.global.audio.playEffectAud("archery/shake"):cc.global.audio.playEffectAud("archery/miss"),e.scoreboard.children[0].getComponent(cc.Label).string=r,e.scoreboard.runAction(cc.sequence(cc.moveTo(0,-370*cc.global.narrowContentRatio,310*cc.global.narrowContentRatio),cc.moveTo(.1,-60*cc.global.narrowContentRatio,310*cc.global.narrowContentRatio),cc.moveTo(.05,-100*cc.global.narrowContentRatio,310*cc.global.narrowContentRatio),cc.delayTime(.6),cc.moveTo(.05,-60*cc.global.narrowContentRatio,310*cc.global.narrowContentRatio),cc.moveTo(.1,-370*cc.global.narrowContentRatio,310*cc.global.narrowContentRatio)))}var n,o,l;if((n=parseInt(a.extdata.ratio))>e.ratio&&e.check_betup(n,e,!1),a.extdata.shoot)if(0==t.seatid){if(4<=this.currentLevel)1<(c=a.extdata.shoot.delta+"").split(".").length&&(c=c.split(".")[0]+c.split(".")[1][0]),o=c;else o=a.extdata.wininfo.totalscore;e.scoreContainer.getChildByName("scorem").getComponent(cc.Label).string=o}else{var c;if(4<=this.currentLevel)1<(c=a.extdata.shoot.delta+"").split(".").length&&(c=c.split(".")[0]+c.split(".")[1][0]),l=c;else l=a.extdata.wininfo.totalscore;e.scoreContainer.getChildByName("scoreo").getComponent(cc.Label).string=l}var h=parseInt(a.extdata.wininfo.winner);if(-2!=h){var d=parseInt(e.scoreContainer.getChildByName("scorem").getComponent(cc.Label).string),u=parseInt(e.scoreContainer.getChildByName("scoreo").getComponent(cc.Label).string);e.resultboard.getChildByName("round_bg").children[0].getComponent(cc.Label).string=e.currentLevel+"Round ",0==t.seatid?(e.loadAvatar(t.userdata.avatarurl,t.userdata.gender,e.resultboard.getChildByName("avatar_self").getChildByName("bg").children[0].children[0].children[0].getComponent(cc.Sprite)),e.loadAvatar(i.userdata.avatarurl,i.userdata.gender,e.resultboard.getChildByName("avatar_opp").getChildByName("bg").children[0].children[0].children[0].getComponent(cc.Sprite)),e.resultboard.getChildByName("avatar_self").getChildByName("name").getComponent(cc.Label).string=t.userdata.nickname,e.resultboard.getChildByName("avatar_opp").getChildByName("name").getComponent(cc.Label).string=i.userdata.nickname):(e.loadAvatar(i.userdata.avatarurl,i.userdata.gender,e.resultboard.getChildByName("avatar_self").getChildByName("bg").children[0].children[0].children[0].getComponent(cc.Sprite)),e.loadAvatar(t.userdata.avatarurl,t.userdata.gender,e.resultboard.getChildByName("avatar_opp").getChildByName("bg").children[0].children[0].children[0].getComponent(cc.Sprite)),e.resultboard.getChildByName("avatar_self").getChildByName("name").getComponent(cc.Label).string=i.userdata.nickname,e.resultboard.getChildByName("avatar_opp").getChildByName("name").getComponent(cc.Label).string=t.userdata.nickname),e.resultboard.getChildByName("scorem").getComponent(cc.Label).string=e.scoreContainer.getChildByName("scorem").getComponent(cc.Label).string,e.resultboard.getChildByName("scoreo").getComponent(cc.Label).string=e.scoreContainer.getChildByName("scoreo").getComponent(cc.Label).string,(-1==h||u<d)&&e.resultboard.getChildByName("avatar_self").getChildByName("avatar_light").getComponent(cc.Animation).play(),(-1==h||d<u)&&e.resultboard.getChildByName("avatar_opp").getChildByName("avatar_light").getComponent(cc.Animation).play(),e.resultboard.runAction(cc.sequence(cc.delayTime(1),cc.scaleTo(0,1.5*cc.global.narrowContentRatio),cc.scaleTo(.25,.8*cc.global.narrowContentRatio),cc.scaleTo(.05,1*cc.global.narrowContentRatio),cc.delayTime(2.25),cc.scaleTo(.05,1.2*cc.global.narrowContentRatio),cc.scaleTo(.25,0))),e.resultboard.getComponent(cc.Animation).play(),t.showScoreAnim(h==t.userdata.id||-1==h,e.currentLevel),i.showScoreAnim(h==i.userdata.id||-1==h,e.currentLevel),this.scheduleOnce(function(){e.scoreContainer.getChildByName("scorem").getComponent(cc.Label).string=0,e.scoreContainer.getChildByName("scoreo").getComponent(cc.Label).string=0,e.changeTurnPlayer(e,i,a)},4)}else this.scheduleOnce(function(){e.changeTurnPlayer(e,i,a)},1.5)},changeTurnPlayer:function(e,t,i){0==e.finishAct.active&&e.isGamePlaying&&(e.initVariables(),e.initPlayer(t,i))},stopTurnTimerAll:function(){this.turntimer.getComponent("ArcheryTimer").stopAllTimer()},showBoardClaim:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";switch(e){case"n":break;case"p":"pass";break;case"w":"win",cc.global.audio.playSummaryAud("win");break;case"l":"defeat",cc.global.audio.playSummaryAud("lose");break;case"d":"draw",cc.global.audio.playSummaryAud("lose")}if(this.boardclaim.node.children[0].active=!1,"tech"==t&&(this.boardclaim.node.children[0].active=!0,this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string={l:"Lose",w:"Victory"}[e]),"w"==e)this.runFinishAction("dzz_cj_win");else if("l"==e)this.runFinishAction("dzz_cj_lose");else if("p"==e){this.boardclaim.node.children[0].active=!0;var i=this.getLanguageText("PASS_0");this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string=i,this.boardclaim.getComponent(cc.Animation).play()}},runFinishAction:function(e){if("yes"!=cc.global.amObserve&&this.finishAct&&this.finishAct.getComponent(sp.Skeleton)){var t=cc.callFunc(this.enableFinishAni,this,e),i=cc.callFunc(this.disableFinishAni,this);this.node.runAction(cc.sequence(t,cc.delayTime(3),i))}},enableFinishAni:function(e,t){if(this.finishAct){var i=this.finishAct.getComponent(sp.Skeleton);i&&(this.finishAct.active=!0,i.animation=t)}},disableFinishAni:function(e){this.finishAct&&(this.finishAct.active=!1)},recovery_event:function(e,t){t.stopTurnTimerAll(),t.isGamePlaying=!0,t.hideAllStatus(),t.initGameboard(!1);var i=t.getPlayer(e.userid);t.currentPlayerId=e.userid,t.initVariables(),t.initPlayer(i,e);for(var a=0;a<e.extdata.players.length;a++){var s,r=t.getPlayer(e.extdata.players[a].playuser);if(r.showCups(e.extdata.players[a].winLog),4<=t.currentLevel){var n=e.extdata.players[a].score+"";1<n.split(".").length&&(n=n.split(".")[0]),s=n}else s=e.extdata.players[a].score;0==r.seatid?t.scoreContainer.getChildByName("scorem").getComponent(cc.Label).string=s:t.scoreContainer.getChildByName("scoreo").getComponent(cc.Label).string=s}var o=parseInt(e.extdata.ratio);1<o&&(t.pangolds=t.panScore*o),t.check_betup(o,t,!1)},setPanInfo:function(e,t){var i=this.getPlayer(e[0].playuser);o.setPanInfo(t),(0==i.seatid&&1==i.userdata.seatid||1==i.seatid&&0==i.userdata.seatid)&&o.flipPan()},setTurn:function(e,t){var i=this.getPlayer(e);i&&(this.turnSeat=i.seatid),this.stopTurnTimerAll(),0==this.turnSeat?this.giveTurn1(t):1==this.turnSeat&&this.giveTurn2(t)},giveTurn1:function(e){this.fireFlag=!1,this.isMoveable=!0,this.turntimer&&this.turntimer.getComponent("ArcheryTimer").turnTimer1(e)},giveTurn2:function(e){this.fireFlag=!1,this.isMoveable=!0,this.turntimer&&this.turntimer.getComponent("ArcheryTimer").turnTimer2(e)},hideAllStatus:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ArcheryPlayerBoard");t&&t.hideStatus()}},multiBetUp:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("ArcheryPlayer");i&&i.betup.getComponent("TetrisBetUp").init(e,0)}},workOutMatchCareer:function(e){for(var t=0;t<e.players.length;t++){var i=this.getPlayer(e.players[t].userid),a=this.getPlayerBoard(e.players[t].userid);i&&a&&("normal"==cc.global.user.selplayway?0<e.players[t].score&&(this.matchCareerData.tgolds[i.userdata.id]+=e.players[t].score-this.pangolds/2):"diamond"==cc.global.user.selplayway&&0<e.players[t].score&&(this.matchCareerData.tdiamonds[i.userdata.id]+=e.players[t].score-this.pangolds/2),2==e.players[t].win&&(this.matchCareerData.wins[i.userdata.id]++,i.userdata.id))}},allcards_event:function(i,a){clearTimeout(a.changeTurnTimer),a.otherEventCache=[],a.isGamePlaying=!1,a.pickedPiece=null,a.stopTurnTimerAll(),a.matchCareerData&&a.workOutMatchCareer(i);for(var e=a.playerlist.length==i.players.length,t=!1,s=4<=a.currentLevel,r=0;r<i.players.length;r++){var n=a.getPlayer(i.players[r].userid);i.players[r].getout&&(t=!0,e=!1),a.getPlayerBoard(i.players[r].userid)&&("suicide"!=i.title||i.players[r].win||((n=a.getPlayer(i.players[r].userid))&&n.showEmoticon(-1),t=!0))}setTimeout(function(){for(var e=0;e<i.players.length;e++){var t=a.getPlayer(i.players[e].userid);t&&("normal"==cc.global.user.selplayway&&(t.userdata.goldcoins=parseInt(i.players[e].gold)),t.summary(i.players[e]))}},t?0:s?2e3:5e3),setTimeout(function(){for(var e=0;e<i.players.length;e++){if(i.players[e].userid==cc.global.user.id)switch(a.notReplay&&(cc.global.user.goldcoins=i.players[e].gold),i.players[e].win){case 0:a.showBoardClaim("l",i.title);break;case 1:a.showBoardClaim("d",i.title);break;case 2:a.showBoardClaim("w",i.title)}}},t?0:s?2e3:5e3),o.init(),e?a.endGameTimer=setTimeout(function(){a.boardclaim&&(a.endGameTimer=null,a.boardclaim.getComponent(cc.Animation).stop(),a.cleanAfterAllCards(),a.setReadyState())},t?5e3:s?7e3:1e4):setTimeout(function(){a.boardclaim&&(a.boardclaim.getComponent(cc.Animation).stop(),a.boardclaim.node.setScale(0,0),a.pandata.children[1].getComponent(cc.Label).string="0",a.initVariables(),a.clearCups())},2e3)},clearCups:function(){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].getComponent("ArcheryPlayer")&&this.playerlist[e].getComponent("ArcheryPlayer").clearCups();this.scoreContainer.getChildByName("level").getComponent(cc.Label).string="1Round",this.scoreContainer.getChildByName("scorem").getComponent(cc.Label).string="0",this.scoreContainer.getChildByName("scoreo").getComponent(cc.Label).string="0"},cleanAfterAllCards:function(){this.pangolds=0,cc.global.amObserve&&"no"==cc.global.amObserve&&this.showWaitingTimer();for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].getComponent("ArcheryPlayer").hideBanker(),this.playerlist[e].getComponent("ArcheryPlayer").updatePassCount(0);this.lblTurnCount&&(this.lblTurnCount.string="\n",this.turnCount.local=0,this.turnCount.server=0),this.turntimer.getComponent("ArcheryTimer").turnIdx=2,this.turntimer.getComponent("ArcheryTimer").myclock.getComponent(cc.ProgressBar).progress=1,this.turntimer.getComponent("ArcheryTimer").yourclock.getComponent(cc.ProgressBar).progress=1,this.turntimer.getComponent("ArcheryTimer").myclock.children[1].getComponent(cc.Label).string="0.00s",this.turntimer.getComponent("ArcheryTimer").yourclock.children[1].getComponent(cc.Label).string="0.00s",this.boardclaim.node.setScale(0,0),this.pandata.children[1].getComponent(cc.Label).string="0",this.initVariables(),this.clearCups()},updateBetUpBalance:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("ArcheryPlayer");i&&(i.userdata.goldcoins-=e)}this.updatePlayerBalance()},updatePlayerBalance:function(){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("ArcheryPlayer");t&&t.updateBalance()}},showWaitingTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ArcheryPlayerBoard");t&&t.startTimer(30)}},showReadyTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ArcheryPlayerBoard");t&&t.startTimer(3)}},hideTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ArcheryPlayerBoard");t&&t.stopTimer()}},getPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("ArcheryPlayer");if(i.userdata.id==e)return i}},getOtherPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("ArcheryPlayer");if(i.userdata.id!=e)return i}},getPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("ArcheryPlayerBoard");if(i.userdata.id==e)return i}},getOtherPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("ArcheryPlayerBoard");if(i.userdata.id!=e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},onClickGiveUp:function(){if(this.isGamePlaying){var e=this;if(this.turnSeat)return void this.alert("No your turn.");cc.global.audio.playVoiceSpeech("support/12_give_up");var t=this.getLanguageText("ARE_YOU_GIVE_UP");this.checkConfirm(t,function(){e&&e.socket().exec("suicide",{})},null)}},onClickSfx:function(){if(this.btnSfx){var e=this.btnSfx,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},showChatDialog:function(){this.onclickChat(0)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.notReplay){if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}if(!(e<0)){this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root();var a=this.chatpage.getComponent("Chat");a.init(this,e),a.base.x=a.base.y=0,this.ischat=!0}}},onClickEmoticon:function(){if(this.notReplay){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),this.isemoticon=!1;this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root();var e=this.emoticonpage.getComponent("Emoticon");e.init(this,!1),e.base.x=e.base.y=0,this.isemoticon=!0}},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase,a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg);var s=t.getObserver(e.userid);s&&s.showCallPlayer(i,e.msg)},callplayer_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg);var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg,!1)},emoticon_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg);var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},onclickBack:function(){var e=this;if(this.notReplay)if(this.isGamePlaying&&"no"==cc.global.amObserve){if(this.turnSeat)return void this.alert("No your turn.");cc.global.audio.playVoiceSpeech("support/14_roomout"),this.checkConfirm("Are you sure to leave room? You will lose.",function(){e.socket().exec("leave",{})},null)}else this.socket().exec("leave",{});else this.exitPlay()},exitPlay:function(){var e=this;cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),null==this.exitTimer&&(this.exitTimer=setInterval(function(){e.finishAct&&!e.finishAct.active&&(e.returnToHall(),clearInterval(e.exitTimer),e.exitTimer=null)},500))},returnToHall:function(){this.loadding(),clearInterval(this.otherEventInvoker),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.startGameTimer&&clearTimeout(this.startGameTimer),this.endGameTimer&&clearTimeout(this.endGameTimer),this.hideTimer(),this.cleanAllPlayers(),this.scene("hall",this)}}),cc._RF.pop()},{ArcheryEngine:"ArcheryEngine",HHCommon:"HHCommon"}],ArcheryEngine:[function(e,t,i){"use strict";cc._RF.push(t,"bcd3asA42dJ5KYNFcwNdfFs","ArcheryEngine"),t.exports=function(){this.init=function(){this.screenWidth=720,this.screenHeight=1280,this.initialTweenX=this.screenWidth/2+100*Math.random()*(.5<Math.random()?1:-1),this.initialTweenY=this.screenHeight/2+100*Math.random()*(.5<Math.random()?1:-1),this.initialArrowScale=.3,this.initialArrowRotation=0,this.initialArrowX=76,this.initialArrowY=-90,this.zoomLevel=1.4,this.windDir=0,this.windPower=0,this.initialBoardScale=1,this.initialBoardOpe=255,this.radian=Math.PI/180},this.setTargetInfo=function(e,t){this.targetDist=e,this.targetMode=t,this.arrowScale=.3-.05*(this.targetDist/10-3),this.cameraCount=10+5*(this.targetDist/10-3),this.flyingTime=.4+(this.targetDist/10-3)/15,this.zoomLimit=1.5+.2*(this.targetDist/10-3)},this.setWindInfo=function(e,t){this.windDir=e,this.windPower=t},this.getWindPower=function(){return 0==this.windPower?"No Wind":this.windPower.toFixed(1).toString()},this.getWindDirection=function(){return this.windDir/this.radian},this.getHitPos=function(e,t,i,a,s){var r=0,n=this.windPower*Math.cos(this.windDir)*50*s,o=-this.windPower*Math.sin(this.windDir)*50*s,l=n,c=o,h=e-i+n,d=t-a+o,u=Math.sqrt(h*h+d*d);return(r=(u/=s)<30?10:u<70?9:u<110?8:u<150?7:u<200?6:0)<=0&&(r=0),[r,l,c]},this.getRndInteger=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},this.getNewWind=function(){var e=0;1==this.getRndInteger(0,1)&&(e=180);return[(60*Math.random()-30+e)*this.radian,Math.round(2*Math.random()*10)/10+1.5]}},cc._RF.pop()},{}],ArcheryPlayerBoard:[function(e,t,i){"use strict";cc._RF.push(t,"50097SSyulDMaG2bYAU8jWb","ArcheryPlayerBoard");var a=e("HHCommon");cc.Class({extends:a,properties:{countdown:{default:null,type:cc.Label},status:{default:null,type:cc.Label},tip:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.layoutForSeat()},startTimer:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode||!(3<e)){var t=this;t.stopTimer(),t.countdown.node.active=!0,t.countdown.string=e,t.timer||(t.timer=setInterval(function(){0<e?t.countdown&&(e--,t.countdown.string=e):t.stopTimer()},1e3))}},stopTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null),this.countdown&&(this.countdown.node.active=!1)},setState:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode){this.status.node.active=!0,this.status.string=e;var t=this.getLanguageText("READY_0")+"?",i=this.getLanguageText("PREPARED_0");t==e&&this.userdata.id==cc.global.user.id&&"no"==cc.global.amObserve?this.tip.active=!0:this.tip.active=!1}else this.status.string=i},hideTip:function(){this.tip.active=!1},hideStatus:function(){this.stopTimer(),this.hideTip(),this.status.node.active=!1},layoutForSeat:function(){0==this.seatid||this.seatid},isReady:function(){return this.getLanguageText("PREPARED_0")==this.status.string},onClickReady:function(){this.parent&&this.parent.processReadyState()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ArcheryPlayer:[function(e,t,i){"use strict";cc._RF.push(t,"19aefenBMJO8KZoksA3L2KG","ArcheryPlayer");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},nickname:{default:null,type:cc.Label},goldcoins:{default:null,type:cc.Label},betup:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},cups:{default:null,type:cc.Node},atlas:{default:null,type:cc.SpriteAtlas},winorlose:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.nickname.string=t.nickname,1==cc.global.championMode||cc.global.championMode,this.goldcoins.string=this.numformat(t.goldcoins),this.loadAvatar(t.avatarurl,t.gender),this.layoutForSeat()},showScoreAnim:function(e,t){if(!(3<t)){var i=this.cups.children[t-1];this.showCupPlayer(e?1:-1,i),e&&i.getComponent(cc.Animation).play()}},clearCups:function(){this.showCupPlayer(0,this.cups.children[0]),this.showCupPlayer(0,this.cups.children[1]),this.showCupPlayer(0,this.cups.children[2])},showCupPlayer:function(e,t){t.getComponent(cc.Sprite).spriteFrame=1==e?this.atlas.getSpriteFrame("cup_win"):this.atlas.getSpriteFrame("cup_lose")},setMyTurn:function(){},stopTurnAction:function(){var e=0==this.seatid?1:-1;this.avatar.node.parent.parent.stopAllActions(),this.avatar.node.parent.parent.setScale(e,1),this.emoticon.parent.stopAllActions(),this.emoticon.parent.setScale(e,1)},showCups:function(e){for(var t=0;t<e.length;t++){var i=this.cups.children[t];this.showCupPlayer(e[t],i)}},addScore:function(e){},totalScore:function(){},speech:function(e){var t=this.userdata.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)},onClickDisInfo:function(){},updateCareer:function(e){},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},spendDiamondForLuck:function(e){this.updateBalance()},showCallPlayer:function(e,t){var i=this;this.hideCallPlayer(),this.callplayer.active=!0,this.callplayer.children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onClickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userdata.id},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){cc.global.user.id==this.userdata.id?this.parent.onClickEmoticon&&this.parent.onClickEmoticon():this.onClickCallPlayer()},layoutForSeat:function(){0==this.seatid?(this.node.scaleX=1,this.nickname.node.scaleX=1,this.node.getChildByName("avatar").scaleX=1,this.node.getChildByName("emoticon").scaleX=1,this.callplayer.children[0].scaleX=1,this.goldcoins.node.parent.scaleX=1,this.winorlose.scaleX=1):1==this.seatid&&(this.node.scaleX=-1,this.nickname.node.scaleX=-1,this.node.getChildByName("avatar").scaleX=-1,this.node.getChildByName("emoticon").scaleX=-1,this.callplayer.children[0].scaleX=-1,this.goldcoins.node.parent.scaleX=-1,this.winorlose.scaleX=-1)},summary:function(e){var a=this;if(this.updateCareer(e),this.winorlose.getComponent(cc.Animation).play(),2==e.win){cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("win"),this.winorlose.children[0].getComponent(cc.Label).string="+"+this.numformat(e.exp),this.winorlose.children[1].getComponent(cc.Label).string="+"+this.numformat(e.score),e.orig_gold=e.gold-e.score,"diamond"==cc.global.user.selplayway&&(e.orig_gold=e.diamond-e.score);var t=cc.callFunc(function(e,t){t.orig_gold+Math.round(t.score/5)>("diamond"==cc.global.user.selplayway?t.diamond:t.gold)?"diamond"==cc.global.user.selplayway?t.orig_gold=t.diamond:t.orig_gold=t.gold:t.orig_gold=t.orig_gold+Math.round(t.score/5);var i=e.getComponent("ArcheryPlayer").goldcoins.node;i.getComponent(cc.Label).string=a.numformat(t.orig_gold),i.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1)))},this,e),i=cc.sequence(cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t);this.node.runAction(i)}else cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("lose"),this.winorlose.children[0].getComponent(cc.Label).string="-"+this.numformat(Math.abs(e.exp)),this.winorlose.children[1].getComponent(cc.Label).string="-"+this.numformat(-1*e.score),this.goldcoins.string=this.numformat(e.gold)},showFuncStatus:function(){},showBanker:function(){},hideBanker:function(){},updatePassCount:function(e){}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ArcheryTimer:[function(e,t,i){"use strict";cc._RF.push(t,"d9653HhyJdMHr2SVxJzOQpQ","ArcheryTimer");var a=e("HHCommon");cc.Class({extends:a,properties:{clock:{default:null,type:cc.Node},myclock:{default:null,type:cc.Node},yourclock:{default:null,type:cc.Node},turnIdx:2,mytimes:20,remaining:20},start:function(){this.isPaused=!1},setParent:function(e){this.parent=e},turnTimer1:function(e){this.stopEnemyTimer(),this.mytimes=e,this.remaining=e,this.turnIdx=0,this.clock.getComponent(cc.ProgressBar).progress=1,this.myclock.getComponent(cc.ProgressBar).progress=1,this.yourclock.getComponent(cc.ProgressBar).progress=1,this.myclock.children[1].getComponent(cc.Label).string=e+".00s",this.yourclock.children[1].getComponent(cc.Label).string=e+".00s"},turnTimer2:function(e){this.stopMyTimer(),this.mytimes=e,this.remaining=e,this.turnIdx=1,this.clock.getComponent(cc.ProgressBar).progress=1,this.myclock.getComponent(cc.ProgressBar).progress=1,this.yourclock.getComponent(cc.ProgressBar).progress=1,this.myclock.children[1].getComponent(cc.Label).string=e+".00s",this.yourclock.children[1].getComponent(cc.Label).string=e+".00s"},stopAllTimer:function(){this.stopMyTimer(),this.stopEnemyTimer(),this.turnIdx=2},stopMyTimer:function(){this.myTimer&&this.unscheduleAllCallbacks()},stopEnemyTimer:function(){this.enemyTimer&&this.unscheduleAllCallbacks()},pauseAllTimer:function(){this.isPaused=!0,this.pauseMyTimer(),this.pauseEnemyTimer()},pauseMyTimer:function(){this.myTimer&&this.unscheduleAllCallbacks()},pauseEnemyTimer:function(){this.enemyTimer&&this.unscheduleAllCallbacks()},resumeAllTimer:function(){this.isPaused=!1,this.resumeMyTimer(),this.resumeEnemyTimer()},resumeMyTimer:function(){this.myTimer&&(this.turnIdx=0)},resumeEnemyTimer:function(){this.enemyTimer&&(this.turnIdx=1)},update:function(e){1!=this.parent.fireFlag?0==this.turnIdx?(this.remaining-=e,this.clock.getComponent(cc.ProgressBar).progress=this.remaining/this.mytimes,this.remaining<=0&&(this.remaining=0,this.turnIdx=2),this.myclock.getComponent(cc.ProgressBar).progress=this.remaining/this.mytimes,this.myclock.children[1].getComponent(cc.Label).string=this.remaining.toFixed(2)+" s"):1==this.turnIdx&&(this.remaining-=e,this.remaining<=0&&(this.remaining=0,this.turnIdx=2),this.yourclock.getComponent(cc.ProgressBar).progress=this.remaining/this.mytimes,this.yourclock.children[1].getComponent(cc.Label).string=this.remaining.toFixed(2)+" s"):this.turnIdx=2}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ArrayList:[function(e,t,i){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}cc._RF.push(t,"f4453G8s0RJsbyW2ylhI9oe","ArrayList"),t.exports=function s(){this.array=[],this.curSize=0,this.add=function(e){this.array[this.curSize]=e,this.curSize++},this.addAtIndex=function(e,t){for(var i=[].concat(r(this.array)),a=0;a<e;a++)this.array[a]=i[a];for(this.array[e]=t,a=e;a<this.curSize;a++)this.array[a+1]=i[a];this.curSize++},this.addAll=function(e){for(var t=this.curSize,i=t;i<t+e.length;i++)this.add(e[i-t])},this.clear=function(){this.array=[],this.curSize=0},this.get=function(e){return this.array[e]},this.getArray=function(){return this.array},this.getSubList=function(e,t){for(var i=new s,a=e;a<e+t;a++)i.add(this.array[a]);return i},this.remove=function(e){var t=[].concat(r(this.array));this.clear();for(var i=0;i<t.length;i++)e!=t[i]&&this.add(t[i])},this.removeAll=function(e){for(var t=0;t<e.length;t++)this.remove(e[t])},this.removeAtIndex=function(e){var t=[].concat(r(this.array)),i=null;this.clear();for(var a=0;a<t.length;a++)e!=a?this.add(t[a]):i=t[a];return i},this.size=function(){return this.curSize},this.isEmpty=function(){return!(0<this.curSize)}},cc._RF.pop()},{}],Audio:[function(e,t,i){"use strict";cc._RF.push(t,"96a36jfjpRLgZT3Jlvhe5k8","Audio"),cc.Class({extends:cc.Component,properties:{bgAudioID:-1,effectAudioID:-1},init:function(){var e=cc.sys.localStorage.getItem("bgVolume"),t=cc.sys.localStorage.getItem("effectVolume");null==e&&(e=.5),this.bgVolume=parseFloat(e),null==t&&(t=.5),this.effectVolume=parseFloat(t),cc.game.on(cc.game.EVENT_HIDE,function(){cc.audioEngine.pauseAll()}),cc.game.on(cc.game.EVENT_SHOW,function(){cc.audioEngine.resumeAll()})},playHallBgm:function(){var e=4===cc.global.theme_idx?1:2;this.playBGM("bgm_hall_theme"+e,.3)},playBGM:function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1]},playEffect:function(e,a){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.7,r=this,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t&&cc.loader.loadRes(e,cc.AudioClip,function(e,t){if(e);else{var i=cc.audioEngine.play(t,a,r.effectVolume*s);a&&(r.effectAudioID=i)}})},setEffectVolume:function(e){this.effectVolume=parseFloat(e),0<=self.effectAudioID&&cc.audioEngine.setVolume(this.effectAudioID,this.effectVolume)},setBGMVolume:function(e){this.bgVolume=parseFloat(e),0<=this.bgAudioID&&cc.audioEngine.setVolume(this.bgAudioID,this.bgVolume)},getState:function(){return cc.audioEngine.getState(this.bgAudioID)},pauseAll:function(){cc.audioEngine.pauseAll()},resumeAll:function(){cc.audioEngine.resumeAll()},playBtnAud:function(){this.playEffect("sounds/ui/click",!1)},playDialogAud:function(){this.playEffect("sounds/ui/dialog",!1)},playEffectAud:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.3;"door"==e&&(i=.3),this.playEffect("sounds/effect/"+e,t,i)},playVoiceSpeech:function(e){},playVoiceSpeechWithType:function(e,t){},playVoiceChatWithType:function(e,t){},playSoundWithURL:function(e,i){cc.loader.load({url:e,type:"mp3"},function(e,t){!e&&t&&i?i("success",t):i&&i("error")})},playSummaryAud:function(e){this.playEffect("sounds/summary/"+e,!1)}}),cc._RF.pop()},{}],AvatarDialog:[function(e,t,i){"use strict";cc._RF.push(t,"97a405ZEjRHR5JzWpf5XERK","AvatarDialog");var a=e("HallDialog");cc.Class({extends:a,properties:{username:cc.Label,avatar:cc.Sprite,base:{default:null,type:cc.Node},avatar_list:cc.Node,tabs:cc.Node,contentList:cc.Node,avatar_app:cc.Sprite},init:function(e){this.parent=e,this.selectedAvatar="null",this.selectedSound=0,this.username.string=cc.global.user.nickname,this.loadAvatar(cc.global.user.avatarurl,cc.global.user.gender,this.avatar),this.loadAvatar(cc.global.user.avatarurl_shapp,cc.global.user.gender,this.avatar_app),cc.global.user.avatarurl&&"g_"==cc.global.user.avatarurl.substr(0,2)&&(this.selectedAvatar=cc.global.user.avatarurl),cc.global.user.playcharacter&&!isNaN(cc.global.user.playcharacter)&&(this.selectedSound=parseInt(cc.global.user.playcharacter)),(this.selectedSound<1||8<this.selectedSound)&&(this.selectedSound=1),this.onSelectAvatar(null,this.selectedAvatar),this.curTab=0},onSelectAvatar:function(e,t){for(var i=0;i<this.avatar_list.children.length;i++)this.avatar_list.children[i].children[0].active=!1,0<i&&(this.avatar_list.children[i].children[1].active=!1),this.avatar_list.children[i].name==t&&(this.avatar_list.children[i].children[0].active=!0,"null"!=t&&0<i&&(this.selectedSound=i));this.avatar_list.children[this.selectedSound].children[1].active=!0,"null"==t?this.selectedAvatar=cc.global.user.avatarurl_shapp:(this.selectedAvatar=t,cc.global.audio.playVoiceSpeech(t+"intro")),this.loadAvatar(this.selectedAvatar,cc.global.user.gender,this.avatar)},onClickClose:function(){var i=this;if(this.selectedAvatar!=cc.global.user.avatarurl||this.selectedSound!=cc.global.user.playcharacter){var e="";e=this.selectedAvatar&&"g_"==this.selectedAvatar.substr(0,2)?this.selectedAvatar:"",this.loadding(),cc.global.http.httpPost("/hall/sel_avatarV2",{avatar:e,sound:this.selectedSound},function(e){i.closeloadding();var t=JSON.parse(e);"00"==t.status&&(cc.global.user.avatarurl=t.avatar,cc.global.user.playcharacter=t.sound,i.parent.loadAvatar(cc.global.user.avatarurl,cc.global.user.gender)),i.parent.closeDialog(i)},function(){i.closeloadding(),i.parent.closeDialog(i)},this,5e3)}else i.parent.closeDialog(i)},onClickTab:function(e,t){this.curTab!=t&&(this.curTab=t,this.updateTab())},initBadgeLabel:function(){this.badgeLabels=[];for(var e=0;e<this.tabs.children.length;e++)this.badgeLabels[e]=0},updateTab:function(){for(var e=0;e<this.contentList.children.length;e++)this.contentList.children[e].active=!1;this.contentList.children[this.curTab].active=!0,this.updateTabBadge()},updateTabBadge:function(){for(var e=0;e<this.tabs.children.length;e++)e==this.curTab?this.tabs.children[e].getComponent("NotifyTabButton").init(!0,this.badgeLabels[e]):this.tabs.children[e].getComponent("NotifyTabButton").init(!1,this.badgeLabels[e])}}),cc._RF.pop()},{HallDialog:"HallDialog"}],BackWall:[function(e,t,i){"use strict";cc._RF.push(t,"ea2f7L/igVIN6sOVnkvM/Z/","BackWall"),Object.defineProperty(i,"__esModule",{value:!0}),i.BackWall=void 0;var a=function(){function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}}(),s=e("./Wall");i.BackWall=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.Wall),a(t,[{key:"onTouch",value:function(e){e.setZ(this.coordinate-e.getRadius());var t=e.getSpeedz();0<t&&e.setSpeedz(-t*this.getRate())}},{key:"isCross",value:function(e){return e.getZ()>this.coordinate-e.getRadius()}}]),t}();cc._RF.pop()},{"./Wall":"Wall"}],Background:[function(e,t,i){"use strict";cc._RF.push(t,"fc4f2XRifZKkosSwPAQWxi/","Background");e("ContentAdapter");cc.Class({extends:cc.Component,properties:{theme1:{default:null,type:cc.Node},theme2:{default:null,type:cc.Node},theme3:{default:null,type:cc.Node}},onLoad:function(){if(this.theme3&&(this.theme3.active=!1),this.theme1&&this.theme2){var e=cc.global.theme_idx;1==e||3==e?(this.theme1.active=!1,this.theme2.active=!0,this.theme=this.theme1):(this.theme2.active=!1,this.theme1.active=!0,this.theme=this.theme2)}cc.global.isDark&&this.theme3&&(this.theme1.active=!1,this.theme2.active=!1,this.theme3.active=!0)}}),cc._RF.pop()},{ContentAdapter:"ContentAdapter"}],BallLayer:[function(e,t,i){"use strict";cc._RF.push(t,"d8cd8hF0YVCkaAZNdM91ZJ1","BallLayer"),Object.defineProperty(i,"__esModule",{value:!0}),i.BallLayer=void 0;var a=function(){function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}}(),n=e("../../Constants"),s=e("../../game/model/Space3d"),r=e("../../game/perspective/Perspective3d"),l=e("../../game/perspective/Vector3d"),c=e("../model/Basketry"),h=e("../PointHistory"),d=e("./BackWall"),u=e("./Floor");e("./FrontWall");i.BallLayer=function(){function o(e,t,i,a,s,r,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,o),this._width=r,this._height=n,this._game=e,this.basketParent=t,this.ballPrefab=i,this._basketryShape=a,this._net=s,this.netRadius=60,this.initPerspective(),this._verticalGap=this._space.getHeight()-this._height,this._waitingBallCenter=0,this.createBasketry(),this.createWalls(),this.createBalls(),this.playingBalls=[],this.ballIndex=0,this.pointHistoryList=[],this._lastTime=0}return a(o,[{key:"initPerspective",value:function(){this._space=new s.Space3d(480,624,270,448.4,690),this._space.scale(this._width,this._height),this._senceParam=this._space.getHeight()/797;var e=new l.Vector3d(0,0,0);this._space.fillViewPoint(e),this.perspective3d=new r.Perspective3d(e)}},{key:"createBasketry",value:function(){var e=this._space.getWidth()/2;this._basketry=new c.Basketry(this.netRadius,this),this._basketry.setPosition(e,490,this._space.getDeepth()-this.netRadius-12),this._basketryShape.setVariables(this._basketry,this._space.getDeepth()),this._basketryShape.setDepOffset(this.netRadius),this._basketryShape.setOffset(0,0),this._basketryShape.drawing(this.perspective3d),this._net.setVariables(this._basketry,this._space.getDeepth()),this._net.setDepOffset(-this.netRadius),this._net.setOffset(0,0),this._net.setZOrder(4),this._net.drawing(this.perspective3d),this.basketParent.getChildByName("basketback").setLocalZOrder(1),this.basketParent.getChildByName("basketry_up").setLocalZOrder(2),this.basketParent.getChildByName("effect").setLocalZOrder(5)}},{key:"createWalls",value:function(){this.ballBoard=new d.BackWall(this._space.getDeepth(),.35),this.floor=new u.Floor(1.3*this._height,.6)}},{key:"createBalls",value:function(){this.balls=[];for(var e=0;e<n.BALL_LIMIT;e++)this.balls.push(cc.instantiate(this.ballPrefab))}},{key:"destroyBalls",value:function(){for(var e=0;e<this.balls.length;e++)this.balls[e].destroy();this.balls=[]}},{key:"initboard",value:function(){this.setMoveByOffset(0);for(var e=this._lastTime=0;e<this.balls.length;e++)this.balls[e].parent=this.basketParent,this.balls[e].getComponent("BasketBall").setParentLayer(this),this.balls[e].getComponent("BasketBall").init(e,this.perspective3d)}},{key:"isRecoveryState",value:function(){return null==this.playingBalls||0==this.playingBalls.length}},{key:"finishBalls",value:function(){for(var e=0;e<this.playingBalls.length;e++)this.playingBalls[e].active=!1,this.playingBalls[e].getComponent("BasketBall").init(this.playingBalls[e].getComponent("BasketBall").getId(),this.perspective3d),this.balls.push(this.playingBalls[e]);this.playingBalls=[],this._net&&this._net.resetSkin()}},{key:"setMoveByOffset",value:function(e){this._basketry.setX(240-e),this._basketryShape.setVariables(this._basketry,this._space.getDeepth()),this._net.setVariables(this._basketry,this._space.getDeepth()),this._basketryShape.drawing(this.perspective3d),this._net.drawing(this.perspective3d);var t=this.perspective3d.mapX(this._basketry.getX(),this._space.getDeepth())*n.textureScale;this.basketParent.getChildByName("shadow").x=t,this.basketParent.getChildByName("basketback").x=t,this.basketParent.getChildByName("effect").x=t}},{key:"mapObject",value:function(e,t,i,a){e.setPos(this.perspective3d.mapX(t,a),this.perspective3d.mapY(i,a))}},{key:"getRndInteger",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},{key:"createNewBasketBall",value:function(){var e=this.balls.shift();e.getComponent("BasketBall").setStartPos(240),e.getComponent("BasketBall").setPosition(240,.9*this._height,this._waitingBallCenter);var t=this.perspective3d.mapX(240,this._waitingBallCenter)*n.textureScale,i=this.perspective3d.mapY(.9*this._height,this._waitingBallCenter)*n.textureScale,a=t,s=this.perspective3d.mapY(this._height,this._waitingBallCenter)*n.textureScale,r=this;e.setPosition(a,s),e.active=!0,e.getComponent("BasketBall").showScaled(),e.runAction(cc.sequence(cc.moveTo(0,a,s),cc.moveTo(.1,t,i-50),cc.moveTo(.05,t,i),cc.callFunc(function(){e.getComponent("BasketBall").isPreparing=!1,r.pickedBall=e,r._game.showFireBall()},this))),this.playingBalls.push(e)}},{key:"getPickedBall",value:function(e){for(var t=this._game.basketContainer.convertToNodeSpaceAR(e),i=0;i<this.playingBalls.length;i++){var a=this.playingBalls[i].getComponent("BasketBall");if(!a.isMoving()&&a.node.getBoundingBox().contains(t))return a}return null}},{key:"callTouchStart",value:function(e){this.pointHistoryList=[],this.pushPoint(e)}},{key:"pushPoint",value:function(e){var t=this._game.basketContainer.convertToNodeSpaceAR(e.getLocation()),i=t.x,a=t.y,s=cc.sys.now(),r=new h.PointHistory;r.f5x=i,r.f6y=a,r.timestamp=s,this.pointHistoryList.push(r)}},{key:"callTouchUp",value:function(e){this.pushPoint(e)}},{key:"shootBallInfo",value:function(){var e=this.pickedBall.getComponent("BasketBall");if(null==e)return null;if(this.pointHistoryList.length<2)return null;var t=this.pointHistoryList[0],i=this.pointHistoryList[1],a=i.timestamp-t.timestamp,s=(i.f5x-t.f5x)/a,r=(i.f6y-t.f6y)/a;console.log("speedx: "+s);var n=this.getBallX(s);if(Math.abs(r)<.04)return null;var o=this.getBallY(r),l=this.getBallZ(r);return[e.getId(),e.getStartPos(),1.5*n,1.2*o,1.3*l,this._lastTime]}},{key:"shootBall",value:function(e,t,i){null!=this.pickedBall&&this.shootPickedBall(e,t,i)}},{key:"getBallX",value:function(e){return 1<e?e=1:e<-1&&(e=-1),5*e}},{key:"getBallY",value:function(e){return Math.min(50,-33-12.8*Math.sqrt(Math.abs(e)))}},{key:"getBallZ",value:function(e){return 6.4*Math.sqrt(Math.abs(e))+12.2}},{key:"shootPickedBall",value:function(e,t,i){var a=this.pickedBall.getComponent("BasketBall");a.prepareShooting(e,t*this._senceParam,i),a.takeSnap(),a.setRollingSpeed(1)}},{key:"onShot",value:function(e){0==e.getCollide()?(e.setScore(3),this._game.commitScore(3*(e.isFireBall?2:1))):(e.setScore(2),this._game.commitScore(2*(e.isFireBall?2:1))),e.setSpeedz(.5*e.getSpeedz()),e.setStat(1)}},{key:"removeBall",value:function(e){for(var t=0;t<this.playingBalls.length;t++){if(this.playingBalls[t].getComponent("BasketBall").getId()==e.getId()){this.playingBalls[t].active=!1,this.playingBalls[t].getComponent("BasketBall").init(e.getId(),this.perspective3d),this.balls.push(this.playingBalls[t]),this.playingBalls.splice(t,1);break}}}},{key:"update",value:function(){for(var e=0;e<this.playingBalls.length;e++){var t=this.playingBalls[e].getComponent("BasketBall");t.update(.5,!1);var i=this._space.getDeepth()-t.getRadius()-2*this.netRadius-12;switch(t.getStat()){case 0:if(!(t.getZ()<=i)){this._basketry.doRebonse(t);break}if(t.getSpeedz()<0){t.setStat(2);break}break;case 1:if(this._net.updateFalling(t,.5)){t.setStat(2);break}break;case 2:if(t.getZ()>i){this._basketry.doRebonse(t);break}}t.getZ()>this._space.getDeepth()?t.setZOrder(0):t.floorFlag?t.setZOrder(2):this.isUpBall(t)?t.setZOrder(3):t.setZOrder(5),t.isMoving()&&this.detectWall(t),t.takeSnap()}}},{key:"detectWall",value:function(e){if(this.ballBoard.isCross(e)){var t=this.basketParent.getChildByName("backcollider").getComponent(cc.PhysicsPolygonCollider).points,i={position:e.node.getPosition(),radius:e.getRadius()};!e.backFlag&&cc.Intersection.polygonCircle(t,i)&&(cc.global.audio.playEffectAud("hall_click_game"),this.ballBoard.onTouch(e)),e.backFlag=!0}if(this.floor.isCross(e)){cc.global.audio.playEffectAud("hall_click_game"),this.floor.onTouch(e),e.isFireBall&&e.hideFire(),e.floorFlag=!0,0==e.getScore()&&this._game.missedBall();var a=this;setTimeout(function(){a.removeBall(e)},500)}}},{key:"getOffsetFromTime",value:function(e){var t=0;if(0<e){var i=Math.floor(e)%4+(e-Math.floor(e));3<i?i-=4:1<i&&(i=2-i),t=-100*i}return t}},{key:"drawing",value:function(e){e?this._lastTime+=.01:this._lastTime=0,this.setMoveByOffset(this.getOffsetFromTime(this._lastTime));for(var t=0;t<this.playingBalls.length;t++){var i=this.playingBalls[t].getComponent("BasketBall");i.isPreparing||i.drawing()}}},{key:"isUpBall",value:function(e){var t=this._space.getDeepth()-2*this.netRadius-12;return e.getZ()>t}}]),o}();cc._RF.pop()},{"../../Constants":"Constants","../../game/model/Space3d":"Space3d","../../game/perspective/Perspective3d":"Perspective3d","../../game/perspective/Vector3d":"Vector3d","../PointHistory":"PointHistory","../model/Basketry":"Basketry","./BackWall":"BackWall","./Floor":"Floor","./FrontWall":"FrontWall"}],Base64ExtPlugin:[function(C,k,s){(function(e){"use strict";cc._RF.push(k,"ad9c7NBeNVLpYFtVC5I2s1f","Base64ExtPlugin");var t,i,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:void 0,i=function(t){var i,a=(t=t||{}).Base64;if(void 0!==k&&k.exports)try{i=C("buffer").Buffer}catch(e){i=void 0}var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=function(e){for(var t={},i=0,a=e.length;i<a;i++)t[e.charAt(i)]=i;return t}(s),n=String.fromCharCode,o=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?n(192|t>>>6)+n(128|63&t):n(224|t>>>12&15)+n(128|t>>>6&63)+n(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return n(240|t>>>18&7)+n(128|t>>>12&63)+n(128|t>>>6&63)+n(128|63&t)},l=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,c=function(e){return e.replace(l,o)},h=function(e){var t=[0,2,1][e.length%3],i=e.charCodeAt(0)<<16|(1<e.length?e.charCodeAt(1):0)<<8|(2<e.length?e.charCodeAt(2):0);return[s.charAt(i>>>18),s.charAt(i>>>12&63),2<=t?"=":s.charAt(i>>>6&63),1<=t?"=":s.charAt(63&i)].join("")},d=t.btoa?function(e){return t.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,h)},u=i?i.from&&Uint8Array&&i.from!==Uint8Array.from?function(e){return(e.constructor===i.constructor?e:i.from(e)).toString("base64")}:function(e){return(e.constructor===i.constructor?e:new i(e)).toString("base64")}:function(e){return d(c(e))},p=function(e,t){return t?u(String(e)).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):u(String(e))},g=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),m=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return n(55296+(t>>>10))+n(56320+(1023&t));case 3:return n((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return n((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},y=function(e){return e.replace(g,m)},f=function(e){var t=e.length,i=t%4,a=(0<t?r[e.charAt(0)]<<18:0)|(1<t?r[e.charAt(1)]<<12:0)|(2<t?r[e.charAt(2)]<<6:0)|(3<t?r[e.charAt(3)]:0),s=[n(a>>>16),n(a>>>8&255),n(255&a)];return s.length-=[0,0,2,1][i],s.join("")},b=t.atob?function(e){return t.atob(e)}:function(e){return e.replace(/\S{1,4}/g,f)},v=i?i.from&&Uint8Array&&i.from!==Uint8Array.from?function(e){return(e.constructor===i.constructor?e:i.from(e,"base64")).toString()}:function(e){return(e.constructor===i.constructor?e:new i(e,"base64")).toString()}:function(e){return y(b(e))},e=function(e){return v(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))};if(t.Base64={VERSION:"2.5.1",atob:function(e){return b(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},btoa:d,fromBase64:e,toBase64:p,utob:c,encode:p,encodeURI:function(e){return p(e,!0)},btou:y,decode:e,noConflict:function(){var e=t.Base64;return t.Base64=a,e},__buffer__:i},"function"==typeof Object.defineProperty){var _=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};t.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",_(function(){return e(this)})),Object.defineProperty(String.prototype,"toBase64",_(function(e){return p(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",_(function(){return p(this,!0)}))}}return t.Meteor&&(Base64=t.Base64),void 0!==k&&k.exports?k.exports.Base64=t.Base64:"function"==typeof define&&define.amd&&define([],function(){return t.Base64}),{Base64:t.Base64}},"object"===(void 0===s?"undefined":a(s))&&void 0!==k?k.exports=i(t):"function"==typeof define&&define.amd?define(i):i(t),cc._RF.pop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{buffer:6}],Base64:[function(e,t,i){"use strict";cc._RF.push(t,"3e0ef6B/q5H0IBGAgl9RoA4","Base64"),cc.Class({extends:cc.Component,properties:{},statics:{decodeExt:function(e,t){var i,a,s,r,n,o,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",h=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<e.length;)i=l.indexOf(e.charAt(h++))<<2|(r=l.indexOf(e.charAt(h++)))>>4,a=(15&r)<<4|(n=l.indexOf(e.charAt(h++)))>>2,s=(3&n)<<6|(o=l.indexOf(e.charAt(h++))),c+=String.fromCharCode(i),64!=n&&(c+=String.fromCharCode(a)),64!=o&&(c+=String.fromCharCode(s));return c},decode:function(e){var t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],i=e.length,a=0;"="==e.charAt(i-1)&&("="==e.charAt(i-2)?(a=4,e=e.substring(0,i-2)):(a=2,e=e.substring(0,i-1)));for(var s=[],r=0,n=e.length;r<n;++r)for(var o=e.charAt(r),l=0,c=t.length;l<c;++l)if(o==t[l]){var h=this._toBinary(l),d=h.length;if(0<6-d)for(var u=6-d;0<u;--u)h.unshift(0);s=s.concat(h);break}0<a&&(s=s.slice(0,s.length-a));var p=[],g=[];for(r=0,n=s.length;r<n;)if(0==s[r])p=p.concat(this._toDecimal(s.slice(r,r+8))),r+=8;else{for(var m=0;r<n&&1==s[r];)++m,++r;for(g=g.concat(s.slice(r+1,r+8-m)),r+=8-m;1<m;)g=g.concat(s.slice(r+2,r+8)),r+=8,--m;p=p.concat(this._toDecimal(g)),g=[]}return p},_toBinary:function(e){for(var t=new Array;0<e;){var i=e%2;e=Math.floor(e/2),t.push(i)}return t.reverse(),t},_toDecimal:function(e){for(var t=0,i=0,a=e.length-1;0<=a;--a)1==e[a]&&(t+=Math.pow(2,i)),++i;return t}}}),cc._RF.pop()},{}],BasketBall:[function(e,t,i){"use strict";cc._RF.push(t,"a7515GfsPNLbYM1T/rHPnKr","BasketBall");var a=e("../../Constants"),s=a.textureScale,r=(a.DT_LIMIT,e("../../game/model/IntCounter").IntCounter);cc.Class({extends:cc.Component,properties:{basketAtlas:{default:null,type:cc.SpriteAtlas},fire:{default:null,type:cc.ParticleSystem}},onLoad:function(){this._tindex=new r(0,7,0),this._ballIndex=0,this.f11_z=0,this._ballstat=1,this._scalex=1,this._scaley=1,this.f9_x=0,this.f10_y=0,this.offsetx=0,this.offsety=0,this.width=114,this.height=114,this.basketSprite=this.getComponent(cc.Sprite),this.score=0,this.fadeFlag=!1,this.initPos=-300},init:function(e,t){this.setAcc(4.5*this.parentLayer._senceParam),this.setStartPos(this.initPos),this.setPosition(this.initPos,this.parentLayer._height-57,20),this.aline(-.5,-.5),this.takeSnap(),this.setSkinIndex(0),this.setThrowed(!1),this.setId(e),this.setZOrder(5),this.setStop(!0),this.setStat(3),this.setScore(0),this.setSpeed(0,0,0),this.lastspeedx=0,this.lastspeedy=0,this.lastspeedz=0,this.lastx=null,this.lasty=null,this.lastz=null,this.collide=0,this.stopAll(),this.node.active=!1,this.pesp=t,this.backFlag=!1,this.floorFlag=!1,this.isPreparing=!0,this.hideFire()},setId:function(e){this.index=e},getId:function(){return this.index},setAcc:function(e){this._acc=e},setParentLayer:function(e){this.parentLayer=e},showFire:function(){this.isFireBall=!0,this.fire.resetSystem()},hideFire:function(){this.isFireBall=!1,this.fire.resetSystem(),this.fire.stopSystem()},touchDownFunc:function(){},touchMoveFunc:function(e){var t=this.getComponent("BasketBall");t.f9_x=e.touch.getLocation().x,t.f10_y=e.touch.getLocation().y,t.moveBallPicked()},touchUpFunc:function(){this.getComponent("BasketBall").parentLayer.shootBall()},moveBallPicked:function(){this.parentLayer.moveBallPicked(this.f9_x,this.f10_y)},getCenter:function(e){e.set(this.f9_x,this.f10_y,this.f11_z)},aline:function(e,t){this.offsetx=this.width*e,this.offsety=this.height*t},getX:function(){return this.f9_x},setX:function(e){this.f9_x=e},getY:function(){return this.f10_y},setY:function(e){this.f10_y=e},getZ:function(){return this.f11_z},setZ:function(e){this.f11_z=e},getStat:function(){return this._ballstat},setStat:function(e){this._ballstat=e},prepareShooting:function(e,t,i){this.setSpeed(e,t,i),this.startAll(),this.collide=0,this._ballstat=3,this.stop=!1,this._inbasketryArea=!1,this._ballstat=0},setRollingSpeed:function(e){this._tindex.setSpeed(e)},stopRolling:function(){this._tindex.setSpeed(0)},update:function(e,t){0!=this._speedMask&&(3!=this._ballstat?(this.updateRotate(e),this.updateMoving(e)):t||this.updateWaiting(e))},updateWaiting:function(e){if(0<(1&this._speedMask)&&(this.f9_x+=this._speedx*e),0<(2&this._speedMask)){var t=this._speedy+this._acc*e,i=(this._speedy+t)*e*.5;this._speedy=t,this.f10_y+=i}},updateMoving:function(e){if(0<(1&this._speedMask)&&(this.f9_x+=this._speedx*e),0<(4&this._speedMask)&&(this.f11_z+=this._speedz*e),0<(2&this._speedMask)){var t=this._speedy+this._acc*e,i=(this._speedy+t)*e*.5;this._speedy=t,this.f10_y+=i}},takeSnap:function(){this.lastspeedx=this._speedx,this.lastspeedy=this._speedy,this.lastspeedz=this._speedz,this.lastx=this.f9_x,this.lasty=this.f10_y,this.lastz=this.f11_z},getWorldYPos:function(){return this.pesp.mapY(this.f10_y,this.f11_z)},drawing:function(e){this.basketSprite.spriteFrame=this.basketAtlas.getSpriteFrame("basketball_"+(this._tindex.getValue()+1)),this.node.x=this.pesp.mapX(this.f9_x,this.f11_z)*s,this.node.y=this.pesp.mapY(this.f10_y,this.f11_z)*s,this.showScaled()},showScaled:function(){var e=this.pesp.mapScale(this.f11_z);this.node.scaleX=e,this.node.scaleY=-e},getRadius:function(){var e=this.pesp.mapScale(this.f11_z);return this.node.width*e/2},getRealPos:function(e,t,i){return[t-(1-e)*(t-360),i-(1-e)*(i-200)]},updateRotate:function(e){this._tindex.update(e)},stopAll:function(){this._speedMask=0},startAll:function(){this._speedMask=7},stopX:function(){this._speedMask&=-2,this._speedx=0},stopY:function(){this._speedMask&=-3,this._speedy=0},stopZ:function(){this._speedMask&=-5,this._speedz=0},setPosition:function(e){3==arguments.length?(this.f9_x=e,this.f10_y=arguments[1],this.f11_z=arguments[2]):(this.f9_x=e.f12x,this.f10_y=e.f13y,this.f11_z=e.f14z)},setStartPos:function(e){this._startPos=e},getStartPos:function(){return this._startPos},setSpeed:function(e){3==arguments.length?(this._speedx=e,this._speedy=arguments[1],this._speedz=arguments[2]):(this._speedx=e.f12x,this._speedy=e.f13y,this._speedz=e.f14z)},collided:function(){this.collide++},getCollide:function(){return this.collide},isStop:function(){return this.stop},setStop:function(e){this.stop=e},getSpeedz:function(){return this._speedz},setSpeedz:function(e){this._speedz=e},getSpeedy:function(){return this._speedy},setSpeedy:function(e){this._speedy=e},getSpeedx:function(){return this._speedx},setSpeedx:function(e){this._speedx=e},isWaiting:function(){return 3==this._ballstat},getLastspeedy:function(){return this.lastspeedy},getLasty:function(){return this.lasty},clearNorm:function(){this._tempNorm=-1},getNorm:function(){return this._tempNorm},setNorm:function(e){this._tempNorm=e},setSkinIndex:function(e){this._tindex.setValue(e)},isInBasketryArea:function(){return this._inbasketryArea},setInBasketryArea:function(e){this._inbasketryArea=e},getSpeed:function(e){e.set(this._speedx,this._speedy,this._speedz)},isMoving:function(){return 0<this._speedMask},setZOrder:function(e){this.zIndex=e,this.node.setLocalZOrder(e)},fadeIn:function(){this.node.runAction(cc.fadeTo(.1,1))},fadeOut:function(){this.node.runAction(cc.fadeTo(.1,0))},setThrowed:function(e){this.throwed=e},isThrowed:function(){return this.throwed},setScore:function(e){this.score=e},getScore:function(){return this.score}}),cc._RF.pop()},{"../../Constants":"Constants","../../game/model/IntCounter":"IntCounter"}],BasketBegin:[function(e,t,i){"use strict";cc._RF.push(t,"b35f9KnBo9DeohCfpCkZvnL","BasketBegin");var a=e("HHCommon"),s=e("./Constants"),r=s.realWidth,n=s.realHeight,o=s.DT_LIMIT,l=e("./basketball/view/BallLayer").BallLayer;cc.Class({extends:a,properties:{basketContainer:{default:null,type:cc.Node},basketryShape:{default:null,type:cc.Node},net:{default:null,type:cc.Node},basket_ball:{default:null,type:cc.Prefab},basket_player:{default:null,type:cc.Prefab},playerListBoard:{default:null,type:cc.Node},statusBoard:{default:null,type:cc.Node},finishBoard:{default:null,type:cc.Node},time:{default:null,type:cc.Label},myBoard:{default:null,type:cc.Node},effectBoard:{default:null,type:cc.Node},btnSfx:{default:null,type:cc.Node},playersInfo:{default:null,type:cc.Node},streakPrefab:{default:null,type:cc.Prefab},warning:{default:null,type:cc.Node},roomdata:{default:null,type:cc.Node},itemgroup:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},betup:{default:null,type:cc.Node},mscore:{default:null,type:cc.Label},combo:{default:null,type:cc.Node},pandata:{default:null,type:cc.Label},playingstate:{default:null,type:cc.Node},readyBtn:{default:null,type:cc.Node}},onLoad:function(){cc.global.user.roomInType="NormalJoin",!cc.global.isOffline&&this.initEventCallback(),cc.game.setFrameRate(60),this.playerlist=new Array,this.inited=!1,this.isGamePlaying=!1,this.isNewRoom=!0,this.isReady=!1,this.myStatus=0,this.offlineTime=60,this.showPlayerCount=5,cc.global.extparams.roomid?this.roomId=cc.global.extparams.roomid:this.roomId=cc.global.user.roomid,null!=cc.global&&this.initgame(),this.setEtcKeyBoardEvent();var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==e&&(e=!0),e?(this.btnSfx.children[0].active=!0,this.btnSfx.children[1].active=!1):(this.btnSfx.children[0].active=!1,this.btnSfx.children[1].active=!0),cc.global.audio.playBGM("bgm_basket"),this.startGame(),cc.global.isOffline&&this.begin_offline()},update:function(e){if(cc.global.isOffline)if(0<=this.offlineTime)this.offlineTime<=30&&this.startMoving(),this.time.string=Math.floor(this.offlineTime),this.offlineTime-=e;else if(this.isGamePlaying){var t=this;t.stopMoving(),t.finish_event(null,t),setTimeout(function(){t.begin_offline()},2e3)}this.dtcounter+=e,this.dtcounter>=o&&(this._ballLayer.drawing(this.isMoving),this._ballLayer.update(),this.dtcounter=0)},stopMoving:function(){this.isMoving=!1},startMoving:function(){this.isMoving=!0},initgame:function(){var t=this;if(!cc.global.isOffline){var e=this.socket();this.map("userready",this.userready_event),this.map("begin",this.begin_event),this.map("tick",this.tick_event),this.map("finish",this.finish_event),this.map("rtleave",this.leave_event),this.map("rtitem",this.item_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)});var i={};i.extparams={roomid:this.roomId},e.exec("rtjoin",i)}this.inited=!0,this.dtcounter=0},setEtcKeyBoardEvent:function(){var i=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e,t){switch(e){case cc.KEY.space:i.processReadyState()}}},i.node)},userready_event:function(){cc.global.audio.playEffectAud("ready"),this.setReadyState()},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(cc.global.user.goldcoins)),this.goldcoins.node.runAction(cc.sequence(cc.scaleTo(0,1),cc.scaleTo(.2,1.5),cc.scaleTo(.1,1))))},begin_event:function(e,t){if(cc.global.isOffline||parseInt(t.roomId)==parseInt(e.room_id)){t.isGamePlaying=!0,t.statusBoard.active=!1,t.playersInfo.active=!cc.global.isOffline,t.effectBoard.active=!0,t.players=e.extdata.players,t.playersInfo.getChildByName("total").getComponent(cc.Label).string="Login: "+e.extdata.total,t.statusBoard.getChildByName("total").getComponent(cc.Label).string="Login: "+e.extdata.total,t.itemPrice=parseInt(e.extdata.itemprice),t.showPrice(t.itemPrice),e.extdata.mscore&&(t.myScore=e.extdata.mscore),t.mscore.string=t.myScore+"",t.toggleItemBtn(0,!0),t.toggleItemBtn(1,!0),t.itemusedPrice=0,e.extdata.itemuse&&(-1!=e.extdata.itemuse.indexOf("0")&&t.toggleItemBtn(0,!1),-1!=e.extdata.itemuse.indexOf("1")&&t.toggleItemBtn(1,!1)),t._ballLayer.createNewBasketBall(),t.panScore=parseInt(e.extdata.roomscore),1==e.extdata.mstatus?t.check_betup(t,t.panScore,t.panScore):(t.toggleItemBtn(0,!1),t.toggleItemBtn(1,!1),t.playingstate.active=!cc.global.isOffline);var i=parseInt(e.extdata.player_count),a=t.panScore*i;t.pandata.string=t.numformat(a)}},check_betup:function(e,t,i){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(cc.global.user.goldcoins-t))),e.multiBetUp(i)},multiBetUp:function(e){this.betup.getComponent("TetrisBetUp").init(e,0)},showPrice:function(e){this.itemgroup.children[0].children[0].children[1].getComponent(cc.Label).string=this.numformat(e),this.itemgroup.children[1].children[0].children[1].getComponent(cc.Label).string=this.numformat(e)},item_event:function(e,t){"0"==e.msg?(t.itemusedPrice+=t.itemPrice,t.check_betup(t,t.panScore+t.itemusedPrice,t.itemPrice),t.fireBallCount=5,t.showFireBall()):"1"==e.msg&&(t.itemusedPrice+=t.itemPrice,t.check_betup(t,t.panScore+t.itemusedPrice,t.itemPrice),t.gotoFireMode())},showFireBall:function(){0<this.fireBallCount&&this._ballLayer.pickedBall&&3==this._ballLayer.pickedBall.getComponent("BasketBall").getStat()&&(this._ballLayer.pickedBall.getComponent("BasketBall").showFire(),this.fireBallCount--)},tick_event:function(e,t){(cc.global.isOffline||parseInt(t.roomId)==parseInt(e.room_id))&&e.extdata&&(t.statusBoard.getChildByName("total").getComponent(cc.Label).string="Login: "+e.extdata.total,t.playersInfo.getChildByName("total").getComponent(cc.Label).string="Login: "+e.extdata.total,t.statusBoard.getChildByName("player").getComponent(cc.Label).string="Playing: "+e.extdata.player_count,t.playersInfo.getChildByName("player").getComponent(cc.Label).string="Playing: "+e.extdata.player_count,t.myStatus=e.extdata.mstatus,t.playingstate.active=1==e.extdata.status&&0==e.extdata.mstatus,0==e.extdata.status?(0==e.extdata.mstatus?(t.setUnReadyState(),e.extdata.time<3&&(t.readyBtn.active=!1),0==e.extdata.time?t.statusBoard.getChildByName("pretime").getComponent(cc.Label).string="Game is playing.":t.statusBoard.getChildByName("pretime").getComponent(cc.Label).string=e.extdata.time+"s after start game."):t.setReadyState(e.extdata.time),t.isGamePlaying=!1,t.pandata.string="0",t.statusBoard.active=!0,t.playersInfo.active=!1,t.effectBoard.active=!1,t.stopMoving()):1==e.extdata.status&&(t.isGamePlaying=!0,t.statusBoard.active=!1,t.playersInfo.active=!0,t.effectBoard.active=!0,t.time.string=t.getTimeString(parseInt(e.extdata.time)),e.extdata.time<=30&&t.startMoving(),e.extdata.scores&&t.showRankScores(e),e.extdata.mscore&&(t.scoreNum=e.extdata.mscore),t.showScore()))},finish_event:function(e,t){if(cc.global.isOffline||parseInt(t.roomId)==parseInt(e.room_id)){t.goldcoins.string=t.numformat(parseInt(cc.global.user.goldcoins)),t.showScore(),t.initVariables();for(var i=0;i<=t.showPlayerCount;i++)t.getPlayer(i+1).node.active=!1;if(t._ballLayer.finishBalls(),!cc.global.isOffline){if(!e.extdata.mstatus)return;t.showFinishResult(e)}}},initVariables:function(){this.isGamePlaying=!1,this.comboCount=0,this.passCount=0,this.itemPrice=0,this.fastmode=!1,this.effectBoard.getChildByName("counter").getChildByName("countermask").height=0,this.myScore=0,this.scoreNum=0,this.fireBallCount=0,this.combo.opacity=0,this.combo.children[0].setScale(0,0),this.combo.children[1].setScale(0,0)},showFinishResult:function(e){var t=this;this.finishBoard.active=!0;for(var i=e.extdata.result,a=0,s=0,r=0;r<i.length;r++)i[r].user_id==cc.global.user.id&&(a=parseInt(i[r].gchange),s=i[r].rank);s<4&&0<s?cc.global.audio.playSummaryAud("win"):cc.global.audio.playSummaryAud("lose"),e.extdata.mrank&&0<parseInt(e.extdata.mrank)?this.finishBoard.getChildByName("mrank").getComponent(cc.Label).string=" "+parseInt(e.extdata.mrank)+"th":this.finishBoard.getChildByName("mrank").getComponent(cc.Label).string="You are a watcher",this.finishBoard.getChildByName("reward").children[1].getComponent(cc.Label).string=0<a?"+"+this.numformat(a):"0",this.scheduleOnce(function(){t.finishBoard.active=!1},3)},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},startGame:function(){this.closeConfirm(),this.touchFlag=!1,this.initScreenSizePortrait(),this._titleHeight=0,this.initVariables(),this.shapeScript=this.basketryShape.getComponent("BasketryShape"),this.netScript=this.net.getComponent("Net"),this._ballLayer=new l(this,this.basketContainer,this.basket_ball,this.shapeScript,this.netScript,this.screenWidth,this.screenHeight-this._titleHeight,!1),this.initGameState(),this.effectBoard.on(cc.Node.EventType.TOUCH_START,this.touchDownFunc,this),this.effectBoard.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveFunc,this),this.effectBoard.on(cc.Node.EventType.TOUCH_END,this.touchUpFunc,this),this.effectBoard.on(cc.Node.EventType.TOUCH_CANCEL,this.touchUpFunc,this);for(var e=0;e<=this.showPlayerCount;e++){var t=cc.instantiate(this.basket_player);t.parent=this.playerListBoard,t.getComponent("BasketPlayer").setIndex(e+1),this.playerlist.push(t)}this.panScore=parseInt(cc.global.curPlaywayScore),this.roomdata.children[0].getComponent(cc.Label).string=this.roomId+"",this.roomdata.children[1].getComponent(cc.Label).string="("+this.numformat(this.panScore)+"pt)",this.showMyInfos()},showMyInfos:function(){this.loadAvatar(cc.global.user.avatarurl,cc.global.user.gender,this.myBoard.getChildByName("avatar").children[0].children[0].getComponent(cc.Sprite)),this.myBoard.getChildByName("name").getComponent(cc.Label).string=cc.global.user.nickname,this.goldcoins.string=this.numformat(parseInt(cc.global.user.goldcoins))},touchDownFunc:function(e){if(this.isGamePlaying){this.touchFlag=!0;var t=this.effectBoard.convertToNodeSpaceAR(e.getLocation());this.streak=cc.instantiate(this.streakPrefab),this.streak.parent=this.effectBoard,this.streak.setPosition(t),this._ballLayer.callTouchStart(e)}},touchMoveFunc:function(e){if(this.isGamePlaying){e.stopPropagation();var t=this.effectBoard.convertToNodeSpaceAR(e.getLocation());this.streak.setPosition(t)}},touchUpFunc:function(e){if(this.isGamePlaying&&(this._ballLayer.callTouchUp(e),this.streak.destroy(),this.touchFlag=!1,null!=this._ballLayer.pickedBall)){var t=this._ballLayer.shootBallInfo();null!=t&&3==this._ballLayer.pickedBall.getComponent("BasketBall").getStat()&&this.shootBall(t)}},showRankScores:function(e){for(var t=e.extdata.scores,i=t.length;i<this.playerlist.length;i++)this.playerlist[i].active=!1;for(var a=!1,s=0;s<t.length&&!(s>this.showPlayerCount);s++)this.getPlayer(s+1).init(t[s][3]+".",this.players[t[s][0]],t[s][1],-1,null,0),cc.global.user.id==t[s][0]?(this.getPlayer(s+1).setMine(!0),a=!0,1==e.extdata.mrank&&0!=s&&(this.getPlayer(1).init("1.",this.players[cc.global.user.id],t[0][1],-1,null,0),this.getPlayer(s+1).init("1.",this.players[t[0][0]],t[0][1],-1,null,0),this.getPlayer(1).setMine(!0),this.getPlayer(s+1).setMine(!1))):this.getPlayer(s+1).setMine(!1);0==a&&this.isReady&&(this.getPlayer(this.showPlayerCount).setMine(!0),this.getPlayer(this.showPlayerCount).init(e.extdata.mrank+".",this.players[cc.global.user.id],e.extdata.mscore,-1,null,0))},shootBall:function(e){cc.global.audio.playEffectAud("hall_click_game"),this._ballLayer.shootBall(e[2],e[3],e[4]);var t=this;this.scheduleOnce(function(){t.isGamePlaying&&t._ballLayer.createNewBasketBall()},this.fastmode?.1:.5)},missedBall:function(){this.comboCount=0,this.combo.opacity=0,this.combo.children[0].setScale(0,0),this.combo.children[1].setScale(0,0)},commitScore:function(e){if(this.comboCount++,5<=this.comboCount&&(this.fireBallCount=1,4!=e&&6!=e&&(e*=2),this.showFireBall()),this.myScore+=e,this.showEffect(),this.mscore.string=this.myScore+"",this.mscore.node.stopAllActions(),this.mscore.node.runAction(cc.sequence(cc.scaleTo(0,1),cc.scaleTo(.1,1.5),cc.scaleTo(.05,1))),1==this.myStatus&&(this.socket().exec("rtscored",{extparams:{score:e,roomid:this.roomId}}),cc.global.audio.playEffectAud("onet/match")),2<=this.comboCount&&(this.combo.opacity=255,this.combo.children[0].getComponent(cc.Label).string=this.comboCount+"",this.combo.children[0].runAction(cc.sequence(cc.scaleTo(0,0),cc.scaleTo(.1,2.5,2),cc.scaleTo(.05,2,1.5))),this.combo.children[1].runAction(cc.sequence(cc.scaleTo(0,1),cc.scaleTo(.1,1.2),cc.scaleTo(.1,1)))),this.passCount++,!this.fastmode)if(12==this.passCount)this.gotoFireMode();else{var t=this;this.schedule(function(){t.effectBoard.getChildByName("counter").getChildByName("countermask").height+=3},.01,11)}this.showScore()},showEffect:function(){this.basketContainer.getChildByName("effect").getComponent(cc.Animation).play()},gotoFireMode:function(){this.fastmode=!0,this.basketContainer.getChildByName("black").active=!0,this.effectBoard.getChildByName("counter").getComponent(cc.Animation).play();var e=this;this.scheduleOnce(function(){e.passCount=0,e.fastmode=!1,e.basketContainer.getChildByName("black").active=!1},5)},showScore:function(){1==this.myStatus&&15<Math.abs(this.myScore-this.scoreNum)&&(this.myScore=this.scoreNum,this.mscore.string=this.myScore+"")},cleanAllPlayers:function(){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].destroy();this.playerlist.splice(0,this.playerlist.length),this.playerlist=new Array},processReadyState:function(){cc.global.isOffline?this.userready_event():this.isGamePlaying||this.isReady||this.socket().exec("rtready",{extparams:{roomid:this.roomId}})},showWarning:function(){this.warning.opacity=220,this.warning.runAction(cc.sequence(cc.delayTime(1),cc.fadeOut(1)))},toggleItemBtn:function(e,t){var i=!!cc.global.isOffline||t,a=this.itemgroup.children[e];a.opacity=i?255:100,a.getComponent(cc.Button).interactable=i},onClickSpecTime:function(){if(cc.global.isOffline){this.item_event({command:"item",event:"command",msg:"1"},this)}else parseInt(cc.global.user.goldcoins)<this.itemPrice+this.panScore?this.showWarning():(this.toggleItemBtn(1,!1),this.socket().exec("rtitem",{extparams:{type:1,roomid:this.roomId}}))},onClickSpecPower:function(){if(cc.global.isOffline){this.item_event({command:"item",event:"command",msg:"0"},this)}else parseInt(cc.global.user.goldcoins)<this.itemPrice+this.panScore?this.showWarning():(this.toggleItemBtn(0,!1),this.socket().exec("rtitem",{extparams:{type:0,roomid:this.roomId}}))},setReadyState:function(e){cc.global.isOffline&&(e=3),this.isReady=!0,this.statusBoard.getChildByName("time").active=!0,this.statusBoard.getChildByName("time").getComponent(cc.Label).string=e,this.statusBoard.getChildByName("pretime").active=!1,this.readyBtn.active=!1},setUnReadyState:function(){this.isReady=!1,this.statusBoard.getChildByName("time").active=!1,this.statusBoard.getChildByName("pretime").active=!0,this.readyBtn.active=!0},initGameState:function(){this.scoreNum=0,this.showScore(),this._ballLayer.initboard()},getPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("BasketPlayer");if(i.index==e)return i}},onclickBack:function(){var e=this;cc.global.isOffline?this.returnToHall():this.isGamePlaying&&1==this.myStatus?(cc.global.audio.playVoiceSpeech("support/14_roomout"),this.checkConfirm("Are you sure to leave room? You will lose.",function(){e.socket().exec("rtleave",{})},null)):this.socket().exec("rtleave",{})},leave_event:function(e,t){t.returnToHall()},returnToHall:function(){this.loadding(),clearInterval(this.otherEventInvoker),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.curPlaywayScore=0,cc.global.backToHall=!0,this._ballLayer.destroyBalls(),this.scene("hall",this)},onClickGiveUp:function(){if(this.isGamePlaying){var e=this;cc.global.audio.playVoiceSpeech("support/12_give_up");var t=this.getLanguageText("ARE_YOU_GIVE_UP");this.checkConfirm(t,function(){e&&e.socket().exec("suicide",{})},null)}},onClickSfx:function(){if(this.btnSfx){var e=this.btnSfx,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},updateEvent:function(){},initScreenSizePortrait:function(){var e=r,t=n;this.scale=e/480,this.screenWidth=480,this.scaleReciprocal=1/this.scale,this.screenHeight=t*this.scaleReciprocal,this._titleHeight=56},getTimeString:function(e){Math.floor(e/60);return e},begin_offline:function(){var e={command:"begin",event:"command",roomid:0,extdata:{players:[cc.global.user.id],itemprice:0,total:1,mscore:0,roomscore:0,mstatus:0,player_count:1}};this.offlineTime=60,this.myScore=0,this.begin_event(e,this)}}),cc._RF.pop()},{"./Constants":"Constants","./basketball/view/BallLayer":"BallLayer",HHCommon:"HHCommon"}],BasketPlayer:[function(e,t,i){"use strict";cc._RF.push(t,"e6c0fjPB2pKX6kFuXXG6KgZ","BasketPlayer");var a=e("HHCommon");cc.Class({extends:a,properties:{rank:{default:null,type:cc.Label},nickname:{default:null,type:cc.Label},score:{default:null,type:cc.Label},seperator:{default:null,type:cc.Node},free:{default:null,type:cc.Node},avatar:{default:null,type:cc.Sprite}},onLoad:function(){this.node.active=!1},init:function(e,t,i,a,s,r){this.nickname.string=t,this.score.string=i,this.rank.string=e,this.seperator.active=5<this.rankid,this.node.active=!0,-1!=a?(this.free.active=!0,this.free.children[1].getComponent(cc.Label).string="+"+a):this.free.active=!1,null!=s?(this.avatar.node.active=!0,this.loadAvatar(s,r,this.avatar)):this.avatar.node.active=!1},setIndex:function(e){this.index=e},setMine:function(e){var t=e?new cc.Color(255,255,0):new cc.Color(255,255,255);this.rank.node.color=t,this.nickname.node.color=t,this.score.node.color=t}}),cc._RF.pop()},{HHCommon:"HHCommon"}],BasketryShape:[function(e,t,i){"use strict";cc._RF.push(t,"f430cFGKHZIRLMwIVAAlBQ+","BasketryShape");var a=e("../../Constants").textureScale;cc.Class({extends:cc.Component,properties:{},setZOrder:function(e){this.node.setLocalZOrder(e)},setVariables:function(e,t){this._basketry=e,this._slotz=t},getDepth:function(){return this._basketry.getZ()+this.deepthOffset},setDepOffset:function(e){this.deepthOffset=e},setOffset:function(e,t){this.offsetx=e,this.offsety=t},drawing:function(e){this.f9_x=e.mapX(this._basketry.getX(),this._slotz),this.f10_y=e.mapY(this._basketry.getY(),this._slotz),this.node.x=this.f9_x*a,this.node.y=this.f10_y*a}}),cc._RF.pop()},{"../../Constants":"Constants"}],Basketry:[function(e,t,i){"use strict";cc._RF.push(t,"b0ac9VFCpRDf4rQ0YbxdheP","Basketry"),Object.defineProperty(i,"__esModule",{value:!0}),i.Basketry=void 0;var a=function(){function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}}(),s=e("../../game/perspective/Vector3d");i.Basketry=function(){function i(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,i),this._radiusD=e,this._balllayer=t,this._ballProj=new s.Vector3d,this._acc=new s.Vector3d,this._basketryCenter=new s.Vector3d,this._ballCenter=new s.Vector3d,this._projection=new s.Vector3d,this._ballSpeed=new s.Vector3d,this._gravitySpeed=new s.Vector3d,this._rebounceSpeed=new s.Vector3d,this._focus=new s.Vector3d,this._crossRadius=new s.Vector3d,this._gravityNorm=new s.Vector3d,this._basketryUp=new s.Vector3d(0,-1,0)}return a(i,[{key:"setX",value:function(e){this.f9_x=e}},{key:"getX",value:function(){return this.f9_x}},{key:"getY",value:function(){return this.f10_y}},{key:"getZ",value:function(){return this.f11_z}},{key:"setPosition",value:function(e,t,i){this.f9_x=e,this.f10_y=t,this.f11_z=i}},{key:"getCenter",value:function(e){e.set(this.f9_x,this.f10_y,this.f11_z)}},{key:"checkCross",value:function(e){var t=e.getY(),i=this.f10_y-e.getRadius();if(!(t<i)){if(t>this.f10_y+e.getRadius())return e.setInBasketryArea(!1),!1;var a=e.getX();if(a<this.f9_x-this._radiusD-e.getRadius())return e.setInBasketryArea(!1),!1;if(a>this.f9_x+this._radiusD+e.getRadius())return e.setInBasketryArea(!1),!1;this.getCenter(this._basketryCenter),e.getCenter(this._ballCenter),this._ballProj.set(this._ballCenter),this._ballProj.set(1,this.f10_y),this._projection.sub(this._ballProj,this._basketryCenter);var s=this.getProjectNorm(this._projection);if(s<this._radiusD){if(e.setInBasketryArea(!0),s<this._radiusD-e.getRadius())return!1}else e.setInBasketryArea(!1);this._projection.scale(this._radiusD/s),this._focus.add(this._basketryCenter,this._projection),this._crossRadius.sub(this._ballCenter,this._focus);var r=this._crossRadius.norm();return!(r>e.getRadius())&&(r<4?(this._crossRadius.set(0,-this._radiusD,0),e.setY(i),e.setSpeedy(-e.getSpeedy())):this._crossRadius.scale(e.getRadius()/r),!0)}e.setInBasketryArea(!1)}},{key:"rebound",value:function(e,t,i,a){this._acc.set(t),this._acc.scale(e.dot(t)/i*-2),this._rebounceSpeed.add(e,this._acc),this._rebounceSpeed.scale(a)}},{key:"doRebonse",value:function(e){this.checkCross(e)&&(e.collided(),this._ballCenter.add(this._focus,this._crossRadius),e.getSpeed(this._ballSpeed),e.setPosition(this._ballCenter),this.rebound(this._ballSpeed,this._crossRadius,3249,.550000011920929),this._gravityNorm.cross(this._projection,this._basketryUp),this._gravityNorm.scale(1/this._radiusD),e.isInBasketryArea()?(this._gravitySpeed.cross(this._gravityNorm,this._crossRadius),this._gravitySpeed.scale(.07017543911933899)):this._gravitySpeed.cross(this._crossRadius,this._gravityNorm),this._gravitySpeed.scale(.07017543911933899),this._rebounceSpeed.add(this._gravitySpeed),e.setSpeed(this._rebounceSpeed));var t=this.f10_y;e.isInBasketryArea()&&e.getY()>t&&e.getLasty()<=t&&this._balllayer.onShot(e)}},{key:"getProjectNorm",value:function(e){var t=e.f12x,i=e.f14z;return Math.sqrt(t*t+i*i)}}]),i}();cc._RF.pop()},{"../../game/perspective/Vector3d":"Vector3d"}],BigRecordItem:[function(e,t,i){"use strict";cc._RF.push(t,"cb79dYMkNtN9LvixyHbr+ma","BigRecordItem");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},nickname:{default:null,type:cc.Label},title:{default:null,type:cc.Label},reward:{default:null,type:cc.Node},rewardval:{default:null,type:cc.Label},tip:{default:null,type:cc.Label}},init:function(e,t){switch(t){case 0:this.tip.string="Top Recorder";break;case 1:this.tip.string="Top Medals";break;case 2:this.tip.string="Top Winner"}var i=this.getLanguageText(["NEW_RECORD","MEDAL_COUNT","WIN_COUNT"][t]);this.title.string=i,e&&0!=e.value?(this.loadAvatar(e.avatarurl),this.nickname.string=e.nickname,this.title.string=i+" : "+this.numformat(parseInt(e.value)),this.rewardval.string=0==t?300:this.numformat(e.reward)):(this.nickname.string=this.getLanguageText("NO_DATA_0"),this.title.string=i)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],BitmapFont:[function(e,t,i){"use strict";cc._RF.push(t,"0105aERrc1B66ri2hBqb+sq","BitmapFont");var a=e("HHCommon");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},number:{default:null,type:cc.Node},atlas:{default:null,type:cc.SpriteAtlas}},onLoad:function(){this.init(0)},init:function(e){this.number.children[0].active=!1,this.number.children[1].active=!1,this.number.children[2].active=!1;var t=0;this.base.getComponent(cc.Sprite).spriteFrame=0<=e&&e<6?this.atlas.getSpriteFrame("3d_clock_red_bg"):this.atlas.getSpriteFrame("3d_clock_bg"),0<=e&&(this.number.children[0].active=!0,t=parseInt(e%10),this.number.children[0].getComponent(cc.Sprite).spriteFrame=e<6?this.atlas.getSpriteFrame("clock_red_num_"+t):this.atlas.getSpriteFrame("clock_num_"+t)),10<=e&&(this.number.children[1].active=!0,t=parseInt(e/10)%10,this.number.children[1].getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("clock_num_"+t)),100<=e&&(this.number.children[2].active=!0,t=parseInt(e/100)%10,this.number.children[2].getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("clock_num_"+t))}}),cc._RF.pop()},{HHCommon:"HHCommon"}],BoardCallStatus:[function(e,t,i){"use strict";cc._RF.push(t,"8485brNfH1CiZq70G3QlkuA","BoardCallStatus");var a=e("HHCommon");cc.Class({extends:a,properties:{buynum:{default:null,type:cc.Node},selmc:{default:null,type:cc.Node},selpartner:{default:null,type:cc.Node},callnumatlas:{default:null,type:cc.SpriteAtlas},lose_coins:{default:null,type:cc.Label}},onLoad:function(){},clearAll:function(e){this.callNum=0,this.master_rank=0,this.master_suit=0,this.ptn_rank=0,this.ptn_suit=0,this.fbm=!1,this.loseCoins=0,this.lose_coins.string="0"},init:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.callNum=e.callScore,this.master_rank=e.masterRank,this.master_suit=e.masterSuit,this.ptn_rank=e.findRank,this.ptn_suit=e.findSuit,this.fbm=e.fBM,this.loseCoins=0;this.callNum;this.buynum.getComponent(cc.Label).string=this.callNum,this.updateMaster(),this.updatePtn(),t&&(this.selpartner.active=!1)},updateMaster:function(){this.selmc&&this.selmc.children[1].getComponent("FiveDeclareCard").init(this.master_rank,this.master_suit,!1,!1)},updatePtn:function(){this.selpartner&&this.selpartner.children[1].getComponent("FiveDeclareCard").init(this.ptn_rank,this.ptn_suit,!0,this.fbm)},showLoseCoins:function(){this.lose_coins.node.parent.active=!0,this.lose_coins.node.parent.opacity=255},setLoseCoins:function(e){0<e&&(this.loseCoins+=e,this.lose_coins.string=this.loseCoins,this.lose_coins.node.parent.getComponent(cc.Animation).play(),cc.global.audio.playEffectAud("five/star"))}}),cc._RF.pop()},{HHCommon:"HHCommon"}],1:[function(e,t,i){var l=e("util/"),c=Array.prototype.slice,a=Object.prototype.hasOwnProperty,r=t.exports=s;function h(e,t){return l.isUndefined(t)?""+t:l.isNumber(t)&&!isFinite(t)?t.toString():l.isFunction(t)||l.isRegExp(t)?t.toString():t}function d(e,t){return l.isString(e)?e.length<t?e:e.slice(0,t):e}function u(e,t,i,a,s){throw new r.AssertionError({message:i,actual:e,expected:t,operator:a,stackStartFunction:s})}function s(e,t){e||u(e,!0,t,"==",r.ok)}function p(e,t){if(e===t)return!0;if(l.isBuffer(e)&&l.isBuffer(t)){if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}return l.isDate(e)&&l.isDate(t)?e.getTime()===t.getTime():l.isRegExp(e)&&l.isRegExp(t)?e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase:l.isObject(e)||l.isObject(t)?function(e,t){if(l.isNullOrUndefined(e)||l.isNullOrUndefined(t))return!1;if(e.prototype!==t.prototype)return!1;if(l.isPrimitive(e)||l.isPrimitive(t))return e===t;var i=g(e),a=g(t);if(i&&!a||!i&&a)return!1;if(i)return e=c.call(e),t=c.call(t),p(e,t);var s,r,n=m(e),o=m(t);if(n.length!=o.length)return!1;for(n.sort(),o.sort(),r=n.length-1;0<=r;r--)if(n[r]!=o[r])return!1;for(r=n.length-1;0<=r;r--)if(s=n[r],!p(e[s],t[s]))return!1;return!0}(e,t):e==t}function g(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function n(e,t){return!(!e||!t)&&("[object RegExp]"==Object.prototype.toString.call(t)?t.test(e):e instanceof t||!0===t.call({},e))}function o(e,t,i,a){var s;l.isString(i)&&(a=i,i=null);try{t()}catch(e){s=e}if(a=(i&&i.name?" ("+i.name+").":".")+(a?" "+a:"."),e&&!s&&u(s,i,"Missing expected exception"+a),!e&&n(s,i)&&u(s,i,"Got unwanted exception"+a),e&&s&&i&&!n(s,i)||!e&&s)throw s}r.AssertionError=function(e){var t;this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=(t=this,d(JSON.stringify(t.actual,h),128)+" "+t.operator+" "+d(JSON.stringify(t.expected,h),128)),this.generatedMessage=!0);var i=e.stackStartFunction||u;if(Error.captureStackTrace)Error.captureStackTrace(this,i);else{var a=new Error;if(a.stack){var s=a.stack,r=i.name,n=s.indexOf("\n"+r);if(0<=n){var o=s.indexOf("\n",n+1);s=s.substring(o+1)}this.stack=s}}},l.inherits(r.AssertionError,Error),r.fail=u,r.ok=s,r.equal=function(e,t,i){e!=t&&u(e,t,i,"==",r.equal)},r.notEqual=function(e,t,i){e==t&&u(e,t,i,"!=",r.notEqual)},r.deepEqual=function(e,t,i){p(e,t)||u(e,t,i,"deepEqual",r.deepEqual)},r.notDeepEqual=function(e,t,i){p(e,t)&&u(e,t,i,"notDeepEqual",r.notDeepEqual)},r.strictEqual=function(e,t,i){e!==t&&u(e,t,i,"===",r.strictEqual)},r.notStrictEqual=function(e,t,i){e===t&&u(e,t,i,"!==",r.notStrictEqual)},r.throws=function(e,t,i){o.apply(this,[!0].concat(c.call(arguments)))},r.doesNotThrow=function(e,t){o.apply(this,[!1].concat(c.call(arguments)))},r.ifError=function(e){if(e)throw e};var m=Object.keys||function(e){var t=[];for(var i in e)a.call(e,i)&&t.push(i);return t}},{"util/":42}],2:[function(e,t,i){"use strict";i.byteLength=function(e){return 3*e.length/4-d(e)},i.toByteArray=function(e){var t,i,a,s,r,n=e.length;s=d(e),r=new h(3*n/4-s),i=0<s?n-4:n;var o=0;for(t=0;t<i;t+=4)a=c[e.charCodeAt(t)]<<18|c[e.charCodeAt(t+1)]<<12|c[e.charCodeAt(t+2)]<<6|c[e.charCodeAt(t+3)],r[o++]=a>>16&255,r[o++]=a>>8&255,r[o++]=255&a;2===s?(a=c[e.charCodeAt(t)]<<2|c[e.charCodeAt(t+1)]>>4,r[o++]=255&a):1===s&&(a=c[e.charCodeAt(t)]<<10|c[e.charCodeAt(t+1)]<<4|c[e.charCodeAt(t+2)]>>2,r[o++]=a>>8&255,r[o++]=255&a);return r},i.fromByteArray=function(e){for(var t,i=e.length,a=i%3,s="",r=[],n=0,o=i-a;n<o;n+=16383)r.push(u(e,n,o<n+16383?o:n+16383));1===a?(t=e[i-1],s+=l[t>>2],s+=l[t<<4&63],s+="=="):2===a&&(t=(e[i-2]<<8)+e[i-1],s+=l[t>>10],s+=l[t>>4&63],s+=l[t<<2&63],s+="=");return r.push(s),r.join("")};for(var l=[],c=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,r=a.length;s<r;++s)l[s]=a[s],c[a.charCodeAt(s)]=s;function d(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function u(e,t,i){for(var a,s,r=[],n=t;n<i;n+=3)a=(e[n]<<16&16711680)+(e[n+1]<<8&65280)+(255&e[n+2]),r.push(l[(s=a)>>18&63]+l[s>>12&63]+l[s>>6&63]+l[63&s]);return r.join("")}c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},{}],3:[function(e,t,i){},{}],4:[function(r,e,p){(function(e,c){var t=r("pako/lib/zlib/messages"),n=r("pako/lib/zlib/zstream"),h=r("pako/lib/zlib/deflate.js"),d=r("pako/lib/zlib/inflate.js"),i=r("pako/lib/zlib/constants");for(var a in i)p[a]=i[a];function s(e){if(e<p.DEFLATE||e>p.UNZIP)throw new TypeError("Bad argument");this.mode=e,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}function u(e,t){for(var i=0;i<e.length;i++)this[t+i]=e[i]}p.NONE=0,p.DEFLATE=1,p.INFLATE=2,p.GZIP=3,p.GUNZIP=4,p.DEFLATERAW=5,p.INFLATERAW=6,p.UNZIP=7,s.prototype.init=function(e,t,i,a,s){switch(this.windowBits=e,this.level=t,this.memLevel=i,this.strategy=a,this.mode!==p.GZIP&&this.mode!==p.GUNZIP||(this.windowBits+=16),this.mode===p.UNZIP&&(this.windowBits+=32),this.mode!==p.DEFLATERAW&&this.mode!==p.INFLATERAW||(this.windowBits=-this.windowBits),this.strm=new n,this.mode){case p.DEFLATE:case p.GZIP:case p.DEFLATERAW:var r=h.deflateInit2(this.strm,this.level,p.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case p.INFLATE:case p.GUNZIP:case p.INFLATERAW:case p.UNZIP:r=d.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}r===p.Z_OK?(this.write_in_progress=!1,this.init_done=!0):this._error(r)},s.prototype.params=function(){throw new Error("deflateParams Not supported")},s.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(this.mode===p.NONE)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")},s.prototype.write=function(t,i,a,s,r,n,o){this._writeCheck(),this.write_in_progress=!0;var l=this;return e.nextTick(function(){l.write_in_progress=!1;var e=l._write(t,i,a,s,r,n,o);l.callback(e[0],e[1]),l.pending_close&&l.close()}),this},s.prototype.writeSync=function(e,t,i,a,s,r,n){return this._writeCheck(),this._write(e,t,i,a,s,r,n)},s.prototype._write=function(e,t,i,a,s,r,n){if(this.write_in_progress=!0,e!==p.Z_NO_FLUSH&&e!==p.Z_PARTIAL_FLUSH&&e!==p.Z_SYNC_FLUSH&&e!==p.Z_FULL_FLUSH&&e!==p.Z_FINISH&&e!==p.Z_BLOCK)throw new Error("Invalid flush value");null==t&&(t=new c(0),i=a=0),s._set?s.set=s._set:s.set=u;var o=this.strm;switch(o.avail_in=a,o.input=t,o.next_in=i,o.avail_out=n,o.output=s,o.next_out=r,this.mode){case p.DEFLATE:case p.GZIP:case p.DEFLATERAW:var l=h.deflate(o,e);break;case p.UNZIP:case p.INFLATE:case p.GUNZIP:case p.INFLATERAW:l=d.inflate(o,e);break;default:throw new Error("Unknown mode "+this.mode)}return l!==p.Z_STREAM_END&&l!==p.Z_OK&&this._error(l),this.write_in_progress=!1,[o.avail_in,o.avail_out]},s.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,this.mode===p.DEFLATE||this.mode===p.GZIP||this.mode===p.DEFLATERAW?h.deflateEnd(this.strm):d.inflateEnd(this.strm),this.mode=p.NONE)},s.prototype.reset=function(){switch(this.mode){case p.DEFLATE:case p.DEFLATERAW:var e=h.deflateReset(this.strm);break;case p.INFLATE:case p.INFLATERAW:e=d.inflateReset(this.strm)}e!==p.Z_OK&&this._error(e)},s.prototype._error=function(e){this.onerror(t[e]+": "+this.strm.msg,e),this.write_in_progress=!1,this.pending_close&&this.close()},p.Zlib=s}).call(this,r("_process"),r("buffer").Buffer)},{_process:25,buffer:6,"pako/lib/zlib/constants":15,"pako/lib/zlib/deflate.js":17,"pako/lib/zlib/inflate.js":19,"pako/lib/zlib/messages":21,"pako/lib/zlib/zstream":23}],5:[function(g,e,m){(function(s,y){var r=g("_stream_transform"),n=g("./binding"),e=g("util"),f=g("assert").ok;function a(t,e,i){var a=[],s=0;function r(){for(var e;null!==(e=t.read());)a.push(e),s+=e.length;t.once("readable",r)}function n(){var e=y.concat(a,s);a=[],i(null,e),t.close()}t.on("error",function(e){t.removeListener("end",n),t.removeListener("readable",r),i(e)}),t.on("end",n),t.end(e),r()}function i(e,t){if("string"==typeof t&&(t=new y(t)),!y.isBuffer(t))throw new TypeError("Not a string or buffer");var i=n.Z_FINISH;return e._processChunk(t,i)}function o(e){if(!(this instanceof o))return new o(e);t.call(this,e,n.DEFLATE)}function l(e){if(!(this instanceof l))return new l(e);t.call(this,e,n.INFLATE)}function c(e){if(!(this instanceof c))return new c(e);t.call(this,e,n.GZIP)}function h(e){if(!(this instanceof h))return new h(e);t.call(this,e,n.GUNZIP)}function d(e){if(!(this instanceof d))return new d(e);t.call(this,e,n.DEFLATERAW)}function u(e){if(!(this instanceof u))return new u(e);t.call(this,e,n.INFLATERAW)}function p(e){if(!(this instanceof p))return new p(e);t.call(this,e,n.UNZIP)}function t(e,t){if(this._opts=e=e||{},this._chunkSize=e.chunkSize||m.Z_DEFAULT_CHUNK,r.call(this,e),e.flush&&e.flush!==n.Z_NO_FLUSH&&e.flush!==n.Z_PARTIAL_FLUSH&&e.flush!==n.Z_SYNC_FLUSH&&e.flush!==n.Z_FULL_FLUSH&&e.flush!==n.Z_FINISH&&e.flush!==n.Z_BLOCK)throw new Error("Invalid flush flag: "+e.flush);if(this._flushFlag=e.flush||n.Z_NO_FLUSH,e.chunkSize&&(e.chunkSize<m.Z_MIN_CHUNK||e.chunkSize>m.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<m.Z_MIN_WINDOWBITS||e.windowBits>m.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<m.Z_MIN_LEVEL||e.level>m.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<m.Z_MIN_MEMLEVEL||e.memLevel>m.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=m.Z_FILTERED&&e.strategy!=m.Z_HUFFMAN_ONLY&&e.strategy!=m.Z_RLE&&e.strategy!=m.Z_FIXED&&e.strategy!=m.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!y.isBuffer(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new n.Zlib(t);var a=this;this._hadError=!1,this._binding.onerror=function(e,t){a._binding=null,a._hadError=!0;var i=new Error(e);i.errno=t,i.code=m.codes[t],a.emit("error",i)};var i=m.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(i=e.level);var s=m.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(s=e.strategy),this._binding.init(e.windowBits||m.Z_DEFAULT_WINDOWBITS,i,e.memLevel||m.Z_DEFAULT_MEMLEVEL,s,e.dictionary),this._buffer=new y(this._chunkSize),this._offset=0,this._closed=!1,this._level=i,this._strategy=s,this.once("end",this.close)}n.Z_MIN_WINDOWBITS=8,n.Z_MAX_WINDOWBITS=15,n.Z_DEFAULT_WINDOWBITS=15,n.Z_MIN_CHUNK=64,n.Z_MAX_CHUNK=1/0,n.Z_DEFAULT_CHUNK=16384,n.Z_MIN_MEMLEVEL=1,n.Z_MAX_MEMLEVEL=9,n.Z_DEFAULT_MEMLEVEL=8,n.Z_MIN_LEVEL=-1,n.Z_MAX_LEVEL=9,n.Z_DEFAULT_LEVEL=n.Z_DEFAULT_COMPRESSION,Object.keys(n).forEach(function(e){e.match(/^Z/)&&(m[e]=n[e])}),m.codes={Z_OK:n.Z_OK,Z_STREAM_END:n.Z_STREAM_END,Z_NEED_DICT:n.Z_NEED_DICT,Z_ERRNO:n.Z_ERRNO,Z_STREAM_ERROR:n.Z_STREAM_ERROR,Z_DATA_ERROR:n.Z_DATA_ERROR,Z_MEM_ERROR:n.Z_MEM_ERROR,Z_BUF_ERROR:n.Z_BUF_ERROR,Z_VERSION_ERROR:n.Z_VERSION_ERROR},Object.keys(m.codes).forEach(function(e){m.codes[m.codes[e]]=e}),m.Deflate=o,m.Inflate=l,m.Gzip=c,m.Gunzip=h,m.DeflateRaw=d,m.InflateRaw=u,m.Unzip=p,m.createDeflate=function(e){return new o(e)},m.createInflate=function(e){return new l(e)},m.createDeflateRaw=function(e){return new d(e)},m.createInflateRaw=function(e){return new u(e)},m.createGzip=function(e){return new c(e)},m.createGunzip=function(e){return new h(e)},m.createUnzip=function(e){return new p(e)},m.deflate=function(e,t,i){return"function"==typeof t&&(i=t,t={}),a(new o(t),e,i)},m.deflateSync=function(e,t){return i(new o(t),e)},m.gzip=function(e,t,i){return"function"==typeof t&&(i=t,t={}),a(new c(t),e,i)},m.gzipSync=function(e,t){return i(new c(t),e)},m.deflateRaw=function(e,t,i){return"function"==typeof t&&(i=t,t={}),a(new d(t),e,i)},m.deflateRawSync=function(e,t){return i(new d(t),e)},m.unzip=function(e,t,i){return"function"==typeof t&&(i=t,t={}),a(new p(t),e,i)},m.unzipSync=function(e,t){return i(new p(t),e)},m.inflate=function(e,t,i){return"function"==typeof t&&(i=t,t={}),a(new l(t),e,i)},m.inflateSync=function(e,t){return i(new l(t),e)},m.gunzip=function(e,t,i){return"function"==typeof t&&(i=t,t={}),a(new h(t),e,i)},m.gunzipSync=function(e,t){return i(new h(t),e)},m.inflateRaw=function(e,t,i){return"function"==typeof t&&(i=t,t={}),a(new u(t),e,i)},m.inflateRawSync=function(e,t){return i(new u(t),e)},e.inherits(t,r),t.prototype.params=function(e,t,i){if(e<m.Z_MIN_LEVEL||e>m.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(t!=m.Z_FILTERED&&t!=m.Z_HUFFMAN_ONLY&&t!=m.Z_RLE&&t!=m.Z_FIXED&&t!=m.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+t);if(this._level!==e||this._strategy!==t){var a=this;this.flush(n.Z_SYNC_FLUSH,function(){a._binding.params(e,t),a._hadError||(a._level=e,a._strategy=t,i&&i())})}else s.nextTick(i)},t.prototype.reset=function(){return this._binding.reset()},t.prototype._flush=function(e){this._transform(new y(0),"",e)},t.prototype.flush=function(e,t){var i=this._writableState;if(("function"==typeof e||void 0===e&&!t)&&(t=e,e=n.Z_FULL_FLUSH),i.ended)t&&s.nextTick(t);else if(i.ending)t&&this.once("end",t);else if(i.needDrain){var a=this;this.once("drain",function(){a.flush(t)})}else this._flushFlag=e,this.write(new y(0),"",t)},t.prototype.close=function(e){if(e&&s.nextTick(e),!this._closed){this._closed=!0,this._binding.close();var t=this;s.nextTick(function(){t.emit("close")})}},t.prototype._transform=function(e,t,i){var a,s=this._writableState,r=(s.ending||s.ended)&&(!e||s.length===e.length);if(null===!e&&!y.isBuffer(e))return i(new Error("invalid input"));r?a=n.Z_FINISH:(a=this._flushFlag,e.length>=s.length&&(this._flushFlag=this._opts.flush||n.Z_NO_FLUSH));this._processChunk(e,a,i)},t.prototype._processChunk=function(r,n,o){var l=r&&r.length,c=this._chunkSize-this._offset,h=0,d=this,u="function"==typeof o;if(!u){var t,p=[],g=0;this.on("error",function(e){t=e});do{var e=this._binding.writeSync(n,r,h,l,this._buffer,this._offset,c)}while(!this._hadError&&m(e[0],e[1]));if(this._hadError)throw t;var i=y.concat(p,g);return this.close(),i}var a=this._binding.write(n,r,h,l,this._buffer,this._offset,c);function m(e,t){if(!d._hadError){var i=c-t;if(f(0<=i,"have should not go down"),0<i){var a=d._buffer.slice(d._offset,d._offset+i);d._offset+=i,u?d.push(a):(p.push(a),g+=a.length)}if((0===t||d._offset>=d._chunkSize)&&(c=d._chunkSize,d._offset=0,d._buffer=new y(d._chunkSize)),0===t){if(h+=l-e,l=e,!u)return!0;var s=d._binding.write(n,r,h,l,d._buffer,d._offset,d._chunkSize);return s.callback=m,void(s.buffer=r)}if(!u)return!1;o()}}a.buffer=r,a.callback=m},e.inherits(o,t),e.inherits(l,t),e.inherits(c,t),e.inherits(h,t),e.inherits(d,t),e.inherits(u,t),e.inherits(p,t)}).call(this,g("_process"),g("buffer").Buffer)},{"./binding":4,_process:25,_stream_transform:37,assert:1,buffer:6,util:42}],6:[function(t,e,H){(function(e){"use strict";var a=t("base64-js"),r=t("ieee754"),n=t("isarray");function i(){return d.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(i()<t)throw new RangeError("Invalid typed array length");return d.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=d.prototype:(null===e&&(e=new d(t)),e.length=t),e}function d(e,t,i){if(!(d.TYPED_ARRAY_SUPPORT||this instanceof d))return new d(e,t,i);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return s(this,e,t,i)}function s(e,t,i,a){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,i,a){if(t.byteLength,i<0||t.byteLength<i)throw new RangeError("'offset' is out of bounds");if(t.byteLength<i+(a||0))throw new RangeError("'length' is out of bounds");t=void 0===i&&void 0===a?new Uint8Array(t):void 0===a?new Uint8Array(t,i):new Uint8Array(t,i,a);d.TYPED_ARRAY_SUPPORT?(e=t).__proto__=d.prototype:e=h(e,t);return e}(e,t,i,a):"string"==typeof t?function(e,t,i){"string"==typeof i&&""!==i||(i="utf8");if(!d.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var a=0|p(t,i),s=(e=o(e,a)).write(t,i);s!==a&&(e=e.slice(0,s));return e}(e,t,i):function(e,t){if(d.isBuffer(t)){var i=0|u(t.length);return 0===(e=o(e,i)).length||t.copy(e,0,0,i),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(a=t.length)!=a?o(e,0):h(e,t);if("Buffer"===t.type&&n(t.data))return h(e,t.data)}var a;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t){if(l(t),e=o(e,t<0?0:0|u(t)),!d.TYPED_ARRAY_SUPPORT)for(var i=0;i<t;++i)e[i]=0;return e}function h(e,t){var i=t.length<0?0:0|u(t.length);e=o(e,i);for(var a=0;a<i;a+=1)e[a]=255&t[a];return e}function u(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function p(e,t){if(d.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var i=e.length;if(0===i)return 0;for(var a=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return E(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return O(e).length;default:if(a)return E(e).length;t=(""+t).toLowerCase(),a=!0}}function g(e,t,i){var a=e[t];e[t]=e[i],e[i]=a}function m(e,t,i,a,s){if(0===e.length)return-1;if("string"==typeof i?(a=i,i=0):2147483647<i?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=s?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(s)return-1;i=e.length-1}else if(i<0){if(!s)return-1;i=0}if("string"==typeof t&&(t=d.from(t,a)),d.isBuffer(t))return 0===t.length?-1:y(e,t,i,a,s);if("number"==typeof t)return t&=255,d.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):y(e,[t],i,a,s);throw new TypeError("val must be string, number or Buffer")}function y(e,t,i,a,s){var r,n=1,o=e.length,l=t.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(e.length<2||t.length<2)return-1;o/=n=2,l/=2,i/=2}function c(e,t){return 1===n?e[t]:e.readUInt16BE(t*n)}if(s){var h=-1;for(r=i;r<o;r++)if(c(e,r)===c(t,-1===h?0:r-h)){if(-1===h&&(h=r),r-h+1===l)return h*n}else-1!==h&&(r-=r-h),h=-1}else for(o<i+l&&(i=o-l),r=i;0<=r;r--){for(var d=!0,u=0;u<l;u++)if(c(e,r+u)!==c(t,u)){d=!1;break}if(d)return r}return-1}function f(e,t,i,a){i=Number(i)||0;var s=e.length-i;a?s<(a=Number(a))&&(a=s):a=s;var r=t.length;if(r%2!=0)throw new TypeError("Invalid hex string");r/2<a&&(a=r/2);for(var n=0;n<a;++n){var o=parseInt(t.substr(2*n,2),16);if(isNaN(o))return n;e[i+n]=o}return n}function b(e,t,i,a){return M(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,a)}function v(e,t,i){return 0===t&&i===e.length?a.fromByteArray(e):a.fromByteArray(e.slice(t,i))}function _(e,t,i){i=Math.min(e.length,i);for(var a=[],s=t;s<i;){var r,n,o,l,c=e[s],h=null,d=239<c?4:223<c?3:191<c?2:1;if(s+d<=i)switch(d){case 1:c<128&&(h=c);break;case 2:128==(192&(r=e[s+1]))&&127<(l=(31&c)<<6|63&r)&&(h=l);break;case 3:r=e[s+1],n=e[s+2],128==(192&r)&&128==(192&n)&&2047<(l=(15&c)<<12|(63&r)<<6|63&n)&&(l<55296||57343<l)&&(h=l);break;case 4:r=e[s+1],n=e[s+2],o=e[s+3],128==(192&r)&&128==(192&n)&&128==(192&o)&&65535<(l=(15&c)<<18|(63&r)<<12|(63&n)<<6|63&o)&&l<1114112&&(h=l)}null===h?(h=65533,d=1):65535<h&&(h-=65536,a.push(h>>>10&1023|55296),h=56320|1023&h),a.push(h),s+=d}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var i="",a=0;for(;a<t;)i+=String.fromCharCode.apply(String,e.slice(a,a+=C));return i}(a)}H.Buffer=d,H.SlowBuffer=function(e){+e!=e&&(e=0);return d.alloc(+e)},H.INSPECT_MAX_BYTES=50,d.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),H.kMaxLength=i(),d.poolSize=8192,d._augment=function(e){return e.__proto__=d.prototype,e},d.from=function(e,t,i){return s(null,e,t,i)},d.TYPED_ARRAY_SUPPORT&&(d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0})),d.alloc=function(e,t,i){return a=null,r=t,n=i,l(s=e),s<=0?o(a,s):void 0!==r?"string"==typeof n?o(a,s).fill(r,n):o(a,s).fill(r):o(a,s);var a,s,r,n},d.allocUnsafe=function(e){return c(null,e)},d.allocUnsafeSlow=function(e){return c(null,e)},d.isBuffer=function(e){return!(null==e||!e._isBuffer)},d.compare=function(e,t){if(!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var i=e.length,a=t.length,s=0,r=Math.min(i,a);s<r;++s)if(e[s]!==t[s]){i=e[s],a=t[s];break}return i<a?-1:a<i?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!n(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);var i;if(void 0===t)for(i=t=0;i<e.length;++i)t+=e[i].length;var a=d.allocUnsafe(t),s=0;for(i=0;i<e.length;++i){var r=e[i];if(!d.isBuffer(r))throw new TypeError('"list" argument must be an Array of Buffers');r.copy(a,s),s+=r.length}return a},d.byteLength=p,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},d.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?_(this,0,e):function(e,t,i){var a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,i);case"utf8":case"utf-8":return _(this,t,i);case"ascii":return k(this,t,i);case"latin1":case"binary":return w(this,t,i);case"base64":return v(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,i);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}.apply(this,arguments)},d.prototype.equals=function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){var e="",t=H.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},d.prototype.compare=function(e,t,i,a,s){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===a&&(a=0),void 0===s&&(s=this.length),t<0||i>e.length||a<0||s>this.length)throw new RangeError("out of range index");if(s<=a&&i<=t)return 0;if(s<=a)return-1;if(i<=t)return 1;if(this===e)return 0;for(var r=(s>>>=0)-(a>>>=0),n=(i>>>=0)-(t>>>=0),o=Math.min(r,n),l=this.slice(a,s),c=e.slice(t,i),h=0;h<o;++h)if(l[h]!==c[h]){r=l[h],n=c[h];break}return r<n?-1:n<r?1:0},d.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},d.prototype.indexOf=function(e,t,i){return m(this,e,t,i,!0)},d.prototype.lastIndexOf=function(e,t,i){return m(this,e,t,i,!1)},d.prototype.write=function(e,t,i,a){if(void 0===t)a="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)a=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(i)?(i|=0,void 0===a&&(a="utf8")):(a=i,i=void 0)}var s=this.length-t;if((void 0===i||s<i)&&(i=s),0<e.length&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");for(var r,n,o,l,c,h,d,u,p,g=!1;;)switch(a){case"hex":return f(this,e,t,i);case"utf8":case"utf-8":return u=t,p=i,M(E(e,(d=this).length-u),d,u,p);case"ascii":return b(this,e,t,i);case"latin1":case"binary":return b(this,e,t,i);case"base64":return l=this,c=t,h=i,M(O(e),l,c,h);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return n=t,o=i,M(function(e,t){for(var i,a,s,r=[],n=0;n<e.length&&!((t-=2)<0);++n)i=e.charCodeAt(n),a=i>>8,s=i%256,r.push(s),r.push(a);return r}(e,(r=this).length-n),r,n,o);default:if(g)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),g=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function k(e,t,i){var a="";i=Math.min(e.length,i);for(var s=t;s<i;++s)a+=String.fromCharCode(127&e[s]);return a}function w(e,t,i){var a="";i=Math.min(e.length,i);for(var s=t;s<i;++s)a+=String.fromCharCode(e[s]);return a}function T(e,t,i){var a=e.length;(!t||t<0)&&(t=0),(!i||i<0||a<i)&&(i=a);for(var s="",r=t;r<i;++r)s+=F(e[r]);return s}function P(e,t,i){for(var a=e.slice(t,i),s="",r=0;r<a.length;r+=2)s+=String.fromCharCode(a[r]+256*a[r+1]);return s}function x(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(i<e+t)throw new RangeError("Trying to access beyond buffer length")}function S(e,t,i,a,s,r){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(s<t||t<r)throw new RangeError('"value" argument is out of bounds');if(i+a>e.length)throw new RangeError("Index out of range")}function R(e,t,i,a){t<0&&(t=65535+t+1);for(var s=0,r=Math.min(e.length-i,2);s<r;++s)e[i+s]=(t&255<<8*(a?s:1-s))>>>8*(a?s:1-s)}function A(e,t,i,a){t<0&&(t=4294967295+t+1);for(var s=0,r=Math.min(e.length-i,4);s<r;++s)e[i+s]=t>>>8*(a?s:3-s)&255}function L(e,t,i,a,s,r){if(i+a>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function N(e,t,i,a,s){return s||L(e,0,i,4),r.write(e,t,i,a,23,4),i+4}function I(e,t,i,a,s){return s||L(e,0,i,8),r.write(e,t,i,a,52,8),i+8}d.prototype.slice=function(e,t){var i,a=this.length;if((e=~~e)<0?(e+=a)<0&&(e=0):a<e&&(e=a),(t=void 0===t?a:~~t)<0?(t+=a)<0&&(t=0):a<t&&(t=a),t<e&&(t=e),d.TYPED_ARRAY_SUPPORT)(i=this.subarray(e,t)).__proto__=d.prototype;else{var s=t-e;i=new d(s,void 0);for(var r=0;r<s;++r)i[r]=this[r+e]}return i},d.prototype.readUIntLE=function(e,t,i){e|=0,t|=0,i||x(e,t,this.length);for(var a=this[e],s=1,r=0;++r<t&&(s*=256);)a+=this[e+r]*s;return a},d.prototype.readUIntBE=function(e,t,i){e|=0,t|=0,i||x(e,t,this.length);for(var a=this[e+--t],s=1;0<t&&(s*=256);)a+=this[e+--t]*s;return a},d.prototype.readUInt8=function(e,t){return t||x(e,1,this.length),this[e]},d.prototype.readUInt16LE=function(e,t){return t||x(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUInt16BE=function(e,t){return t||x(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUInt32LE=function(e,t){return t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUInt32BE=function(e,t){return t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readIntLE=function(e,t,i){e|=0,t|=0,i||x(e,t,this.length);for(var a=this[e],s=1,r=0;++r<t&&(s*=256);)a+=this[e+r]*s;return(s*=128)<=a&&(a-=Math.pow(2,8*t)),a},d.prototype.readIntBE=function(e,t,i){e|=0,t|=0,i||x(e,t,this.length);for(var a=t,s=1,r=this[e+--a];0<a&&(s*=256);)r+=this[e+--a]*s;return(s*=128)<=r&&(r-=Math.pow(2,8*t)),r},d.prototype.readInt8=function(e,t){return t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){t||x(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},d.prototype.readInt16BE=function(e,t){t||x(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},d.prototype.readInt32LE=function(e,t){return t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readFloatLE=function(e,t){return t||x(e,4,this.length),r.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return t||x(e,4,this.length),r.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return t||x(e,8,this.length),r.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return t||x(e,8,this.length),r.read(this,e,!1,52,8)},d.prototype.writeUIntLE=function(e,t,i,a){(e=+e,t|=0,i|=0,a)||S(this,e,t,i,Math.pow(2,8*i)-1,0);var s=1,r=0;for(this[t]=255&e;++r<i&&(s*=256);)this[t+r]=e/s&255;return t+i},d.prototype.writeUIntBE=function(e,t,i,a){(e=+e,t|=0,i|=0,a)||S(this,e,t,i,Math.pow(2,8*i)-1,0);var s=i-1,r=1;for(this[t+s]=255&e;0<=--s&&(r*=256);)this[t+s]=e/r&255;return t+i},d.prototype.writeUInt8=function(e,t,i){return e=+e,t|=0,i||S(this,e,t,1,255,0),d.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},d.prototype.writeUInt16LE=function(e,t,i){return e=+e,t|=0,i||S(this,e,t,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},d.prototype.writeUInt16BE=function(e,t,i){return e=+e,t|=0,i||S(this,e,t,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},d.prototype.writeUInt32LE=function(e,t,i){return e=+e,t|=0,i||S(this,e,t,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):A(this,e,t,!0),t+4},d.prototype.writeUInt32BE=function(e,t,i){return e=+e,t|=0,i||S(this,e,t,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):A(this,e,t,!1),t+4},d.prototype.writeIntLE=function(e,t,i,a){if(e=+e,t|=0,!a){var s=Math.pow(2,8*i-1);S(this,e,t,i,s-1,-s)}var r=0,n=1,o=0;for(this[t]=255&e;++r<i&&(n*=256);)e<0&&0===o&&0!==this[t+r-1]&&(o=1),this[t+r]=(e/n>>0)-o&255;return t+i},d.prototype.writeIntBE=function(e,t,i,a){if(e=+e,t|=0,!a){var s=Math.pow(2,8*i-1);S(this,e,t,i,s-1,-s)}var r=i-1,n=1,o=0;for(this[t+r]=255&e;0<=--r&&(n*=256);)e<0&&0===o&&0!==this[t+r+1]&&(o=1),this[t+r]=(e/n>>0)-o&255;return t+i},d.prototype.writeInt8=function(e,t,i){return e=+e,t|=0,i||S(this,e,t,1,127,-128),d.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},d.prototype.writeInt16LE=function(e,t,i){return e=+e,t|=0,i||S(this,e,t,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},d.prototype.writeInt16BE=function(e,t,i){return e=+e,t|=0,i||S(this,e,t,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},d.prototype.writeInt32LE=function(e,t,i){return e=+e,t|=0,i||S(this,e,t,4,2147483647,-2147483648),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):A(this,e,t,!0),t+4},d.prototype.writeInt32BE=function(e,t,i){return e=+e,t|=0,i||S(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):A(this,e,t,!1),t+4},d.prototype.writeFloatLE=function(e,t,i){return N(this,e,t,!0,i)},d.prototype.writeFloatBE=function(e,t,i){return N(this,e,t,!1,i)},d.prototype.writeDoubleLE=function(e,t,i){return I(this,e,t,!0,i)},d.prototype.writeDoubleBE=function(e,t,i){return I(this,e,t,!1,i)},d.prototype.copy=function(e,t,i,a){if(i||(i=0),a||0===a||(a=this.length),t>=e.length&&(t=e.length),t||(t=0),0<a&&a<i&&(a=i),a===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-t<a-i&&(a=e.length-t+i);var s,r=a-i;if(this===e&&i<t&&t<a)for(s=r-1;0<=s;--s)e[s+t]=this[s+i];else if(r<1e3||!d.TYPED_ARRAY_SUPPORT)for(s=0;s<r;++s)e[s+t]=this[s+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+r),t);return r},d.prototype.fill=function(e,t,i,a){if("string"==typeof e){if("string"==typeof t?(a=t,t=0,i=this.length):"string"==typeof i&&(a=i,i=this.length),1===e.length){var s=e.charCodeAt(0);s<256&&(e=s)}if(void 0!==a&&"string"!=typeof a)throw new TypeError("encoding must be a string");if("string"==typeof a&&!d.isEncoding(a))throw new TypeError("Unknown encoding: "+a)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;var r;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(r=t;r<i;++r)this[r]=e;else{var n=d.isBuffer(e)?e:E(new d(e,a).toString()),o=n.length;for(r=0;r<i-t;++r)this[r+t]=n[r%o]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function E(e,t){var i;t=t||1/0;for(var a=e.length,s=null,r=[],n=0;n<a;++n){if(55295<(i=e.charCodeAt(n))&&i<57344){if(!s){if(56319<i){-1<(t-=3)&&r.push(239,191,189);continue}if(n+1===a){-1<(t-=3)&&r.push(239,191,189);continue}s=i;continue}if(i<56320){-1<(t-=3)&&r.push(239,191,189),s=i;continue}i=65536+(s-55296<<10|i-56320)}else s&&-1<(t-=3)&&r.push(239,191,189);if(s=null,i<128){if((t-=1)<0)break;r.push(i)}else if(i<2048){if((t-=2)<0)break;r.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;r.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;r.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return r}function O(e){return a.toByteArray(function(e){var t;if((e=(t=e,t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function M(e,t,i,a){for(var s=0;s<a&&!(s+i>=t.length||s>=e.length);++s)t[s+i]=e[s];return s}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":2,ieee754:10,isarray:7}],7:[function(e,t,i){var a={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==a.call(e)}},{}],8:[function(e,t,i){(function(e){function t(e){return Object.prototype.toString.call(e)}i.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===t(e)},i.isBoolean=function(e){return"boolean"==typeof e},i.isNull=function(e){return null===e},i.isNullOrUndefined=function(e){return null==e},i.isNumber=function(e){return"number"==typeof e},i.isString=function(e){return"string"==typeof e},i.isSymbol=function(e){return"symbol"==typeof e},i.isUndefined=function(e){return void 0===e},i.isRegExp=function(e){return"[object RegExp]"===t(e)},i.isObject=function(e){return"object"==typeof e&&null!==e},i.isDate=function(e){return"[object Date]"===t(e)},i.isError=function(e){return"[object Error]"===t(e)||e instanceof Error},i.isFunction=function(e){return"function"==typeof e},i.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},i.isBuffer=e.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":12}],9:[function(e,t,i){function a(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function l(e){return"function"==typeof e}function c(e){return"object"==typeof e&&null!==e}function h(e){return void 0===e}((t.exports=a).EventEmitter=a).prototype._events=void 0,a.prototype._maxListeners=void 0,a.defaultMaxListeners=10,a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},a.prototype.emit=function(e){var t,i,a,s,r,n;if(this._events||(this._events={}),"error"===e&&(!this._events.error||c(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var o=new Error('Uncaught, unspecified "error" event. ('+t+")");throw o.context=t,o}if(h(i=this._events[e]))return!1;if(l(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),i.apply(this,s)}else if(c(i))for(s=Array.prototype.slice.call(arguments,1),a=(n=i.slice()).length,r=0;r<a;r++)n[r].apply(this,s);return!0},a.prototype.on=a.prototype.addListener=function(e,t){var i;if(!l(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,l(t.listener)?t.listener:t),this._events[e]?c(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,c(this._events[e])&&!this._events[e].warned&&(i=h(this._maxListeners)?a.defaultMaxListeners:this._maxListeners)&&0<i&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},a.prototype.once=function(e,t){if(!l(t))throw TypeError("listener must be a function");var i=!1;function a(){this.removeListener(e,a),i||(i=!0,t.apply(this,arguments))}return a.listener=t,this.on(e,a),this},a.prototype.removeListener=function(e,t){var i,a,s,r;if(!l(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(i=this._events[e]).length,a=-1,i===t||l(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(c(i)){for(r=s;0<r--;)if(i[r]===t||i[r].listener&&i[r].listener===t){a=r;break}if(a<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(a,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},a.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(l(i=this._events[e]))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},a.prototype.listeners=function(e){return this._events&&this._events[e]?l(this._events[e])?[this._events[e]]:this._events[e].slice():[]},a.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(l(t))return 1;if(t)return t.length}return 0},a.listenerCount=function(e,t){return e.listenerCount(t)}},{}],10:[function(e,t,i){i.read=function(e,t,i,a,s){var r,n,o=8*s-a-1,l=(1<<o)-1,c=l>>1,h=-7,d=i?s-1:0,u=i?-1:1,p=e[t+d];for(d+=u,r=p&(1<<-h)-1,p>>=-h,h+=o;0<h;r=256*r+e[t+d],d+=u,h-=8);for(n=r&(1<<-h)-1,r>>=-h,h+=a;0<h;n=256*n+e[t+d],d+=u,h-=8);if(0===r)r=1-c;else{if(r===l)return n?NaN:1/0*(p?-1:1);n+=Math.pow(2,a),r-=c}return(p?-1:1)*n*Math.pow(2,r-a)},i.write=function(e,t,i,a,s,r){var n,o,l,c=8*r-s-1,h=(1<<c)-1,d=h>>1,u=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,p=a?0:r-1,g=a?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,n=h):(n=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-n))<1&&(n--,l*=2),2<=(t+=1<=n+d?u/l:u*Math.pow(2,1-d))*l&&(n++,l/=2),h<=n+d?(o=0,n=h):1<=n+d?(o=(t*l-1)*Math.pow(2,s),n+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,s),n=0));8<=s;e[i+p]=255&o,p+=g,o/=256,s-=8);for(n=n<<s|o,c+=s;0<c;e[i+p]=255&n,p+=g,n/=256,c-=8);e[i+p-g]|=128*m}},{}],11:[function(e,t,i){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},{}],12:[function(e,t,i){function a(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}t.exports=function(e){return null!=e&&(a(e)||"function"==typeof(t=e).readFloatLE&&"function"==typeof t.slice&&a(t.slice(0,0))||!!e._isBuffer);var t}},{}],13:[function(e,t,i){"use strict";var a="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var a in i)i.hasOwnProperty(a)&&(e[a]=i[a])}}return e},i.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var s={arraySet:function(e,t,i,a,s){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+a),s);else for(var r=0;r<a;r++)e[s+r]=t[i+r]},flattenChunks:function(e){var t,i,a,s,r,n;for(t=a=0,i=e.length;t<i;t++)a+=e[t].length;for(n=new Uint8Array(a),t=s=0,i=e.length;t<i;t++)r=e[t],n.set(r,s),s+=r.length;return n}},r={arraySet:function(e,t,i,a,s){for(var r=0;r<a;r++)e[s+r]=t[i+r]},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){e?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,r))},i.setTyped(a)},{}],14:[function(e,t,i){"use strict";t.exports=function(e,t,i,a){for(var s=65535&e|0,r=e>>>16&65535|0,n=0;0!==i;){for(i-=n=2e3<i?2e3:i;r=r+(s=s+t[a++]|0)|0,--n;);s%=65521,r%=65521}return s|r<<16|0}},{}],15:[function(e,t,i){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],16:[function(e,t,i){"use strict";var o=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t,i,a){var s=o,r=a+i;e^=-1;for(var n=a;n<r;n++)e=e>>>8^s[255&(e^t[n])];return-1^e}},{}],17:[function(e,t,i){"use strict";var l,u=e("../utils/common"),c=e("./trees"),p=e("./adler32"),g=e("./crc32"),a=e("./messages"),h=0,d=1,m=3,y=4,f=5,b=0,v=1,_=-2,s=-3,C=-5,k=-1,r=1,w=2,T=3,P=4,n=0,o=2,x=8,S=9,R=15,A=8,L=286,N=30,I=19,B=2*L+1,F=15,E=3,O=258,M=O+E+1,H=32,D=42,z=69,q=73,G=91,j=103,U=113,X=666,Y=1,V=2,W=3,K=4,J=3;function Z(e,t){return e.msg=a[t],t}function Q(e){return(e<<1)-(4<e?9:0)}function $(e){for(var t=e.length;0<=--t;)e[t]=0}function ee(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(u.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))}function te(e,t){c._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ee(e.strm)}function ie(e,t){e.pending_buf[e.pending++]=t}function ae(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function se(e,t){var i,a,s=e.max_chain_length,r=e.strstart,n=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-M?e.strstart-(e.w_size-M):0,c=e.window,h=e.w_mask,d=e.prev,u=e.strstart+O,p=c[r+n-1],g=c[r+n];e.prev_length>=e.good_match&&(s>>=2),o>e.lookahead&&(o=e.lookahead);do{if(c[(i=t)+n]===g&&c[i+n-1]===p&&c[i]===c[r]&&c[++i]===c[r+1]){r+=2,i++;do{}while(c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&r<u);if(a=O-(u-r),r=u-O,n<a){if(e.match_start=t,o<=(n=a))break;p=c[r+n-1],g=c[r+n]}}}while((t=d[t&h])>l&&0!=--s);return n<=e.lookahead?n:e.lookahead}function re(e){var t,i,a,s,r,n,o,l,c,h,d=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=d+(d-M)){for(u.arraySet(e.window,e.window,d,d,0),e.match_start-=d,e.strstart-=d,e.block_start-=d,t=i=e.hash_size;a=e.head[--t],e.head[t]=d<=a?a-d:0,--i;);for(t=i=d;a=e.prev[--t],e.prev[t]=d<=a?a-d:0,--i;);s+=d}if(0===e.strm.avail_in)break;if(n=e.strm,o=e.window,l=e.strstart+e.lookahead,c=s,h=void 0,h=n.avail_in,c<h&&(h=c),i=0===h?0:(n.avail_in-=h,u.arraySet(o,n.input,n.next_in,h,l),1===n.state.wrap?n.adler=p(n.adler,o,h,l):2===n.state.wrap&&(n.adler=g(n.adler,o,h,l)),n.next_in+=h,n.total_in+=h,h),e.lookahead+=i,e.lookahead+e.insert>=E)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=(e.ins_h<<e.hash_shift^e.window[r+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[r+E-1])&e.hash_mask,e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<E)););}while(e.lookahead<M&&0!==e.strm.avail_in)}function ne(e,t){for(var i,a;;){if(e.lookahead<M){if(re(e),e.lookahead<M&&t===h)return Y;if(0===e.lookahead)break}if(i=0,e.lookahead>=E&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-M&&(e.match_length=se(e,i)),e.match_length>=E)if(a=c._tr_tally(e,e.strstart-e.match_start,e.match_length-E),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=E){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else a=c._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(a&&(te(e,!1),0===e.strm.avail_out))return Y}return e.insert=e.strstart<E-1?e.strstart:E-1,t===y?(te(e,!0),0===e.strm.avail_out?W:K):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?Y:V}function oe(e,t){for(var i,a,s;;){if(e.lookahead<M){if(re(e),e.lookahead<M&&t===h)return Y;if(0===e.lookahead)break}if(i=0,e.lookahead>=E&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=E-1,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-M&&(e.match_length=se(e,i),e.match_length<=5&&(e.strategy===r||e.match_length===E&&4096<e.strstart-e.match_start)&&(e.match_length=E-1)),e.prev_length>=E&&e.match_length<=e.prev_length){for(s=e.strstart+e.lookahead-E,a=c._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-E),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=s&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=E-1,e.strstart++,a&&(te(e,!1),0===e.strm.avail_out))return Y}else if(e.match_available){if((a=c._tr_tally(e,0,e.window[e.strstart-1]))&&te(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return Y}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(a=c._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<E-1?e.strstart:E-1,t===y?(te(e,!0),0===e.strm.avail_out?W:K):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?Y:V}function le(e,t,i,a,s){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=a,this.func=s}function ce(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=o,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?D:U,e.adler=2===t.wrap?0:1,t.last_flush=h,c._tr_init(t),b):Z(e,_)}function he(e){var t,i=ce(e);return i===b&&((t=e.state).window_size=2*t.w_size,$(t.head),t.max_lazy_match=l[t.level].max_lazy,t.good_match=l[t.level].good_length,t.nice_match=l[t.level].nice_length,t.max_chain_length=l[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=E-1,t.match_available=0,t.ins_h=0),i}function de(e,t,i,a,s,r){if(!e)return _;var n=1;if(t===k&&(t=6),a<0?(n=0,a=-a):15<a&&(n=2,a-=16),s<1||S<s||i!==x||a<8||15<a||t<0||9<t||r<0||P<r)return Z(e,_);8===a&&(a=9);var o=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new u.Buf16(2*B),this.dyn_dtree=new u.Buf16(2*(2*N+1)),this.bl_tree=new u.Buf16(2*(2*I+1)),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new u.Buf16(F+1),this.heap=new u.Buf16(2*L+1),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new u.Buf16(2*L+1),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return(e.state=o).strm=e,o.wrap=n,o.gzhead=null,o.w_bits=a,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=s+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+E-1)/E),o.window=new u.Buf8(2*o.w_size),o.head=new u.Buf16(o.hash_size),o.prev=new u.Buf16(o.w_size),o.lit_bufsize=1<<s+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new u.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=t,o.strategy=r,o.method=i,he(e)}l=[new le(0,0,0,0,function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(re(e),0===e.lookahead&&t===h)return Y;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var a=e.block_start+i;if((0===e.strstart||e.strstart>=a)&&(e.lookahead=e.strstart-a,e.strstart=a,te(e,!1),0===e.strm.avail_out))return Y;if(e.strstart-e.block_start>=e.w_size-M&&(te(e,!1),0===e.strm.avail_out))return Y}return e.insert=0,t===y?(te(e,!0),0===e.strm.avail_out?W:K):(e.strstart>e.block_start&&(te(e,!1),e.strm.avail_out),Y)}),new le(4,4,8,4,ne),new le(4,5,16,8,ne),new le(4,6,32,32,ne),new le(4,4,16,16,oe),new le(8,16,32,32,oe),new le(8,16,128,128,oe),new le(8,32,128,256,oe),new le(32,128,258,1024,oe),new le(32,258,258,4096,oe)],i.deflateInit=function(e,t){return de(e,t,x,R,A,n)},i.deflateInit2=de,i.deflateReset=he,i.deflateResetKeep=ce,i.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?_:(e.state.gzhead=t,b):_},i.deflate=function(e,t){var i,a,s,r;if(!e||!e.state||f<t||t<0)return e?Z(e,_):_;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||a.status===X&&t!==y)return Z(e,0===e.avail_out?C:_);if(a.strm=e,i=a.last_flush,a.last_flush=t,a.status===D)if(2===a.wrap)e.adler=0,ie(a,31),ie(a,139),ie(a,8),a.gzhead?(ie(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),ie(a,255&a.gzhead.time),ie(a,a.gzhead.time>>8&255),ie(a,a.gzhead.time>>16&255),ie(a,a.gzhead.time>>24&255),ie(a,9===a.level?2:a.strategy>=w||a.level<2?4:0),ie(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(ie(a,255&a.gzhead.extra.length),ie(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=g(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=z):(ie(a,0),ie(a,0),ie(a,0),ie(a,0),ie(a,0),ie(a,9===a.level?2:a.strategy>=w||a.level<2?4:0),ie(a,J),a.status=U);else{var n=x+(a.w_bits-8<<4)<<8;n|=(a.strategy>=w||a.level<2?0:a.level<6?1:6===a.level?2:3)<<6,0!==a.strstart&&(n|=H),n+=31-n%31,a.status=U,ae(a,n),0!==a.strstart&&(ae(a,e.adler>>>16),ae(a,65535&e.adler)),e.adler=1}if(a.status===z)if(a.gzhead.extra){for(s=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>s&&(e.adler=g(e.adler,a.pending_buf,a.pending-s,s)),ee(e),s=a.pending,a.pending!==a.pending_buf_size));)ie(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>s&&(e.adler=g(e.adler,a.pending_buf,a.pending-s,s)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=q)}else a.status=q;if(a.status===q)if(a.gzhead.name){s=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>s&&(e.adler=g(e.adler,a.pending_buf,a.pending-s,s)),ee(e),s=a.pending,a.pending===a.pending_buf_size)){r=1;break}r=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,ie(a,r)}while(0!==r);a.gzhead.hcrc&&a.pending>s&&(e.adler=g(e.adler,a.pending_buf,a.pending-s,s)),0===r&&(a.gzindex=0,a.status=G)}else a.status=G;if(a.status===G)if(a.gzhead.comment){s=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>s&&(e.adler=g(e.adler,a.pending_buf,a.pending-s,s)),ee(e),s=a.pending,a.pending===a.pending_buf_size)){r=1;break}r=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,ie(a,r)}while(0!==r);a.gzhead.hcrc&&a.pending>s&&(e.adler=g(e.adler,a.pending_buf,a.pending-s,s)),0===r&&(a.status=j)}else a.status=j;if(a.status===j&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&ee(e),a.pending+2<=a.pending_buf_size&&(ie(a,255&e.adler),ie(a,e.adler>>8&255),e.adler=0,a.status=U)):a.status=U),0!==a.pending){if(ee(e),0===e.avail_out)return a.last_flush=-1,b}else if(0===e.avail_in&&Q(t)<=Q(i)&&t!==y)return Z(e,C);if(a.status===X&&0!==e.avail_in)return Z(e,C);if(0!==e.avail_in||0!==a.lookahead||t!==h&&a.status!==X){var o=a.strategy===w?function(e,t){for(var i;;){if(0===e.lookahead&&(re(e),0===e.lookahead)){if(t===h)return Y;break}if(e.match_length=0,i=c._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(te(e,!1),0===e.strm.avail_out))return Y}return e.insert=0,t===y?(te(e,!0),0===e.strm.avail_out?W:K):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?Y:V}(a,t):a.strategy===T?function(e,t){for(var i,a,s,r,n=e.window;;){if(e.lookahead<=O){if(re(e),e.lookahead<=O&&t===h)return Y;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=E&&0<e.strstart&&(a=n[s=e.strstart-1])===n[++s]&&a===n[++s]&&a===n[++s]){r=e.strstart+O;do{}while(a===n[++s]&&a===n[++s]&&a===n[++s]&&a===n[++s]&&a===n[++s]&&a===n[++s]&&a===n[++s]&&a===n[++s]&&s<r);e.match_length=O-(r-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=E?(i=c._tr_tally(e,1,e.match_length-E),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=c._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(te(e,!1),0===e.strm.avail_out))return Y}return e.insert=0,t===y?(te(e,!0),0===e.strm.avail_out?W:K):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?Y:V}(a,t):l[a.level].func(a,t);if(o!==W&&o!==K||(a.status=X),o===Y||o===W)return 0===e.avail_out&&(a.last_flush=-1),b;if(o===V&&(t===d?c._tr_align(a):t!==f&&(c._tr_stored_block(a,0,0,!1),t===m&&($(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),ee(e),0===e.avail_out))return a.last_flush=-1,b}return t!==y?b:a.wrap<=0?v:(2===a.wrap?(ie(a,255&e.adler),ie(a,e.adler>>8&255),ie(a,e.adler>>16&255),ie(a,e.adler>>24&255),ie(a,255&e.total_in),ie(a,e.total_in>>8&255),ie(a,e.total_in>>16&255),ie(a,e.total_in>>24&255)):(ae(a,e.adler>>>16),ae(a,65535&e.adler)),ee(e),0<a.wrap&&(a.wrap=-a.wrap),0!==a.pending?b:v)},i.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==D&&t!==z&&t!==q&&t!==G&&t!==j&&t!==U&&t!==X?Z(e,_):(e.state=null,t===U?Z(e,s):b):_},i.deflateSetDictionary=function(e,t){var i,a,s,r,n,o,l,c,h=t.length;if(!e||!e.state)return _;if(2===(r=(i=e.state).wrap)||1===r&&i.status!==D||i.lookahead)return _;for(1===r&&(e.adler=p(e.adler,t,h,0)),i.wrap=0,h>=i.w_size&&(0===r&&($(i.head),i.strstart=0,i.block_start=0,i.insert=0),c=new u.Buf8(i.w_size),u.arraySet(c,t,h-i.w_size,i.w_size,0),t=c,h=i.w_size),n=e.avail_in,o=e.next_in,l=e.input,e.avail_in=h,e.next_in=0,e.input=t,re(i);i.lookahead>=E;){for(a=i.strstart,s=i.lookahead-(E-1);i.ins_h=(i.ins_h<<i.hash_shift^i.window[a+E-1])&i.hash_mask,i.prev[a&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=a,a++,--s;);i.strstart=a,i.lookahead=E-1,re(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=E-1,i.match_available=0,e.next_in=o,e.input=l,e.avail_in=n,i.wrap=r,b},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":13,"./adler32":14,"./crc32":16,"./messages":21,"./trees":22}],18:[function(e,t,i){"use strict";t.exports=function(e,t){var i,a,s,r,n,o,l,c,h,d,u,p,g,m,y,f,b,v,_,C,k,w,T,P,x;i=e.state,a=e.next_in,P=e.input,s=a+(e.avail_in-5),r=e.next_out,x=e.output,n=r-(t-e.avail_out),o=r+(e.avail_out-257),l=i.dmax,c=i.wsize,h=i.whave,d=i.wnext,u=i.window,p=i.hold,g=i.bits,m=i.lencode,y=i.distcode,f=(1<<i.lenbits)-1,b=(1<<i.distbits)-1;e:do{g<15&&(p+=P[a++]<<g,g+=8,p+=P[a++]<<g,g+=8),v=m[p&f];t:for(;;){if(p>>>=_=v>>>24,g-=_,0===(_=v>>>16&255))x[r++]=65535&v;else{if(!(16&_)){if(0==(64&_)){v=m[(65535&v)+(p&(1<<_)-1)];continue t}if(32&_){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}C=65535&v,(_&=15)&&(g<_&&(p+=P[a++]<<g,g+=8),C+=p&(1<<_)-1,p>>>=_,g-=_),g<15&&(p+=P[a++]<<g,g+=8,p+=P[a++]<<g,g+=8),v=y[p&b];i:for(;;){if(p>>>=_=v>>>24,g-=_,!(16&(_=v>>>16&255))){if(0==(64&_)){v=y[(65535&v)+(p&(1<<_)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(k=65535&v,g<(_&=15)&&(p+=P[a++]<<g,(g+=8)<_&&(p+=P[a++]<<g,g+=8)),l<(k+=p&(1<<_)-1)){e.msg="invalid distance too far back",i.mode=30;break e}if(p>>>=_,g-=_,(_=r-n)<k){if(h<(_=k-_)&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(T=u,(w=0)===d){if(w+=c-_,_<C){for(C-=_;x[r++]=u[w++],--_;);w=r-k,T=x}}else if(d<_){if(w+=c+d-_,(_-=d)<C){for(C-=_;x[r++]=u[w++],--_;);if(w=0,d<C){for(C-=_=d;x[r++]=u[w++],--_;);w=r-k,T=x}}}else if(w+=d-_,_<C){for(C-=_;x[r++]=u[w++],--_;);w=r-k,T=x}for(;2<C;)x[r++]=T[w++],x[r++]=T[w++],x[r++]=T[w++],C-=3;C&&(x[r++]=T[w++],1<C&&(x[r++]=T[w++]))}else{for(w=r-k;x[r++]=x[w++],x[r++]=x[w++],x[r++]=x[w++],2<(C-=3););C&&(x[r++]=x[w++],1<C&&(x[r++]=x[w++]))}break}}break}}while(a<s&&r<o);a-=C=g>>3,p&=(1<<(g-=C<<3))-1,e.next_in=a,e.next_out=r,e.avail_in=a<s?s-a+5:5-(a-s),e.avail_out=r<o?o-r+257:257-(r-o),i.hold=p,i.bits=g}},{}],19:[function(e,t,i){"use strict";var A=e("../utils/common"),L=e("./adler32"),N=e("./crc32"),I=e("./inffast"),B=e("./inftrees"),F=0,E=1,O=2,M=4,H=5,D=6,z=0,q=1,G=2,j=-2,U=-3,X=-4,Y=-5,V=8,W=1,K=2,J=3,Z=4,Q=5,$=6,ee=7,te=8,ie=9,ae=10,se=11,re=12,ne=13,oe=14,le=15,ce=16,he=17,de=18,ue=19,pe=20,ge=21,me=22,ye=23,fe=24,be=25,ve=26,_e=27,Ce=28,ke=29,we=30,Te=31,Pe=32,a=852,s=592,r=15;function xe(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function n(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=W,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new A.Buf32(a),t.distcode=t.distdyn=new A.Buf32(s),t.sane=1,t.back=-1,z):j}function o(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,n(e)):j}function l(e,t){var i,a;return e&&e.state?(a=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?j:(null!==a.window&&a.wbits!==t&&(a.window=null),a.wrap=i,a.wbits=t,o(e))):j}function c(e,t){var i,a;return e?(a=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new A.Buf16(320),this.work=new A.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},(e.state=a).window=null,(i=l(e,t))!==z&&(e.state=null),i):j}var h,d,u=!0;function Se(e){if(u){var t;for(h=new A.Buf32(512),d=new A.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(B(E,e.lens,0,288,h,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;B(O,e.lens,0,32,d,0,e.work,{bits:5}),u=!1}e.lencode=h,e.lenbits=9,e.distcode=d,e.distbits=5}function Re(e,t,i,a){var s,r=e.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new A.Buf8(r.wsize)),a>=r.wsize?(A.arraySet(r.window,t,i-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):(a<(s=r.wsize-r.wnext)&&(s=a),A.arraySet(r.window,t,i-a,s,r.wnext),(a-=s)?(A.arraySet(r.window,t,i-a,a,0),r.wnext=a,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0}i.inflateReset=o,i.inflateReset2=l,i.inflateResetKeep=n,i.inflateInit=function(e){return c(e,r)},i.inflateInit2=c,i.inflate=function(e,t){var i,a,s,r,n,o,l,c,h,d,u,p,g,m,y,f,b,v,_,C,k,w,T,P,x=0,S=new A.Buf8(4),R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return j;(i=e.state).mode===re&&(i.mode=ne),n=e.next_out,s=e.output,l=e.avail_out,r=e.next_in,a=e.input,o=e.avail_in,c=i.hold,h=i.bits,d=o,u=l,w=z;e:for(;;)switch(i.mode){case W:if(0===i.wrap){i.mode=ne;break}for(;h<16;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}if(2&i.wrap&&35615===c){S[i.check=0]=255&c,S[1]=c>>>8&255,i.check=N(i.check,S,2,0),h=c=0,i.mode=K;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",i.mode=we;break}if((15&c)!==V){e.msg="unknown compression method",i.mode=we;break}if(h-=4,k=8+(15&(c>>>=4)),0===i.wbits)i.wbits=k;else if(k>i.wbits){e.msg="invalid window size",i.mode=we;break}i.dmax=1<<k,e.adler=i.check=1,i.mode=512&c?ae:re,h=c=0;break;case K:for(;h<16;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}if(i.flags=c,(255&i.flags)!==V){e.msg="unknown compression method",i.mode=we;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=we;break}i.head&&(i.head.text=c>>8&1),512&i.flags&&(S[0]=255&c,S[1]=c>>>8&255,i.check=N(i.check,S,2,0)),h=c=0,i.mode=J;case J:for(;h<32;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}i.head&&(i.head.time=c),512&i.flags&&(S[0]=255&c,S[1]=c>>>8&255,S[2]=c>>>16&255,S[3]=c>>>24&255,i.check=N(i.check,S,4,0)),h=c=0,i.mode=Z;case Z:for(;h<16;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}i.head&&(i.head.xflags=255&c,i.head.os=c>>8),512&i.flags&&(S[0]=255&c,S[1]=c>>>8&255,i.check=N(i.check,S,2,0)),h=c=0,i.mode=Q;case Q:if(1024&i.flags){for(;h<16;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}i.length=c,i.head&&(i.head.extra_len=c),512&i.flags&&(S[0]=255&c,S[1]=c>>>8&255,i.check=N(i.check,S,2,0)),h=c=0}else i.head&&(i.head.extra=null);i.mode=$;case $:if(1024&i.flags&&(o<(p=i.length)&&(p=o),p&&(i.head&&(k=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),A.arraySet(i.head.extra,a,r,p,k)),512&i.flags&&(i.check=N(i.check,a,p,r)),o-=p,r+=p,i.length-=p),i.length))break e;i.length=0,i.mode=ee;case ee:if(2048&i.flags){if(0===o)break e;for(p=0;k=a[r+p++],i.head&&k&&i.length<65536&&(i.head.name+=String.fromCharCode(k)),k&&p<o;);if(512&i.flags&&(i.check=N(i.check,a,p,r)),o-=p,r+=p,k)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=te;case te:if(4096&i.flags){if(0===o)break e;for(p=0;k=a[r+p++],i.head&&k&&i.length<65536&&(i.head.comment+=String.fromCharCode(k)),k&&p<o;);if(512&i.flags&&(i.check=N(i.check,a,p,r)),o-=p,r+=p,k)break e}else i.head&&(i.head.comment=null);i.mode=ie;case ie:if(512&i.flags){for(;h<16;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}if(c!==(65535&i.check)){e.msg="header crc mismatch",i.mode=we;break}h=c=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=re;break;case ae:for(;h<32;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}e.adler=i.check=xe(c),h=c=0,i.mode=se;case se:if(0===i.havedict)return e.next_out=n,e.avail_out=l,e.next_in=r,e.avail_in=o,i.hold=c,i.bits=h,G;e.adler=i.check=1,i.mode=re;case re:if(t===H||t===D)break e;case ne:if(i.last){c>>>=7&h,h-=7&h,i.mode=_e;break}for(;h<3;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}switch(i.last=1&c,h-=1,3&(c>>>=1)){case 0:i.mode=oe;break;case 1:if(Se(i),i.mode=pe,t===D){c>>>=2,h-=2;break e}break;case 2:i.mode=he;break;case 3:e.msg="invalid block type",i.mode=we}c>>>=2,h-=2;break;case oe:for(c>>>=7&h,h-=7&h;h<32;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",i.mode=we;break}if(i.length=65535&c,h=c=0,i.mode=le,t===D)break e;case le:i.mode=ce;case ce:if(p=i.length){if(o<p&&(p=o),l<p&&(p=l),0===p)break e;A.arraySet(s,a,r,p,n),o-=p,r+=p,l-=p,n+=p,i.length-=p;break}i.mode=re;break;case he:for(;h<14;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}if(i.nlen=257+(31&c),c>>>=5,h-=5,i.ndist=1+(31&c),c>>>=5,h-=5,i.ncode=4+(15&c),c>>>=4,h-=4,286<i.nlen||30<i.ndist){e.msg="too many length or distance symbols",i.mode=we;break}i.have=0,i.mode=de;case de:for(;i.have<i.ncode;){for(;h<3;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}i.lens[R[i.have++]]=7&c,c>>>=3,h-=3}for(;i.have<19;)i.lens[R[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,T={bits:i.lenbits},w=B(F,i.lens,0,19,i.lencode,0,i.work,T),i.lenbits=T.bits,w){e.msg="invalid code lengths set",i.mode=we;break}i.have=0,i.mode=ue;case ue:for(;i.have<i.nlen+i.ndist;){for(;f=(x=i.lencode[c&(1<<i.lenbits)-1])>>>16&255,b=65535&x,!((y=x>>>24)<=h);){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}if(b<16)c>>>=y,h-=y,i.lens[i.have++]=b;else{if(16===b){for(P=y+2;h<P;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}if(c>>>=y,h-=y,0===i.have){e.msg="invalid bit length repeat",i.mode=we;break}k=i.lens[i.have-1],p=3+(3&c),c>>>=2,h-=2}else if(17===b){for(P=y+3;h<P;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}h-=y,k=0,p=3+(7&(c>>>=y)),c>>>=3,h-=3}else{for(P=y+7;h<P;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}h-=y,k=0,p=11+(127&(c>>>=y)),c>>>=7,h-=7}if(i.have+p>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=we;break}for(;p--;)i.lens[i.have++]=k}}if(i.mode===we)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=we;break}if(i.lenbits=9,T={bits:i.lenbits},w=B(E,i.lens,0,i.nlen,i.lencode,0,i.work,T),i.lenbits=T.bits,w){e.msg="invalid literal/lengths set",i.mode=we;break}if(i.distbits=6,i.distcode=i.distdyn,T={bits:i.distbits},w=B(O,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,T),i.distbits=T.bits,w){e.msg="invalid distances set",i.mode=we;break}if(i.mode=pe,t===D)break e;case pe:i.mode=ge;case ge:if(6<=o&&258<=l){e.next_out=n,e.avail_out=l,e.next_in=r,e.avail_in=o,i.hold=c,i.bits=h,I(e,u),n=e.next_out,s=e.output,l=e.avail_out,r=e.next_in,a=e.input,o=e.avail_in,c=i.hold,h=i.bits,i.mode===re&&(i.back=-1);break}for(i.back=0;f=(x=i.lencode[c&(1<<i.lenbits)-1])>>>16&255,b=65535&x,!((y=x>>>24)<=h);){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}if(f&&0==(240&f)){for(v=y,_=f,C=b;f=(x=i.lencode[C+((c&(1<<v+_)-1)>>v)])>>>16&255,b=65535&x,!(v+(y=x>>>24)<=h);){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}c>>>=v,h-=v,i.back+=v}if(c>>>=y,h-=y,i.back+=y,i.length=b,0===f){i.mode=ve;break}if(32&f){i.back=-1,i.mode=re;break}if(64&f){e.msg="invalid literal/length code",i.mode=we;break}i.extra=15&f,i.mode=me;case me:if(i.extra){for(P=i.extra;h<P;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}i.length+=c&(1<<i.extra)-1,c>>>=i.extra,h-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=ye;case ye:for(;f=(x=i.distcode[c&(1<<i.distbits)-1])>>>16&255,b=65535&x,!((y=x>>>24)<=h);){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}if(0==(240&f)){for(v=y,_=f,C=b;f=(x=i.distcode[C+((c&(1<<v+_)-1)>>v)])>>>16&255,b=65535&x,!(v+(y=x>>>24)<=h);){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}c>>>=v,h-=v,i.back+=v}if(c>>>=y,h-=y,i.back+=y,64&f){e.msg="invalid distance code",i.mode=we;break}i.offset=b,i.extra=15&f,i.mode=fe;case fe:if(i.extra){for(P=i.extra;h<P;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}i.offset+=c&(1<<i.extra)-1,c>>>=i.extra,h-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=we;break}i.mode=be;case be:if(0===l)break e;if(p=u-l,i.offset>p){if((p=i.offset-p)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=we;break}p>i.wnext?(p-=i.wnext,g=i.wsize-p):g=i.wnext-p,p>i.length&&(p=i.length),m=i.window}else m=s,g=n-i.offset,p=i.length;for(l<p&&(p=l),l-=p,i.length-=p;s[n++]=m[g++],--p;);0===i.length&&(i.mode=ge);break;case ve:if(0===l)break e;s[n++]=i.length,l--,i.mode=ge;break;case _e:if(i.wrap){for(;h<32;){if(0===o)break e;o--,c|=a[r++]<<h,h+=8}if(u-=l,e.total_out+=u,i.total+=u,u&&(e.adler=i.check=i.flags?N(i.check,s,u,n-u):L(i.check,s,u,n-u)),u=l,(i.flags?c:xe(c))!==i.check){e.msg="incorrect data check",i.mode=we;break}h=c=0}i.mode=Ce;case Ce:if(i.wrap&&i.flags){for(;h<32;){if(0===o)break e;o--,c+=a[r++]<<h,h+=8}if(c!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=we;break}h=c=0}i.mode=ke;case ke:w=q;break e;case we:w=U;break e;case Te:return X;case Pe:default:return j}return e.next_out=n,e.avail_out=l,e.next_in=r,e.avail_in=o,i.hold=c,i.bits=h,(i.wsize||u!==e.avail_out&&i.mode<we&&(i.mode<_e||t!==M))&&Re(e,e.output,e.next_out,u-e.avail_out)?(i.mode=Te,X):(d-=e.avail_in,u-=e.avail_out,e.total_in+=d,e.total_out+=u,i.total+=u,i.wrap&&u&&(e.adler=i.check=i.flags?N(i.check,s,u,e.next_out-u):L(i.check,s,u,e.next_out-u)),e.data_type=i.bits+(i.last?64:0)+(i.mode===re?128:0)+(i.mode===pe||i.mode===le?256:0),(0===d&&0===u||t===M)&&w===z&&(w=Y),w)},i.inflateEnd=function(e){if(!e||!e.state)return j;var t=e.state;return t.window&&(t.window=null),e.state=null,z},i.inflateGetHeader=function(e,t){var i;return e&&e.state?0==(2&(i=e.state).wrap)?j:((i.head=t).done=!1,z):j},i.inflateSetDictionary=function(e,t){var i,a=t.length;return e&&e.state?0!==(i=e.state).wrap&&i.mode!==se?j:i.mode===se&&L(1,t,a,0)!==i.check?U:Re(e,t,a,a)?(i.mode=Te,X):(i.havedict=1,z):j},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":13,"./adler32":14,"./crc32":16,"./inffast":18,"./inftrees":20}],20:[function(e,t,i){"use strict";var F=e("../utils/common"),E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],O=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],M=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],H=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,i,a,s,r,n,o){var l,c,h,d,u,p,g,m,y,f=o.bits,b=0,v=0,_=0,C=0,k=0,w=0,T=0,P=0,x=0,S=0,R=null,A=0,L=new F.Buf16(16),N=new F.Buf16(16),I=null,B=0;for(b=0;b<=15;b++)L[b]=0;for(v=0;v<a;v++)L[t[i+v]]++;for(k=f,C=15;1<=C&&0===L[C];C--);if(C<k&&(k=C),0===C)return s[r++]=20971520,s[r++]=20971520,o.bits=1,0;for(_=1;_<C&&0===L[_];_++);for(k<_&&(k=_),b=P=1;b<=15;b++)if(P<<=1,(P-=L[b])<0)return-1;if(0<P&&(0===e||1!==C))return-1;for(N[1]=0,b=1;b<15;b++)N[b+1]=N[b]+L[b];for(v=0;v<a;v++)0!==t[i+v]&&(n[N[t[i+v]]++]=v);if(0===e?(R=I=n,p=19):1===e?(R=E,A-=257,I=O,B-=257,p=256):(R=M,I=H,p=-1),b=_,u=r,h=-1,d=(x=1<<(w=k))-1,1===e&&852<x||2===e&&592<x)return 1;for(T=v=S=0;;){for(0,g=b-T,n[v]<p?(m=0,y=n[v]):n[v]>p?(m=I[B+n[v]],y=R[A+n[v]]):(m=96,y=0),l=1<<b-T,_=c=1<<w;s[u+(S>>T)+(c-=l)]=g<<24|m<<16|y|0,0!==c;);for(l=1<<b-1;S&l;)l>>=1;if(0!==l?(S&=l-1,S+=l):S=0,v++,0==--L[b]){if(b===C)break;b=t[i+n[v]]}if(k<b&&(S&d)!==h){for(0===T&&(T=k),u+=_,P=1<<(w=b-T);w+T<C&&!((P-=L[w+T])<=0);)w++,P<<=1;if(x+=1<<w,1===e&&852<x||2===e&&592<x)return 1;s[h=S&d]=k<<24|w<<16|u-r|0}}return 0!==S&&(s[u+S]=b-T<<24|64<<16|0),o.bits=k,0}},{"../utils/common":13}],21:[function(e,t,i){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],22:[function(e,t,i){"use strict";var l=e("../utils/common"),o=4,c=0,h=1,d=2;function a(e){for(var t=e.length;0<=--t;)e[t]=0}var u=0,p=1,g=2,n=29,m=256,y=m+1+n,f=30,b=19,v=2*y+1,_=15,s=16,C=7,k=256,w=16,T=17,P=18,x=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=new Array(2*(y+2));a(L);var N=new Array(2*f);a(N);var I=new Array(512);a(I);var B=new Array(256);a(B);var F=new Array(n);a(F);var E,O,M,H=new Array(f);function D(e,t,i,a,s){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=a,this.max_length=s,this.has_stree=e&&e.length}function r(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function z(e){return e<256?I[e]:I[256+(e>>>7)]}function q(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function G(e,t,i){e.bi_valid>s-i?(e.bi_buf|=t<<e.bi_valid&65535,q(e,e.bi_buf),e.bi_buf=t>>s-e.bi_valid,e.bi_valid+=i-s):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)}function j(e,t,i){G(e,i[2*t],i[2*t+1])}function U(e,t){for(var i=0;i|=1&e,e>>>=1,i<<=1,0<--t;);return i>>>1}function X(e,t,i){var a,s,r=new Array(_+1),n=0;for(a=1;a<=_;a++)r[a]=n=n+i[a-1]<<1;for(s=0;s<=t;s++){var o=e[2*s+1];0!==o&&(e[2*s]=U(r[o]++,o))}}function Y(e){var t;for(t=0;t<y;t++)e.dyn_ltree[2*t]=0;for(t=0;t<f;t++)e.dyn_dtree[2*t]=0;for(t=0;t<b;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*k]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function V(e){8<e.bi_valid?q(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function W(e,t,i,a){var s=2*t,r=2*i;return e[s]<e[r]||e[s]===e[r]&&a[t]<=a[i]}function K(e,t,i){for(var a=e.heap[i],s=i<<1;s<=e.heap_len&&(s<e.heap_len&&W(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!W(t,a,e.heap[s],e.depth));)e.heap[i]=e.heap[s],i=s,s<<=1;e.heap[i]=a}function J(e,t,i){var a,s,r,n,o=0;if(0!==e.last_lit)for(;a=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],s=e.pending_buf[e.l_buf+o],o++,0===a?j(e,s,t):(j(e,(r=B[s])+m+1,t),0!==(n=x[r])&&G(e,s-=F[r],n),j(e,r=z(--a),i),0!==(n=S[r])&&G(e,a-=H[r],n)),o<e.last_lit;);j(e,k,t)}function Z(e,t){var i,a,s,r=t.dyn_tree,n=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=v,i=0;i<l;i++)0!==r[2*i]?(e.heap[++e.heap_len]=c=i,e.depth[i]=0):r[2*i+1]=0;for(;e.heap_len<2;)r[2*(s=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[s]=0,e.opt_len--,o&&(e.static_len-=n[2*s+1]);for(t.max_code=c,i=e.heap_len>>1;1<=i;i--)K(e,r,i);for(s=l;i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],K(e,r,1),a=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=a,r[2*s]=r[2*i]+r[2*a],e.depth[s]=(e.depth[i]>=e.depth[a]?e.depth[i]:e.depth[a])+1,r[2*i+1]=r[2*a+1]=s,e.heap[1]=s++,K(e,r,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var i,a,s,r,n,o,l=t.dyn_tree,c=t.max_code,h=t.stat_desc.static_tree,d=t.stat_desc.has_stree,u=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,g=t.stat_desc.max_length,m=0;for(r=0;r<=_;r++)e.bl_count[r]=0;for(l[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<v;i++)g<(r=l[2*l[2*(a=e.heap[i])+1]+1]+1)&&(r=g,m++),l[2*a+1]=r,c<a||(e.bl_count[r]++,n=0,p<=a&&(n=u[a-p]),o=l[2*a],e.opt_len+=o*(r+n),d&&(e.static_len+=o*(h[2*a+1]+n)));if(0!==m){do{for(r=g-1;0===e.bl_count[r];)r--;e.bl_count[r]--,e.bl_count[r+1]+=2,e.bl_count[g]--,m-=2}while(0<m);for(r=g;0!==r;r--)for(a=e.bl_count[r];0!==a;)c<(s=e.heap[--i])||(l[2*s+1]!==r&&(e.opt_len+=(r-l[2*s+1])*l[2*s],l[2*s+1]=r),a--)}}(e,t),X(r,c,e.bl_count)}function Q(e,t,i){var a,s,r=-1,n=t[1],o=0,l=7,c=4;for(0===n&&(l=138,c=3),t[2*(i+1)+1]=65535,a=0;a<=i;a++)s=n,n=t[2*(a+1)+1],++o<l&&s===n||(o<c?e.bl_tree[2*s]+=o:0!==s?(s!==r&&e.bl_tree[2*s]++,e.bl_tree[2*w]++):o<=10?e.bl_tree[2*T]++:e.bl_tree[2*P]++,r=s,(o=0)===n?(l=138,c=3):s===n?(l=6,c=3):(l=7,c=4))}function $(e,t,i){var a,s,r=-1,n=t[1],o=0,l=7,c=4;for(0===n&&(l=138,c=3),a=0;a<=i;a++)if(s=n,n=t[2*(a+1)+1],!(++o<l&&s===n)){if(o<c)for(;j(e,s,e.bl_tree),0!=--o;);else 0!==s?(s!==r&&(j(e,s,e.bl_tree),o--),j(e,w,e.bl_tree),G(e,o-3,2)):o<=10?(j(e,T,e.bl_tree),G(e,o-3,3)):(j(e,P,e.bl_tree),G(e,o-11,7));r=s,(o=0)===n?(l=138,c=3):s===n?(l=6,c=3):(l=7,c=4)}}a(H);var ee=!1;function te(e,t,i,a){var s,r,n,o;G(e,(u<<1)+(a?1:0),3),r=t,n=i,o=!0,V(s=e),o&&(q(s,n),q(s,~n)),l.arraySet(s.pending_buf,s.window,r,n,s.pending),s.pending+=n}i._tr_init=function(e){ee||(function(){var e,t,i,a,s,r=new Array(_+1);for(a=i=0;a<n-1;a++)for(F[a]=i,e=0;e<1<<x[a];e++)B[i++]=a;for(B[i-1]=a,a=s=0;a<16;a++)for(H[a]=s,e=0;e<1<<S[a];e++)I[s++]=a;for(s>>=7;a<f;a++)for(H[a]=s<<7,e=0;e<1<<S[a]-7;e++)I[256+s++]=a;for(t=0;t<=_;t++)r[t]=0;for(e=0;e<=143;)L[2*e+1]=8,e++,r[8]++;for(;e<=255;)L[2*e+1]=9,e++,r[9]++;for(;e<=279;)L[2*e+1]=7,e++,r[7]++;for(;e<=287;)L[2*e+1]=8,e++,r[8]++;for(X(L,y+1,r),e=0;e<f;e++)N[2*e+1]=5,N[2*e]=U(e,5);E=new D(L,x,m+1,y,_),O=new D(N,S,0,f,_),M=new D(new Array(0),R,0,b,C)}(),ee=!0),e.l_desc=new r(e.dyn_ltree,E),e.d_desc=new r(e.dyn_dtree,O),e.bl_desc=new r(e.bl_tree,M),e.bi_buf=0,e.bi_valid=0,Y(e)},i._tr_stored_block=te,i._tr_flush_block=function(e,t,i,a){var s,r,n=0;0<e.level?(e.strm.data_type===d&&(e.strm.data_type=function(e){var t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return c;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return h;for(t=32;t<m;t++)if(0!==e.dyn_ltree[2*t])return h;return c}(e)),Z(e,e.l_desc),Z(e,e.d_desc),n=function(e){var t;for(Q(e,e.dyn_ltree,e.l_desc.max_code),Q(e,e.dyn_dtree,e.d_desc.max_code),Z(e,e.bl_desc),t=b-1;3<=t&&0===e.bl_tree[2*A[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),s=e.opt_len+3+7>>>3,(r=e.static_len+3+7>>>3)<=s&&(s=r)):s=r=i+5,i+4<=s&&-1!==t?te(e,t,i,a):e.strategy===o||r===s?(G(e,(p<<1)+(a?1:0),3),J(e,L,N)):(G(e,(g<<1)+(a?1:0),3),function(e,t,i,a){var s;for(G(e,t-257,5),G(e,i-1,5),G(e,a-4,4),s=0;s<a;s++)G(e,e.bl_tree[2*A[s]+1],3);$(e,e.dyn_ltree,t-1),$(e,e.dyn_dtree,i-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,n+1),J(e,e.dyn_ltree,e.dyn_dtree)),Y(e),a&&V(e)},i._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(B[i]+m+1)]++,e.dyn_dtree[2*z(t)]++),e.last_lit===e.lit_bufsize-1},i._tr_align=function(e){var t;G(e,p<<1,3),j(e,k,L),16===(t=e).bi_valid?(q(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":13}],23:[function(e,t,i){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],24:[function(e,t,i){(function(o){"use strict";!o.version||0===o.version.indexOf("v0.")||0===o.version.indexOf("v1.")&&0!==o.version.indexOf("v1.8.")?t.exports={nextTick:function(e,t,i,a){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var s,r,n=arguments.length;switch(n){case 0:case 1:return o.nextTick(e);case 2:return o.nextTick(function(){e.call(null,t)});case 3:return o.nextTick(function(){e.call(null,t,i)});case 4:return o.nextTick(function(){e.call(null,t,i,a)});default:for(s=new Array(n-1),r=0;r<s.length;)s[r++]=arguments[r];return o.nextTick(function(){e.apply(null,s)})}}}:t.exports=o}).call(this,e("_process"))},{_process:25}],25:[function(e,t,i){var a,s,r=t.exports={};function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function l(t){if(a===setTimeout)return setTimeout(t,0);if((a===n||!a)&&setTimeout)return a=setTimeout,setTimeout(t,0);try{return a(t,0)}catch(e){try{return a.call(null,t,0)}catch(e){return a.call(this,t,0)}}}(function(){try{a="function"==typeof setTimeout?setTimeout:n}catch(e){a=n}try{s="function"==typeof clearTimeout?clearTimeout:o}catch(e){s=o}})();var c,h=[],d=!1,u=-1;function p(){d&&c&&(d=!1,c.length?h=c.concat(h):u=-1,h.length&&g())}function g(){if(!d){var e=l(p);d=!0;for(var t=h.length;t;){for(c=h,h=[];++u<t;)c&&c[u].run();u=-1,t=h.length}c=null,d=!1,function(t){if(s===clearTimeout)return clearTimeout(t);if((s===o||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(t);try{s(t)}catch(e){try{return s.call(null,t)}catch(e){return s.call(this,t)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function y(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];h.push(new m(e,t)),1!==h.length||d||l(g)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=y,r.addListener=y,r.once=y,r.off=y,r.removeListener=y,r.removeAllListeners=y,r.emit=y,r.prependListener=y,r.prependOnceListener=y,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],26:[function(e,t,i){"use strict";var a=e("process-nextick-args"),s=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};t.exports=d;var r=e("core-util-is");r.inherits=e("inherits");var n=e("./_stream_readable"),o=e("./_stream_writable");r.inherits(d,n);for(var l=s(o.prototype),c=0;c<l.length;c++){var h=l[c];d.prototype[h]||(d.prototype[h]=o.prototype[h])}function d(e){if(!(this instanceof d))return new d(e);n.call(this,e),o.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",u)}function u(){this.allowHalfOpen||this._writableState.ended||a.nextTick(p,this)}function p(e){e.end()}Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),a.nextTick(t,e)}},{"./_stream_readable":28,"./_stream_writable":30,"core-util-is":8,inherits:11,"process-nextick-args":24}],27:[function(e,t,i){"use strict";t.exports=r;var a=e("./_stream_transform"),s=e("core-util-is");function r(e){if(!(this instanceof r))return new r(e);a.call(this,e)}s.inherits=e("inherits"),s.inherits(r,a),r.prototype._transform=function(e,t,i){i(null,e)}},{"./_stream_transform":29,"core-util-is":8,inherits:11}],28:[function(B,F,e){(function(y,e){"use strict";var f=B("process-nextick-args");F.exports=u;var n,b=B("isarray");u.ReadableState=r;B("events").EventEmitter;var v=function(e,t){return e.listeners(t).length},s=B("./internal/streams/stream"),c=B("safe-buffer").Buffer,h=e.Uint8Array||function(){};var t=B("core-util-is");t.inherits=B("inherits");var i=B("util"),_=void 0;_=i&&i.debuglog?i.debuglog("stream"):function(){};var o,l=B("./internal/streams/BufferList"),a=B("./internal/streams/destroy");t.inherits(u,s);var d=["error","close","destroy","pause","resume"];function r(e,t){e=e||{};var i=t instanceof(n=n||B("./_stream_duplex"));this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var a=e.highWaterMark,s=e.readableHighWaterMark,r=this.objectMode?16:16384;this.highWaterMark=a||0===a?a:i&&(s||0===s)?s:r,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new l,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(o||(o=B("string_decoder/").StringDecoder),this.decoder=new o(e.encoding),this.encoding=e.encoding)}function u(e){if(n=n||B("./_stream_duplex"),!(this instanceof u))return new u(e);this._readableState=new r(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),s.call(this)}function p(e,t,i,a,s){var r,n,o,l=e._readableState;null===t?(l.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,k(e)}(e,l)):(s||(r=function(e,t){var i;a=t,c.isBuffer(a)||a instanceof h||"string"==typeof t||void 0===t||e.objectMode||(i=new TypeError("Invalid non-string/buffer chunk"));var a;return i}(l,t)),r?e.emit("error",r):l.objectMode||t&&0<t.length?("string"==typeof t||l.objectMode||Object.getPrototypeOf(t)===c.prototype||(n=t,t=c.from(n)),a?l.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):g(e,l,t,!0):l.ended?e.emit("error",new Error("stream.push() after EOF")):(l.reading=!1,l.decoder&&!i?(t=l.decoder.write(t),l.objectMode||0!==t.length?g(e,l,t,!1):T(e,l)):g(e,l,t,!1))):a||(l.reading=!1));return!(o=l).ended&&(o.needReadable||o.length<o.highWaterMark||0===o.length)}function g(e,t,i,a){t.flowing&&0===t.length&&!t.sync?(e.emit("data",i),e.read(0)):(t.length+=t.objectMode?1:i.length,a?t.buffer.unshift(i):t.buffer.push(i),t.needReadable&&k(e)),T(e,t)}Object.defineProperty(u.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),u.prototype.destroy=a.destroy,u.prototype._undestroy=a.undestroy,u.prototype._destroy=function(e,t){this.push(null),t(e)},u.prototype.push=function(e,t){var i,a=this._readableState;return a.objectMode?i=!0:"string"==typeof e&&((t=t||a.defaultEncoding)!==a.encoding&&(e=c.from(e,t),t=""),i=!0),p(this,e,t,!1,i)},u.prototype.unshift=function(e){return p(this,e,null,!0,!1)},u.prototype.isPaused=function(){return!1===this._readableState.flowing},u.prototype.setEncoding=function(e){return o||(o=B("string_decoder/").StringDecoder),this._readableState.decoder=new o(e),this._readableState.encoding=e,this};var m=8388608;function C(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=(m<=(i=e)?i=m:(i--,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i++),i)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0));var i}function k(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(_("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?f.nextTick(w,e):w(e))}function w(e){_("emit readable"),e.emit("readable"),R(e)}function T(e,t){t.readingMore||(t.readingMore=!0,f.nextTick(P,e,t))}function P(e,t){for(var i=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(_("maybeReadMore read 0"),e.read(0),i!==t.length);)i=t.length;t.readingMore=!1}function x(e){_("readable nexttick read 0"),e.read(0)}function S(e,t){t.reading||(_("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),R(e),t.flowing&&!t.reading&&e.read(0)}function R(e){var t=e._readableState;for(_("flow",t.flowing);t.flowing&&null!==e.read(););}function A(e,t){return 0===t.length?null:(t.objectMode?i=t.buffer.shift():!e||e>=t.length?(i=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):i=function(e,t,i){var a;e<t.head.data.length?(a=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):a=e===t.head.data.length?t.shift():i?function(e,t){var i=t.head,a=1,s=i.data;e-=s.length;for(;i=i.next;){var r=i.data,n=e>r.length?r.length:e;if(n===r.length?s+=r:s+=r.slice(0,e),0===(e-=n)){n===r.length?(++a,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i).data=r.slice(n);break}++a}return t.length-=a,s}(e,t):function(e,t){var i=c.allocUnsafe(e),a=t.head,s=1;a.data.copy(i),e-=a.data.length;for(;a=a.next;){var r=a.data,n=e>r.length?r.length:e;if(r.copy(i,i.length-e,0,n),0===(e-=n)){n===r.length?(++s,a.next?t.head=a.next:t.head=t.tail=null):(t.head=a).data=r.slice(n);break}++s}return t.length-=s,i}(e,t);return a}(e,t.buffer,t.decoder),i);var i}function L(e){var t=e._readableState;if(0<t.length)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,f.nextTick(N,t,e))}function N(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function I(e,t){for(var i=0,a=e.length;i<a;i++)if(e[i]===t)return i;return-1}u.prototype.read=function(e){_("read",e),e=parseInt(e,10);var t=this._readableState,i=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return _("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?L(this):k(this),null;if(0===(e=C(e,t))&&t.ended)return 0===t.length&&L(this),null;var a,s=t.needReadable;return _("need readable",s),(0===t.length||t.length-e<t.highWaterMark)&&_("length less than watermark",s=!0),t.ended||t.reading?_("reading or ended",s=!1):s&&(_("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=C(i,t))),null===(a=0<e?A(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),i!==e&&t.ended&&L(this)),null!==a&&this.emit("data",a),a},u.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},u.prototype.pipe=function(i,e){var a=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=i;break;case 1:s.pipes=[s.pipes,i];break;default:s.pipes.push(i)}s.pipesCount+=1,_("pipe count=%d opts=%j",s.pipesCount,e);var t=(!e||!1!==e.end)&&i!==y.stdout&&i!==y.stderr?n:m;function r(e,t){_("onunpipe"),e===a&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,_("cleanup"),i.removeListener("close",p),i.removeListener("finish",g),i.removeListener("drain",l),i.removeListener("error",u),i.removeListener("unpipe",r),a.removeListener("end",n),a.removeListener("end",m),a.removeListener("data",d),c=!0,!s.awaitDrain||i._writableState&&!i._writableState.needDrain||l())}function n(){_("onend"),i.end()}s.endEmitted?f.nextTick(t):a.once("end",t),i.on("unpipe",r);var o,l=(o=a,function(){var e=o._readableState;_("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&v(o,"data")&&(e.flowing=!0,R(o))});i.on("drain",l);var c=!1;var h=!1;function d(e){_("ondata"),(h=!1)!==i.write(e)||h||((1===s.pipesCount&&s.pipes===i||1<s.pipesCount&&-1!==I(s.pipes,i))&&!c&&(_("false write response, pause",a._readableState.awaitDrain),a._readableState.awaitDrain++,h=!0),a.pause())}function u(e){_("onerror",e),m(),i.removeListener("error",u),0===v(i,"error")&&i.emit("error",e)}function p(){i.removeListener("finish",g),m()}function g(){_("onfinish"),i.removeListener("close",p),m()}function m(){_("unpipe"),a.unpipe(i)}return a.on("data",d),function(e,t,i){if("function"==typeof e.prependListener)return e.prependListener(t,i);e._events&&e._events[t]?b(e._events[t])?e._events[t].unshift(i):e._events[t]=[i,e._events[t]]:e.on(t,i)}(i,"error",u),i.once("close",p),i.once("finish",g),i.emit("pipe",a),s.flowing||(_("pipe resume"),a.resume()),i},u.prototype.unpipe=function(e){var t=this._readableState,i={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,i)),this;if(!e){var a=t.pipes,s=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var r=0;r<s;r++)a[r].emit("unpipe",this,i);return this}var n=I(t.pipes,e);return-1===n||(t.pipes.splice(n,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,i)),this},u.prototype.addListener=u.prototype.on=function(e,t){var i=s.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var a=this._readableState;a.endEmitted||a.readableListening||(a.readableListening=a.needReadable=!0,a.emittedReadable=!1,a.reading?a.length&&k(this):f.nextTick(x,this))}return i},u.prototype.resume=function(){var e,t,i=this._readableState;return i.flowing||(_("resume"),i.flowing=!0,e=this,(t=i).resumeScheduled||(t.resumeScheduled=!0,f.nextTick(S,e,t))),this},u.prototype.pause=function(){return _("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(_("pause"),this._readableState.flowing=!1,this.emit("pause")),this},u.prototype.wrap=function(t){var i=this,a=this._readableState,s=!1;for(var e in t.on("end",function(){if(_("wrapped end"),a.decoder&&!a.ended){var e=a.decoder.end();e&&e.length&&i.push(e)}i.push(null)}),t.on("data",function(e){(_("wrapped data"),a.decoder&&(e=a.decoder.write(e)),a.objectMode&&null==e)||(a.objectMode||e&&e.length)&&(i.push(e)||(s=!0,t.pause()))}),t)void 0===this[e]&&"function"==typeof t[e]&&(this[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e));for(var r=0;r<d.length;r++)t.on(d[r],this.emit.bind(this,d[r]));return this._read=function(e){_("wrapped _read",e),s&&(s=!1,t.resume())},this},u._fromList=A}).call(this,B("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":26,"./internal/streams/BufferList":31,"./internal/streams/destroy":32,"./internal/streams/stream":33,_process:25,"core-util-is":8,events:9,inherits:11,isarray:34,"process-nextick-args":24,"safe-buffer":38,"string_decoder/":35,util:3}],29:[function(e,t,i){"use strict";t.exports=r;var a=e("./_stream_duplex"),s=e("core-util-is");function r(e){if(!(this instanceof r))return new r(e);a.call(this,e),this._transformState={afterTransform:function(e,t){var i=this._transformState;i.transforming=!1;var a=i.writecb;if(!a)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,(i.writecb=null)!=t&&this.push(t),a(e);var s=this._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",n)}function n(){var i=this;"function"==typeof this._flush?this._flush(function(e,t){o(i,e,t)}):o(this,null,null)}function o(e,t,i){if(t)return e.emit("error",t);if(null!=i&&e.push(i),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}s.inherits=e("inherits"),s.inherits(r,a),r.prototype.push=function(e,t){return this._transformState.needTransform=!1,a.prototype.push.call(this,e,t)},r.prototype._transform=function(e,t,i){throw new Error("_transform() is not implemented")},r.prototype._write=function(e,t,i){var a=this._transformState;if(a.writecb=i,a.writechunk=e,a.writeencoding=t,!a.transforming){var s=this._readableState;(a.needTransform||s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}},r.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},r.prototype._destroy=function(e,t){var i=this;a.prototype._destroy.call(this,e,function(e){t(e),i.emit("close")})}},{"./_stream_duplex":26,"core-util-is":8,inherits:11}],30:[function(k,w,e){(function(e,t){"use strict";var f=k("process-nextick-args");function d(e){var t=this;this.next=null,this.entry=null,this.finish=function(){(function(e,t,i){var a=e.entry;e.entry=null;for(;a;){var s=a.callback;t.pendingcb--,s(i),a=a.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e})(t,e)}}w.exports=c;var o,u=!e.browser&&-1<["v0.10","v0.9."].indexOf(e.version.slice(0,5))?setImmediate:f.nextTick;c.WritableState=l;var i=k("core-util-is");i.inherits=k("inherits");var a={deprecate:k("util-deprecate")},s=k("./internal/streams/stream"),b=k("safe-buffer").Buffer,v=t.Uint8Array||function(){};var r,n=k("./internal/streams/destroy");function _(){}function l(e,t){o=o||k("./_stream_duplex"),e=e||{};var i=t instanceof o;this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var a=e.highWaterMark,s=e.writableHighWaterMark,r=this.objectMode?16:16384;this.highWaterMark=a||0===a?a:i&&(s||0===s)?s:r,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var n=(this.destroyed=!1)===e.decodeStrings;this.decodeStrings=!n,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){(function(e,t){var i=e._writableState,a=i.sync,s=i.writecb;if(d=i,d.writing=!1,d.writecb=null,d.length-=d.writelen,d.writelen=0,t)n=e,o=i,l=a,c=t,h=s,--o.pendingcb,l?(f.nextTick(h,c),f.nextTick(y,n,o),n._writableState.errorEmitted=!0,n.emit("error",c)):(h(c),n._writableState.errorEmitted=!0,n.emit("error",c),y(n,o));else{var r=m(i);r||i.corked||i.bufferProcessing||!i.bufferedRequest||g(e,i),a?u(p,e,i,r,s):p(e,i,r,s)}var n,o,l,c,h;var d})(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new d(this)}function c(e){if(o=o||k("./_stream_duplex"),!(r.call(c,this)||this instanceof o))return new c(e);this._writableState=new l(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),s.call(this)}function C(e,t,i,a,s,r,n){t.writelen=a,t.writecb=n,t.writing=!0,t.sync=!0,i?e._writev(s,t.onwrite):e._write(s,r,t.onwrite),t.sync=!1}function p(e,t,i,a){var s,r;i||(s=e,0===(r=t).length&&r.needDrain&&(r.needDrain=!1,s.emit("drain"))),t.pendingcb--,a(),y(e,t)}function g(e,t){t.bufferProcessing=!0;var i=t.bufferedRequest;if(e._writev&&i&&i.next){var a=t.bufferedRequestCount,s=new Array(a),r=t.corkedRequestsFree;r.entry=i;for(var n=0,o=!0;i;)(s[n]=i).isBuf||(o=!1),i=i.next,n+=1;s.allBuffers=o,C(e,t,!0,t.length,s,"",r.finish),t.pendingcb++,t.lastBufferedRequest=null,r.next?(t.corkedRequestsFree=r.next,r.next=null):t.corkedRequestsFree=new d(t),t.bufferedRequestCount=0}else{for(;i;){var l=i.chunk,c=i.encoding,h=i.callback;if(C(e,t,!1,t.objectMode?1:l.length,l,c,h),i=i.next,t.bufferedRequestCount--,t.writing)break}null===i&&(t.lastBufferedRequest=null)}t.bufferedRequest=i,t.bufferProcessing=!1}function m(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function h(t,i){t._final(function(e){i.pendingcb--,e&&t.emit("error",e),i.prefinished=!0,t.emit("prefinish"),y(t,i)})}function y(e,t){var i,a,s=m(t);return s&&(i=e,(a=t).prefinished||a.finalCalled||("function"==typeof i._final?(a.pendingcb++,a.finalCalled=!0,f.nextTick(h,i,a)):(a.prefinished=!0,i.emit("prefinish"))),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),s}i.inherits(c,s),l.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(l.prototype,"buffer",{get:a.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(r=Function.prototype[Symbol.hasInstance],Object.defineProperty(c,Symbol.hasInstance,{value:function(e){return!!r.call(this,e)||this===c&&(e&&e._writableState instanceof l)}})):r=function(e){return e instanceof this},c.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},c.prototype.write=function(e,t,i){var a,s,r,n,o,l,c,h,d,u,p,g=this._writableState,m=!1,y=!g.objectMode&&(a=e,b.isBuffer(a)||a instanceof v);return y&&!b.isBuffer(e)&&(s=e,e=b.from(s)),"function"==typeof t&&(i=t,t=null),y?t="buffer":t||(t=g.defaultEncoding),"function"!=typeof i&&(i=_),g.ended?(d=this,u=i,p=new Error("write after end"),d.emit("error",p),f.nextTick(u,p)):(y||(r=this,n=g,l=i,c=!0,h=!1,null===(o=e)?h=new TypeError("May not write null values to stream"):"string"==typeof o||void 0===o||n.objectMode||(h=new TypeError("Invalid non-string/buffer chunk")),h&&(r.emit("error",h),f.nextTick(l,h),c=!1),c))&&(g.pendingcb++,m=function(e,t,i,a,s,r){if(!i){var n=function(e,t,i){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=b.from(t,i));return t}(t,a,s);a!==n&&(i=!0,s="buffer",a=n)}var o=t.objectMode?1:a.length;t.length+=o;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:a,encoding:s,isBuf:i,callback:r,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else C(e,t,!1,o,a,s,r);return l}(this,g,y,e,t,i)),m},c.prototype.cork=function(){this._writableState.corked++},c.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||g(this,e))},c.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},c.prototype._write=function(e,t,i){i(new Error("_write() is not implemented"))},c.prototype._writev=null,c.prototype.end=function(e,t,i){var a=this._writableState;"function"==typeof e?(i=e,t=e=null):"function"==typeof t&&(i=t,t=null),null!=e&&this.write(e,t),a.corked&&(a.corked=1,this.uncork()),a.ending||a.finished||function(e,t,i){t.ending=!0,y(e,t),i&&(t.finished?f.nextTick(i):e.once("finish",i));t.ended=!0,e.writable=!1}(this,a,i)},Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),c.prototype.destroy=n.destroy,c.prototype._undestroy=n.undestroy,c.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,k("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":26,"./internal/streams/destroy":32,"./internal/streams/stream":33,_process:25,"core-util-is":8,inherits:11,"process-nextick-args":24,"safe-buffer":38,"util-deprecate":39}],31:[function(e,t,i){"use strict";var o=e("safe-buffer").Buffer,a=e("util");t.exports=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,i=""+t.data;t=t.next;)i+=e+t.data;return i},e.prototype.concat=function(e){if(0===this.length)return o.alloc(0);if(1===this.length)return this.head.data;for(var t,i,a,s=o.allocUnsafe(e>>>0),r=this.head,n=0;r;)t=r.data,i=s,a=n,t.copy(i,a),n+=r.data.length,r=r.next;return s},e}(),a&&a.inspect&&a.inspect.custom&&(t.exports.prototype[a.inspect.custom]=function(){var e=a.inspect({length:this.length});return this.constructor.name+" "+e})},{"safe-buffer":38,util:3}],32:[function(e,t,i){"use strict";var r=e("process-nextick-args");function n(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var i=this,a=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return a||s?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(n,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(r.nextTick(n,i,e),i._writableState&&(i._writableState.errorEmitted=!0)):t&&t(e)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":24}],33:[function(e,t,i){t.exports=e("events").EventEmitter},{events:9}],34:[function(e,t,i){arguments[4][7][0].apply(i,arguments)},{dup:7}],35:[function(e,t,i){"use strict";var a=e("safe-buffer").Buffer,s=a.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(a.isEncoding===s||!s(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=h,this.end=d,t=3;break;default:return this.write=u,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=a.allocUnsafe(t)}function n(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:-1}function o(e){var t=this.lastTotal-this.lastNeed,i=function(e,t,i){if(128!=(192&t[0]))return e.lastNeed=0,"�".repeat(i);if(1<e.lastNeed&&1<t.length){if(128!=(192&t[1]))return e.lastNeed=1,"�".repeat(i+1);if(2<e.lastNeed&&2<t.length&&128!=(192&t[2]))return e.lastNeed=2,"�".repeat(i+2)}}(this,e,t);return void 0!==i?i:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var i=e.toString("utf16le",t);if(i){var a=i.charCodeAt(i.length-1);if(55296<=a&&a<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,i)}return t}function h(e,t){var i=(e.length-t)%3;return 0===i?e.toString("base64",t):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-i))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function u(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}(i.StringDecoder=r).prototype.write=function(e){if(0===e.length)return"";var t,i;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<e.length?t?t+this.text(e,i):this.text(e,i):t||""},r.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�".repeat(this.lastTotal-this.lastNeed):t},r.prototype.text=function(e,t){var i=function(e,t,i){var a=t.length-1;if(a<i)return 0;var s=n(t[a]);if(0<=s)return 0<s&&(e.lastNeed=s-1),s;if(--a<i)return 0;if(0<=(s=n(t[a])))return 0<s&&(e.lastNeed=s-2),s;if(--a<i)return 0;if(0<=(s=n(t[a])))return 0<s&&(2===s?s=0:e.lastNeed=s-3),s;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=i;var a=e.length-(i-this.lastNeed);return e.copy(this.lastChar,0,a),e.toString("utf8",t,a)},r.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":38}],36:[function(e,t,i){(((i=t.exports=e("./lib/_stream_readable.js")).Stream=i).Readable=i).Writable=e("./lib/_stream_writable.js"),i.Duplex=e("./lib/_stream_duplex.js"),i.Transform=e("./lib/_stream_transform.js"),i.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":26,"./lib/_stream_passthrough.js":27,"./lib/_stream_readable.js":28,"./lib/_stream_transform.js":29,"./lib/_stream_writable.js":30}],37:[function(e,t,i){t.exports=e("./readable").Transform},{"./readable":36}],38:[function(e,t,i){var a=e("buffer"),s=a.Buffer;function r(e,t){for(var i in e)t[i]=e[i]}function n(e,t,i){return s(e,t,i)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?t.exports=a:(r(a,i),i.Buffer=n),r(s,n),n.from=function(e,t,i){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,i)},n.alloc=function(e,t,i){if("number"!=typeof e)throw new TypeError("Argument must be a number");var a=s(e);return void 0!==t?"string"==typeof i?a.fill(t,i):a.fill(t):a.fill(0),a},n.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},n.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return a.SlowBuffer(e)}},{buffer:6}],39:[function(e,t,i){(function(i){function a(e){try{if(!i.localStorage)return!1}catch(e){return!1}var t=i.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}t.exports=function(e,t){if(a("noDeprecation"))return e;var i=!1;return function(){if(!i){if(a("throwDeprecation"))throw new Error(t);a("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],40:[function(e,t,i){arguments[4][11][0].apply(i,arguments)},{dup:11}],41:[function(e,t,i){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],42:[function(u,e,S){(function(a,s){var o=/%[sdj%]/g;S.format=function(e){if(!_(e)){for(var t=[],i=0;i<arguments.length;i++)t.push(l(arguments[i]));return t.join(" ")}i=1;for(var a=arguments,s=a.length,r=String(e).replace(o,function(e){if("%%"===e)return"%";if(s<=i)return e;switch(e){case"%s":return String(a[i++]);case"%d":return Number(a[i++]);case"%j":try{return JSON.stringify(a[i++])}catch(e){return"[Circular]"}default:return e}}),n=a[i];i<s;n=a[++i])b(n)||!h(n)?r+=" "+n:r+=" "+l(n);return r},S.deprecate=function(e,t){if(C(s.process))return function(){return S.deprecate(e,t).apply(this,arguments)};if(!0===a.noDeprecation)return e;var i=!1;return function(){if(!i){if(a.throwDeprecation)throw new Error(t);a.traceDeprecation?console.trace(t):console.error(t),i=!0}return e.apply(this,arguments)}};var e,r={};function l(e,t){var i={seen:[],stylize:c};return 3<=arguments.length&&(i.depth=arguments[2]),4<=arguments.length&&(i.colors=arguments[3]),f(t)?i.showHidden=t:t&&S._extend(i,t),C(i.showHidden)&&(i.showHidden=!1),C(i.depth)&&(i.depth=2),C(i.colors)&&(i.colors=!1),C(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=n),p(i,e,i.depth)}function n(e,t){var i=l.styles[t];return i?"["+l.colors[i][0]+"m"+e+"["+l.colors[i][1]+"m":e}function c(e,t){return e}function p(t,i,a){if(t.customInspect&&i&&P(i.inspect)&&i.inspect!==S.inspect&&(!i.constructor||i.constructor.prototype!==i)){var e=i.inspect(a,t);return _(e)||(e=p(t,e,a)),e}var s=function(e,t){if(C(t))return e.stylize("undefined","undefined");if(_(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string")}if(v(t))return e.stylize(""+t,"number");if(f(t))return e.stylize(""+t,"boolean");if(b(t))return e.stylize("null","null")}(t,i);if(s)return s;var r,n=Object.keys(i),o=(r={},n.forEach(function(e,t){r[e]=!0}),r);if(t.showHidden&&(n=Object.getOwnPropertyNames(i)),T(i)&&(0<=n.indexOf("message")||0<=n.indexOf("description")))return g(i);if(0===n.length){if(P(i)){var l=i.name?": "+i.name:"";return t.stylize("[Function"+l+"]","special")}if(k(i))return t.stylize(RegExp.prototype.toString.call(i),"regexp");if(w(i))return t.stylize(Date.prototype.toString.call(i),"date");if(T(i))return g(i)}var c,h="",d=!1,u=["{","}"];(y(i)&&(d=!0,u=["[","]"]),P(i))&&(h=" [Function"+(i.name?": "+i.name:"")+"]");return k(i)&&(h=" "+RegExp.prototype.toString.call(i)),w(i)&&(h=" "+Date.prototype.toUTCString.call(i)),T(i)&&(h=" "+g(i)),0!==n.length||d&&0!=i.length?a<0?k(i)?t.stylize(RegExp.prototype.toString.call(i),"regexp"):t.stylize("[Object]","special"):(t.seen.push(i),c=d?function(t,i,a,s,e){for(var r=[],n=0,o=i.length;n<o;++n)x(i,String(n))?r.push(m(t,i,a,s,String(n),!0)):r.push("");return e.forEach(function(e){e.match(/^\d+$/)||r.push(m(t,i,a,s,e,!0))}),r}(t,i,a,o,n):n.map(function(e){return m(t,i,a,o,e,d)}),t.seen.pop(),function(e,t,i){if(60<e.reduce(function(e,t){return 0,0<=t.indexOf("\n")&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0))return i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1];return i[0]+t+" "+e.join(", ")+" "+i[1]}(c,h,u)):u[0]+h+u[1]}function g(e){return"["+Error.prototype.toString.call(e)+"]"}function m(e,t,i,a,s,r){var n,o,l;if((l=Object.getOwnPropertyDescriptor(t,s)||{value:t[s]}).get?o=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(o=e.stylize("[Setter]","special")),x(a,s)||(n="["+s+"]"),o||(e.seen.indexOf(l.value)<0?-1<(o=b(i)?p(e,l.value,null):p(e,l.value,i-1)).indexOf("\n")&&(o=r?o.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+o.split("\n").map(function(e){return"   "+e}).join("\n")):o=e.stylize("[Circular]","special")),C(n)){if(r&&s.match(/^\d+$/))return o;(n=JSON.stringify(""+s)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=e.stylize(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=e.stylize(n,"string"))}return n+": "+o}function y(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function b(e){return null===e}function v(e){return"number"==typeof e}function _(e){return"string"==typeof e}function C(e){return void 0===e}function k(e){return h(e)&&"[object RegExp]"===t(e)}function h(e){return"object"==typeof e&&null!==e}function w(e){return h(e)&&"[object Date]"===t(e)}function T(e){return h(e)&&("[object Error]"===t(e)||e instanceof Error)}function P(e){return"function"==typeof e}function t(e){return Object.prototype.toString.call(e)}function i(e){return e<10?"0"+e.toString(10):e.toString(10)}S.debuglog=function(t){if(C(e)&&(e=a.env.NODE_DEBUG||""),t=t.toUpperCase(),!r[t])if(new RegExp("\\b"+t+"\\b","i").test(e)){var i=a.pid;r[t]=function(){var e=S.format.apply(S,arguments);console.error("%s %d: %s",t,i,e)}}else r[t]=function(){};return r[t]},(S.inspect=l).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},S.isArray=y,S.isBoolean=f,S.isNull=b,S.isNullOrUndefined=function(e){return null==e},S.isNumber=v,S.isString=_,S.isSymbol=function(e){return"symbol"==typeof e},S.isUndefined=C,S.isRegExp=k,S.isObject=h,S.isDate=w,S.isError=T,S.isFunction=P,S.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},S.isBuffer=u("./support/isBuffer");var d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function x(e,t){return Object.prototype.hasOwnProperty.call(e,t)}S.log=function(){var e,t;console.log("%s - %s",(e=new Date,t=[i(e.getHours()),i(e.getMinutes()),i(e.getSeconds())].join(":"),[e.getDate(),d[e.getMonth()],t].join(" ")),S.format.apply(S,arguments))},S.inherits=u("inherits"),S._extend=function(e,t){if(!t||!h(t))return e;for(var i=Object.keys(t),a=i.length;a--;)e[i[a]]=t[i[a]];return e}}).call(this,u("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":41,_process:25,inherits:40}],CardExchange:[function(s,e,t){"use strict";cc._RF.push(e,"25b254bNRpA24HW6yFLrzrc","CardExchange");var i=s("HHCommon");cc.Class({extends:i,properties:{touch:{default:null,type:cc.Node},cardspanel:{default:null,type:cc.Node},cardprefab:{default:null,type:cc.Prefab},timer:{default:null,type:cc.Node}},onLoad:function(){},init:function(e,t,i){this.game=e,this.addCards(t),this.addTouchEvent(),this.rtgametimer&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc);var a=s("GameTimer");this.rtgametimer=new a,this.timesrc=this.rtgametimer.runtimerBmpFnt(this,this.timer,i.timer),this.game.game.leftovercards.active=!1,this.game.game.leftovercards3.active=!1},addCards:function(e){this.cardspanel.destroyAllChildren(),this.cardspanel.removeAllChildren();for(var t=0;t<e.length;t++){var i=cc.instantiate(this.cardprefab);i.parent=this.cardspanel;var a=i.getComponent("HHCard");a.setCard(e[t]),a.order()}},addTouchEvent:function(){this.touch.on(cc.Node.EventType.TOUCH_START,this.onCardClick,this),this.cardsArr=this.cardspanel.getChildren()},onCardClick:function(e){var t=e.getLocation(),i=this._beginPos=this.touch.convertToNodeSpaceAR(t);this.processClickCard(i)},processClickCard:function(e){for(var t=this.cardsArr.length-1;0<=t;t--){var i=this.cardsArr[t],a=i.getComponent("HHCard");if(i.getBoundingBox().contains(e))return void a.doselect()}},onExchangeCard:function(){for(var e=[],t=0;t<this.cardspanel.children.length;t++){var i=this.cardspanel.children[t];i.getComponent("HHCard").selected&&e.push(i)}this.game.onExchangeCard(e)},cardReplace:function(e){for(var t=[],i=0;i<this.cardspanel.children.length;i++){var a=this.cardspanel.children[i];a.getComponent("HHCard").selected&&t.push(a)}for(i=0;i<e.length;i++){var s=t[i].getComponent("HHCard");s.setCard(e[i]),s.order(),s.doselect()}var r="";for(i=0;i<this.cardspanel.children.length;i++)r+=this.cardspanel.children[i].getComponent("HHCard").card,i<this.cardspanel.children.length-1&&(r+=",");this.socket().exec("changeevent",{extparams:{changecards:r}})},onExit:function(){this.socket().exec("changeend",{})},onGiveUp:function(){var e=this,t=this.getLanguageText("ARE_YOU_SURE_TO_GIVE_UP");this.checkConfirm(t,function(){e.game.giveUpGame(),e.socket().exec("suicide",{})})},sendGiveUp:function(){},finish:function(){this.cardspanel.destroyAllChildren(),this.cardspanel.removeAllChildren()}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],CardInfo:[function(e,t,i){"use strict";cc._RF.push(t,"06448U8AlBLpKr8eRostq/V","CardInfo");var a=e("ArrayList");t.exports=function(e){this.cardRank=e,this.totalSize=0,this.cards=new a,this.addCard=function(e){this.cards.add(e),this.totalSize++},this.getString=function(){return this.cardRank+"("+this.totalSize+")"},this.clear=function(){this.cards.clear(),this.totalSize=0}},cc._RF.pop()},{ArrayList:"ArrayList"}],Card:[function(e,t,i){"use strict";cc._RF.push(t,"d939egLwZpOQZcTHfJOI/oc","Card"),t.exports=function(e,t){this.suit=e,this.rank=t,this.getString=function(){var e="";switch(this.suit){case 1:e="♦";break;case 2:e="♣";break;case 3:e="♥";break;case 4:e="♠";break;default:e="^"}switch(this.rank){case 11:e+="J";break;case 12:e+="Q";break;case 13:e+="K";break;case 14:e+="A";break;case 15:e+="2";break;case 16:e+="@";break;case 17:e+="$";break;default:e+=this.rank}return e}},cc._RF.pop()},{}],Character:[function(e,t,i){"use strict";cc._RF.push(t,"c34eae9lw1D5IcFDl8HzZMM","Character");var a=e("HHCommon");cc.Class({extends:a,properties:{chsit:{default:null,type:cc.Node},bottom:{default:null,type:cc.Node},sel:{default:null,type:cc.Node},tooltip:{default:null,type:cc.Node}},disUserCharacter:function(e,t,i,a,s,r){var n=6<arguments.length&&void 0!==arguments[6]&&arguments[6],o=parseInt(e);this.characterID=o,this.userid=o,this.chsit.active=!0,this.selCh=this.chsit.children[o%2+1],this.selCh&&(this.selCh.active=!0),this.premium=n,this.pos=t,0<o?this.disChPos("Idle_0"+(parseInt(1e4*Math.random())%3+1)):this.disAvatar(i),t&&(a?(this.sel.active=!0,this.sel.children[0].active=!s,this.sel.children[1].active=s,this.sel.children[2].active=!1):this.sel.active=!1,this.bottom.active=!0,this.bottom.children[1].active=e==cc.global.user.playcharacter,"Characters"==this.node.parent.name&&this.node.on(cc.Node.EventType.MOUSE_ENTER,function(){for(var e=0;e<this.node.parent.children.length;e++)this.hideTimer&&clearTimeout(this.hideTimer),this.node.parent.children[e].getComponent("Character").tooltip.active=!1;this.tooltip.active=!0;var t=this;this.tooltip.hideTimer=setTimeout(function(){t.tooltip&&(t.tooltip.active=!1)},4e3)},this)),this.context=r,this.initTip()},disAvatar:function(e){},disChPos:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=this;if(t.characterID<=0&&(this.selCh=this.chsit.children[1]),this.selCh){var i=this.selCh.getComponent(sp.Skeleton);if(!i)return;i.prevAni||(i.prevAni=""),null==i.lap?i.lap=parseInt(1e4*Math.random())%2:"Victory"==e||"Lost"==e?(i.lap=1e3,setTimeout(function(){i&&(i.lap=void 0,t.disChPos("Idle_0"+(parseInt(1e4*Math.random())%3+1)))},5e3)):0<=i.lap?(e=i.prevAni,i.lap--):(e="",i.lap=parseInt(1e4*Math.random())%2),""==e&&(e=this.getNextAnimation()),i.prevAni=e,i.setAnimation(0,e,!1),i.setCompleteListener(function(){t.disChPos()})}},getNextAnimation:function(){var e="";if(this.selCh&&this.selCh.getComponent(sp.Skeleton)){var t=this.selCh.getComponent(sp.Skeleton).prevAni.split("_");if(2==t.length){var i=(parseInt(t[1].replace("0",""))+1)%4;0==i&&(i=1),e="Idle_0"+i}else e="Idle_01";return e}},onClickSelect:function(){},onClickBuy:function(){},onClickUnlock:function(){},initTip:function(){}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ChargeDialog:[function(e,t,i){"use strict";cc._RF.push(t,"2ff77APVWtNcq8rQs0P1L1T","ChargeDialog");var a=e("HallDialog");cc.Class({extends:a,properties:{username:cc.Label,goldcoins:cc.Label,diamonds:cc.Label,avatar:cc.Sprite,chargebuttons:cc.Node,pointlabel:cc.Label,modes:cc.Node,contents:cc.Node,freescore:cc.Label,item:cc.Prefab,item_large:cc.Prefab,item_sunday:cc.Prefab,hintlabel:cc.Label,vip_bonus:cc.Node,vip_status:cc.Node,vip_contents:cc.Node,loan_dlg:cc.Node,loan_items:cc.Node,loan_alert:cc.Node,vip_bonus_btn:cc.Node},init:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.parent=e,this.rgame=0,this.fgame="ofc",this.curBalPage=1,this.preCeremonyGold=cc.global.user.goldcoins,this.orggolds=parseInt(cc.global.user.goldcoins),this.orgdiamonds=parseInt(cc.global.user.diamonds),this.username.string=cc.global.user.nickname,this.loadAvatar(cc.global.user.avatarurl,cc.global.user.gender),this.updateBalance(),this.updatePointLabel();this.curMode=t,this.updateContentView(),this.onClickRefresh(),(cc.global.updategdstack=this).orgMode=t;var i=JSON.parse(cc.sys.localStorage.getItem("show_vip_bonus"));null==i||0==i?this.vip_bonus_btn.getComponent(cc.Animation).play():this.vip_bonus_btn.getComponent(cc.Animation).stop()},updateTab:function(){var e=0;for(var t in cc.global.goods_type){this.modes.children[e++].getComponent("NotifyTabButton").buttonLabel.string=cc.global.goods_type[t].title}},updateBalance:function(){this.goldcoins.string=this.numformat(parseInt(cc.global.user.goldcoins)),this.diamonds.string=this.numformat(cc.global.user.diamonds),this.orggolds>parseInt(cc.global.user.goldcoins)?this.goldcoins.node.runAction(cc.sequence(cc.scaleTo(.1,.8,.8),cc.scaleTo(.1,1,1))):this.orggolds<parseInt(cc.global.user.goldcoins)&&this.goldcoins.node.runAction(cc.sequence(cc.scaleTo(.1,1.4,1.4),cc.scaleTo(.1,1,1))),this.orgdiamonds>parseInt(cc.global.user.diamonds)?this.diamonds.node.runAction(cc.sequence(cc.scaleTo(.1,.8,.8),cc.scaleTo(.1,1,1))):this.orgdiamonds<parseInt(cc.global.user.diamonds)&&this.diamonds.node.runAction(cc.sequence(cc.scaleTo(.1,1.4,1.4),cc.scaleTo(.1,1,1))),this.orggolds=parseInt(cc.global.user.goldcoins),this.orgdiamonds=parseInt(cc.global.user.diamonds),this.username.string=cc.global.user.nickname+"("+cc.global.user.viplevel+"lv)",this.checkLoanStatus()},checkLoanStatus:function(){var e=cc.global.user.loan_amount;if(0<e&&(1==this.curMode||2==this.curMode)){this.isLastDate()&&(e/=2),this.loan_alert.active=!0;var t="Loan Date";1==cc.global.user.loan_date?t+="day left.":0<cc.global.user.loan_date?t+=" "+cc.global.user.loan_date+"day left.":t+="out.",t+="\n",this.isLastDate()&&(t+="\n "+this.numformat(2*e)+" "+this.numformat(e)),this.loan_alert.children[3].getComponent(cc.Label).string=t,this.loan_alert.children[4].children[0].getComponent(cc.Label).string=this.numformat(e)+""}else this.loan_alert.active=!1},updatePointLabel:function(){0<cc.global.user.walledadded?this.pointlabel.string="Coin: "+this.numformat(parseInt(cc.global.user.walletvalued-cc.global.user.walledadded))+" pt\nPoint: "+this.numformat(parseInt(cc.global.user.walledadded))+" pt\nFree: "+this.numformat(parseInt(cc.global.user.walletfree))+" pt":this.pointlabel.string="Point: "+this.numformat(parseInt(cc.global.user.walletvalued))+" pt\nFree: "+this.numformat(parseInt(cc.global.user.walletfree))+" pt"},onClickClose:function(){cc.global.updategdstack=null,this.parent.closeDialog(this)},onClickMyFriend:function(e,t){this.checkConfirm("Point",function(){cc.sys.isNative&&jsb.reflection.callStaticMethod("org.cocos2dx.javascript.LoginController","launchAppStorPurchase","()V")})},onPurchase:function(e,t){this.loadding();var a=this;cc.global.http.httpPost("/hall/purchaseV2",{purchase_id:t},function(e){if(a.closeloadding(),null!=e){var t=a.parse(e);null!=t&&"00"==t.status?(cc.global.user.walletvalued=t.valued,cc.global.user.walledadded=t.added,cc.global.user.walletfree=t.free,cc.global.goods_list=t.goodslist,a.updatePointLabel(),a.updateTab(),a.updateContentView(),cc.global.event.updatedgd&&cc.global.event.updatedgd(t)):null!=t&&"02"==t.status?(cc.global.user.walletvalued=t.valued,cc.global.user.walledadded=t.added,cc.global.user.walletfree=t.free,a.updatePointLabel(),a.alert(t.msg)):t&&t.msg&&a.alert(t.msg),a.alert(i)}else{var i=a.getLanguageText("ERROR_IN_PROCESSING");a.alert(i)}},function(){a.closeloadding();var e=a.getLanguageText("ERROR_IN_PROCESSING");a.alert(e)},a,5e3)},onClickRefresh:function(e,t){this.loadding();var a=this;cc.global.http.httpPost("/hall/get_ptsv2",{},function(e){if(a.closeloadding(),null!=e){var t=a.parse(e);null!=t&&"00"==t.status&&(cc.global.user.walletvalued=t.valued,cc.global.user.walletfree=t.free,cc.global.user.walledadded=t.added,cc.global.goods_type=t.goodstype,cc.global.goods_list=t.goodslist,a.curMode=t.tab,a.updatePointLabel(),a.updateTab(),a.updateContentView())}else{var i=a.getLanguageText("ERROR_IN_PROCESSING");a.alert(i)}},function(){a.closeloadding();var e=a.getLanguageText("ERROR_IN_PROCESSING");a.alert(e)},a,5e3)},updateContentView:function(){if(this.orgMode=this.curMode,cc.global.goods_type){for(var e in cc.global.goods_type[this.curMode+1]&&(this.hintlabel.string=cc.global.goods_type[this.curMode+1].description),this.contents.destroyAllChildren(),this.contents.removeAllChildren(),cc.global.goods_list){var t,i=cc.global.goods_list[e];if(i.type==this.curMode+1)(t=4==i.type?4999==i.id?cc.instantiate(this.item_sunday):cc.instantiate(this.item_large):cc.instantiate(this.item)).parent=this.contents,t.getComponent("ChargeItem").init(this,i)}for(e=0;e<this.modes.children.length;e++)e==this.curMode?this.modes.children[e].getComponent("NotifyTabButton").init(!0,0,0,cc.hexToColor("#B4B4B4"),cc.hexToColor("#FFEA00")):this.modes.children[e].getComponent("NotifyTabButton").init(!1,0,0,cc.hexToColor("#B4B4B4"),cc.hexToColor("#FFEA00"))}},onUpdateScoreMode:function(e,t){this.curMode!=t&&(this.curMode=parseInt(t),this.updateContentView(),this.checkLoanStatus())},onExchangeDiamond:function(){if(cc.global.user.diamonds<=0)this.alert("");else{var a=this;this.checkConfirm("",function(){a.loadding(),cc.global.http.httpPost("/hall/exchange_diamond",{},function(e){if(a.closeloadding(),null!=e){var t=a.parse(e);null!=t&&"00"==t.status?cc.global.event.updatedgd&&cc.global.event.updatedgd(t):t&&t.msg&&a.alert(t.msg)}else{var i=a.getLanguageText("ERROR_IN_PROCESSING");a.alert(i)}},function(){a.closeloadding();var e=a.getLanguageText("ERROR_IN_PROCESSING");a.alert(e)})})}},curlVipBonus:function(e){var a=this;a.loadding(),cc.global.http.httpPost("/hall/vip_bonus",{id:e},function(e){if(a.closeloadding(),null!=e){var t=a.parse(e);null!=t&&"00"==t.status?a.updateVipBonuses(t.vip_bouns):t&&t.msg&&a.alert(t.msg)}else{var i=a.getLanguageText("ERROR_IN_PROCESSING");a.alert(i)}},function(){a.closeloadding();var e=a.getLanguageText("ERROR_IN_PROCESSING");a.alert(e)})},onClickVipBonus:function(){this.vip_bonus.active=!0,this.curlVipBonus(0),cc.sys.localStorage.setItem("show_vip_bonus",JSON.stringify(!0)),this.vip_bonus_btn.getComponent(cc.Animation).stop()},onClickShowLoanDlg:function(){var e=cc.global.user.loan_amount;if(0<e){var t="";this.isLastDate()&&(e/=2,t=" "+this.numformat(2*e)+" "+this.numformat(e)+"\n");var i=this;this.checkConfirm(t+" "+this.numformat(e),function(){i.onPurchase(null,1)})}else this.loan_dlg.active=!0,this.loan_items.children[1].active=9<=cc.global.user.viplevel,this.loan_items.children[2].active=10<=cc.global.user.viplevel,this.loan_items.children[3].active=13<=cc.global.user.viplevel},onClickCloseVipBonus:function(){this.vip_bonus.active=!1,this.loan_dlg.active=!1},updateVipBonuses:function(e){this.vipdata=e,this.vip_status.getComponent("VIPStatus").init();for(var t=0;t<this.vip_contents.children.length;t++)e&&null!=e[t]?(this.vip_contents.children[t].active=!0,this.vip_contents.children[t].children[0].children[0].getComponent(cc.Label).string=e[t].level+"lv",this.vip_contents.children[t].children[2].children[0].getComponent(cc.Label).string=this.numformat(e[t].goldcoins),this.vip_contents.children[t].children[2].children[1].getComponent(cc.Label).string=this.numformat(e[t].diamonds),1==e[t].status&&(this.vip_contents.children[t].children[1].children[0].vip_id=t),this.vip_contents.children[t].children[1].children[0].active=1==e[t].status,this.vip_contents.children[t].children[1].children[1].active=2==e[t].status,this.vip_contents.children[t].children[1].children[2].active=3==e[t].status):this.vip_contents.children[t].active=!1},onClickGetVipBonus:function(e,t){this.curlVipBonus(e.target.vip_id)},onClickLoanStar:function(e,t){this.loan_dlg.active=!0;var a=this;this.checkConfirm("Star "+this.numformat(t),function(){a.loadding(),cc.global.http.httpPost("/hall/loan_amount",{amount:t},function(e){if(a.closeloadding(),null!=e){var t=a.parse(e);null!=t&&"00"==t.status?a.onClickCloseVipBonus():t&&t.msg}else{var i=a.getLanguageText("ERROR_IN_PROCESSING");a.alert(i)}},function(){a.closeloadding();var e=a.getLanguageText("ERROR_IN_PROCESSING");a.alert(e)})},function(){})},onClickPurchaseNumber:function(){var a=this;cc.loader.loadRes("prefab/main/PurchaseNumber",cc.Prefab,function(e,t){if(!e){var i=cc.instantiate(t);i.getComponent("PurchaseNumber").init(a),i.parent=a.node}})}}),cc._RF.pop()},{HallDialog:"HallDialog"}],ChargeItem:[function(e,t,i){"use strict";cc._RF.push(t,"72997+sL1VKIos/t/sWj6jd","ChargeItem");var a=e("HHCommon");cc.Class({extends:a,properties:{version:{default:0,type:cc.Integer},base:cc.Node,countdown:cc.Node,opentime:cc.Label,closetime:cc.Label,item_name:cc.Label,title:cc.Label,diamonds:cc.Node,goldcoins:cc.Node,vip_score:cc.Node,price:cc.Label,badge:cc.Node,badge_label:cc.Label,buttons:cc.Node,old_price:cc.Node,remain:cc.Label,available:cc.Label},onLoad:function(){},init:function(e,t){if((t.old_price<=0||isNaN(t.old_price))&&(t.old_price=t.price),this.parent=e,1<(this.data=t).ratio?(0<t.per_vip&&this.item_name&&(this.item_name.string=t.per_vip+"Vip"),0<t.per_vip&&this.available&&(this.available.string="Vip "+t.per_vip),this.badge.active=!0,this.badge_label.string="+"+Math.round(100*(t.ratio-1))+"%",2<=t.ratio&&(t.ratio-parseInt(t.ratio)==0?this.badge_label.string=parseInt(t.ratio)+"x":this.badge_label.string=t.ratio.toFixed(1)+"x"),this.base.children[0].active=!1):(this.badge.active=!1,this.goldcoins.children[2].active=!1,this.diamonds.children[2].active=!1),1==this.version)return 0==t.max_count?this.remain.string="No Limit":this.remain.string="Count "+t.max_count,t.sold?this.buttons&&(this.buttons.children[0].active=!1,this.buttons.children[1].active=!0):this.buttons&&(this.buttons.children[0].active=!0,this.buttons.children[1].active=!1),this.opentime.string=" "+this.getDateFromTimestamp(this.data.start_time,!0).replace("\n"," ")+" - 23:59:59",t.price!=t.old_price?(this.old_price.active=!0,this.old_price.getComponent(cc.Label).string=this.numformat(t.old_price)+"pt"):this.old_price.active=!1,this.price.string=this.numformat(t.price)+"pt",void(0==t.goldcoins?this.title.string="  "+t.diamonds:0==t.diamonds?this.title.string="  "+t.goldcoins/1e4+"0k":this.title.string=t.goldcoins/1e4+"0k + "+t.diamonds);0==t.goldcoins&&0<t.diamonds?(this.diamonds.active=!0,this.goldcoins.active=!1,this.diamonds.children[0].getComponent(cc.Label).string=this.numformat(t.diamonds)+""):(this.diamonds.active=!1,this.goldcoins.active=!0,this.goldcoins.children[1].getComponent(cc.Label).string=this.numformat(t.goldcoins)+""),t.price!=t.old_price?(this.old_price.active=!0,this.old_price.getComponent(cc.Label).string=this.numformat(t.old_price)+"pt"):this.old_price.active=!1,this.price.string=this.numformat(t.price)+"pt"},update:function(){if(1!=this.version&&this.data){if(0==this.data.start_time||this.reviseTimezone(this.data.start_time)<cc.global.logintime)this.base.opacity=255,this.countdown.active=!1;else if(0==this.version){if(this.base.opacity=40,this.countdown.active=!0,864e5<(t=this.reviseTimezone(this.data.start_time)-cc.global.logintime)){var e=Math.ceil(t/864e5);this.opentime.string=e+""}else this.opentime.string=0<t?this.remaintime(t)+"\n":""}if(0<this.data.end_time&&this.reviseTimezone(this.data.end_time)>cc.global.logintime){var t;if(864e5<(t=this.reviseTimezone(this.data.end_time)-cc.global.logintime)){var i=new Date(this.data.end_time);this.closetime.string=i.getMonth()+1+"."+i.getDate()}else this.closetime.string=0<t?"Today":"";this.closetime.node.active=!0}else this.closetime.node.active=!1;if(1==this.version){i=new Date(this.data.end_time);var a=new Date(this.data.start_time);this.closetime.string=a.getMonth()+1+". "+a.getDate()+"- "+(i.getMonth()+1)+". "+i.getDate(),this.closetime.node.active=!0}}},onClickPurchase:function(){if(!(0<cc.global.user.loan_amount)||2!=this.data.type&&3!=this.data.type)if(0!=this.data.start_time&&this.reviseTimezone(this.data.start_time)>cc.global.logintime){var e=this.reviseTimezone(this.data.start_time)-cc.global.logintime,t="";864e5<e?t=Math.floor(e/864e5)+"day after.":0<e&&(t=this.genRemainTimeString(e)+"day after."),this.alert(t)}else if(this.data.id<=0)this.alert("Error.");else{t="";if(this.data.is_free?t+="Free ":t+="Point ",t+=this.numkrformat(this.data.price)+"pt ",0<this.data.goldcoins&&0<this.data.diamonds){var i=this.data.goldcoins;t+="coin "+this.numkrformat(i)+" "+this.data.diamonds}else if(0<this.data.goldcoins){i=this.data.goldcoins;t+="coin "+this.numkrformat(i)}else t+=""+this.data.diamonds;var a=this;this.checkConfirm(t,function(){a.parent.onPurchase(null,a.data.id)},function(){})}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ChatItem:[function(e,t,i){"use strict";cc._RF.push(t,"4418dZFeHdKxJcGbxzyRxvf","ChatItem");var a=e("HHCommon");cc.Class({extends:a,properties:{index:{default:null,type:cc.Label},message:{default:null,type:cc.Label}},init:function(e,t,i,a,s){this.message.string=e,this.index.string=t+".",this.context=i,this.page=a,this.phraseIdx=s},onAddchatHistory:function(e){var t=JSON.parse(cc.sys.localStorage.getItem("chat_history"));null!=t&&0!=t||(t=[]);for(var i=0;i<t.length;i++)if(t[i]==e){t.splice(i,1);break}9<t.length&&t.splice(0,1),t[t.length]=e,cc.sys.localStorage.setItem("chat_history",JSON.stringify(t))},onClickMessage:function(){if(this.onAddchatHistory(this.phraseIdx),this.ready()){var e=this.socket(),t={};t.extparams={chat:this.phraseIdx},e.exec("sendchat",t),null!=this.context&&this.page.getComponent("Chat").onclickRestPart()}},onItemSelected:function(){var e=cc.scaleTo(.1,.9,.9);this.node.runAction(e)},onItemReleased:function(){var e=cc.scaleTo(.1,1,1);this.node.runAction(e)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],Chat:[function(e,t,i){"use strict";cc._RF.push(t,"ad8ed4pcJZB1pfGQ3MRBhGo","Chat");var a=e("HHCommon");cc.Class({extends:a,properties:{version:{default:0,type:cc.Integer},base:{default:null,type:cc.Node},search:{default:null,type:cc.EditBox},searchlabel:{default:null,type:cc.Label},content:{default:null,type:cc.Node},chatitem:{default:null,type:cc.Prefab},tabs:cc.Node},onLoad:function(){this.closing=!0,this.base.getComponent(cc.Animation).play("show_dlg");var t=this;switch(this.base.getComponent(cc.Animation).on("finished",function(e){"hide_dlg"==e.target.name&&(t.context.chatpage.destroy(),t.context.ischat=!1),t.closing=!1}),cc.global.audio.playDialogAud(),cc.global.theme.background){case 1:this.base.children[0].children[0].color=this.base.children[1].color=cc.hexToColor("#2f96f0");break;case 2:this.base.children[0].children[0].color=this.base.children[1].color=cc.hexToColor("#fbc279")}},init:function(e,t){this.context=e,null!=(t=cc.sys.localStorage.getItem("chat_dialog_tab"))&&0!=t||(t=0);var i=JSON.parse(cc.sys.localStorage.getItem("chat_history"));null!=i&&0!=i||(i=[]),0==i.length&&0==t&&(t=1),this.curTab=t,this.initContent()},onclickRestPart:function(){this.closing||(this.base.getComponent(cc.Animation).play("hide_dlg"),this.closing=!0)},onChatTab:function(e,t){this.seltab!=t&&(cc.sys.localStorage.setItem("chat_dialog_tab",t),this.seltab=t,this.search.string="",this.curTab=t,this.initContent())},initContent:function(){this.content.destroyAllChildren();var e=1;if(1==this.version)for(var t=0;t<this.tabs.children.length;t++)t==this.curTab?this.tabs.children[t].getComponent("NotifyTabButton").init(!0,0):this.tabs.children[t].getComponent("NotifyTabButton").init(!1,0);if(0==this.curTab){var i=JSON.parse(cc.sys.localStorage.getItem("chat_history"));null!=i&&0!=i||(i=[]);for(t=i.length-1;0<=t;t--){var a=cc.global.chat[i[t]];(s=cc.instantiate(this.chatitem)).parent=this.content,s.getComponent("ChatItem").init(a.phrase,e,this.context,this.context.chatpage,i[t]),10==++e&&(e=0)}}else for(t=0;t<cc.global.chat.length;t++){var s;if(cc.global.chat[t].type==this.curTab)(s=cc.instantiate(this.chatitem)).parent=this.content,s.getComponent("ChatItem").init(cc.global.chat[t].phrase,e,this.context,this.context.chatpage,t),10==++e&&(e=0)}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ChessBegin:[function(e,t,i){"use strict";cc._RF.push(t,"afb720Z7QVIT6nukAZx6jV6","ChessBegin");var a=e("HHCommon"),s=e("ChessEngine"),o={};cc.Class({extends:a,properties:{chess_player:{default:null,type:cc.Prefab},chess_player_board:{default:null,type:cc.Prefab},opponent_playersboard:{default:null,type:cc.Node},self_playersboard:{default:null,type:cc.Node},statusboard:{default:null,type:cc.Node},boardclaim:{default:null,type:cc.Sprite},claimatlas:{default:null,type:cc.SpriteAtlas},towerboard:{default:null,type:cc.Node},roomdata:{default:null,type:cc.Node},pojindeclare:{default:null,type:cc.Node},turntimer:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},observer:{default:null,type:cc.Prefab},observerbench:{default:null,type:cc.Node},emodlg:{default:null,type:cc.Prefab},chat:{default:null,type:cc.Prefab},chatsearch:{default:null,type:cc.Prefab},userinfodlg:{default:null,type:cc.Prefab},btn_enter:{default:null,type:cc.Node},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},illegalconfirm:{default:null,type:cc.Prefab},btn_find_empty:{default:null,type:cc.Node},pcs_cell_pref:{default:null,type:cc.Prefab},timerboard:{default:null,type:cc.Node},roomrankdialog:{default:null,type:cc.Prefab},finishAct:{default:null,type:cc.Node},controlPanel:{default:null,type:cc.Node},leftPanel:{default:null,type:cc.Node},rightPanel:{default:null,type:cc.Node},errorMove:{default:null,type:cc.Node},lblTurnCount:{default:null,type:cc.Label},btnSfx:{default:null,type:cc.Node}},onLoad:function(){this.initEventCallback(),cc.game.setFrameRate(60),cc.global.amObserve="no",this.play_status=0,this.playerlist=new Array,this.playerboardlist=new Array,this.observerlist=new Array,this.posBaseIdx=0,this.inited=!1,this.playerBoardSlotPos=[cc.v2(0,-115),cc.v2(0,115)],this.notReplay=!0,this.startGameTimer=null,this.endGameTimer=null,this.pangolds=0,this.isGamePlaying=!1,this.pickedPiece=null,this.turnSeat=0,this.curTurn=0,this.isNewRoom=!0,o=new s,null!=cc.global&&(this.initgame(),""!=cc.global.user.roomid&&(this.recovery(),this.isNewRoom=!1)),this.pojindeclare.getComponent("PojinDeclare").init(this,o),cc.global.watchReplayData.onReplay&&this.prepareReplay(),this.setEtcKeyBoardEvent(),this.turntimer.getComponent("TurnTimer").setParent(this),this.toggleControlPanel()},initgame:function(){var t=this;this.finishAct&&(this.finishAct.active=!1);var e=this.socket();this.map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("banker",this.banker_event),this.map("play",this.play_event),this.map("cdraw",this.cdraw_event),this.map("back",this.beg_event),this.map("camp",this.camp_event),this.map("playchess",this.playchess_event),this.map("move_error",this.move_error_event),this.map("rer",this.recovery_event),this.map("selemoticon",this.emoticon_event),this.map("sendchat",this.sendchat_event),this.map("callplayer",this.callplayer_event),this.map("sl",this.sendlines_event),this.map("allcards",this.allcards_event),e.on("command",function(e){t.inited&&t.route(e.command)(e,t)});var i={};"NormalCreate"==cc.global.user.roomInType?(null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i)):"NormalJoin"==cc.global.user.roomInType?(i.extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i)):"NormalObserve"==cc.global.user.roomInType&&(i.extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i)),this.inited=!0,this.loadding()},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},prepareReplay:function(){this.notReplay=!1,cc.global.amObserve="yes",this.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),this.replay_bar.active=!0,this.replayStep="ready_room",this.replaySeq=0,this.replayPrevCmd="",this.goReplay()},stopAllClock:function(){this.pojindeclare.active&&this.pojindeclare.getComponent("PojinDeclare").pauseAllTimer(),this.turntimer.getComponent("TurnTimer").pauseAllTimer()},resumeAllClock:function(){this.pojindeclare.active&&this.pojindeclare.getComponent("PojinDeclare").resumeAllTimer(),this.turntimer.getComponent("TurnTimer").resumeAllTimer()},pauseReplayTimer:function(){this.stopAllClock(),clearTimeout(this.replayTimer)},resumeReplayTimer:function(){var e=this;this.resumeAllClock(),this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay/cc.global.watchReplayData.replaySpeedX)},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):this.togglePlayToPause()},togglePlayToPause:function(){this.replayTimer&&clearTimeout(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replay_bar.children[0].opacity=20,this.pauseReplayTimer()},replayPrevMove:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.replayEventProcess(!0))},replayNextMove:function(){this.togglePlayToPause(),this.replayEventProcess(!0)},onClickReplaySpeedUp:function(){if(cc.global.watchReplayData.replaySpeedX<5){cc.global.watchReplayData.replaySpeedX++;var e=this.getLanguageText("REPLAY_TIME");this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()}this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){if(1<cc.global.watchReplayData.replaySpeedX){cc.global.watchReplayData.replaySpeedX--;var e=this.getLanguageText("REPLAY_TIME");this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()}this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},cleanAllPlayers:function(){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].destroy(),this.playerboardlist[e].destroy();this.playerlist.splice(0,this.playerlist.length),this.playerboardlist.splice(0,this.playerboardlist.length),this.playerlist=new Array,this.playerboardlist=new Array,this.opponent_playersboard&&(this.opponent_playersboard.destroyAllChildren(),this.opponent_playersboard.removeAllChildren()),this.self_playersboard&&(this.self_playersboard.destroyAllChildren(),this.self_playersboard.removeAllChildren()),this.removeAllPieces()},replayEventProcess:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.play_history&&this.play_history[this.replaySeq]){this.replayTimeDelay=0;var t=!1;switch(this.replayStep){case"ready_room":this.cleanAllPlayers(),this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"camp":t=!0,this.camp_event(i,this);break;case"play":t=!0,this.play_event(i,this);break;case"playchess":t=!0,this.playchess_event(i,this);break;case"cdraw":t=!0,this.cdraw_event(i,this);break;case"sl":t=!0,this.sendlines_event(i,this);break;case"allcards":t=!0,this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.emoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"players":this.players_event(i,this)}this.replayPrevCmd=i.command}this.play_history[this.replaySeq+1]&&""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay+=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,e&&!t&&this.replayEventProcess(!0)}},goReplay:function(){var e=this;this.replayEventProcess(),this.play_history[this.replaySeq]?this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay):(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=20,this.replayTimeDelay=0,this.replayPrevCmd="",this.pauseReplayTimer())},setEtcKeyBoardEvent:function(){var i=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e,t){switch(e){case cc.KEY.space:i.processReadyState();break;case cc.KEY.escape:case cc.KEY.back:if(!i.isemoticon&&!i.ischat)return void i.onclickBack();if(i.isemoticon)return null!=i.emoticonpage&&i.emoticonpage.destroy(),void(i.isemoticon=!1);if(i.ischat)return null!=i.chatpage&&i.chatpage.destroy(),void(i.ischat=!1);i.onclickBack()}}},i.node)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;0<e&&(this.socket().exec("selemoticon",{extparams:{emoticon:e}}),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1))},onCtrlKeyDown:function(e){switch(event.keyCode){case cc.KEY.escape:case cc.KEY.back:return void this.onclickBack()}},processReadyState:function(){this.is_team_game||2!=this.playerlist.length||this.sendState(),this.is_team_game&&4==this.playerlist.length&&this.sendState()},joinroom_event:function(e,t){cc.global.user.selplayway=e.name,t.roomid=e.id,t.is_team_game=3==e.cond,t.panScore=cc.global.curPlaywayScore=e.score;var i=t.getLanguageText("ROOM_0");switch(t.roomdata.children[0].getComponent(cc.Label).string=e.id+i,t.roomdata.children[1].getComponent(cc.Label).string="("+t.numformat(e.score)+"pt)",cc.global.gamestatus){case"ready":cc.global.gamestatus="waiting",t.is_team_game?(4==e.playerlist.length&&(cc.global.gamestatus="playing"),t.timerboard.children[1].active=!0):(2==e.playerlist.length&&(cc.global.gamestatus="playing"),t.timerboard.children[0].active=!0,t.timerboard.children[1].active=!1),t.players_event(e,t);break;case"waiting":t.players_event(e,t);break;case"playing":cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)}t.closeloadding()},players_event:function(e,t){t.is_team_game?4==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting"):2==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)if(e.observerlist[a].id==cc.global.user.id){i=!1;break}if(i&&t.notReplay)return cc.global.outReasonMsg=e.msg,void t.exitPlay();t.observer_event(e,t),t.isBoardPlayersChanged(e.playerlist)&&(t.startGameTimer&&clearTimeout(t.startGameTimer),t.endGameTimer&&clearTimeout(t.endGameTimer),t.players_engine(e,t))},players_engine:function(e){this.removeBoardPlayers(e.playerlist),this.removeAllPieces(),this.initEngagedPieces();var t=this.posBaseIdx,i=2;this.is_team_game&&(i=4,this.playerBoardSlotPos=[cc.v2(-200,-175),cc.v2(200,-175),cc.v2(200,220),cc.v2(-200,220)]);for(var a=0;a<e.playerlist.length;a++)"no"==cc.global.amObserve&&e.playerlist[a].id==cc.global.user.id&&(this.posBaseIdx=i-a);for(a=0;a<e.playerlist.length;a++){if(t=(e.playerlist[a].seatid=a)+this.posBaseIdx,this.playerexist(e.playerlist[a])){var s=this.getPlayer(e.playerlist[a].id),r=this.getPlayerBoard(e.playerlist[a].id);r.node.setPosition(this.playerBoardSlotPos[t%i]),s.joinorder=a,s.seatid=r.seatid=t%i,s.setColorForSeat(),s.layoutForSeat(),r.layoutForSeat()}else{var n=cc.instantiate(this.chess_player);"yes"!=cc.global.amObserve?e.playerlist[a].id==cc.global.user.id?n.parent=this.self_playersboard:n.parent=this.opponent_playersboard:n.parent=t%i==0?this.self_playersboard:this.opponent_playersboard,n.getComponent("ChessPlayer").init(this,e.playerlist[a],t%i,a,this.is_team_game,a),this.playerlist.push(n);var o=cc.instantiate(this.chess_player_board);o.parent=this.statusboard,o.setPosition(this.playerBoardSlotPos[t%i]),o.getComponent("ChessPlayerBoard").init(this,e.playerlist[a],t%i,a),this.playerboardlist.push(o)}t++}1<=e.playerlist.length&&(this.setWaitingState(),this.cleanAfterAllCards()),this.is_team_game&&4==e.playerlist.length&&this.setReadyState(),this.is_team_game||2!=e.playerlist.length||this.setReadyState(),this.is_team_game?"yes"==cc.global.amObserve&&e.playerlist.length<4?1==cc.global.championMode?this.btn_enter&&(this.btn_enter.active=!1):0==cc.global.championMode&&this.notReplay&&this.btn_enter&&(this.btn_enter.active=!0):this.btn_enter&&(this.btn_enter.active=!1):"yes"==cc.global.amObserve&&e.playerlist.length<2?1==cc.global.championMode?this.btn_enter&&(this.btn_enter.active=!1):0==cc.global.championMode&&this.notReplay&&this.btn_enter&&(this.btn_enter.active=!0):this.btn_enter&&(this.btn_enter.active=!1),this.showWaitingTimer()},setWaitingState:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ChessPlayerBoard");t&&t.setState("Pending")}},setReadyState:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ChessPlayerBoard");if(t){var i=this.getLanguageText("READY_0")+"?";t.setState(i)}}},observer_event:function(e,t){t.observerbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i],t),a.getComponent("Observer").nickname.node.active=!1,a.getComponent("Observer").right=!0,a.parent=t.observerbench,t.observerlist[i]=a}},removeBoardPlayers:function(e){for(var t=0;t<this.playerlist.length;t++){for(var i=this.playerlist[t].getComponent("ChessPlayer"),a=!1,s=0;s<e.length;s++)if(i.userdata.id==e[s].id){a=!0;break}a||(this.playerlist[t].destroy(),this.playerlist.splice(t,1),this.playerboardlist[t].destroy(),this.playerboardlist.splice(t,1))}},isBoardPlayersChanged:function(e){if(0==this.playerlist.length&&0!=e.length)return!0;if(this.playerlist.length!=e.length)return!0;for(var t=0;t<e.length;t++)if(!this.getPlayer(e[t].id))return!0;return!1},playerexist:function(e){for(var t=0;t<this.playerlist.length;t++)if(null!=this.playerlist[t]&&this.playerlist[t].getComponent("ChessPlayer").userdata.id==e.id)return!0;return!1},initGameboard:function(){if(this.pcs_cell_pref){this.towerboard.destroyAllChildren(),this.towerboard.removeAllChildren();for(var e=0;e<o.boardHeight;e++)for(var t=0;t<o.boardWidth;t++){var i=cc.instantiate(this.pcs_cell_pref);i.parent=this.towerboard,i.getComponent("ChessPiece").init(this,o.status[e][t],e,t),i.getComponent(cc.Animation).play()}}this.closeloadding()},piecePicked:function(e,t,i,a){this.pickedPiece={id:e,r:t,c:i,cell:a},this.hidePosHint();var s=[];switch(e){case 1:case 10:case 11:s=o.MovablePos_b1(t,i);break;case 2:case 3:s=o.MovablePos_b2(t,i);break;case 4:case 5:s=o.MovablePos_b4(t,i);break;case 6:case 7:s=o.MovablePos_b6(t,i);break;case 8:case 9:s=o.MovablePos_b8(t,i);break;case 12:case 13:case 14:case 15:case 16:s=o.MovablePos_b12(t,i)}this.showGoAble(s)},makePieceNormal:function(){for(var e=0;e<this.towerboard.children.length;e++){var t=this.towerboard.children[e].getComponent("ChessPiece");t&&(t.hidePosHint(),t.toggleShadow(!1),t.toggleDropFade(!1))}},hidePosHint:function(){for(var e=0;e<this.towerboard.children.length;e++){var t=this.towerboard.children[e].getComponent("ChessPiece");t&&(t.hidePosHint(),t.toggleShadow(!1))}},showGoAble:function(e){for(var t=0;t<e.length;t++){var i=e[t][0],a=e[t][1],s=this.getPieceByRowCol(i,a);s&&s.showPosHint()}},unpickAllPieces:function(){for(var e=0;e<this.towerboard.children.length;e++)if(this.towerboard.children[e].isPicked){var t=this.towerboard.children[e].getComponent("ChessPiece");t&&t.unpick()}},onClickMarble:function(){this.hidePosHint(),this.unpickAllPieces()},sendMovePiece:function(e,t){this.socket().exec("playchess",{extparams:{pn:this.pickedPiece.id,srow:this.pickedPiece.r,scol:this.pickedPiece.c,frow:e,fcol:t,roomid:this.roomid,localturn:this.turnCount}})},onClickSkipMove:function(){"no"==cc.global.amObserve&&this.isGamePlaying&&0==this.turnSeat&&this.socket().exec("playchess",{extparams:{roomid:this.roomid,localturn:this.turnCount}}),this.toggleControlPanel()},onClickSfx:function(){var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==e&&(e=!0),e?cc.global.audio.pauseAll():cc.global.audio.resumeAll(),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!e)),this.toggleControlPanel()},movePiece:function(e,t,i){if(this.makePieceNormal(),this.pickedPiece){var a=o.movePiece(this.pickedPiece.id,this.pickedPiece.r,this.pickedPiece.c,e,t);a?(this.addEngaged(a.id,this.getPieceByRowCol(a.r,a.c).node),this.addEmptyPiece(this.pickedPiece.id,this.pickedPiece.r,this.pickedPiece.c)):(this.getPieceByRowCol(e,t).toggleShadow(this.pickedPiece.id,!0),this.getPieceByRowCol(e,t).setCellPosition(this.pickedPiece.r,this.pickedPiece.c,!1)),this.pickedPiece.cell.setCellPosition(e,t,!0),this.pickedPiece=null}},addEmptyPiece:function(e,t,i){var a=cc.instantiate(this.pcs_cell_pref);a.parent=this.towerboard,a.getComponent("ChessPiece").init(this,0,t,i),a.getComponent("ChessPiece").toggleShadow(e,!0)},undoEngage:function(e,t,i){this.makePieceNormal();var a=this.getPieceByRowCol(t,i);a&&a.getComponent("ChessPiece").init(this,e,t,i),o.setPieceRowCol(e,t,i)},addEngaged:function(e,t){t&&(t.destroy(),t.removeFromParent())},getPieceByRowCol:function(e,t){for(var i=0;i<this.towerboard.children.length;i++){var a=this.towerboard.children[i].getComponent("ChessPiece");if(a&&a.row==e&&a.col==t)return a}},showMatchCareer:function(e){},hideMatchCareer:function(){},sendState:function(){this.getPlayerBoard(cc.global.user.id).isReady()||this.socket().exec("ready",{extparams:{roomid:this.roomid}})},userready_event:function(e,t){cc.global.audio.playEffectAud("ready");var i=t.getPlayerBoard(e.userid);if(i){var a=t.getLanguageText("PREPARED_0");i.setState(a),i.startTimer(30)}},banker_event:function(e,t){t.closeloadding(),t.removeAllPieces(),t.hideAllStatus(),t.pojindeclare.getComponent("PojinDeclare").setPlayers(t.playerlist),t.pojindeclare.getComponent("PojinDeclare").showPojin(e.userid);for(var i=t.getPlayer(e.userid),a=0;a<t.playerlist.length;a++)t.playerlist[a].getComponent("ChessPlayer").hideBanker();i&&i.showBanker(),t.isGamePlaying=!0,t.isNewRoom=!1},play_event:function(e,t){t.closeConfirm(),t.makePieceNormal(),t.unpickAllPieces(),t.pojindeclare.getComponent("PojinDeclare").hidePojin(),t.isGamePlaying=!0;var i=t.getPlayer(e.userid);t.curTurn=i.seatid,i&&(i.seatid%2==0?(t.turnSeat=0,t.giveTurn1(e.extdata.ftime),i.joinorder%2==0?o.InitArrangement(e.extdata.fc,e.extdata.sc):o.InitArrangement(e.extdata.sc,e.extdata.fc)):(t.turnSeat=1,t.giveTurn2(e.extdata.ftime),i.joinorder%2==0?o.InitArrangement(e.extdata.sc,e.extdata.fc):o.InitArrangement(e.extdata.fc,e.extdata.sc)),t.initGameboard(),t.togglePcsTurn(t.turnSeat))},cdraw_event:function(e,t){if(e.userid==cc.global.user.id)t.checkConfirm("Are you agree to be draw?",function(){t.socket().exec("draw",{extparams:{draw:"y"}})},function(){},null,{isChess:!0});else{var i=t.getPlayer(cc.global.user.id);i&&i.toggleWaitingPeace(!0)}},onClickBeg:function(){if(this.isGamePlaying&&1==this.turnSeat&&!(cc.global.user.goldcoins<this.panScore)){var e=this,t=this.controlPanel.children[2].children[0],i=this.controlPanel.children[2].children[1];1==t.active&&e.checkConfirm("You user coin for backward.Are you sure?",function(){e.socket().exec("back",{}),t.active=!1,i.active=!0,setTimeout(function(){t.active=!0,i.active=!1},1e4)},function(){},10,{isChess:!0})}},beg_event:function(e,t){if(e.userid==cc.global.user.id)t.checkConfirm("Oposite request backward.\nYou can get coin. Agree?",function(){t.socket().exec("aback",{extparams:{aback:"y"}})},function(){},null,{isChess:!0});else{var i=t.getPlayer(cc.global.user.id);i&&i.toggleWaitingBeg(!0)}},camp_event:function(e,t){t.pojindeclare.getComponent("PojinDeclare").turnChanged(e.userid,e.extdata.camp,e.extdata.gong,20,e.extdata.nextid),t.pojindeclare.getComponent("PojinDeclare").setInitialTime(e.extdata.ftime)},begPayGet:function(){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("ChessPlayer");t&&(t.seatid==this.turnSeat?t.payOrGetBegMoney(!0):t.payOrGetBegMoney(!1))}},playchess_event:function(e,t){if(!t.notReplay||parseInt(t.roomid)==parseInt(e.extdata.roomid)){if(t.closeConfirm(),t.unpickAllPieces(),t.makePieceNormal(),t.lblTurnCount&&e.extdata&&e.extdata.turncount){var i=parseInt(e.extdata.turncount);if(t.notReplay&&t.turnCount+1!=i)return t.loadding(),void t.recovery();t.lblTurnCount.string=Math.round(parseInt(i)/2)+"Turn",t.turnCount=parseInt(i)}var a=t.getPlayer(e.userid);t.curTurn=(a.seatid+1)%4,a&&e.extdata.passcount&&a.updatePassCount(e.extdata.passcount),a&&"r"!=e.extdata.type&&(a.seatid%2==0?("p"!=e.extdata.type&&e.extdata.data&&(t.pickedPiece={id:parseInt(e.extdata.data.pn),r:parseInt(e.extdata.data.srow),c:parseInt(e.extdata.data.scol),cell:t.getPieceByRowCol(parseInt(e.extdata.data.srow),parseInt(e.extdata.data.scol))},t.movePiece(parseInt(e.extdata.data.frow),parseInt(e.extdata.data.fcol),e.extdata.type),e.extdata.data&&0!=e.extdata.data.on&&null!=e.extdata.data.on&&t.undoEngage(e.extdata.data.on+16,e.extdata.data.srow,e.extdata.data.scol)),"b"==e.extdata.type?(t.turnSeat=0,t.giveTurn1(e.extdata.timer),t.begPayGet()):(t.turnSeat=1,t.giveTurn2(e.extdata.timer))):("p"!=e.extdata.type&&e.extdata.data&&(t.pickedPiece={id:parseInt(e.extdata.data.pn)+16,r:9-parseInt(e.extdata.data.srow),c:8-parseInt(e.extdata.data.scol),cell:t.getPieceByRowCol(9-parseInt(e.extdata.data.srow),8-parseInt(e.extdata.data.scol))},t.movePiece(9-parseInt(e.extdata.data.frow),8-parseInt(e.extdata.data.fcol),e.extdata.type),e.extdata.data&&0!=e.extdata.data.on&&null!=e.extdata.data.on&&t.undoEngage(e.extdata.data.on,9-parseInt(e.extdata.data.srow),8-parseInt(e.extdata.data.scol))),"b"==e.extdata.type?(t.turnSeat=1,t.giveTurn2(e.extdata.timer),t.begPayGet()):(t.turnSeat=0,t.giveTurn1(e.extdata.timer)))),"r"==e.extdata.type&&e.userid==cc.global.user.id&&"no"==cc.global.amObserve&&t.checkConfirm("Reapeatly, it will be draw?",function(){t.sendDrawEvent("y")},function(){t.noRepeatAndGo()},10,{isChess:!0}),"g"==e.extdata.type&&e.userid!=cc.global.user.id&&"no"==cc.global.amObserve&&t.checkConfirm("chckout. draw?",function(){t.sendDrawEvent("y")},function(){t.noRepeatAndGo()},10,{isChess:!0}),t.showBoardClaim(e.extdata.type);var s="";switch(e.extdata.type){case"n":break;case"p":s="pass";break;case"j":s="janghun";break;case"g":s="gungjang";break;case"t":break;case"m":s="mengfun"}""!=s&&a.speech(s)}},sendDrawEvent:function(e){this.socket().exec("draw",{extparams:{draw:e}})},noRepeatAndGo:function(){this.sendDrawEvent("n"),this.turnSeat=0,this.giveTurn1(20)},stopTurnTimerAll:function(){this.turntimer.getComponent("TurnTimer").stopAllTimer()},showBoardClaim:function(e){var t="";switch(e){case"n":break;case"p":t="pass";break;case"j":case"g":t="check";break;case"t":t="tcheck";break;case"m":t="defense";break;case"w":t="win";break;case"l":t="defeat";break;case"d":t="draw"}"CH"==cc.global.curLanguage?t+="_ch":"RU"==cc.global.curLanguage?t+="_ru":t+="_en","w"==e?this.runFinishAction("dzz_cj_win"):"l"==e?this.runFinishAction("dzz_cj_lose"):(this.boardclaim.spriteFrame=this.claimatlas.getSpriteFrame(t),this.boardclaim.getComponent(cc.Animation).play())},runFinishAction:function(e){if("yes"!=cc.global.amObserve&&this.finishAct&&this.finishAct.getComponent(sp.Skeleton)){var t=cc.callFunc(this.enableFinishAni,this,e),i=cc.callFunc(this.disableFinishAni,this);this.node.runAction(cc.sequence(t,cc.delayTime(3),i))}},enableFinishAni:function(e,t){if(this.finishAct){var i=this.finishAct.getComponent(sp.Skeleton);i&&(this.finishAct.active=!0,i.animation=t)}},disableFinishAni:function(e){this.finishAct&&(this.finishAct.active=!1)},removeAllPieces:function(){this.towerboard.destroyAllChildren(),this.towerboard.removeAllChildren()},onClickReqDraw:function(){var e=this.controlPanel.children[1].children[0],t=this.controlPanel.children[1].children[1];if("no"==cc.global.amObserve&&this.isGamePlaying&&1==this.turnSeat&&1==e.active){e.active=!1,t.active=!0;this.socket().exec("cdraw",{}),this.makePieceNormal(),this.unpickAllPieces(),setTimeout(function(){e.active=!0,t.active=!1},1e4)}},toggleControlPanel:function(){var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==e&&(e=!0),this.btnSfx.children[0].active=e,this.btnSfx.children[1].active=!e},recovery_event:function(e,t){t.isGamePlaying=!0,t.hideAllStatus(),t.getPlayer(e.banker).showBanker(),"camping"==e.status?(t.pojindeclare.getComponent("PojinDeclare").setPlayers(t.playerlist),e.userid&&e.timer?t.pojindeclare.getComponent("PojinDeclare").showPojin(e.userid,e.timer):(t.pojindeclare.getComponent("PojinDeclare").showPojin(),t.setPojin(e.players,e.gong,e.userid,e.ftime,e.camps))):"playing"==e.status&&(t.pojindeclare.getComponent("PojinDeclare").hidePojin(),t.setPanInfo(e.players,e.paninfos),t.initGameboard(),t.setPlayersEngaged(e.players),e.userid&&e.timer&&t.setTurn(e.userid,e.timer)),t.closeloadding(),t.lblTurnCount&&e.count&&(t.lblTurnCount.string=Math.round(parseInt(e.count)/2)+"Turn",t.turnCount=parseInt(e.count));for(var i=0;i<e.players.length;i++){var a=t.getPlayer(e.players[i].playuser);a&&e.players[i].pass&&a.updatePassCount(e.players[i].pass)}},setPojin:function(e,t,i,a,s){var r=this.pojindeclare.getComponent("PojinDeclare");r.onChangeGong(t),a&&r.setInitialTime(a);for(var n=0;n<e.length;n++){var o;(o=this.getPlayer(e[n].playuser))&&0<s[n]&&(o.seatid%2==0&&(r.onChangeMyPojin(e[n].playuser,s[n]),r.turnChangeCount++),1==o.seatid&&(r.onChangeEnemyPojin(e[n].playuser,s[n]),r.turnChangeCount++))}(o=this.getPlayer(i))&&0==o.seatid&&0<r.turnChangeCount&&"no"==cc.global.amObserve&&(r.endbtn.node.active=!0,r.confirmbtn.node.children[0].active=!1,r.confirmbtn.node.children[1].active=!0,r.confirmbtn.node.opacity=220,r.confirmbtn.interactable=!1)},setPanInfo:function(e,t){var i=this.getPlayer(e[0].playuser);o.setStatus(t),0!=i.seatid&&o.flipPanInfo()},setPlayersEngaged:function(e){},setTurn:function(e,t){var i=this.getPlayer(e);i&&(this.turnSeat=i.seatid),this.stopTurnTimerAll(),this.curTurn=i.seatid,this.turnSeat%2==0?this.giveTurn1(t):this.giveTurn2(t)},giveTurn1:function(e){this.turntimer.getComponent("TurnTimer").turnTimer1(e),this.togglePcsTurn(0);this.getPlayer(cc.global.user.id)},giveTurn2:function(e){this.turntimer.getComponent("TurnTimer").turnTimer2(e),this.togglePcsTurn(1);this.getPlayer(cc.global.user.id)},togglePcsTurn:function(e){for(var t=0;t<this.towerboard.children.length;t++){var i=this.towerboard.children[t].getComponent("ChessPiece");i&&i.toggleTurn(e)}},hideAllStatus:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ChessPlayerBoard");t&&t.hideStatus()}},sendlines_event:function(e,t){var i=parseInt(e.extmsg);if(0<i){2<=i&&(i/=2,cc.global.audio.playEffectAud("charge"));var a=t.panScore*i,s=0;if("normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway)for(r=0;r<t.playerlist.length;r++)if(n=t.playerlist[r].getComponent("ChessPlayer")){if(0==n.userdata.goldcoins)return;0==s?s=n.userdata.goldcoins:s>n.userdata.goldcoins&&(s=n.userdata.goldcoins)}s<a&&(a=s),t.updateBetUpBalance(a),t.multiBetUp(a),t.pangolds=t.pangolds+2*a}},multiBetUp:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("ChessPlayer");i&&i.betup.getComponent("TetrisBetUp").init(e,i.seatid)}},workOutMatchCareer:function(e){for(var t=0;t<e.players.length;t++){var i=this.getPlayer(e.players[t].userid),a=this.getPlayerBoard(e.players[t].userid);i&&a&&("normal"==cc.global.user.selplayway&&0<e.players[t].score&&(this.matchCareerData.tgolds[i.userdata.id]+=e.players[t].score-this.pangolds/2),"diamond"==cc.global.user.selplayway&&0<e.players[t].score&&(this.matchCareerData.tdiamonds[i.userdata.id]+=e.players[t].score-this.pangolds/2),2==e.players[t].win&&this.matchCareerData.wins[i.userdata.id]++)}},allcards_event:function(e,t){t.otherEventCache=[],t.isGamePlaying=!1,t.pickedPiece=null,t.pojindeclare.getComponent("PojinDeclare").hidePojin(),t.stopTurnTimerAll(),t.matchCareerData&&t.workOutMatchCareer(e);for(var i=t.playerlist.length==e.players.length,a=0;a<e.players.length;a++){e.players[a].getout&&(i=!1);var s=t.getPlayer(e.players[a].userid);if(s&&(s.userdata.goldcoins=parseInt(e.players[a].gold),s.summary(e.players[a])),t.getPlayerBoard(e.players[a].userid)&&("suicide"!=e.title||e.players[a].win||(s=t.getPlayer(e.players[a].userid))&&s.showEmoticon(-1)),e.players[a].userid==cc.global.user.id)switch(t.notReplay&&(cc.global.user.goldcoins=e.players[a].gold),e.players[a].win){case 0:t.showBoardClaim("l");break;case 1:t.showBoardClaim("d");break;case 2:t.showBoardClaim("w")}}o.init(),i&&(t.endGameTimer=setTimeout(function(){t.removeAllPieces(),t.initEngagedPieces(),t.cleanAfterAllCards(),t.setReadyState()},3e3))},initEngagedPieces:function(){},cleanAfterAllCards:function(){for(var e=this.pangolds=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ChessPlayerBoard");t&&t.showPlayCharacter()}cc.global.amObserve&&"no"==cc.global.amObserve&&this.showWaitingTimer();for(e=0;e<this.playerlist.length;e++)this.playerlist[e].getComponent("ChessPlayer").hideBanker(),this.playerlist[e].getComponent("ChessPlayer").updatePassCount(0);this.lblTurnCount&&(this.lblTurnCount.string=""),this.turnCount=0},updateBetUpBalance:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("ChessPlayer");i&&(i.userdata.goldcoins-=e)}this.updatePlayerBalance()},updatePlayerBalance:function(){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("ChessPlayer");t&&t.updateBalance()}},showWaitingTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ChessPlayerBoard");t&&t.startTimer(30)}},showReadyTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ChessPlayerBoard");t&&t.startTimer(3)}},hideTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ChessPlayerBoard");t&&t.stopTimer()}},hideCharacter:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ChessPlayerBoard");t&&t.hidePlayCharacter()}},getPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("ChessPlayer");if(i.userdata.id==e)return i}},getOtherPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("ChessPlayer");if(i.userdata.id!=e)return i}},getPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("ChessPlayerBoard");if(i.userdata.id==e)return i}},getOtherPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("ChessPlayerBoard");if(i.userdata.id!=e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},showChatDialog:function(){this.onclickChat(0)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.notReplay){if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}if(!(e<0)){this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root();var a=this.chatpage.getComponent("Chat");a.init(this,e),a.base.x=a.base.y=0,this.ischat=!0}}},onClickEmoticon:function(){if(this.notReplay){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),this.isemoticon=!1;this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root();var e=this.emoticonpage.getComponent("Emoticon");e.init(this,!1),e.base.x=e.base.y=0,this.isemoticon=!0}},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase,a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg);var s=t.getObserver(e.userid);s&&s.showCallPlayer(i,e.msg)},callplayer_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg);var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg,!1)},emoticon_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg);var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},onClickSwitchTheme:function(){},onClickGiveUp:function(){if("no"==cc.global.amObserve&&this.isGamePlaying){var e=this;cc.global.audio.playVoiceSpeech("support/12_give_up"),this.checkConfirm("Are you give up?",function(){e&&(e.socket().exec("suicide",{}),e.stopTurnTimerAll())},null,null,{isChess:!0})}this.toggleControlPanel()},onClickFindEmptyRoom:function(){},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},onclickBack:function(){var e=this;cc.find("Canvas/ConfirmDlg")?this.closeConfirm():this.notReplay?this.isGamePlaying&&"no"==cc.global.amObserve?(cc.global.audio.playVoiceSpeech("support/14_roomout"),this.checkConfirm("Are you sure to leave room? You will lose.",function(){e.socket().exec("leave",{})},null,null,{isChess:!0})):this.socket().exec("leave",{}):this.exitPlay()},exitPlay:function(){var e=this;cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),null==this.exitTimer&&(this.exitTimer=setInterval(function(){e.finishAct&&!e.finishAct.active&&(e.returnToHall(),clearInterval(e.exitTimer),e.exitTimer=null)},500))},returnToHall:function(){this.loadding(),clearInterval(this.otherEventInvoker),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.startGameTimer&&clearTimeout(this.startGameTimer),this.endGameTimer&&clearTimeout(this.endGameTimer),this.hideTimer(),this.cleanAllPlayers(),this.scene("hall",this)},move_error_event:function(e,t){t.closeConfirm(),t.unpickAllPieces(),t.makePieceNormal(),e.extdata&&e.extdata.type&&t.errorMove&&("1"==e.extdata.type?t.errorMove.getComponent("ToastCtrl").init("invisible","Can not move",!1):"2"==e.extdata.type&&t.errorMove.getComponent("ToastCtrl").init("invisible","Checkmate",!1))}}),cc._RF.pop()},{ChessEngine:"ChessEngine",HHCommon:"HHCommon"}],ChessEngine:[function(e,t,i){"use strict";cc._RF.push(t,"45544Cc4k9M0KNpMROye4Oj","ChessEngine"),t.exports=function(){this.boardWidth=9,this.boardHeight=10,this.bluePojinType=0,this.redPojinType=0,this.status=[],this.isPoLeg=!1,this.isPoLeg2=!1,this.setPojinType=function(e,t){e&&(this.bluePojinType=e),t&&(this.redPojinType=t)},this.init=function(){this.initStatus(),this.bluePojinType=this.redPojinType=0,this.isPoLeg=this.isPoLeg2=0},this.initStatus=function(){for(var e=0;e<this.boardHeight;e++){this.status[e]=[];for(var t=0;t<this.boardWidth;t++)this.status[e][t]=0}},this.setStatus=function(e){this.status=e},this.Player1InitArrangement=function(e){switch(this.status[1][4]=1,this.status[0][0]=2,this.status[0][8]=3,this.status[2][1]=4,this.status[2][7]=5,this.status[0][1]=6,this.status[0][7]=7,this.status[0][2]=8,this.status[0][6]=9,this.status[0][3]=10,this.status[0][5]=11,this.status[3][0]=12,this.status[3][2]=13,this.status[3][4]=14,this.status[3][6]=15,this.status[3][8]=16,e){case 1:this.status[0][6]=7,this.status[0][7]=9;break;case 2:this.status[0][2]=6,this.status[0][1]=8;break;case 4:this.status[0][2]=6,this.status[0][6]=7,this.status[0][1]=8,this.status[0][7]=9;break;case 5:this.status[0][2]=2,this.status[0][6]=3,this.status[0][0]=8,this.status[0][8]=9}},this.Player2InitArrangement=function(e){switch(this.status[8][4]=17,this.status[9][8]=18,this.status[9][0]=19,this.status[7][7]=20,this.status[7][1]=21,this.status[9][7]=22,this.status[9][1]=23,this.status[9][6]=24,this.status[9][2]=25,this.status[9][5]=26,this.status[9][3]=27,this.status[6][8]=28,this.status[6][6]=29,this.status[6][4]=30,this.status[6][2]=31,this.status[6][0]=32,e){case 0:break;case 1:this.status[9][2]=23,this.status[9][1]=25;break;case 2:this.status[9][6]=22,this.status[9][7]=24;break;case 4:this.status[9][6]=22,this.status[9][2]=23,this.status[9][7]=24,this.status[9][1]=25;break;case 5:this.status[9][6]=18,this.status[9][2]=19,this.status[9][8]=24,this.status[9][0]=25}},this.InitArrangement=function(e,t){switch(0!=e&&(this.status[1][4]=1,this.status[0][0]=2,this.status[0][8]=3,this.status[2][1]=4,this.status[2][7]=5,this.status[0][1]=6,this.status[0][7]=7,this.status[0][2]=8,this.status[0][6]=9,this.status[0][3]=10,this.status[0][5]=11,this.status[3][0]=12,this.status[3][2]=13,this.status[3][4]=14,this.status[3][6]=15,this.status[3][8]=16),0!=t&&(this.status[8][4]=17,this.status[9][8]=18,this.status[9][0]=19,this.status[7][7]=20,this.status[7][1]=21,this.status[9][7]=22,this.status[9][1]=23,this.status[9][6]=24,this.status[9][2]=25,this.status[9][5]=26,this.status[9][3]=27,this.status[6][8]=28,this.status[6][6]=29,this.status[6][4]=30,this.status[6][2]=31,this.status[6][0]=32),e){case 1:this.status[0][6]=7,this.status[0][7]=9;break;case 2:this.status[0][2]=6,this.status[0][1]=8;break;case 4:this.status[0][2]=6,this.status[0][6]=7,this.status[0][1]=8,this.status[0][7]=9;break;case 5:this.status[0][2]=2,this.status[0][6]=3,this.status[0][0]=8,this.status[0][8]=9}switch(t){case 0:break;case 1:this.status[9][2]=23,this.status[9][1]=25;break;case 2:this.status[9][6]=22,this.status[9][7]=24;break;case 4:this.status[9][6]=22,this.status[9][2]=23,this.status[9][7]=24,this.status[9][1]=25;break;case 5:this.status[9][6]=18,this.status[9][2]=19,this.status[9][8]=24,this.status[9][0]=25}},this.MovablePos_b1=function(e,t){var i=new Array,a=0;return 0==e&&3==t?((0==this.status[1][3]||16<this.status[1][3])&&(i[a]=[],i[a]=[1,3],a++),(0==this.status[0][4]||16<this.status[0][4])&&(i[a]=[],i[a]=[0,4],a++),(0==this.status[1][4]||16<this.status[1][4])&&(i[a]=[],i[a]=[1,4],a++)):0==e&&4==t?((0==this.status[0][3]||16<this.status[0][3])&&(i[a]=[],i[a]=[0,3],a++),(0==this.status[0][5]||16<this.status[0][5])&&(i[a]=[],i[a]=[0,5],a++),(0==this.status[1][4]||16<this.status[1][4])&&(i[a]=[],i[a]=[1,4],a++)):0==e&&5==t?((0==this.status[0][4]||16<this.status[0][4])&&(i[a]=[],i[a]=[0,4],a++),(0==this.status[1][4]||16<this.status[1][4])&&(i[a]=[],i[a]=[1,4],a++),(0==this.status[1][5]||16<this.status[1][5])&&(i[a]=[],i[a]=[1,5],a++)):1==e&&3==t?((0==this.status[0][3]||16<this.status[0][3])&&(i[a]=[],i[a]=[0,3],a++),(0==this.status[1][4]||16<this.status[1][4])&&(i[a]=[],i[a]=[1,4],a++),(0==this.status[2][3]||16<this.status[2][3])&&(i[a]=[],i[a]=[2,3],a++)):1==e&&4==t?((0==this.status[0][3]||16<this.status[0][3])&&(i[a]=[],i[a]=[0,3],a++),(0==this.status[1][3]||16<this.status[1][3])&&(i[a]=[],i[a]=[1,3],a++),(0==this.status[2][3]||16<this.status[2][3])&&(i[a]=[],i[a]=[2,3],a++),(0==this.status[0][4]||16<this.status[0][4])&&(i[a]=[],i[a]=[0,4],a++),(0==this.status[2][4]||16<this.status[2][4])&&(i[a]=[],i[a]=[2,4],a++),(0==this.status[0][5]||16<this.status[0][5])&&(i[a]=[],i[a]=[0,5],a++),(0==this.status[1][5]||16<this.status[1][5])&&(i[a]=[],i[a]=[1,5],a++),(0==this.status[2][5]||16<this.status[2][5])&&(i[a]=[],i[a]=[2,5],a++)):1==e&&5==t?((0==this.status[0][5]||16<this.status[0][5])&&(i[a]=[],i[a]=[0,5],a++),(0==this.status[1][4]||16<this.status[1][4])&&(i[a]=[],i[a]=[1,4],a++),(0==this.status[2][5]||16<this.status[2][5])&&(i[a]=[],i[a]=[2,5],a++)):2==e&&3==t?((0==this.status[1][3]||16<this.status[1][3])&&(i[a]=[],i[a]=[1,3],a++),(0==this.status[1][4]||16<this.status[1][4])&&(i[a]=[],i[a]=[1,4],a++),(0==this.status[2][4]||16<this.status[2][4])&&(i[a]=[],i[a]=[2,4],a++)):2==e&&4==t?((0==this.status[2][3]||16<this.status[2][3])&&(i[a]=[],i[a]=[2,3],a++),(0==this.status[2][5]||16<this.status[2][5])&&(i[a]=[],i[a]=[2,5],a++),(0==this.status[1][4]||16<this.status[1][4])&&(i[a]=[],i[a]=[1,4],a++)):2==e&&5==t&&((0==this.status[2][4]||16<this.status[2][4])&&(i[a]=[],i[a]=[2,4],a++),(0==this.status[1][5]||16<this.status[1][5])&&(i[a]=[],i[a]=[1,5],a++),(0==this.status[1][4]||16<this.status[1][4])&&(i[a]=[],i[a]=[1,4],a++)),i},this.MovablePos_r1=function(e,t){var i=new Array,a=0;return 9==e&&3==t?((0==this.status[8][3]||this.status[8][3]<17)&&(i[a]=[],i[a]=[8,3],a++),(0==this.status[9][4]||this.status[9][4]<17)&&(i[a]=[],i[a]=[9,4],a++),(0==this.status[8][4]||this.status[8][4]<17)&&(i[a]=[],i[a]=[8,4],a++)):9==e&&4==t?((0==this.status[9][3]||this.status[9][3]<17)&&(i[a]=[],i[a]=[9,3],a++),(0==this.status[9][5]||this.status[9][5]<17)&&(i[a]=[],i[a]=[9,5],a++),(0==this.status[8][4]||this.status[8][4]<17)&&(i[a]=[],i[a]=[8,4],a++)):9==e&&5==t?((0==this.status[9][4]||this.status[9][4]<17)&&(i[a]=[],i[a]=[9,4],a++),(0==this.status[8][4]||this.status[8][4]<17)&&(i[a]=[],i[a]=[8,4],a++),(0==this.status[8][5]||this.status[8][5]<17)&&(i[a]=[],i[a]=[8,5],a++)):8==e&&3==t?((0==this.status[9][3]||this.status[9][3]<17)&&(i[a]=[],i[a]=[9,3],a++),(0==this.status[8][4]||this.status[8][4]<17)&&(i[a]=[],i[a]=[8,4],a++),(0==this.status[7][3]||this.status[7][3]<17)&&(i[a]=[],i[a]=[7,3],a++)):8==e&&4==t?((0==this.status[9][3]||this.status[9][3]<17)&&(i[a]=[],i[a]=[9,3],a++),(0==this.status[8][3]||this.status[8][3]<17)&&(i[a]=[],i[a]=[8,3],a++),(0==this.status[7][3]||this.status[7][3]<17)&&(i[a]=[],i[a]=[7,3],a++),(0==this.status[9][4]||this.status[9][4]<17)&&(i[a]=[],i[a]=[9,4],a++),(0==this.status[7][4]||this.status[7][4]<17)&&(i[a]=[],i[a]=[7,4],a++),(0==this.status[9][5]||this.status[9][5]<17)&&(i[a]=[],i[a]=[9,5],a++),(0==this.status[8][5]||this.status[8][5]<17)&&(i[a]=[],i[a]=[8,5],a++),(0==this.status[7][5]||this.status[7][5]<17)&&(i[a]=[],i[a]=[7,5],a++)):8==e&&5==t?((0==this.status[9][5]||this.status[9][5]<17)&&(i[a]=[],i[a]=[9,5],a++),(0==this.status[8][4]||this.status[8][4]<17)&&(i[a]=[],i[a]=[8,4],a++),(0==this.status[7][5]||this.status[7][5]<17)&&(i[a]=[],i[a]=[7,5],a++)):7==e&&3==t?((0==this.status[8][3]||this.status[8][3]<17)&&(i[a]=[],i[a]=[8,3],a++),(0==this.status[8][4]||this.status[8][4]<17)&&(i[a]=[],i[a]=[8,4],a++),(0==this.status[7][4]||this.status[7][4]<17)&&(i[a]=[],i[a]=[7,4],a++)):7==e&&4==t?((0==this.status[7][3]||this.status[7][3]<17)&&(i[a]=[],i[a]=[7,3],a++),(0==this.status[7][5]||this.status[7][5]<17)&&(i[a]=[],i[a]=[7,5],a++),(0==this.status[8][4]||this.status[8][4]<17)&&(i[a]=[],i[a]=[8,4],a++)):7==e&&5==t&&((0==this.status[7][4]||this.status[7][4]<17)&&(i[a]=[],i[a]=[7,4],a++),(0==this.status[8][5]||this.status[8][5]<17)&&(i[a]=[],i[a]=[8,5],a++),(0==this.status[8][4]||this.status[8][4]<17)&&(i[a]=[],i[a]=[8,4],a++)),i},this.MovablePos_b2=function(e,t){var i=new Array,a=0;this.isEnemy=!1;for(var s=1;s<9-t;s++)if(0!=this.status[e][t+s]||this.isEnemy){if(this.status[e][t+s]<=16||this.isEnemy){this.isEnemy=!1;break}i[a]=[],i[a]=[e,t+s],a++,this.isEnemy=!0}else i[a]=[],i[a]=[e,t+s],a++;this.isEnemy=!1;for(var r=1;r<=t;r++)if(0!=this.status[e][t-r]||this.isEnemy){if(this.status[e][t-r]<=16||this.isEnemy){this.isEnemy=!1;break}i[a]=[],i[a]=[e,t-r],a++,this.isEnemy=!0}else i[a]=[],i[a]=[e,t-r],a++;this.isEnemy=!1;for(var n=1;n<10-e;n++)if(0!=this.status[e+n][t]||this.isEnemy){if(this.status[e+n][t]<=16||this.isEnemy){this.isEnemy=!1;break}i[a]=[],i[a]=[e+n,t],a++,this.isEnemy=!0}else i[a]=[],i[a]=[e+n,t],a++;this.isEnemy=!1;for(var o=1;o<=e;o++)if(0!=this.status[e-o][t]||this.isEnemy){if(this.status[e-o][t]<=16||this.isEnemy){this.isEnemy=!1;break}i[a]=[],i[a]=[e-o,t],a++,this.isEnemy=!0}else i[a]=[],i[a]=[e-o,t],a++;return 0==e&&3==t?((0==this.status[1][4]||16<this.status[1][4])&&(i[a]=[],i[a]=[1,4],a++),0==this.status[1][4]&&(0==this.status[2][5]||16<this.status[2][5])&&(i[a]=[],i[a]=[2,5],a++)):0==e&&5==t?((0==this.status[1][4]||16<this.status[1][4])&&(i[a]=[],i[a]=[1,4],a++),0==this.status[1][4]&&(0==this.status[2][3]||16<this.status[2][3])&&(i[a]=[],i[a]=[2,3],a++)):2==e&&3==t?((0==this.status[1][4]||16<this.status[1][4])&&(i[a]=[],i[a]=[1,4],a++),0==this.status[1][4]&&(0==this.status[0][5]||16<this.status[0][5])&&(i[a]=[],i[a]=[0,5],a++)):2==e&&5==t?((0==this.status[1][4]||16<this.status[1][4])&&(i[a]=[],i[a]=[1,4],a++),0==this.status[1][4]&&(0==this.status[0][3]||16<this.status[0][3])&&(i[a]=[],i[a]=[0,3],a++)):1==e&&4==t?((0==this.status[0][3]||16<this.status[0][3])&&(i[a]=[],i[a]=[0,3],a++),(0==this.status[0][5]||16<this.status[0][5])&&(i[a]=[],i[a]=[0,5],a++),(0==this.status[2][3]||16<this.status[2][3])&&(i[a]=[],i[a]=[2,3],a++),(0==this.status[2][5]||16<this.status[2][5])&&(i[a]=[],i[a]=[2,5],a++)):7==e&&3==t?((0==this.status[8][4]||16<this.status[8][4])&&(i[a]=[],i[a]=[8,4],a++),0==this.status[8][4]&&(0==this.status[9][5]||16<this.status[9][5])&&(i[a]=[],i[a]=[8,5],a++)):7==e&&5==t?((0==this.status[8][4]||16<this.status[8][4])&&(i[a]=[],i[a]=[8,4],a++),0==this.status[8][4]&&(0==this.status[9][3]||16<this.status[9][3])&&(i[a]=[],i[a]=[9,3],a++)):8==e&&4==t?((0==this.status[7][3]||16<this.status[7][3])&&(i[a]=[],i[a]=[7,3],a++),(0==this.status[7][5]||16<this.status[7][5])&&(i[a]=[],i[a]=[7,5],a++),(0==this.status[9][3]||16<this.status[9][3])&&(i[a]=[],i[a]=[9,3],a++),(0==this.status[9][5]||16<this.status[9][5])&&(i[a]=[],i[a]=[9,5],a++)):9==e&&3==t?((0==this.status[8][4]||16<this.status[8][4])&&(i[a]=[],i[a]=[8,4],a++),0==this.status[8][4]&&(0==this.status[7][5]||16<this.status[7][5])&&(i[a]=[],i[a]=[7,5],a++)):9==e&&5==t&&((0==this.status[8][4]||16<this.status[8][4])&&(i[a]=[],i[a]=[8,4],a++),0==this.status[8][4]&&(0==this.status[7][3]||16<this.status[7][3])&&(i[a]=[],i[a]=[7,3],a++)),i},this.MovablePos_r2=function(e,t){var i=new Array,a=0;this.isEnemy=!1;for(var s=1;s<9-t;s++)if(0!=this.status[e][t+s]||this.isEnemy){if(17<=this.status[e][t+s]||this.isEnemy){this.isEnemy=!1;break}i[a]=[],i[a]=[e,t+s],a++,this.isEnemy=!0}else i[a]=[],i[a]=[e,t+s],a++;this.isEnemy=!1;for(var r=1;r<=t;r++)if(0!=this.status[e][t-r]||this.isEnemy){if(17<=this.status[e][t-r]||this.isEnemy){this.isEnemy=!1;break}i[a]=[],i[a]=[e,t-r],a++,this.isEnemy=!0}else i[a]=[],i[a]=[e,t-r],a++;this.isEnemy=!1;for(var n=1;n<10-e;n++)if(0!=this.status[e+n][t]||this.isEnemy){if(17<=this.status[e+n][t]||this.isEnemy){this.isEnemy=!1;break}i[a]=[],i[a]=[e+n,t],a++,this.isEnemy=!0}else i[a]=[],i[a]=[e+n,t],a++;this.isEnemy=!1;for(var o=1;o<=e;o++)if(0!=this.status[e-o][t]||this.isEnemy){if(17<=this.status[e-o][t]||this.isEnemy){this.isEnemy=!1;break}i[a]=[],i[a]=[e-o,t],a++,this.isEnemy=!0}else i[a]=[],i[a]=[e-o,t],a++;return 0==e&&3==t&&((0==this.status[1][4]||this.status[1][4]<17)&&(i[a]=[],i[a]=[1,4],a++),0==this.status[1][4]&&(0==this.status[2][5]||this.status[2][5]<17)&&(i[a]=[],i[a]=[2,5],a++)),0==e&&5==t&&((0==this.status[1][4]||this.status[1][4]<17)&&(i[a]=[],i[a]=[1,4],a++),0==this.status[1][4]&&(0==this.status[2][3]||this.status[2][3]<17)&&(i[a]=[],i[a]=[2,3],a++)),2==e&&3==t&&((0==this.status[1][4]||this.status[1][4]<17)&&(i[a]=[],i[a]=[1,4],a++),0==this.status[1][4]&&(0==this.status[0][5]||this.status[0][5]<17)&&(i[a]=[],i[a]=[0,5],a++)),2==e&&5==t&&((0==this.status[1][4]||this.status[1][4]<17)&&(i[a]=[],i[a]=[1,4],a++),0==this.status[1][4]&&(0==this.status[0][3]||this.status[0][3]<17)&&(i[a]=[],i[a]=[0,3],a++)),1==e&&4==t&&((0==this.status[0][3]||this.status[0][3]<17)&&(i[a]=[],i[a]=[0,3],a++),(0==this.status[0][5]||this.status[0][5]<17)&&(i[a]=[],i[a]=[0,5],a++),(0==this.status[2][3]||this.status[2][3]<17)&&(i[a]=[],i[a]=[2,3],a++),(0==this.status[2][5]||this.status[2][5]<17)&&(i[a]=[],i[a]=[2,5],a++)),7==e&&3==t&&((0==this.status[8][4]||this.status[8][4]<17)&&(i[a]=[],i[a]=[8,4],a++),0==this.status[8][4]&&(0==this.status[9][5]||this.status[9][5]<17)&&(i[a]=[],i[a]=[9,5],a++)),7==e&&5==t&&((0==this.status[8][4]||this.status[8][4]<17)&&(i[a]=[],i[a]=[8,4],a++),0==this.status[8][4]&&(0==this.status[9][3]||this.status[9][3]<17)&&(i[a]=[],i[a]=[9,3],a++)),9==e&&3==t&&((0==this.status[8][4]||this.status[8][4]<17)&&(i[a]=[],i[a]=[8,4],a++),0==this.status[8][4]&&(0==this.status[7][5]||this.status[7][5]<17)&&(i[a]=[],i[a]=[7,5],a++)),9==e&&5==t&&((0==this.status[8][4]||this.status[8][4]<17)&&(i[a]=[],i[a]=[8,4],a++),0==this.status[8][4]&&(0==this.status[7][3]||this.status[7][3]<17)&&(i[a]=[],i[a]=[7,3],a++)),8==e&&4==t&&((0==this.status[7][3]||this.status[7][3]<17)&&(i[a]=[],i[a]=[7,3],a++),(0==this.status[7][5]||this.status[7][5]<17)&&(i[a]=[],i[a]=[7,5],a++),(0==this.status[9][3]||this.status[9][3]<17)&&(i[a]=[],i[a]=[9,3],a++),(0==this.status[9][5]||this.status[9][5]<17)&&(i[a]=[],i[a]=[9,5],a++)),i},this.MovablePos_b4=function(e,t){var i=new Array,a=0;0==e&&3==t?0!=this.status[1][4]&&4!=this.status[1][4]&&5!=this.status[1][4]&&20!=this.status[1][4]&&21!=this.status[1][4]&&(0==this.status[2][5]||16<this.status[2][5]&&20!=this.status[2][5]&&21!=this.status[2][5])&&(i[a]=[],i[a]=[2,5],a++):0==e&&5==t?0!=this.status[1][4]&&4!=this.status[1][4]&&5!=this.status[1][4]&&20!=this.status[1][4]&&21!=this.status[1][4]&&(0==this.status[2][3]||16<this.status[2][3]&&20!=this.status[2][3]&&21!=this.status[2][3])&&(i[a]=[],i[a]=[2,3],a++):2==e&&3==t?0!=this.status[1][4]&&4!=this.status[1][4]&&5!=this.status[1][4]&&20!=this.status[1][4]&&21!=this.status[1][4]&&(0==this.status[0][5]||16<this.status[0][5]&&20!=this.status[0][5]&&21!=this.status[0][5])&&(i[a]=[],i[a]=[0,5],a++):2==e&&5==t?0!=this.status[1][4]&&4!=this.status[1][4]&&5!=this.status[1][4]&&20!=this.status[1][4]&&21!=this.status[1][4]&&(0==this.status[0][3]||16<this.status[0][3]&&20!=this.status[0][3]&&21!=this.status[0][3])&&(i[a]=[],i[a]=[0,3],a++):7==e&&3==t?0!=this.status[8][4]&&4!=this.status[8][4]&&5!=this.status[8][4]&&20!=this.status[8][4]&&21!=this.status[8][4]&&(0==this.status[9][5]||16<this.status[9][5]&&20!=this.status[9][5]&&21!=this.status[9][5])&&(i[a]=[],i[a]=[9,5],a++):7==e&&5==t?0!=this.status[8][4]&&4!=this.status[8][4]&&5!=this.status[8][4]&&20!=this.status[8][4]&&21!=this.status[8][4]&&(0==this.status[9][3]||16<this.status[9][3]&&20!=this.status[9][3]&&21!=this.status[9][3])&&(i[a]=[],i[a]=[9,3],a++):9==e&&3==t?0!=this.status[8][4]&&4!=this.status[8][4]&&5!=this.status[8][4]&&20!=this.status[8][4]&&21!=this.status[8][4]&&(0==this.status[7][5]||16<this.status[7][5]&&20!=this.status[7][5]&&21!=this.status[7][5])&&(i[a]=[],i[a]=[7,5],a++):9==e&&5==t&&0!=this.status[8][4]&&4!=this.status[8][4]&&5!=this.status[8][4]&&20!=this.status[8][4]&&21!=this.status[8][4]&&(0==this.status[7][3]||16<this.status[7][3]&&20!=this.status[7][3]&&21!=this.status[7][3])&&(i[a]=[],i[a]=[7,3],a++),this.isPoLeg=!1,this.isPoLeg2=!1;for(var s=1;s<9-t&&(this.isPoLeg||4!=this.status[e][t+s]&&5!=this.status[e][t+s]&&20!=this.status[e][t+s]&&21!=this.status[e][t+s]);s++)if(this.isPoLeg||0==this.status[e][t+s]||4==this.status[e][t+s]||5==this.status[e][t+s]||20==this.status[e][t+s]||21==this.status[e][t+s]){if(this.isPoLeg&&this.isPoLeg2&&0!=this.status[e][t+s]){16<this.status[e][t+s]&&20!=this.status[e][t+s]&&21!=this.status[e][t+s]&&(i[a]=[],i[a]=[e,t+s],a++);break}if(this.isPoLeg)if(this.isPoLeg2)0==this.status[e][t+s]&&(i[a]=[],i[a]=[e,t+s],a++);else{if(0!=this.status[e][t+s]){16<this.status[e][t+s]&&20!=this.status[e][t+s]&&21!=this.status[e][t+s]&&(i[a]=[],i[a]=[e,t+s],a++);break}i[a]=[],i[a]=[e,t+s],a++,this.isPoLeg2=!0}}else this.isPoLeg=!0;this.isPoLeg=!1,this.isPoLeg2=!1;for(var r=1;r<=t&&(this.isPoLeg||4!=this.status[e][t-r]&&5!=this.status[e][t-r]&&20!=this.status[e][t-r]&&21!=this.status[e][t-r]);r++)if(this.isPoLeg||0==this.status[e][t-r]||4==this.status[e][t-r]||5==this.status[e][t-r]||20==this.status[e][t-r]||21==this.status[e][t-r]){if(this.isPoLeg&&this.isPoLeg2&&0!=this.status[e][t-r]){16<this.status[e][t-r]&&20!=this.status[e][t-r]&&21!=this.status[e][t-r]&&(i[a]=[],i[a]=[e,t-r],a++);break}if(this.isPoLeg)if(this.isPoLeg2)0==this.status[e][t-r]&&(i[a]=[],i[a]=[e,t-r],a++);else{if(0!=this.status[e][t-r]){16<this.status[e][t-r]&&20!=this.status[e][t-r]&&21!=this.status[e][t-r]&&(i[a]=[],i[a]=[e,t-r],a++);break}i[a]=[],i[a]=[e,t-r],a++,this.isPoLeg2=!0}}else this.isPoLeg=!0;this.isPoLeg=!1,this.isPoLeg2=!1;for(var n=1;n<10-e&&(this.isPoLeg||4!=this.status[e+n][t]&&5!=this.status[e+n][t]&&20!=this.status[e+n][t]&&21!=this.status[e+n][t]);n++)if(this.isPoLeg||0==this.status[e+n][t]||4==this.status[e+n][t]||5==this.status[e+n][t]||20==this.status[e+n][t]||21==this.status[e+n][t]){if(this.isPoLeg&&this.isPoLeg2&&0!=this.status[e+n][t]){16<this.status[e+n][t]&&20!=this.status[e+n][t]&&21!=this.status[e+n][t]&&(i[a]=[],i[a]=[e+n,t],a++);break}if(this.isPoLeg)if(this.isPoLeg2)0==this.status[e+n][t]&&(i[a]=[],i[a]=[e+n,t],a++);else{if(0!=this.status[e+n][t]){16<this.status[e+n][t]&&20!=this.status[e+n][t]&&21!=this.status[e+n][t]&&(i[a]=[],i[a]=[e+n,t],a++);break}i[a]=[],i[a]=[e+n,t],a++,this.isPoLeg2=!0}}else this.isPoLeg=!0;this.isPoLeg=!1,this.isPoLeg2=!1;for(var o=1;o<=e&&(this.isPoLeg||4!=this.status[e-o][t]&&5!=this.status[e-o][t]&&20!=this.status[e-o][t]&&21!=this.status[e-o][t]);o++)if(this.isPoLeg||0==this.status[e-o][t]||4==this.status[e-o][t]||5==this.status[e-o][t]||20==this.status[e-o][t]||21==this.status[e-o][t]){if(this.isPoLeg&&this.isPoLeg2&&0!=this.status[e-o][t]){16<this.status[e-o][t]&&20!=this.status[e-o][t]&&21!=this.status[e-o][t]&&(i[a]=[],i[a]=[e-o,t],a++);break}if(this.isPoLeg)if(this.isPoLeg2)0==this.status[e-o][t]&&(i[a]=[],i[a]=[e-o,t],a++);else{if(0!=this.status[e-o][t]){16<this.status[e-o][t]&&20!=this.status[e-o][t]&&21!=this.status[e-o][t]&&(i[a]=[],i[a]=[e-o,t],a++);break}i[a]=[],i[a]=[e-o,t],a++,this.isPoLeg2=!0}}else this.isPoLeg=!0;return i},this.MovablePos_r4=function(e,t){var i=new Array,a=0;0==e&&3==t?0!=this.status[1][4]&&4!=this.status[1][4]&&5!=this.status[1][4]&&20!=this.status[1][4]&&21!=this.status[1][4]&&(0==this.status[2][5]||this.status[2][5]<17&&4!=this.status[2][5]&&5!=this.status[2][5])&&(i[a]=[],i[a]=[2,5],a++):0==e&&5==t?0!=this.status[1][4]&&4!=this.status[1][4]&&5!=this.status[1][4]&&20!=this.status[1][4]&&21!=this.status[1][4]&&(0==this.status[2][3]||this.status[2][3]<17&&4!=this.status[2][3]&&5!=this.status[2][3])&&(i[a]=[],i[a]=[2,3],a++):2==e&&3==t?0!=this.status[1][4]&&4!=this.status[1][4]&&5!=this.status[1][4]&&20!=this.status[1][4]&&21!=this.status[1][4]&&(0==this.status[0][5]||17<this.status[0][5]&&4!=this.status[0][5]&&5!=this.status[0][5])&&(i[a]=[],i[a]=[0,5],a++):2==e&&5==t?0!=this.status[1][4]&&4!=this.status[1][4]&&5!=this.status[1][4]&&20!=this.status[1][4]&&21!=this.status[1][4]&&(0==this.status[0][3]||this.status[0][3]<17&&4!=this.status[0][3]&&5!=this.status[0][3])&&(i[a]=[],i[a]=[0,3],a++):7==e&&3==t?0!=this.status[8][4]&&4!=this.status[8][4]&&5!=this.status[8][4]&&20!=this.status[8][4]&&21!=this.status[8][4]&&(0==this.status[9][5]||this.status[9][5]<17&&4!=this.status[9][5]&&5!=this.status[9][5])&&(i[a]=[],i[a]=[9,5],a++):7==e&&5==t?0!=this.status[8][4]&&4!=this.status[8][4]&&5!=this.status[8][4]&&20!=this.status[8][4]&&21!=this.status[8][4]&&(0==this.status[9][3]||this.status[9][3]<17&&4!=this.status[9][3]&&5!=this.status[9][3])&&(i[a]=[],i[a]=[9,3],a++):9==e&&3==t?0!=this.status[8][4]&&4!=this.status[8][4]&&5!=this.status[8][4]&&20!=this.status[8][4]&&21!=this.status[8][4]&&(0==this.status[7][5]||this.status[7][5]<17&&4!=this.status[7][5]&&5!=this.status[7][5])&&(i[a]=[],i[a]=[7,5],a++):9==e&&5==t&&0!=this.status[8][4]&&4!=this.status[8][4]&&5!=this.status[8][4]&&20!=this.status[8][4]&&21!=this.status[8][4]&&(0==this.status[7][3]||this.status[7][3]<17&&4!=this.status[7][3]&&5!=this.status[7][3])&&(i[a]=[],i[a]=[7,3],a++),this.isPoLeg=!1,this.isPoLeg2=!1;for(var s=1;s<9-t&&(this.isPoLeg||4!=this.status[e][t+s]&&5!=this.status[e][t+s]&&20!=this.status[e][t+s]&&21!=this.status[e][t+s]);s++)if(this.isPoLeg||0==this.status[e][t+s]||4==this.status[e][t+s]||5==this.status[e][t+s]||20==this.status[e][t+s]||21==this.status[e][t+s]){if(this.isPoLeg&&this.isPoLeg2&&0!=this.status[e][t+s]){this.status[e][t+s]<17&&4!=this.status[e][t+s]&&5!=this.status[e][t+s]&&(i[a]=[],i[a]=[e,t+s],a++);break}if(this.isPoLeg)if(this.isPoLeg2)0==this.status[e][t+s]&&(i[a]=[],i[a]=[e,t+s],a++);else{if(0!=this.status[e][t+s]){this.status[e][t+s]<17&&4!=this.status[e][t+s]&&5!=this.status[e][t+s]&&(i[a]=[],i[a]=[e,t+s],a++);break}i[a]=[],i[a]=[e,t+s],a++,this.isPoLeg2=!0}}else this.isPoLeg=!0;this.isPoLeg=!1,this.isPoLeg2=!1;for(var r=1;r<=t&&(this.isPoLeg||4!=this.status[e][t-r]&&5!=this.status[e][t-r]&&20!=this.status[e][t-r]&&21!=this.status[e][t-r]);r++)if(this.isPoLeg||0==this.status[e][t-r]||4==this.status[e][t-r]||5==this.status[e][t-r]||20==this.status[e][t-r]||21==this.status[e][t-r]){if(this.isPoLeg&&this.isPoLeg2&&0!=this.status[e][t-r]){this.status[e][t-r]<17&&4!=this.status[e][t-r]&&5!=this.status[e][t-r]&&(i[a]=[],i[a]=[e,t-r],a++);break}if(this.isPoLeg)if(this.isPoLeg2)0==this.status[e][t-r]&&(i[a]=[],i[a]=[e,t-r],a++);else{if(0!=this.status[e][t-r]){this.status[e][t-r]<17&&4!=this.status[e][t-r]&&5!=this.status[e][t-r]&&(i[a]=[],i[a]=[e,t-r],a++);break}i[a]=[],i[a]=[e,t-r],a++,this.isPoLeg2=!0}}else this.isPoLeg=!0;this.isPoLeg=!1,this.isPoLeg2=!1;for(var n=1;n<10-e&&(this.isPoLeg||4!=this.status[e+n][t]&&5!=this.status[e+n][t]&&20!=this.status[e+n][t]&&21!=this.status[e+n][t]);n++)if(this.isPoLeg||0==this.status[e+n][t]||4==this.status[e+n][t]||5==this.status[e+n][t]||20==this.status[e+n][t]||21==this.status[e+n][t]){if(this.isPoLeg&&this.isPoLeg2&&0!=this.status[e+n][t]){this.status[e+n][t]<17&&4!=this.status[e+n][t]&&5!=this.status[e+n][t]&&(i[a]=[],i[a]=[e+n,t],a++);break}if(this.isPoLeg)if(this.isPoLeg2)0==this.status[e+n][t]&&(i[a]=[],i[a]=[e+n,t],a++);else{if(0!=this.status[e+n][t]){this.status[e+n][t]<17&&4!=this.status[e+n][t]&&5!=this.status[e+n][t]&&(i[a]=[],i[a]=[e+n,t],a++);break}i[a]=[],i[a]=[e+n,t],a++,this.isPoLeg2=!0}}else this.isPoLeg=!0;this.isPoLeg=!1,this.isPoLeg2=!1;for(var o=1;o<=e&&(this.isPoLeg||4!=this.status[e-o][t]&&5!=this.status[e-o][t]&&20!=this.status[e-o][t]&&21!=this.status[e-o][t]);o++)if(this.isPoLeg||0==this.status[e-o][t]||4==this.status[e-o][t]||5==this.status[e-o][t]||20==this.status[e-o][t]||21==this.status[e-o][t]){if(this.isPoLeg&&this.isPoLeg2&&0!=this.status[e-o][t]){this.status[e-o][t]<17&&4!=this.status[e-o][t]&&5!=this.status[e-o][t]&&(i[a]=[],i[a]=[e-o,t],a++);break}if(this.isPoLeg)if(this.isPoLeg2)0==this.status[e-o][t]&&(i[a]=[],i[a]=[e-o,t],a++);else{if(0!=this.status[e-o][t]){this.status[e-o][t]<17&&4!=this.status[e-o][t]&&5!=this.status[e-o][t]&&(i[a]=[],i[a]=[e-o,t],a++);break}i[a]=[],i[a]=[e-o,t],a++,this.isPoLeg2=!0}}else this.isPoLeg=!0;return i},this.MovablePos_b6=function(e,t){var i=new Array,a=0;return 0<=e-2&&0<=t-1&&0==this.status[e-1][t]&&(0==this.status[e-2][t-1]||16<this.status[e-2][t-1])&&(i[a]=[],i[a]=[e-2,t-1],a++),0<=e-2&&t+1<=8&&0==this.status[e-1][t]&&(0==this.status[e-2][t+1]||16<this.status[e-2][t+1])&&(i[a]=[],i[a]=[e-2,t+1],a++),0<=e-1&&0<=t-2&&0==this.status[e][t-1]&&(0==this.status[e-1][t-2]||16<this.status[e-1][t-2])&&(i[a]=[],i[a]=[e-1,t-2],a++),e+1<=9&&0<=t-2&&0==this.status[e][t-1]&&(0==this.status[e+1][t-2]||16<this.status[e+1][t-2])&&(i[a]=[],i[a]=[e+1,t-2],a++),e+2<=9&&0<=t-1&&0==this.status[e+1][t]&&(0==this.status[e+2][t-1]||16<this.status[e+2][t-1])&&(i[a]=[],i[a]=[e+2,t-1],a++),e+2<=9&&t+1<=8&&0==this.status[e+1][t]&&(0==this.status[e+2][t+1]||16<this.status[e+2][t+1])&&(i[a]=[],i[a]=[e+2,t+1],a++),0<=e-1&&t+2<=8&&0==this.status[e][t+1]&&(0==this.status[e-1][t+2]||16<this.status[e-1][t+2])&&(i[a]=[],i[a]=[e-1,t+2],a++),e+1<=9&&t+2<=8&&0==this.status[e][t+1]&&(0==this.status[e+1][t+2]||16<this.status[e+1][t+2])&&(i[a]=[],i[a]=[e+1,t+2],a++),i},this.MovablePos_r6=function(e,t){var i=new Array,a=0;return 0<=e-2&&0<=t-1&&0==this.status[e-1][t]&&(0==this.status[e-2][t-1]||this.status[e-2][t-1]<17)&&(i[a]=[],i[a]=[e-2,t-1],a++),0<=e-2&&t+1<=8&&0==this.status[e-1][t]&&(0==this.status[e-2][t+1]||this.status[e-2][t+1]<17)&&(i[a]=[],i[a]=[e-2,t+1],a++),0<=e-1&&0<=t-2&&0==this.status[e][t-1]&&(0==this.status[e-1][t-2]||this.status[e-1][t-2]<17)&&(i[a]=[],i[a]=[e-1,t-2],a++),e+1<=9&&0<=t-2&&0==this.status[e][t-1]&&(0==this.status[e+1][t-2]||this.status[e+1][t-2]<17)&&(i[a]=[],i[a]=[e+1,t-2],a++),e+2<=9&&0<=t-1&&0==this.status[e+1][t]&&(0==this.status[e+2][t-1]||this.status[e+2][t-1]<17)&&(i[a]=[],i[a]=[e+2,t-1],a++),e+2<=9&&t+1<=8&&0==this.status[e+1][t]&&(0==this.status[e+2][t+1]||this.status[e+2][t+1]<17)&&(i[a]=[],i[a]=[e+2,t+1],a++),0<=e-1&&t+2<=8&&0==this.status[e][t+1]&&(0==this.status[e-1][t+2]||this.status[e-1][t+2]<17)&&(i[a]=[],i[a]=[e-1,t+2],a++),e+1<=9&&t+2<=8&&0==this.status[e][t+1]&&(0==this.status[e+1][t+2]||this.status[e+1][t+2]<17)&&(i[a]=[],i[a]=[e+1,t+2],a++),i},this.MovablePos_b8=function(e,t){var i=new Array,a=0;return 0<=e-3&&0<=t-2&&0==this.status[e-1][t]&&0==this.status[e-2][t-1]&&(0==this.status[e-3][t-2]||16<this.status[e-3][t-2])&&(i[a]=[],i[a]=[e-3,t-2],a++),0<=e-3&&t+2<=8&&0==this.status[e-1][t]&&0==this.status[e-2][t+1]&&(0==this.status[e-3][t+2]||16<this.status[e-3][t+2])&&(i[a]=[],i[a]=[e-3,t+2],a++),0<=e-2&&0<=t-3&&0==this.status[e][t-1]&&0==this.status[e-1][t-2]&&(0==this.status[e-2][t-3]||16<this.status[e-2][t-3])&&(i[a]=[],i[a]=[e-2,t-3],a++),e+2<=9&&0<=t-3&&0==this.status[e][t-1]&&0==this.status[e+1][t-2]&&(0==this.status[e+2][t-3]||16<this.status[e+2][t-3])&&(i[a]=[],i[a]=[e+2,t-3],a++),e+3<=9&&0<=t-2&&0==this.status[e+1][t]&&0==this.status[e+2][t-1]&&(0==this.status[e+3][t-2]||16<this.status[e+3][t-2])&&(i[a]=[],i[a]=[e+3,t-2],a++),e+3<=9&&t+2<=8&&0==this.status[e+1][t]&&0==this.status[e+2][t+1]&&(0==this.status[e+3][t+2]||16<this.status[e+3][t+2])&&(i[a]=[],i[a]=[e+3,t+2],a++),0<=e-2&&t+3<=8&&0==this.status[e][t+1]&&0==this.status[e-1][t+2]&&(0==this.status[e-2][t+3]||16<this.status[e-2][t+3])&&(i[a]=[],i[a]=[e-2,t+3],a++),e+2<=9&&t+3<=8&&0==this.status[e][t+1]&&0==this.status[e+1][t+2]&&(0==this.status[e+2][t+3]||16<this.status[e+2][t+3])&&(i[a]=[],i[a]=[e+2,t+3],a++),i},this.MovablePos_r8=function(e,t){var i=new Array,a=0;return 0<=e-3&&0<=t-2&&0==this.status[e-1][t]&&0==this.status[e-2][t-1]&&(0==this.status[e-3][t-2]||this.status[e-3][t-2]<17)&&(i[a]=[],i[a]=[e-3,t-2],a++),0<=e-3&&t+2<=8&&0==this.status[e-1][t]&&0==this.status[e-2][t+1]&&(0==this.status[e-3][t+2]||this.status[e-3][t+2]<17)&&(i[a]=[],i[a]=[e-3,t+2],a++),0<=e-2&&0<=t-3&&0==this.status[e][t-1]&&0==this.status[e-1][t-2]&&(0==this.status[e-2][t-3]||this.status[e-2][t-3]<17)&&(i[a]=[],i[a]=[e-2,t-3],a++),e+2<=9&&0<=t-3&&0==this.status[e][t-1]&&0==this.status[e+1][t-2]&&(0==this.status[e+2][t-3]||this.status[e+2][t-3]<17)&&(i[a]=[],i[a]=[e+2,t-3],a++),e+3<=9&&0<=t-2&&0==this.status[e+1][t]&&0==this.status[e+2][t-1]&&(0==this.status[e+3][t-2]||this.status[e+3][t-2]<17)&&(i[a]=[],i[a]=[e+3,t-2],a++),e+3<=9&&t+2<=8&&0==this.status[e+1][t]&&0==this.status[e+2][t+1]&&(0==this.status[e+3][t+2]||this.status[e+3][t+2]<17)&&(i[a]=[],i[a]=[e+3,t+2],a++),0<=e-2&&t+3<=8&&0==this.status[e][t+1]&&0==this.status[e-1][t+2]&&(0==this.status[e-2][t+3]||this.status[e-2][t+3]<17)&&(i[a]=[],i[a]=[e-2,t+3],a++),e+2<=9&&t+3<=8&&0==this.status[e][t+1]&&0==this.status[e+1][t+2]&&(0==this.status[e+2][t+3]||this.status[e+2][t+3]<17)&&(i[a]=[],i[a]=[e+2,t+3],a++),i},this.MovablePos_b12=function(e,t){var i=new Array,a=0;return 7==e&&3==t?(0==this.status[8][4]||16<this.status[8][4])&&(i[a]=[],i[a]=[8,4],a++):7==e&&5==t?(0==this.status[8][4]||16<this.status[8][4])&&(i[a]=[],i[a]=[8,4],a++):8==e&&4==t&&((0==this.status[9][3]||16<this.status[9][3])&&(i[a]=[],i[a]=[9,3],a++),(0==this.status[9][5]||16<this.status[9][5])&&(i[a]=[],i[a]=[9,5],a++)),0<=t-1&&(0==this.status[e][t-1]||16<this.status[e][t-1])&&(i[a]=[],i[a]=[e,t-1],a++),t+1<=8&&(0==this.status[e][t+1]||16<this.status[e][t+1])&&(i[a]=[],i[a]=[e,t+1],a++),e+1<=9&&(0==this.status[e+1][t]||16<this.status[e+1][t])&&(i[a]=[],i[a]=[e+1,t],a++),i},this.MovablePos_r12=function(e,t){var i=new Array,a=0;return 2==e&&3==t?this.status[1][4]<17&&(i[a]=[],i[a]=[1,4],a++):2==e&&5==t?this.status[1][4]<17&&(i[a]=[],i[a]=[1,4],a++):1==e&&4==t&&(this.status[0][3]<17&&(i[a]=[],i[a]=[0,3],a++),this.status[0][5]<17&&(i[a]=[],i[a]=[0,5],a++)),0<=t-1&&this.status[e][t-1]<17&&(i[a]=[],i[a]=[e,t-1],a++),t+1<=8&&this.status[e][t+1]<17&&(i[a]=[],i[a]=[e,t+1],a++),0<=e-1&&this.status[e-1][t]<17&&(i[a]=[],i[a]=[e-1,t],a++),i},this.movePiece=function(e,t,i,a,s){var r=null;return(this.status[t][i]=0)!=this.status[a][s]&&(r={id:this.status[a][s],r:a,c:s}),this.status[a][s]=e,r},this.setPieceRowCol=function(e,t,i){this.status[t][i]=e},this.flipPanInfo=function(){for(var e=[],t=0;t<this.boardHeight;t++)for(e[t]=[],i=0;i<this.boardWidth;i++)e[t][i]=0;for(t=0;t<this.boardHeight;t++)for(var i=0;i<this.boardWidth;i++)17<=this.status[9-t][8-i]?e[t][i]=this.status[9-t][8-i]-16:0<this.status[9-t][8-i]&&(e[t][i]=this.status[9-t][8-i]+16);this.status=e}},cc._RF.pop()},{}],ChessPiece:[function(e,t,i){"use strict";cc._RF.push(t,"b058btqZn9Nxafe/yUDHMM4","ChessPiece");var a=e("HHCommon");cc.Class({extends:a,properties:{pieceAtlas:{default:null,type:cc.SpriteAtlas},shadow:{default:null,type:cc.Sprite},piece:{default:null,type:cc.Sprite},poshint:{default:null,type:cc.Node}},onLoad:function(){this.pieceId=0},init:function(e,t,i,a){this.parent=e,this.pieceId=t,this.row=i,this.col=a,this.cell_width=e.towerboard.width/8,this.cell_height=e.towerboard.height/9,""!=this.getPieceSpriteName(this.pieceId)&&this.changePieceMode(),this.node.setPosition(this.cell_width*this.col,this.cell_height*this.row),this.node.width=this.piece.node.width,this.node.height=this.piece.node.height,this.node.zIndex=1},changePieceMode:function(){if(0<this.pieceId&&this.pieceId<=32){var e=this.getPieceSpriteName(this.pieceId);""!=e&&(this.piece.spriteFrame=this.pieceAtlas.getSpriteFrame(e))}},onClickPiece:function(){if(this.parent.isGamePlaying)if(this.parent.is_team_game){if("no"==cc.global.amObserve&&0==this.parent.turnSeat&&0==this.parent.curTurn&&this.parent.notReplay){if(1==this.poshint.active)return this.parent.sendMovePiece(this.row,this.col),void this.parent.unpickAllPieces();this.pieceId<=16&&(this.parent.unpickAllPieces(),this.node.isPicked?(this.parent.hidePosHint(),this.node.isPicked=!1):(this.parent.piecePicked(this.pieceId,this.row,this.col,this),this.node.isPicked=!0,this.piece.node.getComponent(cc.Animation).play("pcs_picked")))}}else if("no"==cc.global.amObserve&&0==this.parent.turnSeat&&this.parent.notReplay){if(1==this.poshint.active)return this.parent.sendMovePiece(this.row,this.col),void this.parent.unpickAllPieces();this.pieceId<=16&&(this.parent.unpickAllPieces(),this.node.isPicked?(this.parent.hidePosHint(),this.node.isPicked=!1):(this.parent.piecePicked(this.pieceId,this.row,this.col,this),this.node.isPicked=!0,this.piece.node.getComponent(cc.Animation).play("pcs_picked")))}},unpick:function(){this.piece.node.getComponent(cc.Animation).stop(),this.piece.node.y=0,this.node.isPicked=!1},showPosHint:function(){this.poshint.active=!0},hidePosHint:function(){this.poshint.active=!1},setCellPosition:function(e,t){2<arguments.length&&void 0!==arguments[2]&&arguments[2]?(this.node.stopAllActions(),this.node.setPosition(this.cell_width*this.col,this.cell_height*this.row),this.goCellMoveAnim(e,t),this.row=e,this.col=t):(this.row=e,this.col=t,this.node.setPosition(this.cell_width*this.col,this.cell_height*this.row),0<this.pieceId&&this.toggleDropFade(!0))},toggleShadow:function(e,t){this.shadow.node.active=t;var i=this.getPieceSpriteName(e);if(""!=i){var a=this.pieceAtlas.getSpriteFrame(i);this.shadow.node.width=a.getRect().width,this.shadow.node.height=a.getRect().height}this.node.zIndex=1},getPieceSpriteName:function(e){var t="";switch(e){case 1:t="7_1";break;case 2:case 3:t="6_1";break;case 4:case 5:t="5_1";break;case 6:case 7:t="4_1";break;case 8:case 9:t="2_1";break;case 10:case 11:t="3_1";break;case 12:case 13:case 14:case 15:case 16:t="1_1";break;case 17:t="7_2";break;case 18:case 19:t="6_2";break;case 20:case 21:t="5_2";break;case 22:case 23:t="4_2";break;case 24:case 25:t="2_2";break;case 26:case 27:t="3_2";break;case 28:case 29:case 30:case 31:case 32:t="1_2"}return t},toggleDropFade:function(e){},goCellMoveAnim:function(e,t){var i=cc.callFunc(function(e,t){t.script.toggleDropFade(!0),cc.global.audio.playEffectAud("chess/pcs_drop")},this,{script:this}),a=cc.easeSineOut(),s=cc.easeBezierAction(0,0,1,1);this.node.zIndex=100;var r=e-this.row,n=t-this.col,o=16<this.pieceId?this.pieceId-16:this.pieceId;if(o<6||9<o){var l=Math.sqrt(Math.pow(r,2)+Math.pow(1.75*n,2));l<5&&(l=5),this.node.runAction(cc.sequence(cc.moveBy(l/5*.15,this.cell_width*n,this.cell_height*r).easing(s),i))}else{var c=Math.abs(r)>Math.abs(n)?1:0,h=n<0?-1:1,d=r<0?-1:1;6<=o&&o<=7?0==c?this.node.runAction(cc.sequence(cc.moveBy(.15,this.cell_width*h,0),cc.moveBy(.15,this.cell_width*h,this.cell_height*d).easing(a),i)):this.node.runAction(cc.sequence(cc.moveBy(.15,0,this.cell_height*d),cc.moveBy(.15,this.cell_width*h,this.cell_height*d).easing(a),i)):8<=o&&o<=9&&(0==c?this.node.runAction(cc.sequence(cc.moveBy(.1,this.cell_width*h,0),cc.moveBy(.2,2*h*this.cell_width,2*d*this.cell_height).easing(a),i)):this.node.runAction(cc.sequence(cc.moveBy(.1,0,this.cell_height*d),cc.moveBy(.2,2*h*this.cell_width,2*d*this.cell_height).easing(a),i)))}},toggleTurn:function(e){16<this.pieceId&&1==e?this.piece.node.color=cc.hexToColor("#FFFFFF"):0<this.pieceId&&this.pieceId<=16&&0==e?this.piece.node.color=cc.hexToColor("#FFFFFF"):0<this.pieceId&&(this.piece.node.color=cc.hexToColor("#D0D0D0"))}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ChessPlayerBoard:[function(e,t,i){"use strict";cc._RF.push(t,"fb1d2C5cehOaJIrWCzISIua","ChessPlayerBoard");var a=e("HHCommon");cc.Class({extends:a,properties:{countdown:{default:null,type:cc.Label},status:{default:null,type:cc.Label},character:{default:null,type:cc.Node},tip:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.layoutForSeat(),this.showPlayCharacter()},startTimer:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode||!(3<e)){var t=this;t.stopTimer(),t.countdown.node.active=!0,t.countdown.string=e,t.timer||(t.timer=setInterval(function(){0<e?t.countdown&&(e--,t.countdown.string=e):t.stopTimer()},1e3))}},stopTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null),this.countdown&&(this.countdown.node.active=!1)},setState:function(e){var t=this.getLanguageText("READY_0")+"?",i=this.getLanguageText("PREPARED_0");1!=cc.global.championMode&&2!=cc.global.championMode?(this.status.node.active=!0,t==(this.status.string=e)&&this.userdata.id==cc.global.user.id&&"no"==cc.global.amObserve?this.tip.active=!0:this.tip.active=!1):this.status.string=i},hideTip:function(){this.tip.active=!1},hideStatus:function(){this.stopTimer(),this.hideTip(),this.hidePlayCharacter(),this.status.node.active=!1},layoutForSeat:function(){0==this.seatid||this.seatid},showPlayCharacter:function(){},hidePlayCharacter:function(){},characterAction:function(e){},isReady:function(){return this.getLanguageText("PREPARED_0")==this.status.string},onClickReady:function(){this.parent&&this.parent.processReadyState()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ChessPlayer:[function(e,t,i){"use strict";cc._RF.push(t,"4f4ab2lcrlMO7twI0FZzyjk","ChessPlayer");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},nickname:{default:null,type:cc.Label},goldcoin_base:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},diamonds:{default:null,type:cc.Label},betup:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},winorlose:{default:null,type:cc.Node},boardstat:{default:null,type:cc.Node},engagepane:{default:null,type:cc.Node},btnbeg:{default:null,type:cc.Node},btnskip:{default:null,type:cc.Node},btnpeace:{default:null,type:cc.Node},btnsurrender:{default:null,type:cc.Node},begpayget:{default:null,type:cc.Node},info_out_line:{default:null,type:cc.Node},turnFlag:{default:null,type:cc.Node},banker:{default:null,type:cc.Node},passCount:{default:null,type:cc.Label}},init:function(e,t,i,a){4<arguments.length&&void 0!==arguments[4]&&arguments[4];var s=arguments[5];this.parent=e,this.userdata=t,this.seatid=i,this.joinorder=s,this.playerIdx=a,this.nickname.string=t.nickname,1==cc.global.championMode||cc.global.championMode,this.goldcoins.string=this.numformat(t.goldcoins),this.goldcoins.node.parent.active=!0,this.loadAvatar(t.avatarurl,t.gender),this.layoutForSeat(),this.begScore=Math.round(this.parent.panScore)},update:function(){},setColorForSeat:function(){},speech:function(e){var t=this.userdata.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)},onClickDisInfo:function(){},updateCareer:function(e){},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},spendDiamondForLuck:function(e){this.updateBalance()},showCallPlayer:function(e,t){cc.global.audio.playVoiceChatWithType(this.userdata.playcharacter,t);var i=this;this.hideCallPlayer(),this.callplayer.active=!0,this.callplayer.zIndex=999,this.callplayer.children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onClickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userdata.id},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){cc.global.user.id==this.userdata.id?this.parent.onClickEmoticon&&this.parent.onClickEmoticon():this.onClickCallPlayer()},layoutForSeat:function(){this.seatid%3==0?this.banker.x=-52:(this.winorlose.x=-144,this.callplayer.scaleX=-1,this.callplayer.children[0].scaleX=-1,this.callplayer.children[0].anchorX=.5,this.begpayget.x=-115)},summary:function(e){var a=this;if(this.updateCareer(e),this.winorlose.getComponent(cc.Animation).play(),this.disableControlBtns(),2==e.win){cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("win"),this.winorlose.children[1].getComponent(cc.Label).string="+"+this.numformat(e.exp),this.winorlose.children[2].getComponent(cc.Label).string="+"+this.numformat(e.score),e.orig_gold=e.gold-e.score,"diamond"==cc.global.user.selplayway&&(e.orig_gold=e.diamond-e.score);var t=cc.callFunc(function(e,t){if(t.orig_gold+Math.round(t.score/5)>("diamond"==cc.global.user.selplayway?t.diamond:t.gold)?"diamond"==cc.global.user.selplayway?t.orig_gold=t.diamond:t.orig_gold=t.gold:t.orig_gold=t.orig_gold+Math.round(t.score/5),"diamond"==cc.global.user.selplayway);else{var i=e.getComponent("ChessPlayer").goldcoins.node;i.getComponent(cc.Label).string=a.numformat(t.orig_gold),i.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1)))}},this,e),i=cc.sequence(cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t);this.node.runAction(i)}else{cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("lose"),this.winorlose.children[1].getComponent(cc.Label).string="-"+this.numformat(Math.abs(e.exp)),this.winorlose.children[2].getComponent(cc.Label).string="-"+this.numformat(-1*e.score);this.goldcoins.string=this.numformat(e.gold)}},setEngaged:function(e){},addEngaged:function(e){},undoEngage:function(e){},initEngagedPieces:function(){},onClickBeg:function(){this.toggleBegBtn(!1),this.parent.onClickBeg(),this.userdata.goldcoins-=this.begScore},onClickSkip:function(){this.parent.onClickSkipMove()},onClickPeace:function(){this.togglePeaceBtn(!1),this.parent.onClickReqDraw()},onClickSurrender:function(){this.parent.onClickGiveUp()},disableControlBtns:function(){this.toggleWaitingBeg(!1),this.toggleWaitingPeace(!1),this.toggleBegBtn(!1),this.toggleSkipBtn(!1),this.togglePeaceBtn(!1),this.toggleSurrenderBtn(!1)},toggleBegBtn:function(){},toggleSkipBtn:function(){},togglePeaceBtn:function(){},toggleSurrenderBtn:function(){},toggleWaitingBeg:function(){},toggleWaitingPeace:function(){},toggleEngagePieceMode:function(e){},payOrGetBegMoney:function(e){this.begpayget.children[1].getComponent(cc.Label).string=e?"- "+Math.floor(this.begScore):"+ "+Math.floor(.8*this.begScore),this.begpayget.getComponent(cc.Animation).play("beg_pay_get")},showBanker:function(){this.banker.active=!0,2<=this.banker.children.length&&(this.banker.children[0].active=0==this.seatid,this.banker.children[1].active=0!=this.seatid)},hideBanker:function(){this.banker.active=!1},updatePassCount:function(e){if(this.passCount){var t=3-parseInt(e);if(0<=t){var i=this.getLanguageText("PASS_COUNT");this.passCount.string=i+": "+t}else{i=this.getLanguageText("NO_PASS_COUNT");this.passCount.string=i}}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ConfirmDialog:[function(e,t,i){"use strict";cc._RF.push(t,"6e8c94MOodByoTZPPimuvoL","ConfirmDialog");var a=e("HHCommon");cc.Class({extends:a,properties:{out:{default:null,type:cc.Node},base:{default:null,type:cc.Node},text:{default:null,type:cc.Label},timer:{default:null,type:cc.ProgressBar},yes_label:{default:null,type:cc.Label},no_label:{default:null,type:cc.Label},yes_btn:{default:null,type:cc.Button},no_btn:{default:null,type:cc.Button},close_btn:{default:null,type:cc.Node}},onLoad:function(){},init:function(e,t,i,a){var s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,r=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null;6<arguments.length&&void 0!==arguments[6]&&arguments[6],7<arguments.length&&void 0!==arguments[7]&&arguments[7];this.parent=e,this.text.string=t,this.callback=i,this.declineproc=a;var n=this.getLanguageText("OK_0"),o=this.getLanguageText("CANCEL_0");if(this.yes_label.string=n,this.no_label.string=o,r&&(r.width&&(this.base.width=r.width),r.height&&(this.base.height=r.height),r.x&&(this.base.x=r.x),r.y&&(this.base.y=r.y),r.out_opacity&&(this.out.opacity=r.out_opacity),r.yes_label&&(this.yes_label.string=r.yes_label),r.no_label&&(this.no_label.string=r.no_label),r.yes_btn_height&&(this.yes_btn.node.height=r.yes_btn_height),r.no_btn_height&&(this.no_btn.node.height=r.no_btn_height),r.yes_btn_width&&(this.yes_btn.node.width=r.yes_btn_width),r.no_btn_width&&(this.no_btn.node.width=r.no_btn_width),r.can_close&&(this.close_btn.active=!0),r.out_not_show&&(this.out.active=!1),r.no_btn_not_show&&(this.no_btn.node.active=!1),r.isChess&&(this.base.children[0].children[0].active=!1,this.base.children[0].children[1].active=!0),r.theme)){for(var l=0;l<this.base.children[0].children.length;l++)this.base.children[0].children[l].active=!1;this.base.children[0].children[r.theme-1].active=!0}s?(this._timer=0,this.times=s):this.timer.node.active=!1,this.disDialogEffect(this.base),cc.global.audio.playDialogAud()},onClickProceed:function(){this.callback&&this.callback(),this.onClickClose()},onClickDecline:function(){this.declineproc&&this.declineproc(),this.onClickClose()},onClickClose:function(){this.parent.closeConfirm()},update:function(e){this.timer&&this.times&&(this._timer<=this.times?(this.timer.progress=cc.lerp(1,0,this._timer/this.times),this._timer+=e):this.onClickDecline())}}),cc._RF.pop()},{HHCommon:"HHCommon"}],Constants:[function(e,t,i){"use strict";cc._RF.push(t,"e9ea79RlclK/adToWRqLt+M","Constants"),Object.defineProperty(i,"__esModule",{value:!0});i.realWidth=720,i.realHeight=1280,i.textureScale=1.5,i.basketryUpWidth=98,i.basketryUpHeight=26,i.slotWidth=151,i.slotHeight=12,i.basketryWidth=98,i.basketryHeight=93,i.DT_LIMIT=.01,i.BALL_LIMIT=10;cc._RF.pop()},{}],ContentAdapter:[function(e,t,i){"use strict";cc._RF.push(t,"9a4behpLwNIl6FKqAWvYdjZ","ContentAdapter"),cc.Class({extends:cc.Component,properties:{exact_width:{default:!0},exact_height:{default:!0}},onLoad:function(){this.exact_width&&(this.node.scaleX*=cc.global.narrowContentRatio),this.exact_height&&(this.node.scaleY*=cc.global.narrowContentRatio)},start:function(){}}),cc._RF.pop()},{}],CreateOrJoinDialog:[function(e,t,i){"use strict";cc._RF.push(t,"07bb0FSCBhHJq6Lz+tvssrv","CreateOrJoinDialog");var a=e("HHCommon");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},input_number:cc.Node,button_label:cc.Label},onLoad:function(){this.disDialogEffect(this.base),cc.global.audio.playDialogAud()},init:function(e,t){this.parent=e,this.number_pos=0,this.numbers=[],this.numbers[3]=this.numbers[2]=this.numbers[1]=this.numbers[0]="-",this.roominfo=t,null==this.roominfo?(this.isCreate=!1,this.button_label.string="Find Room"):(this.isCreate=!0,this.button_label.string="Create Room")},onClickNumber:function(e,t){if(!(4<=this.number_pos)){var i=parseInt(t);0<=i&&i<=9&&(this.numbers[this.number_pos]=i+"",this.input_number.children[this.number_pos].children[0].runAction(cc.sequence(cc.scaleTo(.2,2.8,1.4).easing(cc.easeIn(.2)),cc.scaleTo(.2,2,1).easing(cc.easeOut(.2)))),this.number_pos++),this.refreshnumber()}},onClickCancel:function(){this.number_pos=0,this.refreshnumber()},onClickBackspace:function(){this.numbers[this.number_pos]="-",this.number_pos--,this.number_pos<0&&(this.number_pos=0),this.refreshnumber()},refreshnumber:function(){for(var e=0;e<4;e++)"-"==this.numbers[e]&&e<this.number_pos?this.number_pos=e:e>=this.number_pos&&(this.numbers[e]="-"),this.input_number.children[e].children[0].getComponent(cc.Label).string=this.numbers[e]},onClickCreateOrJoin:function(){if(this.number_pos<4)this.alert("Code.");else{for(var e=0;e<4;e++)(this.numbers[e]<"0"||"9"<this.numbers[e])&&(this.number_pos=e,this.refreshnumber(),this.alert("Code"));this.loadding();var a=this;cc.global.http.httpPost("/hall/private_room",{password:this.numbers.join(""),create:this.isCreate,gameidx:this.roominfo?this.roominfo.gameidx:0,score:this.roominfo?this.roominfo.score:0},function(e){a.closeloadding();var t=a.parse(e);if(t&&"00"==t.status){cc.global.cur_game_condition=t.condition,cc.global.cur_game_code=t.code,cc.global.curPlaywayScore=t.score,cc.global.user.selplayway="normal",cc.global.user.roomInType="NormalJoin";var i={roomid:t.roomid};a.parent.enterGame(i),a.closeOpenWin()}else t&&t.msg&&a.alert(t.msg)},function(){a.closeloadding(),a.alert("No Internet.")},a,5e3)}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],DIZHUCardAnalyzer:[function(e,t,i){"use strict";cc._RF.push(t,"c3b6btFLr9FG5QaKkLSgLkv","DIZHUCardAnalyzer"),t.exports=function(){this.numOfIndex=[15];for(var e=0;e<13;e++)this.numOfIndex[e]=4;this.numOfIndex[13]=1,this.numOfIndex[14]=1,this.update=function(e){for(var t=0;t<e.size();t++){var i=e.get(t).rank-3;this.numOfIndex[i]--}},this.checkNoBomb=function(){if(this.numOfIndex[13]+this.numOfIndex[14]==2)return!1;for(var e=0;e<13;e++)if(4==this.numOfIndex[e])return!1;return!0},this.checkExistRocket=function(){return 2==this.numOfIndex[13]+this.numOfIndex[14]},this.verifyForSupreme=function(e){var t=e.get(0).rank-3,i=e.size();if(4==i&&this.numOfIndex[13]+this.numOfIndex[14]==2)return!1;for(var a=t+1;a<15;a++)if(this.numOfIndex[a]>=i)return!1;return!0},this.verifyForStrongSupreme=function(e){var t=e.get(0).rank-3,i=e.size();if(4==i&&this.numOfIndex[13]+this.numOfIndex[14]==2)return!1;for(var a=t;a<15;a++)if(this.numOfIndex[a]>=i)return!1;return!0},this.display=function(){for(var e="analyzer:",t=0;t<15;t++)e=e+this.numOfIndex[t]+",";return e}},cc._RF.pop()},{}],DIZHUSelCardsEngine:[function(e,t,i){"use strict";cc._RF.push(t,"a0b80/mHZ9GQYyTu2G5Bife","DIZHUSelCardsEngine");var F=e("ArrayList"),a=e("DIZHUCardAnalyzer"),E=e("CardInfo");t.exports=function(){this.cards=null,this.cardAnalyzer=new a,this.cardInfoList=new F,this.kingList=new F,this.singleList=new F,this.pairList=new F,this.threeList=new F,this.straightList=new F,this.pairStraightList=new F,this.threeStraightList=new F,this.bombList=new F,this.allSingles=new F,this.allSinglesForAI=new F,this.allPairs=new F,this.allPairsForAI=new F,this.allThrees=new F,this.allStraights=new F,this.allPairStraights=new F,this.allRecomendSingles=new F,this.allRecomendPairs=new F,this.weakList=new F,this.strongList=new F,this.analyzeCards=function(e){this.cards=new F,this.cards.addAll(e.getArray()),this.cardInfoList=new F,this.kingList=new F,this.singleList=new F,this.pairList=new F,this.threeList=new F,this.straightList=new F,this.pairStraightList=new F,this.threeStraightList=new F,this.bombList=new F,this.allSingles=new F,this.allSinglesForAI=new F,this.allPairs=new F,this.allPairsForAI=new F,this.allThrees=new F,this.allStraights=new F,this.allPairStraights=new F,this.allRecomendSingles=new F,this.allRecomendPairs=new F,this.weakList=new F,this.strongList=new F;for(var t=[],i=0;i<15;i++)k=new E(i+3),t[i]=k;for(i=0;i<e.size();i++)t[e.get(i).rank-3].addCard(e.get(i));for(i=0;i<t.length;i++)0<t[i].totalSize&&this.cardInfoList.add(t[i]);for(i=0;i<this.cardInfoList.size();i++)16!=(k=this.cardInfoList.get(i)).cardRank&&17!=k.cardRank||this.kingList.add(k.cards.get(0));for(i=0;i<this.cardInfoList.size();i++)0<(k=this.cardInfoList.get(i)).totalSize&&k.totalSize<5&&this.allSingles.add(k.cards.get(0)),0<k.totalSize&&k.totalSize<4&&this.allSinglesForAI.add(k.cards.get(0));for(i=0;i<this.kingList.size();i++)for(var a=this.kingList.get(i),s=0;s<this.cardInfoList.size();s++)k=this.cardInfoList.get(s),a.rank==k.cardRank&&k.clear();for(i=0;i<this.cardInfoList.size();i++)2!=(k=this.cardInfoList.get(i)).totalSize&&3!=k.totalSize&&4!=k.totalSize||((S=new F).add(k.cards.get(0)),S.add(k.cards.get(1)),this.allPairs.add(S)),2!=k.totalSize&&3!=k.totalSize||((S=new F).add(k.cards.get(0)),S.add(k.cards.get(1)),this.allPairsForAI.add(S));var r=new F,n=new F;for(i=0;i<this.cardInfoList.size();i++)switch((k=this.cardInfoList.get(i)).totalSize){case 2:break;case 3:(S=new F).add(k.cards.get(0)),S.add(k.cards.get(1)),r.add(S);break;case 4:(S=new F).add(k.cards.get(0)),S.add(k.cards.get(1)),n.add(S)}for(i=0;i<this.cardInfoList.size();i++)if(3==(k=this.cardInfoList.get(i)).totalSize){var o=new F;o.addAll(k.cards.getArray()),this.allThrees.add(o)}var l=0;for(i=0;i<this.cardInfoList.size()-1;i++)if(f=new F,0<(k=this.cardInfoList.get(i)).totalSize&&k.cardRank<15&&(a=k.cards.get(0),f.add(a)),l<=i){for(s=i+1;s<this.cardInfoList.size()&&0<(b=this.cardInfoList.get(s)).totalSize&&b.cardRank<15&&Math.abs(b.cardRank-k.cardRank)==s-i;s++)v=b.cards.get(0),f.add(v),l=s;5<=f.size()&&this.allStraights.add(f)}for(i=l=0;i<this.cardInfoList.size()-1;i++)if(y=new F,1<(k=this.cardInfoList.get(i)).totalSize&&k.cardRank<15&&(y.add(k.cards.get(0)),y.add(k.cards.get(1))),l<=i){for(s=i+1;s<this.cardInfoList.size()&&1<(b=this.cardInfoList.get(s)).totalSize&&b.cardRank<15&&Math.abs(b.cardRank-k.cardRank)==s-i;s++)y.add(b.cards.get(0)),y.add(b.cards.get(1)),l=s;6<=y.size()&&this.allPairStraights.add(y)}for(i=0;i<this.cardInfoList.size();i++)if(3==(k=this.cardInfoList.get(i)).totalSize&&k.cardRank<15){var c=new F;for(c.addAll(k.cards.getArray()),s=i+1;s<this.cardInfoList.size()&&3==(C=this.cardInfoList.get(s)).totalSize&&Math.abs(C.cardRank-k.cardRank)==s-i&&C.cardRank<15;s++)c.addAll(C.cards.getArray());if(3<c.size())for(this.threeStraightList.add(c),_=0;_<c.size();_++)for(var h=c.get(_),d=0;d<this.cardInfoList.size();d++){var u=this.cardInfoList.get(d);h.rank==u.cardRank&&u.clear()}}var p=0;for(i=0;i<this.cardInfoList.size();i++){p=0;var g=null,m=null;if((2==(k=this.cardInfoList.get(i)).totalSize||3==k.totalSize)&&k.cardRank<15){var y=new F;for(2==k.totalSize?y.addAll(k.cards.getArray()):g=k,s=i+1;s<this.cardInfoList.size()&&(2==(b=this.cardInfoList.get(s)).totalSize||3==b.totalSize)&&Math.abs(k.cardRank-b.cardRank)==s-i&&b.cardRank<15;s++)if(2==(m=b).totalSize)y.addAll(b.cards.getArray());else{if(1<++p)break;y.add(b.cards.get(0)),y.add(b.cards.get(1))}if(4==y.size()&&0==p&&null!=g&&(y.addAtIndex(0,g.cards.get(0)),y.addAtIndex(0,g.cards.get(1))),7<y.size()&&3==m.totalSize&&(y.removeAtIndex(y.size()-1),y.removeAtIndex(y.size()-1)),5<y.size())for(this.pairStraightList.add(y),_=0;_<y.size();_++)for(h=y.get(_),d=0;d<this.cardInfoList.size();d++)(C=this.cardInfoList.get(d)).cardRank==h.rank&&(2==C.totalSize?C.clear():3==C.totalSize&&(C.cards.removeAtIndex(0),C.cards.removeAtIndex(1),C.totalSize-=2))}}for(i=0;i<this.cardInfoList.size();i++){p=0;var f=new F;g=null,m=null;for(0<(k=this.cardInfoList.get(i)).totalSize&&k.totalSize<4&&k.cardRank<15&&(a=k.cards.get(0),1==k.totalSize&&f.add(a),3==k.totalSize&&(g=k,p++),2==k.totalSize&&(g=k,p+=.5)),s=i+1;s<this.cardInfoList.size();s++){var b=this.cardInfoList.get(s);if(!(0<b.totalSize&&b.totalSize<4&&b.cardRank<15&&Math.abs(k.cardRank-b.cardRank)==s-i))break;if(3==b.totalSize&&p++,2==b.totalSize&&(p+=.5),1<p)break;var v=b.cards.get(0);f.add(v),m=b}if(p<1&&4==f.size()&&null!=g&&(a=g.cards.get(0),f.addAtIndex(0,a)),5<=f.size()){5<f.size()&&p==.5*(m.totalSize-1)&&0<p&&f.removeAtIndex(f.size()-1),this.straightList.add(f);for(var _=0;_<f.size();_++)for(h=f.get(_),d=0;d<this.cardInfoList.size();d++){var C=this.cardInfoList.get(d);if(h.rank==C.cardRank){C.cards.removeAtIndex(0),C.totalSize--;break}}}}for(i=0;i<this.cardInfoList.size();i++)1==(k=this.cardInfoList.get(i)).totalSize&&(this.singleList.addAll(k.cards.getArray()),(B=new F).add(k.cards.get(0)),this.allRecomendSingles.add(B),k.clear());if(!this.straightList.isEmpty())for(i=0;i<this.straightList.size();i++)for(s=(A=this.straightList.get(i)).size()-1;4<s;s--)L=A.get(s),(N=new F).add(L),this.allRecomendSingles.add(N);for(i=0;i<this.cardInfoList.size();i++){var k=this.cardInfoList.get(i),w=new F;2==k.totalSize&&(w.addAll(k.cards.getArray()),this.pairList.add(w),(B=new F).add(w.get(0)),this.allRecomendSingles.add(B),k.clear())}for(i=0;i<this.cardInfoList.size();i++){k=this.cardInfoList.get(i);var T=new F;3==k.totalSize&&(T.addAll(k.cards.getArray()),this.threeList.add(T),(B=new F).add(T.get(0)),this.allRecomendSingles.add(B),k.clear())}if(!this.pairStraightList.isEmpty())for(i=0;i<this.pairStraightList.size();i++){var P=this.pairStraightList.get(i);for(s=0;s<P.size();s+=2)(B=new F).add(P.get(s)),this.allRecomendSingles.add(B);if(P.size()<7)for(s=0;s<P.size();s+=2)(S=new F).add(P.get(s)),S.add(P.get(s+1)),this.allRecomendPairs.add(S);else for(s=P.size()-1;0<=s;s-=2)(S=new F).add(P.get(s)),S.add(P.get(s-1)),this.allRecomendPairs.add(S)}this.allRecomendPairs.addAll(r),this.allRecomendPairs.addAll(n);var x=new F;for(i=0;i<this.allPairs.size();i++){var S=this.allPairs.get(i);for(s=0;s<this.allRecomendPairs.size()&&S.get(0).rank!=this.allRecomendPairs.get(s).get(0).rank;s++);s>this.allRecomendPairs.size()-1&&x.add(S)}if(this.allRecomendPairs.addAll(x),!this.threeStraightList.isEmpty())for(i=0;i<this.threeStraightList.size();i++){var R=this.threeStraightList.get(i);for(s=0;s<R.size();s+=3)(B=new F).add(R.get(s)),this.allRecomendSingles.add(B)}if(!this.straightList.isEmpty())for(i=0;i<this.straightList.size();i++){var A=this.straightList.get(i);for(s=(A.size(),4);0<=s;s--){var L=A.get(s),N=new F;N.add(L),this.allRecomendSingles.add(N)}}for(1==this.kingList.size()&&((B=new F).add(this.kingList.get(0)),this.allRecomendSingles.add(B),this.singleList.add(this.kingList.removeAtIndex(0))),i=0;i<this.cardInfoList.size();i++){k=this.cardInfoList.get(i);var I=new F;4==k.totalSize&&(I.addAll(k.cards.getArray()),this.bombList.add(I),(B=new F).add(I.get(0)),this.allRecomendSingles.add(B),this.allThrees.add(k.cards.getSubList(0,3)),k.clear())}if(2==this.kingList.size()){var B=new F;B.add(this.kingList.get(0)),this.allRecomendSingles.add(B),(B=new F).add(this.kingList.get(1)),this.allRecomendSingles.add(B)}this.setStrategy()},this.setStrategy=function(){for(this.weakList.clear(),this.strongList.clear(),d=0;d<this.threeStraightList.size();d++){var e=new F;e.addAll(this.threeStraightList.get(d).getArray());var t=Math.floor(e.size()/3);if(this.singleList.size()>=t)for(n=0;n<t;n++){var i=this.singleList.removeAtIndex(0);e.add(i)}else if(this.pairList.size()>=t)for(n=0;n<t;n++)o=this.pairList.removeAtIndex(0),e.addAll(o.getArray());this.weakList.add(e)}for(d=0;d<this.threeList.size();d++){var a=new F;a.addAll(this.threeList.get(d).getArray());var s=this.cardAnalyzer.verifyForSupreme(a);if(!this.singleList.isEmpty())for(n=0;n<this.singleList.size();n++){var r=new F;if(r.add(this.singleList.get(n)),!this.cardAnalyzer.verifyForSupreme(r)||4==this.cards.size()){a.add(this.singleList.removeAtIndex(n));break}}if(3==a.size()&&!this.pairList.isEmpty())for(var n=0;n<this.pairList.size();n++)if(o=this.pairList.get(n),!this.cardAnalyzer.verifyForSupreme(o)||5==this.cards.size()){a.addAll(this.pairList.removeAtIndex(n).getArray());break}s?this.strongList.add(a):this.weakList.add(a)}for(d=0;d<this.singleList.size();d++)(h=new F).add(this.singleList.get(d)),this.cardAnalyzer.verifyForSupreme(h)?this.strongList.add(h):this.weakList.add(h);for(d=0;d<this.pairList.size();d++){var o=this.pairList.get(d);this.cardAnalyzer.verifyForSupreme(o)?this.strongList.add(o):this.weakList.add(o)}for(d=0;d<this.pairStraightList.size();d++){var l=this.pairStraightList.get(d);14==l.get(l.size()-1).rank?this.strongList.add(l):this.weakList.add(l)}for(d=0;d<this.straightList.size();d++){var c=this.straightList.get(d);14==c.get(c.size()-1).rank?this.strongList.add(c):this.weakList.add(c)}for(this.sortGroupList(this.weakList),this.sortGroupList(this.strongList),d=0;d<this.bombList.size();d++)this.strongList.add(this.bombList.get(d));if(2==this.kingList.size()){for(var h=new F,d=0;d<this.kingList.size();d++)h.add(this.kingList.get(d));this.strongList.add(h)}},this.getPossibleCards=function(e){if(this.analyzeCards(e),0<this.getBetCardsType(e))return e;var t=new F,i=new F;if(this.allPairStraights.isEmpty()||(t=this.allPairStraights.get(0)),!this.allStraights.isEmpty())return i=this.allStraights.get(0),t.size()<=i.size()&&(t=i),t;if(t.clear(),0<this.bombList.size()&&1<this.allPairsForAI.size())return t.addAll(this.bombList.get(0)),t.addAll(this.allPairsForAI.get(0)),t.addAll(this.allPairsForAI.get(1)),t;if(t.clear(),0<this.bombList.size()&&1<this.allSinglesForAI.size())return t.addAll(this.bombList.get(0)),t.add(this.allSinglesForAI.get(0)),t.add(this.allSinglesForAI.get(1)),t;t.clear();for(var a=0,s=0;s<this.weakList.size();s++)(r=this.weakList.get(s)).size()>a&&(a=r.size(),t=r);for(s=0;s<this.strongList.size();s++){var r=this.strongList.get(s);r.size()>a&&(a=r.size(),t=r)}return t},this.getBetCardsType=function(e){var t=e.size();switch(t){case 1:return 1;case 2:if(15<e.get(0).rank&&15<e.get(1).rank)return 14;if(e.get(0).rank==e.get(1).rank)return 2;break;case 3:if(e.get(0).rank==e.get(1).rank&&e.get(0).rank==e.get(2).rank)return 3;break;case 4:for(var i=0,a=0;a<3;a++)e.get(a).rank==e.get(a+1).rank&&i++;if(3==i)return 13;if(e.get(0).rank==e.get(1).rank&&e.get(0).rank==e.get(2).rank)return 6;if(e.get(1).rank==e.get(2).rank&&e.get(1).rank==e.get(3).rank)return 6;break;case 5:if(e.get(0).rank==e.get(1).rank&&e.get(0).rank==e.get(2).rank&&e.get(3).rank==e.get(4).rank)return 7;if(e.get(2).rank==e.get(3).rank&&e.get(2).rank==e.get(4).rank&&e.get(0).rank==e.get(1).rank)return 7;for(a=0;a<t-1;a++)if(e.get(a+1).rank-e.get(a).rank!=1)return-1;if(e.get(t-1).rank<15)return 4;break;default:if(t%2==0){i=0;var s=e.get(0).rank;for(a=0;a<t/2;a++)e.get(2*a).rank==e.get(2*a+1).rank&&e.get(2*a).rank==s+a&&i++;if(i==t/2&&e.get(t-1).rank-e.get(0).rank==t/2-1&&e.get(t-1).rank<15)return 5}var r=[];for(a=0;a<15;a++){var n=new E(a+3);r[a]=n}for(a=0;a<t;a++)r[e.get(a).rank-3].addCard(e.get(a));var o=0,l=0,c=0,h=0,d=-1,u=0;for(a=0;a<r.length;a++)4==r[a].totalSize&&o++,3==r[a].totalSize&&r[a].cardRank<15&&(-1==d?(d=a,l++):a-d==1&&(d=a,l++)),2==r[a].totalSize&&c++,1==r[a].totalSize&&(h++,15<r[a].cardRank&&u++);if(0==h&&0==c&&0==o&&1<l)return 8;if(0==c&&0==o&&1<l&&l==h&&u<2)return 9;if(0==h&&0==o&&1<l&&l==c)return 10;if(0==c&&0==l&&1==o&&2==h&&u<2)return 11;if(2==c&&0==l&&1==o&&0==h)return 12;for(a=0;a<t-1;a++)if(1!=Math.abs(e.get(a+1).rank-e.get(a).rank))return-1;if(e.get(t-1).rank<15)return 4}return-1},this.sortGroupList=function(e){var t=e.getArray();e.clear();for(var i=1;i<t.length;i++){for(var a=t[i],s=i-1;0<=s&&t[s].get(0).rank>a.get(0).rank;)t[s+1]=t[s],s--;t[s+1]=a}e.addAll(t)}},cc._RF.pop()},{ArrayList:"ArrayList",CardInfo:"CardInfo",DIZHUCardAnalyzer:"DIZHUCardAnalyzer"}],DailyRewardDlg:[function(e,t,i){"use strict";cc._RF.push(t,"db6c8xFAAdHXIk80feJWxUo","DailyRewardDlg");var a=e("HHCommon");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},desc:{default:null,type:cc.Label},days:{default:null,type:cc.Node},eventPane:{default:null,type:cc.Node},eventDesc:{default:null,type:cc.Label},total:{default:null,type:cc.Label},star:{default:null,type:cc.Node},goldslot:{default:null,type:cc.Node},award:{default:null,type:cc.Node},owngold:{default:null,type:cc.Label},awardgold:{default:null,type:cc.Label},awardShadow:{default:null,type:cc.Node},fireworks:{default:null,type:cc.ParticleSystem}},onLoad:function(){cc.global.audio.playDialogAud()},init:function(e,t){this.parent=e,this.data=t,this.preCeremonyGold=cc.global.user.goldcoins,this.owngold=this.parent.goldcoins;for(var i=0;i<this.days.children.length;i++)i+1==parseInt(this.data.ctive)?this.days.children[i].getComponent("NotifyTabButton").init(!0,0):this.days.children[i].getComponent("NotifyTabButton").init(!1,0);this.data.des?(this.eventPane.active=!0,this.eventDesc.string=this.data.des):this.eventPane.active=!1,this.desc.string="",this.desc.string+=this.data.ctive+"Day "+this.numformat(parseInt(this.data.defreward)+parseInt(this.data.defreward)*this.data.ctive/10),0<parseInt(this.data.holreward)&&(this.desc.string+="\nHoliday: "+this.numformat(this.data.holreward)),0<parseInt(this.data.birreward)&&(this.desc.string+="\nBirthday: "+this.numformat(this.data.birreward)),0<parseInt(this.data.sunreward)&&(this.desc.string+="\nWeekend: "+this.numformat(this.data.sunreward)),0<parseInt(this.data.imgreward)&&(this.desc.string+="\nAvatar: "+this.numformat(this.data.imgreward)),0<parseInt(this.data.vipreward)&&(this.desc.string+="\nVip: "+this.numformat(this.data.vipreward)),0<parseInt(this.data.medreward)&&(this.desc.string+="\nMedals: "+this.numformat(this.data.medreward)),0<parseInt(this.data.topreward)&&(this.desc.string+="\nRecords: "+this.numformat(this.data.topreward)),this.total.string=this.numformat(this.data.sum)},onClickReceiveReward:function(){var i=this;i.loadding(),cc.global.http.httpPost("/hall/getdr",{},function(e){if(i.closeloadding(),null!=e&&""!=e)if("00"==e)i.awardCeremony(i.data.sum),cc.global.user.drewards=null,setTimeout(function(){i.closeOpenWin()},1200);else if("01"==e)i.alert("");else if("02"==e)i.alert(".");else if("03"==e)i.alert(".");else{t=i.getLanguageText("ERROR_IN_PROCESSING");i.alert(t)}else{var t=i.getLanguageText("ERROR_IN_SERVER_RESPONSE");i.alert(t)}},function(){i.closeloadding();var e=i.getLanguageText("CONNECTING_FAILED_0");i.alert(e)},i,5e3)},awardCeremony:function(e){this.awardgold.string=e,this.awardShadow.runAction(cc.sequence(cc.fadeIn(.2),cc.delayTime(1.35),cc.fadeOut(.2))),this.award.runAction(cc.sequence(cc.fadeIn(0),cc.scaleTo(0,0,0),cc.scaleTo(.2,1.1,1.1),cc.scaleTo(.1,.6,.6),cc.scaleTo(.15,1,1),cc.delayTime(1),cc.fadeOut(.2))),this.fireworks.resetSystem(),this.goldslot.runAction(cc.sequence(cc.delayTime(.4),cc.fadeIn(.05),cc.delayTime(1),cc.fadeOut(.05)));var o=this.goldslot.position,t=cc.callFunc(function(e,t){var i=cc.instantiate(t.script.star),a=cc.callFunc(function(e){e.destroy()},i),s=cc.callFunc(function(e,t){t.script.preCeremonyGold=t.script.preCeremonyGold+Math.round(t.prize/5),t.owngold&&(t.owngold.string=t.script.numformat(t.script.preCeremonyGold),t.owngold.node.runAction(cc.sequence(cc.scaleTo(.05,1.1,1.1),cc.scaleTo(.05,1,1))))},e,t),r=parseInt(1e3*Math.random())%10,n=parseInt(1e3*Math.random())%10;i.position=new cc.Vec2(28+r,18+n),i.scale=new cc.Vec2(2,2),i.parent=e,i.runAction(cc.sequence(cc.moveTo(.4,o.x,o.y).easing(cc.easeOut(.4)),s)),i.runAction(cc.sequence(cc.scaleTo(.4,1,1).easing(cc.easeOut(.4)),cc.delayTime(.2),a))},this,{script:this,owngold:this.owngold,prize:e}),i=cc.sequence(cc.delayTime(.1),t,cc.delayTime(.1),t,cc.delayTime(.1),t,cc.delayTime(.1),t,cc.delayTime(.1),t);this.node.runAction(i)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],Deck:[function(e,t,i){"use strict";cc._RF.push(t,"8e19c4Ru8lE6YrGL9wuw3Sy","Deck");var a=e("ArrayList"),s=e("Card");t.exports=function(){this.makeEngineCardArray=function(e){for(var t=new a,i=0;i<e.length;i++)t.add(this.getCard(e[i]));return t},this.getNumber=function(e){return 4*(e.rank-3)+(e.suit-1)},this.getCard=function(e){var t=Math.floor(e/4);return new s(e%4+1,t+3)},this.getRandomInteger=function(e,t){return Math.floor(Math.random()*(t-e))+e}},cc._RF.pop()},{ArrayList:"ArrayList",Card:"Card"}],DeclarePanel:[function(a,e,t){"use strict";cc._RF.push(e,"22dcdNHbUhE4b4n6n4DmpnG","DeclarePanel");var i=a("HHCommon");cc.Class({extends:i,properties:{buynum:{default:null,type:cc.Node},selmc:{default:null,type:cc.Node},mc_suit_option:{default:null,type:cc.Node},mc_rank_option:{default:null,type:cc.Node},selpartner:{default:null,type:cc.Node},ptn_suit_option:{default:null,type:cc.Node},ptn_rank_option:{default:null,type:cc.Node},atlas:{default:null,type:cc.SpriteAtlas},timer:{default:null,type:cc.Node},ptn_option:{default:null,type:cc.Node},tab_sd:{default:null,type:cc.Node},tab_ad:{default:null,type:cc.Node},panel_sd:{default:null,type:cc.Node},panel_ad:{default:null,type:cc.Node}},onLoad:function(){},clearAll:function(){this.callNum=0,this.master_rank=0,this.master_suit=0,this.ptn_rank=0,this.ptn_suit=0,this.fbm=!1,this.buynum.getComponent(cc.Sprite).spriteFrame=null,this.cleanMasterSuitSelection(),this.cleanMasterRankSelection(),this.cleanPtnSuitSelection(),this.cleanPtnRankSelection(),this.rtgametimer&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc)},init:function(e,t){this.is3=t,this.callNum=e.ratio,this.master_rank=0,this.master_suit=0,this.ptn_rank=0,this.ptn_suit=0,this.fbm=!1,this.initOptions(e.ratio),this.updateMaster(),this.updatePtn(),this.rtgametimer&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc);var i=a("GameTimer");this.rtgametimer=new i,this.timesrc=this.rtgametimer.runtimerBmpFnt(this,this.timer,e.timer)},initOptions:function(e){var t="game_buy_btn_"+e;this.buynum.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(t),this.initMasterOptions(e),this.initPtnOptions(e)},initMasterOptions:function(e){this.mc_rank_option.active=!(e<100),this.mc_suit_option.children[4].active=!(e<100)},initPtnOptions:function(e){for(t=0;t<this.ptn_suit_option.children.length;t++)this.ptn_suit_option.children[t].active=!0;for(var t=0;t<this.ptn_rank_option.children.length;t++)this.ptn_rank_option.children[t].active=!0;switch(e){case 75:this.ptn_suit_option.children[4].active=this.ptn_suit_option.children[5].active=this.ptn_suit_option.children[6].active=!1,this.ptn_suit_option.children[7].active=!1,this.ptn_rank_option.children[0].active=!1;break;case 80:case 85:this.ptn_suit_option.children[4].active=this.ptn_suit_option.children[5].active=this.ptn_suit_option.children[6].active=!1,this.ptn_suit_option.children[7].active=!1;break;case 90:this.ptn_suit_option.children[5].active=this.ptn_suit_option.children[6].active=!1,this.ptn_suit_option.children[7].active=!1;break;case 95:this.ptn_suit_option.children[6].active=!1,this.ptn_suit_option.children[7].active=!1;break;case 100:this.ptn_suit_option.children[7].active=!0}},onSelectTab:function(e,t){"sd"==t?(this.tab_sd.getComponent(cc.Sprite).enabled=!1,this.tab_sd.children[0].active=!0,this.tab_sd.children[1].active=!1,this.tab_ad.getComponent(cc.Sprite).enabled=!0,this.tab_ad.children[0].active=!1,this.tab_ad.children[1].active=!0,this.panel_sd.active=!0,this.panel_ad.active=!1):"ad"!=t||this.is3||(this.tab_sd.getComponent(cc.Sprite).enabled=!0,this.tab_sd.children[0].active=!1,this.tab_sd.children[1].active=!0,this.tab_ad.getComponent(cc.Sprite).enabled=!1,this.tab_ad.children[0].active=!0,this.tab_ad.children[1].active=!1,this.panel_sd.active=!1,this.panel_ad.active=!0)},onSelectMainSuit:function(e,t){if(15<=this.master_rank)return cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.getComponent("ToastCtrl").init(""," ."),void(cc.global.opentoast.parent=this.node);if(this.cleanMasterSuitSelection(),this.master_suit!=parseInt(t)){if(14==this.master_rank&&4==parseInt(t))return cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.getComponent("ToastCtrl").init("","."),void(cc.global.opentoast.parent=this.node);this.master_suit=parseInt(t),e.target.parent.children[1].active=!0}else this.master_suit=0,e.target.parent.children[1].active=!1;this.changeRankOptionForSuit(),this.updateMaster()},onSelectMainSuitRank:function(e,t){this.cleanMasterSuitSelection(),this.cleanMasterRankSelection();var i=t.split(",");this.master_rank!=parseInt(i[0])?(this.master_rank=parseInt(i[0]),e.target.getComponent(cc.Sprite).enabled=!0):this.master_rank=0,this.master_suit!=parseInt(i[1])?(this.master_suit=parseInt(i[1]),e.target.getComponent(cc.Sprite).enabled=!0):this.master_suit=0,this.updateMaster()},onSelectMainRank:function(e,t){if(this.cleanMasterRankSelection(),this.master_rank!=parseInt(t)){if(15<=parseInt(t)||4==this.master_suit&&14==parseInt(t))return cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.getComponent("ToastCtrl").init("","."),void(cc.global.opentoast.parent=this.node);this.master_rank=parseInt(t),e.target.getComponent(cc.Sprite).enabled=!0}else this.master_rank=0,e.target.getComponent(cc.Sprite).enabled=!1;this.updateMaster()},changeRankOptionForSuit:function(){switch(this.callNum){case 75:4==this.ptn_suit?(this.ptn_rank_option.children[1].active=!1,14==this.ptn_rank&&(this.ptn_rank=0)):this.ptn_rank_option.children[1].active=!0;break;case 80:4==this.ptn_suit?(this.ptn_rank_option.children[1].active=!1,14==this.ptn_rank&&(this.ptn_rank=0)):this.ptn_rank_option.children[1].active=!0,this.ptn_suit==this.master_suit?this.ptn_rank_option.children[0].active=!1:this.ptn_rank_option.children[0].active=!0;break;case 85:4==this.ptn_suit?(this.ptn_rank_option.children[1].active=!1,14==this.ptn_rank&&(this.ptn_rank=0)):this.ptn_rank_option.children[1].active=!0}},onSelectPtnSuit:function(e,t){this.cleanPtnSuitSelection(),14==this.ptn_rank&&4==this.ptn_suit&&(this.ptn_rank=0,this.ptn_suit=0),16<=this.ptn_rank&&5<=this.ptn_suit&&(this.ptn_rank=0),0==this.ptn_rank&&0==this.ptn_suit&&(this.ptn_rank=0),this.ptn_suit=parseInt(t),this.checkPartnerShip()||(this.ptn_rank=0),e.target.parent.children[1].active=!0,this.fbm=!1,this.changeRankOptionForSuit(),this.updatePtn()},onSelectPtnRank:function(e,t){14==this.ptn_rank&&4==this.ptn_suit&&(this.cleanPtnSuitSelection(),this.ptn_suit=0),16<=this.ptn_rank&&5<=this.ptn_suit&&(this.cleanPtnSuitSelection(),this.ptn_suit=0),0==this.ptn_rank&&0==this.ptn_suit&&this.cleanPtnSuitSelection(),this.cleanPtnRankSelection(),this.ptn_rank=parseInt(t),e.target.getComponent(cc.Sprite).enabled=!0,this.fbm=!1,this.updatePtn()},onSelectPtnSuitRank:function(e,t){this.cleanPtnRankSelection(),this.cleanPtnSuitSelection();var i=t.split(",");this.ptn_rank=parseInt(i[0]),this.ptn_suit=parseInt(i[1]),e.target.parent.children[1].active=!0,this.fbm=!1,this.updatePtn()},onSelectFBM:function(e){this.cleanPtnRankSelection(),this.cleanPtnSuitSelection(),this.ptn_rank=0,this.ptn_suit=0,e.target.parent.children[1].active=!0,this.fbm=!0,this.updatePtn()},cleanMasterSuitSelection:function(){for(var e=0;e<this.mc_suit_option.children.length;e++)this.mc_suit_option.children[e].children[1].active=!1},cleanMasterRankSelection:function(){for(var e=0;e<this.mc_rank_option.children.length;e++)this.mc_rank_option.children[e].getComponent(cc.Sprite).enabled=!1},cleanPtnSuitSelection:function(){for(var e=0;e<this.ptn_suit_option.children.length;e++)this.ptn_suit_option.children[e].children[1].active=!1},cleanPtnRankSelection:function(){for(var e=0;e<this.ptn_rank_option.children.length;e++)this.ptn_rank_option.children[e].getComponent(cc.Sprite).enabled=!1},updateMaster:function(){this.selmc&&this.selmc.children[0].getComponent("FiveDeclareCard").init(this.master_rank,this.master_suit,!1,!1)},checkPartnerShip:function(){switch(this.callNum){case 75:if(4==this.ptn_suit&&14==this.ptn_rank)return!1;break;case 80:if(4==this.ptn_suit&&14==this.ptn_rank)return!1;if(this.ptn_suit==this.master_suit&&15==this.ptn_rank)return!1;break;case 85:if(4==this.ptn_suit&&14==this.ptn_rank)return!1}return!0},updatePtn:function(){this.selpartner&&this.selpartner.children[0].getComponent("FiveDeclareCard").init(this.ptn_rank,this.ptn_suit,!1,this.fbm)},onClickConfirmDeclare:function(){var e=this.getLanguageText("SELECT_YOUR_PARTNER"),t=this.getLanguageText("SELECT_MUSTER_CARD");if(0!=this.master_rank||0!=this.master_suit)if(this.is3||0!=this.ptn_rank&&0!=this.ptn_suit||0!=this.fbm){var i=this.socket();this.is3?i.exec("callevent",{extparams:{masterrank:this.master_rank,mastersuit:this.master_suit,findrank:0,findsuit:-1,fbm:!1}}):i.exec("callevent",{extparams:{masterrank:this.master_rank,mastersuit:this.master_suit,findrank:this.ptn_rank,findsuit:this.ptn_suit,fbm:this.fbm}})}else null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.getComponent("ToastCtrl").init("",e),cc.global.opentoast.parent=this.node);else null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.getComponent("ToastCtrl").init("",t),cc.global.opentoast.parent=this.node)},changeTheme:function(e){}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],DizhuBegin:[function(e,t,i){"use strict";cc._RF.push(t,"27afadqEcZGtoZxe+zhXreM","DizhuBegin");var a=e("HHCommon"),s=e("Deck"),r=e("DIZHUSelCardsEngine");cc.Class({extends:a,properties:{global:{default:null,type:cc.Node},readybtn:{default:null,type:cc.Node},poker:{default:null,type:cc.Node},lastCardsPanel:{default:null,type:cc.Node},ratio:{default:null,type:cc.Label},summary:{default:null,type:cc.Prefab},touch:{default:null,type:cc.Node},effect:{default:null,type:cc.Node},players:{default:null,type:cc.Node},btn_enter:{default:null,type:cc.Node},roomid:{default:null,type:cc.Label},leavereq:{default:null,type:cc.Node},chat:{default:null,type:cc.Prefab},chatsearch:{default:null,type:cc.Prefab},emodlg:{default:null,type:cc.Prefab},lbl_task:{default:null,type:cc.Label},unselect:{default:null,type:cc.Node},cardscount:{default:null,type:cc.Node},roominfo:{default:null,type:cc.Node},roomscore:{default:null,type:cc.Label},roomnumber:{default:null,type:cc.Label},observer:{default:null,type:cc.Prefab},obsbench:{default:null,type:cc.Node},obsbench1:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},obschatbtn:{default:null,type:cc.Node},obsemojibtn:{default:null,type:cc.Node},btn_sfx:{default:null,type:cc.Node},btn_robot:{default:null,type:cc.Node},gameboardmark:{default:null,type:cc.Node},btn_record_play:{default:null,type:cc.Node},lbl_record_status:{default:null,type:cc.Label},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},illegalconfirm:{default:null,type:cc.Prefab},btn_find_empty:{default:null,type:cc.Node},select_winner:{default:null,type:cc.Prefab},roomrankdialog:{default:null,type:cc.Prefab},roommarkatlas:{default:null,type:cc.SpriteAtlas},lastcardprefab:{default:null,type:cc.Prefab},background:{default:null,type:cc.Node},buttons:{default:null,type:cc.Node},bar_bottom:{default:null,type:cc.Node},settinglayer:{default:null,type:cc.Node},settingback:{default:null,type:cc.Node},switchtogame:{default:null,type:cc.Node},raiseAni:{default:null,type:cc.Node},soundbtn:cc.Node},onLoad:function(){var e=this;e.switchtogame.active=!0,e.switchtogame.getComponent(cc.Animation).play("door_open"),cc.global.audio.playEffectAud("door"),setTimeout(function(){e.onStartGame()},700),this.curTheme=parseInt(cc.global.game_theme_idx),this.changeTheme(this.curTheme),this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged()},onStartGame:function(){this.show_setting=!1,this.initEventCallback(),cc.game.setFrameRate(30),this.curBgIdx=1,this.curCardsCountMode=JSON.parse(cc.sys.localStorage.getItem("dizhu_calc_mode")),null==this.curCardsCountMode&&(this.curCardsCountMode=1),this.goRecovery=!1,this.initUI(),this.player=new Array,this.observerlist=new Array,this.pokercards=new Array,this.lastcards=new Array,this.cardsArr=new Array,this.summarypage=null,this.inited=!1,this.lasttip=null,this.score="1",this.play_status=0,this.upCardsCount=0,this.rerenderPlayers=[],this.isOnSummary=!1,this.notReplay=!0,this.gameCleaned=!1,cc.global.amObserve="no",null!=cc.global&&(""!=cc.global.user.roomid&&this.recovery(),this.initgame()),cc.global.watchReplayData.onReplay&&this.prepareReplay(),this.deck=new s,this.engine=new r,this.touch.width=this.touch.width/cc.global.narrowContentRatio},initUI:function(){cc.global.audio.playBGM("bgm_card");var e=JSON.parse(cc.sys.localStorage.getItem("show_record"));JSON.parse(cc.sys.localStorage.getItem("sfx_on1"))?(this.soundbtn.children[1].active=!0,this.soundbtn.children[0].active=!1):(this.soundbtn.children[0].active=!0,this.soundbtn.children[1].active=!1),this.cardscount.active=!e},prepareReplay:function(){this.notReplay=!1,cc.global.amObserve="yes",this.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),this.replay_bar.active=!0,this.replayStep="ready_room",this.replaySeq=0,this.replayTimeDelay=0,this.createReplayTimer(),this.bar_bottom.active=!1,this.buttons.children[2].active=!1},createReplayTimer:function(){var e=this;this.replayTimer=setInterval(function(){e.play_history&&(e.replayTimeDelay-=30*cc.global.watchReplayData.replaySpeedX,e.replayTimeDelay<=0&&e.play_history[e.replaySeq]&&e.goReplay())},30)},pauseReplayTimer:function(){clearInterval(this.replayTimer)},resumeReplayTimer:function(){this.createReplayTimer()},goReplay:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=!1;switch(this.replayStep){case"ready_room":this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"play":t=!0,this.replay_play_event(i,this);break;case"catch":this.catch_event(i,this);break;case"catchresult":this.catchresult_event(i,this);break;case"lasthands":this.lasthands_event(i,this);break;case"bet":t=!0,this.takecards_event(i,this);break;case"stips":t=!0,this.seltips_event(i,this);break;case"ratio":t=!0,this.ratio_event(i,this);break;case"allcards":t=!0,this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.selemoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"players":this.players_event(i,this);break;case"exit":this.leave_event(i,this);break;case"cal":t=!0,this.remaincards_event(i,this)}}""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,this.play_history[this.replaySeq]||(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.pauseReplayTimer()),e&&!t&&this.goReplay(!0)},exitPlay:function(){cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearInterval(this.replayTimer),clearTimeout(this.deal1_timer),clearTimeout(this.deal2_timer),clearTimeout(this.bankerSelfTimer),clearTimeout(this.bankerOtherTimer),this.rerenderPlayers=[],this.isOnSummary=!1,this.returnToHall()},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.gameTimerSpeedChange(!0),this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):(this.replayTimer&&clearInterval(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.gameTimerSpeedChange(!1),this.replay_bar.children[0].opacity=100,this.pauseReplayTimer())},onClickReplayStop:function(){},onClickReplaySpeedUp:function(){var e=this.getLanguageText("REPLAY_TIME")+" : ";cc.global.watchReplayData.replaySpeedX<5&&(cc.global.watchReplayData.replaySpeedX++,this.lbl_replaySpeedX.string=e+cc.global.watchReplayData.replaySpeedX+"x",this.gameTimerSpeedChange(!0),this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){var e=this.getLanguageText("REPLAY_TIME")+" : ";1<cc.global.watchReplayData.replaySpeedX&&(cc.global.watchReplayData.replaySpeedX--,this.lbl_replaySpeedX.string=e+cc.global.watchReplayData.replaySpeedX+"x",this.gameTimerSpeedChange(!0),this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},togglePlayToPause:function(){this.replayTimer&&clearInterval(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.gameTimerSpeedChange(!1),this.replay_bar.children[0].opacity=100,this.pauseReplayTimer()},onClickReplayNextTurn:function(){this.togglePlayToPause(),this.goReplay(!0)},onClickReplayPrevTurn:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.goReplay(!0))},gameTimerSpeedChange:function(e){if(this&&this.player)for(var t=0;t<this.player.length;t++){var i=this.player[t].getComponent("DizhuPlayerRender");i&&i.rtgametimer&&(i.rtgametimer.isRunTimer?i.pauseTimer():i.resumeTimer())}},onClickReady:function(){if(this.ready()){var e=this.socket(),t={};t.extparams={roomid:cc.global.extparams.roomid},e.exec("ready",t)}},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},initgame:function(){var t=this;if(this.ready()){var e=this.socket();if(this.game=this.getCommon("DizhuDataBind"),(cc.global.dizhubegin=this).map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("catch",this.catch_event),this.map("catchresult",this.catchresult_event),this.map("lasthands",this.lasthands_event),this.map("bet",this.takecards_event),this.map("ratio",this.ratio_event),this.map("play",this.play_event),this.map("allcards",this.allcards_event),this.map("cardtips",this.cardtips_event),this.map("roomready",this.roomready_event),this.map("playeready",this.playeready_event),this.map("rer",this.recovery_event),this.map("banker",this.banker_event),this.map("exit",this.leave_event),this.map("stips",this.seltips_event),this.map("selemoticon",this.selemoticon_event),this.map("callplayer",this.callplayer_event),this.map("sendchat",this.sendchat_event),this.map("cal",this.remaincards_event),this.map("startrecordresult",this.startrecord_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)}),this.notReplay){if("NormalCreate"==cc.global.user.roomInType){var i={};null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i)}else"NormalJoin"==cc.global.user.roomInType?((i={}).extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i)):"NormalObserve"==cc.global.user.roomInType&&((i={}).extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i),this.bar_bottom.active=!1);this.inited=!0}this.changeTheme(t.curTheme)}},joinroom_event:function(e,t){cc.global.extparams.roomid=e.id,cc.global.user.roomNo=e.id,cc.global.user.selplayway=e.name,"champion"!=cc.global.user.selplayway&&(cc.global.championMode=0),cc.global.curPlaywayScore=e.score,t.score=e.score;var i=t.getLanguageText("ROOM_0");t.ratio.string=parseInt(e.score),t.roomnumber.string=e.id+i;"yes"==cc.global.amObserve?t.touch.active=!1:t.touch.active=!0,"diamond"==cc.global.user.selplayway&&(1,t.roominfo.children[1].children[1].children[0].active=!1,t.roominfo.children[1].children[1].children[1].active=!0),"ready"==cc.global.gamestatus?(cc.global.gamestatus="waiting",e.playerlist.length==e.players&&(cc.global.gamestatus="playing"),t.goRecovery=!0,t.players_event(e,t)):"waiting"==cc.global.gamestatus?(t.goRecovery=!0,t.players_event(e,t)):"playing"==cc.global.gamestatus&&(cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)),t.goRecovery=!1},observer_event:function(e,t){t.obsbench1.destroyAllChildren(),t.obsbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i]),a.parent=2<i?t.obsbench1:t.obsbench,(t.observerlist[i]=a).getComponent("Observer").nickname.node.active=!1}},userready_event:function(e,t){e.userid==cc.global.user.id?t.game.playermysql.getComponent("DizhuPlayerRender").amready.active=!0:t.getPlayer(e.userid).amready.active=!0},roomready_event:function(e,t){1==e.cardroom&&null!=t.invite&&t.invite.destroy()},returnToHall:function(){this.loadding(),clearTimeout(this.restartTimer),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.scene("hall",this)},players_event:function(e,t){if(e.msg&&(cc.global.outReasonMsg=e.msg),0==e.playerlist.length||3<e.playerlist.length)t.returnToHall();else{3==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)e.observerlist[a].id==cc.global.user.id&&(i=!1);if(i&&t.notReplay)t.exitPlay();else{if(t.observer_event(e,t),"playing"==cc.global.gamestatus&&0==t.goRecovery)return;if("yes"==cc.global.amObserve?0==t.play_status?"waiting"==cc.global.gamestatus&&0==t.isOnSummary?1==cc.global.championMode||2==cc.global.championMode?t.btn_enter&&(t.btn_enter.active=!1):0==cc.global.championMode&&t.notReplay&&t.btn_enter&&(t.btn_enter.active=!0):t.btn_enter&&(t.btn_enter.active=!1):1==t.play_status&&t.btn_enter&&(t.btn_enter.active=!1):t.btn_enter&&(t.btn_enter.active=!1),t.rerenderPlayers=e.playerlist,t.isOnSummary)return;t.cleanGamePlayers(),t.game.restart(),t.addBoardPlayers(),t.displayCardsCount(["/","/","/","/","/","/","/","/","/","/","/","/","/","/","/"])}}},addBoardPlayers:function(){if("no"==cc.global.amObserve){for(var e=-1,t=0;t<this.rerenderPlayers.length;t++)this.rerenderPlayers[t].seatid=t,this.rerenderPlayers[t].id==cc.global.user.id&&(this.game.addSelfPlayer(this,this.rerenderPlayers[t]),this.game.giveContext(this),e=this.rerenderPlayers[t].seatid);for(t=0;t<this.rerenderPlayers.length;t++)this.rerenderPlayers[t].seatid!=e&&0==this.playerexist(this.rerenderPlayers[t],this)&&this.newplayer(this.player.length,this,this.rerenderPlayers[t],(e+1)%3==this.rerenderPlayers[t].seatid,this.rerenderPlayers[t].seatid)}else for(t=0;t<this.rerenderPlayers.length;t++)this.rerenderPlayers[t].seatid=t,0==this.playerexist(this.rerenderPlayers[t],this)&&this.newplayer(this.player.length,this,this.rerenderPlayers[t],1==this.rerenderPlayers[t].seatid,this.rerenderPlayers[t].seatid)},playerexist:function(e,t){for(var i=0;i<t.player.length;i++)if(null!=t.player[i]&&t.player[i].getComponent("DizhuPlayerRender").userid==e.id)return!0;return!1},banker_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay)t.bankerSelfTimer=setTimeout(function(){t&&t.game&&(t.game.showBanker(e,!0),t.game.speech("call"))},1e3);else{var i=1e3;t.notReplay||(i=0),t.bankerOtherTimer=setTimeout(function(){t&&t.game&&(t.getPlayer(e.userid).showBanker(),t.getPlayer(e.userid).speech("call"))},i)}},catch_event:function(e,t){for(i=0;i<t.player.length;i++)(a=t.player[i].getComponent("DizhuPlayerRender")).stopTimer();if(t.ratio.string=parseInt(t.score)*e.ratio,e.userid==cc.global.user.id&&t.notReplay)t.game.catchtimer(e.timer,e.ratio),cc.global.user.doCatch=!0;else for(var i=0;i<t.player.length;i++){var a=t.player[i].getComponent("DizhuPlayerRender");a.userid&&a.userid==e.userid?a.catchtimer(e.timer):a.stopTimer()}},recovery_event:function(e,t){if(t.cleanGame(),t.ratio.string=parseInt(t.score)*e.ratio,t.showLastHands(t.game,t,3,0),t.lastCardsPanel.active=!0,e.remains)for(var i=t.decode(e.remains),a=0;a<t.lastcards.length;a++){var s=t.lastcards[a].getComponent("HHCard");s.setCard(i[a]),s.order()}if("no"==cc.global.amObserve){for(var r=t.decode(e.player.cards),n=0;n<r.length;n++){var o=t.playcards(t.game,t,50*n-300,r[n]);t.registerProxy(o)}t.layoutPokerCard()}for(a=0;a<t.pokercards.length;a++){t.pokercards[a].getComponent("HHCard").order()}if("playing"==e.status){if(e.player&&e.player.buy)t.game.lasthands(t,t.game,!0);else for(a=0;a<e.others.length;a++)t.getPlayer(e.others[a].playuser).setDizhuFlag(e.others[a].buy);if(e.player)if(e.player.history&&0<e.player.history.length){var l=t.decode(e.player.history);t.game.lasttakecards(t.game,t,l.length,l,{donot:!1,userid:e.player.playuser})}else t.game.lasttakecards(t.game,t,0,null,{donot:!0,userid:e.player.playuser});if(null!=e.others&&0<e.others.length)for(a=0;a<e.others.length;a++){var c=t.getPlayer(e.others[a].playuser);if(c&&e.others[a].history&&0<e.others[a].history.length){var h=t.decode(e.others[a].history);c.lasttakecards(t.game,t,h.length,h,{donot:!1,finished:!1,userid:e.others[a].playuser})}else c.lasttakecards(t.game,t,0,null,{donot:!0,finished:!1,userid:e.others[a].playuser})}if(e.expid==cc.global.user.id)t.game.playtimer(t.game,e.timer,1==e.bt);else{var d=t.getPlayer(e.expid);d&&d.playtimer(t.game,e.timer)}}else if("calling"==e.status){if(""!=e.expid)for("no"==cc.global.amObserve&&t.game.showRecoveryCatchResult(e.player.ratio),a=0;a<e.others.length;a++)t.getPlayer(e.others[a].playuser).showRecoveryCatchResult(e.others[a].ratio);if(e.expid==cc.global.user.id)t.game.catchtimer(e.timer,e.ratio),cc.global.user.doCatch=!0;else for(n=0;n<t.player.length;n++){var u=t.player[n].getComponent("DizhuPlayerRender");if(u.userid&&u.userid==e.expid){u.catchtimer(e.timer);break}}}if(null!=e.others&&0<e.others.length)for(a=0;a<e.others.length;a++)t.getPlayer(e.others[a].playuser).resetcards(e.others[a].cnum);t.addTouchEvent()},ratio_event:function(e,t){var i=t;if(t.ratio.string=parseInt(t.score)*parseInt(e.msg),t.raiseAni&&0<t.raiseAni.children.length){t.raiseAni.active=!0;var a=t.raiseAni.children[0].getComponent(sp.Skeleton);a.clearTracks(),a.setAnimation(0,"play",!1),cc.global.audio.playEffectAud("call"),setTimeout(function(){i&&i.raiseAni&&(i.raiseAni.active=!1)},2e3)}},catchresult_event:function(e,t){if(t.ratio.string=parseInt(t.score)*parseInt(e.ratio),e.userid==cc.global.user.id&&t.notReplay){if("no"==cc.global.amObserve)if(t.game.catchresult(e),cc.global.user.doCatch=!1,0<parseInt(e.myratio))switch(parseInt(e.myratio)){case 1:t.showAnimation(16,e.userid);break;case 2:t.showAnimation(17,e.userid);break;case 3:t.showAnimation(18,e.userid)}else t.game.speech("pass")}else t.getPlayer(e.userid).catchresult(e)},lasthands_event:function(e,t){cc.global.gotLastHands=!0;var i=[];for(null!=e.lasthands&&(i=t.decode(e.lasthands)),o=0;o<t.player.length;o++){t.player[o].getComponent("DizhuPlayerRender").stopTimer()}for(t.notReplay||(t.showLastHands(t.game,t,3,0),t.lastCardsPanel.active=!0),s=0;s<t.lastcards.length;s++){var a=t.lastcards[s].getComponent("HHCard");a.setCard(i[s]),a.order()}if(e.userid==cc.global.user.id&&t.notReplay){if("no"==cc.global.amObserve){for(t.game.lasthands(t,t.game,e.userid),o=0;o<t.player.length;o++){t.player[o].getComponent("DizhuPlayerRender").hideresult()}t.game.playtimer(t.game,e.timer,!0);for(var s=0;s<i.length;s++){var r=null;s==i.length-1&&(r=cc.callFunc(function(e,t){for(var i=0;i<t.tempcontext.pokercards.length;i++)t.tempcontext.pokercards[i].y=0,t.tempcontext.pokercards[i].getComponent("HHCard").order();t.tempcontext&&t.tempcontext.layout(t.tempcontext.poker,function(e,t){return e.zIndex-t.zIndex})},this,{tempcontext:t}));var n=t.current(t.game,t,600+50*(6+s)-300,i[s],r);if(null==n)return;t.registerProxy(n)}t.game.playtimer(t.game,e.timer,!0)}}else{t.game.hideresult();for(var o=0;o<t.player.length;o++){t.player[o].getComponent("DizhuPlayerRender").hideresult()}var l=t.getPlayer(e.userid);l&&(l.lasthands(t,t.game,e.userid,i),l.playtimer(t.game,e.timer))}},takecards_event:function(e,t){var i="";if(t.lasttip=null,t.dealed=!0,1==e.allow){var a;if(t.showAnimation(e.type,e.userid),e.cards){if(0<(a=t.decode(e.cards)).length)switch(cc.global.audio.playEffectAud("takecard"),parseInt(e.type)){case 1:var s=parseInt(a[0]/4)+3;i=52==a[0]?"joker2":53==a[0]?"joker1":13<s?"c"+(s-13):"c"+s;break;case 2:i="pair";break;case 3:i="three";break;case 4:i="straight";break;case 5:i="pair_straight";break;case 6:i="three_1";break;case 7:i="three_2";break;case 8:case 9:case 10:i="";break;case 11:case 12:case 13:i="";break;case 14:case 15:i="rocket"}""!=i&&(e.userid==cc.global.user.id?t.game.speech(i):(r=t.getPlayer(e.userid))&&r.speech(i))}else e.userid==cc.global.user.id?t.game.speech("pass"):(r=t.getPlayer(e.userid))&&r.speech("pass");if(e.userid==cc.global.user.id&&t.notReplay)cc.global.user.myPlayTurn=!1,t.game.unselected(t,t.game),t.game.lasttakecards(t.game,t,e.cnum,a,e);else{var r=t.getPlayer(e.userid);r&&r.lasttakecards(t.game,t,e.cnum,a,e)}if(t.game.selectedcards.splice(0,t.game.selectedcards.length),e.nextid)if(e.nextid==cc.global.user.id&&t.notReplay)t.game.playtimer(t.game,e.timer,e.first),cc.global.user.myPlayTurn=!0,1==e.first?cc.global.user.hardLiner=!0:cc.global.user.hardLiner=!1;else{var n=t.getPlayer(e.nextid);n&&n.playtimer(t.game,e.timer)}}else t.game.notallow.active=!0,setTimeout(function(){t.game.notallow.active=!1},2e3),t.game.unselected(t,t.game);e.userid==cc.global.user.id&&t.pokerLayout(t)},leave_event:function(e,t){e.userid==cc.global.user.id&&t.notReplay?t.disLeaveReq("true"==e.msg):t.getPlayer(e.userid).disLeaveReq("true"==e.msg)},selemoticon_event:function(e,t){if("itr"==e.msg.substring(0,3)){var i,a,s=e.msg.split("_"),r=(parseInt(s[1]),parseInt(s[2]));parseInt(s[3]);return e.userid==cc.global.user.id?i=cc.v2(90.2*cc.global.narrowContentRatio-640,-277.1*cc.global.narrowContentRatio):((i=t.getPlayer(e.userid).node.getPosition()).y+=65.4,i.x*=cc.global.narrowContentRatio,i.y*=cc.global.narrowContentRatio,i.x+=22,0<i.x?i.x+=22:i.x-=22),void(r==cc.global.user.id?a=cc.v2(90.2*cc.global.narrowContentRatio-640,-277.1*cc.global.narrowContentRatio):((a=t.getPlayer(r).node.getPosition()).y+=65.4,a.x*=cc.global.narrowContentRatio,a.y*=cc.global.narrowContentRatio,0<a.x?a.x+=22:a.x-=22))}if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showEmoticon(e.msg);else{var n=t.getPlayer(e.userid);n&&n.showEmoticon(e.msg)}var o=t.getObserver(e.userid);o&&o.showEmoticon(e.msg)},callplayer_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showCallPlayer(e.msg);else{var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg)}var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg)},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase;if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showCallPlayer(i,e.msg);else{var a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg)}var s=t.getObserver(e.userid);s&&s.showCallPlayer(i,e.msg)},remaincards_event:function(e,t){var i=t.decode(e.extdata.cal);i.reverse(),t.displayCardsCount(i)},displayCardsCount:function(e){if(this.notReplay){if(0<e.length){for(t=0;t<8;t++)this.cardscount.children[0].children[t].getComponent(cc.Label).string=e[t];for(var t=8;t<15;t++)this.cardscount.children[1].children[t-8].getComponent(cc.Label).string=e[t]}2==this.curCardsCountMode&&this.changeCardsCountMode()}else this.cardscount.active=!1},showAnimation:function(e,t){var i=-1;switch(e){case 4:i=0;break;case 5:i=1;break;case 6:case 7:i=0;break;case 8:case 9:case 10:i=1;break;case 14:i=2;break;case 15:i=3;break;case 20:i=7;break;case 16:i=4;break;case 17:i=5;break;case 18:i=6}0<=i&&this.disEffect(i,t)},hideEffect:function(e){var t=this;setTimeout(function(){t&&t.effect&&(t.effect.children[e].active=!1)},1500)},disEffect:function(e,t){this.effect.children[e].active=!0;var i="",a=null;switch(cc.global.user.id==t?this.game&&this.game.playermysql&&(a=this.game.playermysql.getComponent("DizhuPlayerRender")):a=this.getPlayer(t),e){case 0:cc.global.audio.playEffectAud("boat"),i="tonghou",0==a.seatidx||2==a.seatidx?this.effect.children[e].rotation=-90:this.effect.children[e].rotation=90;break;case 1:i="doudizhu_feiji",cc.global.audio.playEffectAud("plane");break;case 2:i="doudizhu zha",cc.global.audio.playEffectAud("bomb");break;case 3:i="doudizhu_huojian",cc.global.audio.playEffectAud("rocket");break;case 4:i="tongqian",cc.global.audio.playEffectAud("call"),a&&a.speech("call2");break;case 5:i="tongqian",cc.global.audio.playEffectAud("call"),a&&a.speech("call4");break;case 6:i="tongqian",cc.global.audio.playEffectAud("call"),a&&a.speech("call8");break;case 7:i="ddz_cj_win",cc.global.audio.playEffectAud("call");break;case 8:i="tongqian"}if(""!=i){var s=this.effect.children[e].getComponent(sp.Skeleton);s.clearTracks(),s.setAnimation(0,i,!1)}this.hideEffect(e)},cardtips_event:function(e,t){if(t.game.unselected(t,t.game),e.extdata.cards){var i=t.decode(e.extdata.cards);t.lasttip=i.join(","),cc.global.tipsReady=!0,t.upCardsCount=i.length;for(var a=0;a<i.length;a++)t.game.cardtips(t,i[a],i)}else t.upCardsCount=0,t.game.cardtipsfornot(t,t.game)},seltips_event:function(e,t){t.disCardtips(e.userid,parseInt(e.msg))},replay_play_event:function(e,t){if(e.curgame==cc.global.cur_game_code){cc.global.gamestatus="playing";var i=[],a=this.getPlayer(e.playuser);e.cards&&(i=t.decode(e.cards),a.resetcards(i.length),a.setCards(i))}},play_event:function(e,t){if(e.curgame==cc.global.cur_game_code){t.isOnSummary=!1,t.summarypage&&t.summarypage.getComponent("DizhuSummaryDetail")&&(t.summarypage.destroy(),t.summarypage=null),t.restart(),cc.global.gamestatus="playing";var i=[];e.cards&&(i=t.decode(e.cards));var a=t.game.pokerpool.get(),s=t.game.pokerpool.get(),r=t.game.pokerpool.get(),n=t.game.pokerpool.get();a.parent=t.root(),s.parent=t.root(),r.parent=t.root(),n.parent=t.root(),a.setPosition(0,0),a.setScale(.6,.6),s.setPosition(0,0),s.setScale(.6,.6),r.setPosition(0,0),r.setScale(.6,.6),n.setPosition(0,0),n.setScale(.6,.6);for(var o=0;o<t.player.length;o++)t.player[o].getComponent("DizhuPlayerRender").showCardsPanel();var l=cc.callFunc(function(e,t){if(t.game){if(t.game.pokerpool.put(t.current),t.game.pokerpool.put(t.left),t.game.pokerpool.put(t.right),t.game.pokerpool.put(t.down),"no"==cc.global.amObserve)for(var i=0;i<t.self.pokercards.length;i++)t.self.pokercards[i].getComponent("HHCard").order();t.self.layoutPokerCard(),t.self.lastCardsPanel.active=!0,t.self.animatePokerCard()}},this,{game:t.game,self:t,left:s,right:r,current:a,down:n});t.showLastHands(t.game,t,3,0),1==t.curCardsCountMode?t.displayCardsCount([1,1,4,4,4,4,4,4,4,4,4,4,4,4,4]):2==t.curCardsCountMode&&t.displayCardsCount([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),t.dealing(t.game,6,t,0,s,r,n,i),cc.global.audio.playEffectAud("shuffle"),t.deal1_timer=setTimeout(function(){t.dealing(t.game,6,t,1,s,r,n,i),t.deal2_timer=setTimeout(function(){t.dealing(t.game,5,t,2,s,r,n,i,l),t.reordering(t)},250)},250)}},allcards_event:function(e,t){t.gameCleaned=!1,t.hasRight=!1,cc.global.gotLastHands=!1,e.finished=!0,cc.global.gamestatus="waiting";var i=null;null!=e.cnt&&0<cc.global.championMode&&(t.currenRound=parseInt(e.cnt)+1);for(var a=0;a<e.players.length;a++){for(var s=e.players[a],r=0;r<t.rerenderPlayers.length;r++)t.rerenderPlayers[r].id==s.userid&&(t.rerenderPlayers[r].goldcoins=s.gold,t.rerenderPlayers[r].rank=s.rank,t.rerenderPlayers[r].exp=s.normalscore,t.rerenderPlayers[r].texp=s.texp,t.rerenderPlayers[r].explevel=s.explevel);if(s.userid==cc.global.user.id&&t.notReplay)cc.global.user.normalrank=s.normalrank,cc.global.user.goldcoins=s.gold,cc.global.user.texp=s.texp,cc.global.user.explevel=s.explevel,t.game.updateCareerAfterMatch(s),t.game.disChPos(s.win?"Victory":"Lost");else{i=s;var n=t.decode(s.cards),o=t.getPlayer(s.userid);o.cleancards();for(var l=0;l<n.length;l++)o.lasttakecards(t.game,t,n.length,n,e);o.updateCareerAfterMatch(s),o.disChPos(s.win?"Victory":"Lost")}}if(t.ratio.string=parseInt(t.score)*parseInt(e.ratio),t.isOnSummary=!0,cc.global.summaryDetailData=e,null!=i){if(t.updatepva(),t.closeOpenWin(),t.summarypage=cc.instantiate(t.summary),null==t.summarypage||null==t.summarypage)return;t.summarypage.parent=t.root(),t.summarypage.getComponent("DizhuSummaryDetail").create(t,e)}t.displayCardsCount(["/","/","/","/","/","/","/","/","/","/","/","/","/","/","/"])},rend_event:function(e,t){t.isOnSummary=!1,"no"==cc.global.amObserve&&t.socket().exec("rnr",{extparams:{roomid:cc.global.extparams.roomid}}),t.hasRight=!1},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},startrecord_event:function(e,t){},getPlayer:function(e){if(this.player)for(var t=0;t<this.player.length;t++){var i=this.player[t].getComponent("DizhuPlayerRender");if(i.userid&&i.userid==e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},dealing:function(e,t,i,a,s,r,n,o,l){if(i.otherplayer(s,0,t,e,i,l),i.otherplayer(r,1,t,e,i,l),"yes"==cc.global.amObserve)i.otherplayer(n,2,t,e,i,l);else for(var c=0;c<t;c++){var h=i.current(e,i,300*a+50*c-300,o[6*a+c],l);null!=h&&i.registerProxy(h)}},otherplayer:function(e,t,i,a,s,r){if(s.player){var n={};if(0==t?(n=cc.sequence(cc.spawn(cc.moveTo(.2,-310,30),cc.scaleTo(.2,.1,.1)),cc.moveTo(0,0,r?200:0),cc.scaleTo(0,r?1:.6,r?1:.6)),e.runAction(n)):1==t?(n=cc.sequence(cc.spawn(cc.moveTo(.2,310,30),cc.scaleTo(.2,.1,.1)),cc.moveTo(0,0,r?200:0),cc.scaleTo(0,r?1:.6,r?1:.6)),e.runAction(n)):2==t&&(n=cc.sequence(cc.spawn(cc.moveTo(.2,0,-100),cc.scaleTo(.2,.1,.1)),cc.moveTo(0,0,r?200:0),cc.scaleTo(0,r?1:.6,r?1:.6)),e.runAction(n)),null!=r&&"yes"==cc.global.amObserve&&e.runAction(r),null!=s.player&&null!=s.player)for(var o=s.player[t].getComponent("DizhuPlayerRender"),l=0;l<i;l++)o.countcards(1)}},showLastHands:function(e,t,i,a){for(var s=0;s<i;s++){var r;(r=this.lastCardsPanel.children[s]).active=!0,r.getComponent("HHCard").setCard(a),r.card=a,t.lastcards[s]=r}},registerProxy:function(e){e&&e.getComponent("HHCard").proxy(this.game)},playcards:function(e,t,i,a){return t.current(e,t,i,a,null)},current:function(e,t,i,a,s){if(null==e||null==e)return null;if(null==e.pokerpool||null==e.pokerpool)return null;var r=e.pokerpool.get(),n=cc.global.theme.card_sort;if("no"==cc.global.amObserve){if(r.getComponent("HHCard").setCard(a),r.emit("theme-changed"),r.card=a,r.parent=t.poker,r.setPosition(0,200),r.setScale(1.1,1.1),r.zIndex=1==n?a:100-a,t.pokercards.push(r),"luckyre"!=cc.global.gamestatus)if(null!=s){var o=cc.sequence(cc.moveTo(.2,i,0),cc.delayTime(.1),s);r.runAction(o)}else{var l=cc.moveTo(.2,i,0);r.runAction(l)}}else r.x=i,r.y=0;return t.pokerLayout(t),r},reordering:function(e){if(e.pokerLayout(e),null!=e.pokercards&&null!=e.pokercards&&"no"==cc.global.amObserve){for(var t=0;t<e.pokercards.length;t++)e.pokercards[t].parent=e.poker;e.addTouchEvent()}},newplayer:function(e,t,i,a,s){var r=cc.v2(-524/cc.global.narrowContentRatio,70);1==a&&(r=cc.v2(524/cc.global.narrowContentRatio,70)),"yes"==cc.global.amObserve&&null!=s&&0==s&&(r=cc.v2(-360,-251));var n=t.game;if(n&&0<n.playerspool.size()){t.player[e]=n.playerspool.get(),t.player[e].parent=t.players,t.player[e].setPosition(r),null!=s&&0==s&&(t.player[e].zIndex=1),t.player[e].getComponent("DizhuPlayerRender").initplayer(t,i,s,a,"yes"==cc.global.amObserve);"diamond"==cc.global.user.selplayway&&1}},givup:function(){this.ready()&&this.socket().exec("giveup",{})},cardtips:function(){if(this.ready()){var e=this.socket(),t={};null!=this.lasttip?t.extparams={cardtips:this.lasttip}:t.extparams={cardtips:""},e.exec("cardtips",t),this.lasttip=null}},docatch:function(e,t){this.ready()&&this.socket().exec("docatch",{extparams:{callx:t}})},doPlayCards:function(){if(this.ready()){var e=this.socket();this.game.selectedcards.splice(0,this.game.selectedcards.length);for(var t=0;t<this.pokercards.length;t++){var i=this.pokercards[t].getComponent("HHCard");1==i.selected&&this.game.selectedcards.push(i.card)}if(this.game.selectedcards.length){var a={};a.extparams={cards:this.game.selectedcards.join()},e.exec("bet",a),cc.global.user.hardLiner=!1}}this.lasttip=null},noCards:function(){this.ready()&&this.socket().exec("bet",{}),this.lasttip=null},cleanGame:function(){for(var e=0;e<this.pokercards.length;e++){var t=this.pokercards[e];this.game.pokerpool.put(t)}for(this.pokercards.splice(0,this.pokercards.length),a=0;a<this.lastcards.length;a++){var i=this.lastcards[a].getComponent("HHCard");i.setCard(0),i.init()}for(var a=0;a<this.player.length;a++){var s=this.player[a].getComponent("DizhuPlayerRender");s&&(s.result&&(s.result.active=!1),s.cannot&&(s.cannot.active=!1),s.donot&&(s.donot.active=!1),s.lastcards&&(s.lastcards.active=!1),s.dizhu&&(s.dizhu.active=!1),s.resetcards(0),s.cleanDizhuFlag())}this.game.clean(this),this.ratio.string=parseInt(this.score),this.dealed=!1,this.leavereq.active=!1},cleanGamePlayers:function(){for(var e=0;e<this.player.length;e++)this.player[e].destroy();this.player.splice(0,this.player.length),this.player=new Array},restart:function(e){this.gameCleaned||(this.gameCleaned=!0,this.cleanGame(),this.goRecovery=!1,cc.global.gamestatus="waiting",this.cleanGamePlayers(),this.game.restart(),this.addBoardPlayers(),"yes"==cc.global.amObserve&&this.rerenderPlayers.length<3&&(1!=cc.global.championMode&&2!=cc.global.championMode||!this.btn_enter?0==cc.global.championMode&&this.notReplay&&this.btn_enter&&(this.btn_enter.active=!0):this.btn_enter.active=!1),this.play_status=0,this.isOnSummary=!1)},continuegame:function(){this.restart("begin")},statictimer:function(e,t){this.waittimer=cc.instantiate(this.waitting),this.waittimer.parent=this.root();var i=this.waittimer.getComponent("HHTimer");i&&i.init(e,t,this.waittimer)},onDestroy:function(){this.inited=!1,this.cleanmap(),cc.global.onBatteryChanged=null},addTouchEvent:function(){this.touch.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.touch.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.touch.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.cardsArr=this.poker.getChildren(),this.touch.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},onTouchStart:function(e){var t=e.getLocation(),i=this._beginPos=this.touch.convertToNodeSpaceAR(t);this.checkSelStartCard(i)},onTouchMove:function(e){var t=e.getLocation(),i=this.touch.convertToNodeSpaceAR(t);this.checkSelMoveCard(i)},onTouchEnd:function(e){this.checkSelEndCard()},checkSelStartCard:function(e){var t=this.cardsArr.length;this.beginCardId=-1,this.moveCardId=-1;for(var i=t-1;0<=i;i--){var a=this.cardsArr[i];if(a.getBoundingBox().contains(e))return a.getComponent("HHCard").touched=!0,void(this.beginCardId=i)}},checkSelMoveCard:function(e){for(var t=this.cardsArr.length,i=t-1;0<=i;i--){var a=this.cardsArr[i];if(a.getBoundingBox().contains(e)){a.getComponent("HHCard").touched=!0,this.moveCardId=i,this.beginCardId=-1==this.beginCardId?i:this.beginCardId;break}}if(-1!=this.beginCardId)for(var s=Math.min(this.beginCardId,this.moveCardId),r=Math.max(this.beginCardId,this.moveCardId),n=0;n<t;n++)this.cardsArr[n].getComponent("HHCard").touched=s<=n&&n<=r},sendTouchCards:function(){for(var e=new Array,t=this.cardsArr.length,i=0;i<t;i++){var a=this.cardsArr[i].getComponent("HHCard");a.touched&&(e.push(a.card),a.doselect())}e=new Array;for(var s=0;s<this.cardsArr.length;s++){var r=this.cardsArr[s].getComponent("HHCard");r.touched&&(e.push(r.card),r.doselect())}this.beginCardId=-1,this.moveCardId=-1},checkSelEndCard:function(){for(var e=this.cardsArr.length,t=[],i=1,a=0;a<e;a++){var s=this.cardsArr[a].getComponent("HHCard");s.touched&&0==s.selected?(i=1,t.push(s.card)):s.touched&&1==s.selected&&(i=0,s.doselect()),s.touched=!1}if(0==t.length)return 1==i&&(this.upCardsCount=0,this.game.unselected(this,this.game));var r=this.deck.makeEngineCardArray(t),n=this.engine.getPossibleCards(r);t=[];for(var o=0;o<n.size();o++)t.push(this.deck.getNumber(n.get(o)));this.upCardsCount=t.length,this.showSelCardsTip(t)},showSelCardsTip:function(e){for(var t=0;t<this.cardsArr.length;t++)for(var i=this.cardsArr[t].getComponent("HHCard"),a=0;a<e.length;a++)i.card==e[a]&&i.doTipSelect()},disCardtips:function(e,t){e!=cc.global.user.id&&this.getPlayer(e).disCardtips(parseInt(t))},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},onclickBack:function(){this.ready()&&(this.notReplay&&(0<this.player.length||"no"==cc.global.amObserve)?this.socket().exec("leave",{}):this.exitPlay())},changeCharacter:function(){"no"==cc.global.amObserve&&this.game.disUserCharacter();for(var e=0;e<this.player.length;e++)this.player[e].getComponent("DizhuPlayerRender").disUserCharacter()},onclickUnSel:function(){cc.global.tipsReady&&(cc.global.tipsReady=!1);this.game.unselected(this,this.game)},showChatDialog:function(){this.onclickChat(1)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}e<0||(this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root(),this.chatpage.getComponent("Chat").init(this,e),this.ischat=!0)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;if(!(e<0)&&this.ready()){var t=this.socket(),i={};i.extparams={emoticon:e},t.exec("selemoticon",i),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1)}},onClickEmoticon:function(){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),void(this.isemoticon=!1);this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root(),this.emoticonpage.getComponent("Emoticon").init(this),this.isemoticon=!0},disLeaveReq:function(e){this.leavereq.active=e},changeCardSortOrder:function(){var e=cc.global.theme.card_sort;null==e&&(e=!1);for(var t=0;t<this.poker.children.length;t++)this.poker.children[t].zIndex=100-this.poker.children[t].zIndex;this.layoutPokerCard()},pokerLayout:function(e){var t=(1250/cc.global.narrowContentRatio-155)/(e.poker.children.length-1)-155;-60<t&&(t=-60),e.poker.getComponent(cc.Layout).spacingX=t},animatePokerCard:function(){var i=(1250/cc.global.narrowContentRatio-155)/(this.poker.children.length-1)-155;-60<i&&(i=-60),this.poker.getComponent(cc.Animation).play("card_dealing");this.poker.runAction(cc.sequence(cc.delayTime(.26),cc.callFunc(function(e,t){e.getComponent(cc.Animation).stop(),e.getComponent(cc.Layout).spacingX=i},this,null)));for(var e=0;e<this.poker.children.length;e++)this.poker.children[e].runAction(cc.sequence(cc.delayTime(.3+.03*e),cc.scaleTo(.08,1.15,1.15),cc.scaleTo(.08,1.1,1.1)))},layoutPokerCard:function(){for(var e=0;e<this.poker.children.length;e++)this.poker.children[e].y=0;this.layout(this.poker,function(e,t){return e.zIndex-t.zIndex})},onClickRecordPlay:function(){this.socket().exec("startrecord",{})},onClickFindEmptyRoom:function(){},onClickRemainCardsLock:function(){cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.getComponent("ToastCtrl").init("","Error"),cc.global.opentoast.parent=this.node},initTheme1:function(){if(this.game&&this.game.changeTheme(1),this.player)for(var e=0;e<this.player.length;e++)this.player[e].getComponent("DizhuPlayerRender").changeTheme(1,!1)},initTheme2:function(){if(this.game&&this.game.changeTheme(2),this.player)for(var e=0;e<this.player.length;e++)this.player[e].getComponent("DizhuPlayerRender").changeTheme(2,!1)},changeCardsCountMode:function(){var i=this,e="images/other/play_cards_count"+this.curCardsCountMode;cc.loader.loadRes(e,cc.SpriteFrame,function(e,t){e||i.cardscount&&(i.cardscount.getComponent(cc.Sprite).spriteFrame=t)});var t=[];if("/"!=this.cardscount.children[0].children[0].getComponent(cc.Label).string){for(r=0;r<8;r++)t[r]=this.cardscount.children[0].children[r].getComponent(cc.Label).string;for(r=8;r<15;r++)t[r]=this.cardscount.children[1].children[r-8].getComponent(cc.Label).string;for(r=0;r<15;r++)t[r]=1<r?4-t[r]:1-t[r];for(r=0;r<this.poker.children.length;r++){var a=this.poker.children[r].getComponent("HHCard");if(a)if(a.card<52){var s=14-(a.card-a.card%4)/4;0<t[s]&&t[s]--}else 52==a.card?0<t[1]&&t[1]--:53==a.card&&0<t[0]&&t[0]--}if(this.cardscount.children[2].active=!1,0<t.length){for(r=0;r<8;r++)this.cardscount.children[0].children[r].getComponent(cc.Label).string=t[r];for(var r=8;r<15;r++)this.cardscount.children[1].children[r-8].getComponent(cc.Label).string=t[r]}}},onToggleCardsCountMode:function(){this.curCardsCountMode=3-this.curCardsCountMode,cc.sys.localStorage.setItem("dizhu_calc_mode",JSON.stringify(this.curCardsCountMode)),this.changeCardsCountMode()},changeTheme:function(e){},onChangeTheme:function(){},onToggleSetting:function(){var i=this;this.closeOpenWin(),cc.loader.loadRes("prefab/main/ThemeSelectDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("ThemeSelectDialog").init(i),cc.global.openwin.parent=i.root())})},onToggleSound:function(){var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));e=!e,cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(e)),e?(this.soundbtn.children[0].active=!1,this.soundbtn.children[1].active=!0,cc.global.audio.playBGM("bgm_card"),cc.audioEngine.resumeAll()):(this.soundbtn.children[0].active=!0,this.soundbtn.children[1].active=!1,cc.audioEngine.pauseAll())},onThemeChanged:function(e){cc.sys.localStorage.setItem("card_game_theme",JSON.stringify(cc.global.theme)),this.background.children[0].active=1==cc.global.theme.background,this.background.children[1].active=2==cc.global.theme.background,this.background.children[2].active=3==cc.global.theme.background,this.bar_bottom.children[0].active=1==cc.global.theme.background,this.bar_bottom.children[1].active=2==cc.global.theme.background,this.bar_bottom.children[2].active=3==cc.global.theme.background;for(var t=0;t<3;t++)this.buttons.children[2].children[t].children[0].active=1==cc.global.theme.background,this.buttons.children[2].children[t].children[1].active=2==cc.global.theme.background,this.buttons.children[2].children[t].children[2].active=3==cc.global.theme.background;if(this.poker){for(t=0;t<this.poker.children.length;t++)this.poker.children[t]&&this.poker.children[t].emit("theme-changed");for(t=0;t<this.lastCardsPanel.children.length;t++)this.lastCardsPanel.children[t]&&this.lastCardsPanel.children[t].emit("theme-changed");if(1==cc.global.theme.card_size?this.poker.y=-225:this.poker.y=-208,this.game&&this.game.node.emit("theme-changed"),this.player)for(t=0;t<this.player.length;t++)this.player[t].emit("theme-changed");if(this.playerboard)for(t=0;t<this.playerboard.length;t++)this.playerboard[t].emit("theme-changed")}}}),cc._RF.pop()},{DIZHUSelCardsEngine:"DIZHUSelCardsEngine",Deck:"Deck",HHCommon:"HHCommon"}],DizhuButton:[function(e,t,i){"use strict";cc._RF.push(t,"f7b242y/B9EZqOpSeUXyPHz","DizhuButton");var a=e("HHCommon");cc.Class({extends:a,properties:{helpdlg:{default:null,type:cc.Prefab},setting:{default:null,type:cc.Prefab}},onClickHelp:function(){cc.global.openwin=cc.instantiate(this.helpdlg),cc.global.openwin.getComponent("HelpDialog").init(this,3),cc.global.openwin.parent=this.root()},onSettingClick:function(){cc.global.openwin=cc.instantiate(this.setting),cc.global.openwin.parent=this.root(),cc.global.openwin.getComponent("SettingDialog").init()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],DizhuDataBind:[function(n,e,t){"use strict";cc._RF.push(e,"bf1b9AYYupPXoTsdQo0NtbF","DizhuDataBind");var a=n("HHCommon");cc.Class({extends:a,properties:{goldcoins:{default:null,type:cc.Label},player:{default:null,type:cc.Prefab},poker:{default:null,type:cc.Prefab},poker_min:{default:null,type:cc.Prefab},myself:{default:null,type:cc.Prefab},catchbtn:{default:null,type:cc.Node},timer:{default:null,type:cc.Node},timer_num:{default:null,type:cc.Label},lastcards:{default:null,type:cc.Node},playbtn:{default:null,type:cc.Node},notallow:{default:null,type:cc.Node},operesult:{default:null,type:cc.Node},donottake:{default:null,type:cc.Node},cardtipmsg:{default:null,type:cc.Node},robot:{default:null,type:cc.Button},championexp:{default:null,type:cc.Label},timerplaynum:{default:null,type:cc.Label},callx2btn:{default:null,type:cc.Node},callx4btn:{default:null,type:cc.Node},callx8btn:{default:null,type:cc.Node},catchclock:{default:null,type:cc.Node},playclock:{default:null,type:cc.Node},playermysql:cc.Node},onLoad:function(){for(this.changeTheme(),this.timer&&(this.timer.active=!1),this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1),this.playbtn&&(this.playbtn.active=!1),this.notallow&&(this.notallow.active=!1),this.operesult&&(this.operesult.active=!1),this.cardtipmsg&&(this.cardtipmsg.active=!1),(this.dizhu_databind_context=this).playerspool=new cc.NodePool,this.myselfpool=new cc.NodePool,this.pokerpool=new cc.NodePool,this.minpokerpool=new cc.NodePool,this.myselfpool,this.selectedcards=new Array,this.cardslist=new Array,i=0;i<3;i++)this.playerspool.put(cc.instantiate(this.player));for(i=0;i<25;i++)this.pokerpool.put(cc.instantiate(this.poker));for(i=0;i<60;i++)this.minpokerpool.put(cc.instantiate(this.poker_min));this.myselfpool.put(cc.instantiate(this.myself)),this.ready()&&(this.pva_format(cc.global.user.goldcoins,cc.global.user.cards,0,cc.global.user.championexp,this),this.pvalistener(this,function(e){e.pva_format(cc.global.user.goldcoins,cc.global.user.cards,0,cc.global.user.championexp,e)})),this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged()},addSelfPlayer:function(e,t){0<this.myselfpool.size()&&null!=cc.global&&(this.playermysql.active=!0,this.playermysql.getComponent("DizhuPlayerRender").initplayer(e,t,0,!1,!1,!1))},giveContext:function(e){this.playermysql.getComponent("DizhuPlayerRender").giveContext(e)},showRoomNumber:function(e){this.playermysql.getComponent("DizhuPlayerRender").showRoomNumber(e)},showCardsCount:function(e){this.playermysql.getComponent("DizhuPlayerRender").displayCardsCount(e)},updateCareerAfterMatch:function(e){this.playermysql.getComponent("DizhuPlayerRender").updateCareerAfterMatch(e)},pva_format:function(e,t,i,a,s){s.goldcoins.string=this.numformat(e),s.championexp.string=this.numformat(parseFloat(a).toFixed(2))},catchtimer:function(e,t){if(this.playbtn&&(this.playbtn.active=!1),this.timer&&(this.timer.active=!0),this.catchbtn)switch(this.catchbtn.active=!0,this.catchbtn.opacity=0,this.catchbtn.runAction(cc.fadeIn(.2)),this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1,parseInt(t)){case 1:this.callx2btn.active=!0,this.callx4btn.active=!0,this.callx8btn.active=!0;break;case 2:this.callx4btn.active=!0,this.callx8btn.active=!0;break;case 4:this.callx8btn.active=!0;case 8:this.giveup()}this.operesult&&(this.operesult.active=!1);var i=n("GameTimer");this.rtgametimer=new i,this.timesrc=this.rtgametimer.runtimer(this,this.timer_num.node.parent,this.atlas,this.timer_num,this.timer_num,e)},giveup:function(){this.ready()&&this.socket().exec("giveup",{})},showBanker:function(){this.doOperatorResult("catch",!0,0)},showRecoveryCatchResult:function(e){this.operesult.active=!0;for(var t=0;t<this.operesult.children.length;t++)this.operesult.children[t].active=!1;1==e?this.operesult.children[1].active=!0:2==e?this.operesult.children[2].active=!0:4==e?this.operesult.children[3].active=!0:8==e&&(this.operesult.children[4].active=!0)},stopTimer:function(){this.rtgametimer.stoptimer(this,this.timer,this.timesrc)},catchresult:function(e,t){this.timer&&(this.timer.active=!1),this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1),this.playbtn&&(this.playbtn.active=!1),this.timesrc&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc),t?this.doOperatorResult("catch",t,e.myratio):this.doOperatorResult("catch",0<e.myratio,e.myratio)},hideresult:function(){this.operesult&&(this.operesult.active=!1)},lasthands:function(e,t,i){this.setDizhuFlag(i),this.operesult&&(this.operesult.active=!1)},setDizhuFlag:function(e){this.playermysql.getComponent("DizhuPlayerRender").setDizhuFlag(e)},lasttakecards:function(e,t,i,a,s){for(this.result&&(this.result.active=!1),this.playbtn&&(this.playbtn.active=!1),this.catchbtn&&(this.catchbtn.active=!1),this.callx2btn&&(this.callx2btn.active=!1),this.callx4btn&&(this.callx4btn.active=!1),this.callx8btn&&(this.callx8btn.active=!1),this.jsq&&(this.jsq.active=!1),this.lastcards&&(this.lastcards.active=!0),this.timesrc&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc),r=0;r<this.cardslist.length;r++)this.pokerpool.put(this.cardslist[r]);if(this.cardslist.splice(0,this.cardslist.length),a)for(var r=0;r<a.length;r++)this.playcards(t,r,a[r],a);else this.doOperatorResult("lasttakecards",!0);this.repositionLastCards()},repositionLastCards:function(){if(this.lastcards&&0!=this.lastcards.children.length)if(2==this.curTheme)this.lastcards.width=24*(this.lastcards.children.length-1)+109;else if(1==this.curTheme){var e=6<=this.lastcards.children.length?6:this.lastcards.children.length;this.lastcards.width=24*(e-1)+109}this.lastcards&&this.lastcards.getComponent(cc.Animation)&&(this.lastcards.stopAllActions(),this.lastcards.getComponent(cc.Animation).play(),this.lastcards.runAction(cc.moveBy(.2,5,0).easing(cc.easeIn(.2))))},cardtips:function(e,t,i){for(var a,s=0;s<e.pokercards.length;s++){var r=e.pokercards[s];if(r.getComponent("HHCard").card==t){a=r;break}}null!=a&&a.getComponent("HHCard").doselect()},cardtipsfornot:function(e,t){t.cardtipmsg.active=!0,setTimeout(function(){t.cardtipmsg.active=!1},1e3),t.unselected(e,t)},unselected:function(e,t){for(var i=0,a=0;a<e.pokercards.length;a++){var s=e.pokercards[a];if(s){var r=s.getComponent("HHCard");r&&(i+=r.unselected())}}return i},playcards:function(e,t,i,a){for(var s,r=0;r<e.pokercards.length;r++){var n=e.pokercards[r];if(n.card==i){s=n;break}}if(null!=s){for(i=0;i<s.children.length;i++)s.children[i].stopAllActions(),s.children[i].y=0;s.x=0,s.y=0,s.parent=this.lastcards,this.countcard(i,a),s.zIndex=t,s.setScale(.7,.7),this.cardslist.push(s)}},countcard:function(e,t){for(var i=parseInt(e/4),a=0,s=0;s<t.length;s++)i==parseInt(t[s]/4)&&(a+=1);return a},playtimer:function(e,t,i){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;this.timer&&(this.timer.active=!0),this.playbtn&&(this.playbtn.active=!0),this.playbtn.opacity=0,this.playbtn.runAction(cc.fadeIn(.3)),this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1),this.lastcards&&(this.lastcards.active=!1),this.operesult&&(this.operesult.active=!1),this.donottake.active=1!=i,4==a&&(this.playbtn.active=!0,this.playbtn.children[0].active=!1,this.playbtn.children[1].active=!1,this.playbtn.children[2].active=!0,this.playbtn.children[3].active=!1,this.playbtn.children[4].active=!0,this.catchbtn.active=!1,this.donottake.active=!1);for(var s=0;s<this.cardslist.length;s++)e.pokerpool.put(cc.instantiate(this.poker));var r=n("GameTimer");this.rtgametimer=new r,this.timesrc=this.rtgametimer.runtimer(this,this.timerplaynum.node.parent,this.atlas,this.timerplaynum,this.timerplaynum,t),this.canTouch=!0},doOperatorResult:function(e,t,i){if(this.operesult.active=!0,"catch"==e)if(1==t)for(a=0;a<this.operesult.children.length;a++)this.operesult.children[a].active=!1,"call"==this.operesult.children[a].name&&(this.operesult.children[a].active=!0),"callx2"==this.operesult.children[a].name&&1==i&&(this.operesult.children[0].active=!1,this.operesult.children[a].active=!0),"callx4"==this.operesult.children[a].name&&2==i&&(this.operesult.children[0].active=!1,this.operesult.children[a].active=!0),"callx8"==this.operesult.children[a].name&&3==i&&(this.operesult.children[0].active=!1,this.operesult.children[a].active=!0);else for(a=0;a<this.operesult.children.length;a++)this.operesult.children[a].active=!1,"pass"==this.operesult.children[a].name&&(this.operesult.children[a].active=!0);else if("lasttakecards"==e)for(var a=0;a<this.operesult.children.length;a++)this.operesult.children[a].active=!1,"pass"==this.operesult.children[a].name&&(this.operesult.children[a].active=!0)},doSelectCard:function(e){null==this.selectedcards.find(function(e){e.card})&&this.selectedcards.push(e)},doUnSelectCard:function(e){var t=this.selectedcards.indexOf(e);0<=t&&this.selectedcards.splice(t,1)},clean:function(e){this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1),this.lastcards&&(this.lastcards.active=!1),this.operesult&&(this.operesult.active=!1),cc.global.amObserve},restart:function(){this.playerspool.clear();for(var e=0;e<3;e++)this.playerspool.put(cc.instantiate(this.player));for(this.pokerpool.clear(),this.minpokerpool.clear(),t=0;t<25;t++)this.pokerpool.put(cc.instantiate(this.poker));for(var t=0;t<60;t++)this.minpokerpool.put(cc.instantiate(this.poker_min));this.myselfpool.active=!0},disChPos:function(e){this.playermysql.getComponent("DizhuPlayerRender").disChPos(e)},disChSitPos:function(e){this.playermysql.getComponent("DizhuPlayerRender").disChSitPos()},disChEffectPos:function(){this.playermysql.getComponent("DizhuPlayerRender").disChEffectPos()},disUserCharacter:function(){this.playermysql.getComponent("DizhuPlayerRender").disUserCharacter()},showEmoticon:function(e){this.playermysql&&this.playermysql.getComponent("DizhuPlayerRender")&&this.playermysql.getComponent("DizhuPlayerRender").showEmoticon(e)},showCallPlayer:function(e,t){this.playermysql&&this.playermysql.getComponent("DizhuPlayerRender")&&this.playermysql.getComponent("DizhuPlayerRender").showCallPlayer(e,t)},onClickEmoticon:function(){this.playermysql&&this.playermysql.getComponent("DizhuPlayerRender")&&this.playermysql.getComponent("DizhuPlayerRender").onClickEmoticon()},playCardAnimation:function(){},changeTheme:function(){switch(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1){case 1:this.initTheme1();break;case 2:this.initTheme2()}},initTheme1:function(){if(this.playermysql){var e=this.playermysql.getComponent("DizhuPlayerRender");e&&e.changeTheme(1,!0)}},initTheme2:function(){if(this.playermysql){var e=this.playermysql.getComponent("DizhuPlayerRender");e&&e.changeTheme(2,!0)}},speech:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";if(this.playermysql){var t=this.playermysql.getComponent("DizhuPlayerRender");t&&t.speech(e)}},onThemeChanged:function(e){1==cc.global.theme.card_size?this.timer.y=70:this.timer.y=113;for(var t=0;t<this.lastcards.children.length;t++)this.lastcards.children[t]&&this.lastcards.children[t].emit("theme-changed");this.playermysql&&this.playermysql.emit("theme-changed")}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],DizhuPlayerRender:[function(s,e,t){"use strict";cc._RF.push(e,"925feAL2tdCGK3x0HPXYRPQ","DizhuPlayerRender");var i=s("HHCommon");cc.Class({extends:i,properties:{username:{default:null,type:cc.Label},freeicon:{default:null,type:cc.Node},diamondicon:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},diamonds:{default:null,type:cc.Label},dizhu:{default:null,type:cc.Node},timer:{default:null,type:cc.Node},jsq:{default:null,type:cc.Node},amready:{default:null,type:cc.Node},atlas:{default:null,type:cc.SpriteAtlas},timer_num:{default:null,type:cc.Label},result:{default:null,type:cc.Node},lastcards:{default:null,type:cc.Node},cannot:{default:null,type:cc.Node},donot:{default:null,type:cc.Node},avatar:{default:null,type:cc.Sprite},userlevel:{default:null,type:cc.Label},expscore:{default:null,type:cc.Label},btncharacter:{default:null,type:cc.Node},box_stageinfo:{default:null,type:cc.Label},box_roominfo:{default:null,type:cc.Label},bubble_talk:{default:null,type:cc.Node},avatar_outline:{default:null,type:cc.Node},info_outline:{default:null,type:cc.Node},userinfonode:{default:null,type:cc.Node},userinfo:{default:null,type:cc.Prefab},userch:{default:null,type:cc.Node},character:{default:null,type:cc.Prefab},resultx2:{default:null,type:cc.Node},resultx4:{default:null,type:cc.Node},resultx8:{default:null,type:cc.Node},userinfopan:{default:null,type:cc.Node},leave:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},emoticonprefab:{default:null,type:cc.Prefab},effect:{default:null,type:cc.Node},cardspanel:{default:null,type:cc.Node},cardshand:{default:null,type:cc.Node},cardbg:{default:null,type:cc.Prefab},robot:{default:null,type:cc.Node},quality:!0,vipcrown:{default:null,type:cc.Node},crownlist:{default:null,type:cc.Node},vipbadge:{default:null,type:cc.Node},viplevel:{default:null,type:cc.Label},funcusing:{default:null,type:cc.Node},medals:{default:null,type:cc.Node},chpcrown:{default:null,type:cc.Node},bigsmile:{default:null,type:cc.Sprite},bigsmileatlas:{default:null,type:cc.SpriteAtlas}},onLoad:function(){this.cardcount=0,this.cardslist=new Array,this.isRight=!1,this.remaincards=new Array,this.isFirstTheme=!0,this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged()},initplayer:function(e,t,i,a,s,r){this.curTheme=e.curTheme,this.parent=e;if(this.userdata=t,cc.global.user.id,t.id,this.username.string=t.nickname,this.userid=t.id,this.playcharacter=t.playcharacter,this.avatarurl=t.avatarurl,this.seatid=i,this.obsmode=s,0==this.seatid&&1==s&&1.2,this.disUserCharacter(),this.loadAvatar(t.avatarurl,t.gender),1==a){this.timer.x=-1*this.timer.x,this.result.x=-1*this.result.x,this.resultx2.x=-1*this.resultx2.x,this.resultx4.x=-1*this.resultx4.x,this.resultx8.x=-1*this.resultx8.x,this.userinfopan.x=-1*this.userinfopan.x,this.amready.x=-1*this.amready.x,this.cardspanel.x=-1*this.cardspanel.x,this.cannot.x=-1*this.cannot.x,this.donot.x=-1*this.donot.x,this.jsq.x=-1*this.jsq.x,this.lastcards.x=-1*this.lastcards.x,this.lastcards.getComponent(cc.Layout).horizontalDirection=0,this.emoticon.x=-1*this.emoticon.x,this.callplayer.x=-1*this.callplayer.x,this.callplayer.scaleX=-1*this.callplayer.scaleX,this.callplayer.children[1].scaleX=-1*this.callplayer.children[1].scaleX,this.callplayer.children[1].anchorX=1,this.effect.x=-1*this.effect.x,this.userinfonode.x=-1*this.userinfonode.x,this.leave.x=-1*this.leave.x,this.leave.scaleX=-1*this.leave.scaleX;for(var n=0;n<this.effect.children.length;n++)this.effect.children[n].x=-1*this.effect.children[n].x;this.isRight=a,this.cardshand.scaleX=-this.cardshand.scaleX,this.cardshand.getComponent(cc.Layout).horizontalDirection=cc.Layout.HorizontalDirection.RIGHT_TO_LEFT,this.cardshand.x=-this.cardshand.x,this.oriposx=this.lastcards.x}else this.userid,cc.global.user.id;0==this.seatid&&this.obsmode,this.dizhu&&(this.dizhu.active=!1),this.jsq&&(this.jsq.active=!1),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(t.goldcoins))),this.goldcoins.node.parent.getComponent(cc.Label)&&(this.goldcoins.node.parent.getComponent(cc.Label).string=this.numformat(parseInt(t.goldcoins))),this.goldcoins.node.parent.active=!0,this.changeTheme(this.curTheme)},updateBalance:function(){this.goldcoins.node.parent.getComponent(cc.Label)&&(this.goldcoins.node.parent.getComponent(cc.Label).string=this.numformat(parseInt(this.userdata.goldcoins))),this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},updateCareerAfterMatch:function(e){this.goldcoins.node.parent.getComponent(cc.Label)&&(this.goldcoins.node.parent.getComponent(cc.Label).string=this.numformat(parseInt(e.gold)))},countcards:function(e){this.cardcount=this.cardcount+e,this.resetcards(this.cardcount)},addAndShowCards:function(e){if(this.resetcards(20),!this.parent.notReplay){for(var t=[],i=0;i<this.cardshand.children.length;i++)t[i]=this.cardshand.children[i].getComponent("HHCard").card;t=t.concat(e),this.setCards(t)}},setCards:function(e){for(var t=0;t<e.length;t++)if(this.cardshand.children[t]){var i=this.cardshand.children[t].getComponent("HHCard");i.setCard(e[t]),i.order()}},resetcards:function(e){if(this.parent.notReplay)this.cardshand.active=!1;else{this.cardshand.active=!0,this.cardshand.removeAllChildren();for(var t=0;t<e;t++){var i=cc.instantiate(this.cardbg);i.parent=this.cardshand,this.isRight&&(i.scaleX=-i.scaleX)}}0==(this.cardcount=e)?(this.cardspanel.children[0].active=!1,this.cardspanel.children[1].active=!1,this.cardspanel.children[2].active=!1):(this.cardspanel.children[0].active=!0,this.cardspanel.children[1].active=!0,this.cardspanel.children[2].active=!1,this.cardcount=e,this.cardspanel.children[1].getComponent(cc.Label).string=this.cardcount)},cleancards:function(){this.cardspanel.active=!1,this.cardshand.active=!1},showCardsPanel:function(){this.cardspanel.active=!0,this.parent.notReplay||(this.cardshand.active=!0)},catchtimer:function(e){this.jsq&&(this.jsq.active=!0),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1);var t=s("GameTimer");this.rtgametimer=new t,this.timesrc=this.rtgametimer.runtimer(this,this.jsq,this.atlas,this.timer_num,this.timer_num,e)},showBanker:function(){this.result&&(this.result.active=!0)},showRecoveryCatchResult:function(e){1==e?this.donot.active=!0:2==e?this.resultx2.active=!0:4==e?this.resultx4.active=!0:8==e&&(this.resultx8.active=!0)},catchresult:function(e,t){if(this.rtgametimer)if(this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),0<e.myratio)switch(this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),parseInt(e.myratio)){case 1:this.resultx2&&(this.resultx2.active=!0,this.showEffect(0),this.speech("call2"));break;case 2:this.resultx4&&(this.resultx4.active=!0,this.showEffect(1),this.speech("call4"));break;case 3:this.resultx8&&(this.resultx8.active=!0,this.showEffect(2),this.speech("call8"))}else this.speech("pass"),this.result&&(this.result.active=!1),this.cannot&&!t&&(this.cannot.active=!0),this.donot&&(this.donot.active=!0),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1)},hideresult:function(){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1)},lasthands:function(e,t,i,a){this.hideresult(),this.rtgametimer&&this.timesrc&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),this.userid==i&&(this.parent.notReplay?-1==cc.global.gamestatus.indexOf("lucky")&&this.countcards(3):-1==cc.global.gamestatus.indexOf("lucky")&&this.addAndShowCards(a),this.playtimer(t,25)),this.setDizhuFlag(i)},cleanDizhuFlag:function(e){this.dizhu.active=!1},setDizhuFlag:function(e){this.dizhu.active=!!e},lasttakecards:function(e,t,i,a,s){var r=this.parent.notReplay;if(this.rtgametimer&&this.timesrc&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.jsq&&(this.jsq.active=!1),this.lastcards&&(this.lastcards.active=!0),0<this.cardslist.length){for(n=0;n<this.cardslist.length;n++)e.minpokerpool.put(this.cardslist[n]);this.cardslist.splice(0,this.cardslist.length)}if(a){r?this.resetcards(i):(this.boardRemainCards=[],""!=s.playercards&&null!=s.playercards?(this.boardRemainCards=this.decode(s.playercards),this.resetcards(this.boardRemainCards.length,this.boardRemainCards),this.setCards(this.boardRemainCards)):this.resetcards(0));for(var n=0;n<a.length;n++)this.playcards(e,n,a[n],a)}else t.getPlayer(s.userid).tipdonot()},tipcannot:function(){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.cannot&&(this.cannot.active=!0),this.donot&&(this.donot.active=!1)},tipdonot:function(){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!0)},playcards:function(e,t,i,a){var s,r=e.minpokerpool.get();s=9<a.length?9:a.length,this.isRight?this.lastcards.x=36*(9-s)-353-84-14:0!=this.seatid&&(this.lastcards.x=76),r.parent=this.lastcards,this.cardslist.push(r);var n=r.getComponent("HHCard");n.setCard(i),n.order()},countcard:function(e,t){return parseInt(e/4)},playtimer:function(e,t){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.lastcards&&(this.lastcards.active=!1);for(var i=0;i<this.cardslist.length;i++)e.minpokerpool.put(this.cardslist[i]);var a=s("GameTimer");this.rtgametimer=new a,this.timesrc=this.rtgametimer.runtimer(this,this.jsq,this.atlas,this.timer_num,this.timer_num,t)},pauseTimer:function(){this.rtgametimer&&this.rtgametimer.pauseTimer(this,this.jsq,this.timesrc)},resumeTimer:function(){this.rtgametimer&&(this.timesrc=this.rtgametimer.resumeTimer(this,this.jsq,this.timer_num))},stopTimer:function(){this.rtgametimer&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc)},clean:function(e){for(var t=0;t<this.cardslist.length;t++)e.minpokerpool.put(this.cardslist[t]);this.dizhu&&(this.dizhu.active=!1,this.info_outline.color=new cc.Color(255,255,255)),this.jsq&&(this.jsq.active=!1),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.cardcount=0},onClickDisInfo:function(){this.parent.notReplay&&(this.userid==cc.global.user.id?this.onClickEmoticon():this.onclickCallPlayer())},disUserCharacter:function(){},disChPos:function(e){},disLeaveReq:function(e){this.leave.active=e},showCallPlayer:function(e,t){var i=this;cc.global.audio.playVoiceChatWithType(this.playcharacter,t),this.hideCallPlayer(),this.callplayer.active=!0,this.callplayer.children[0].getComponent(cc.Label).string=this.callplayer.children[1].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onclickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userid},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){this.dizhucontxt.onClickEmoticon()},onClickChat:function(){this.dizhucontxt.onclickChat()},onClickLobbyList:function(){this.dizhucontxt.onclickUserlist()},giveContext:function(e){this.dizhucontxt=e},showRoomNumber:function(e){var t=this.getLanguageText("ROOM_0");this.box_roominfo.string=e+t},hideEffect:function(e){var t=this;setTimeout(function(){t&&t.effect&&(t.effect.children[e].active=!1)},1500)},showEffect:function(e){this.effect.children[e].active=!0;var t=this.effect.children[e].getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"tongqian",!1),cc.global.audio.playEffectAud("call"),this.hideEffect(e)},display:function(e){for(var t=": [",i=0;i<e.length;i++)t=t+e[i]+" , ";t+="]"},changeTheme:function(e,t){this.repositionCards()},repositionCards:function(){if(this.lastcards){for(var e=[],t=0;t<this.lastcards.children.length;t++)this.lastcards.children[t].getComponent("HHCard")&&e.push(1);var i;i=9<e.length?9:e.length,this.isRight?this.lastcards.x=36*(9-i)-353-65-14:0!=this.seatid&&(this.lastcards.x=74),0==this.seatid&&this.obsmode}},speech:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";if(""!=e){var t=this.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)}},onThemeChanged:function(){if(1==cc.global.theme.background||2==cc.global.theme.background?(this.avatar_outline.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("head_frame"+cc.global.theme.background),this.cardspanel&&(this.cardspanel.children[0].getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("left_cards_back"+cc.global.theme.background))):(this.avatar_outline.getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas2.getSpriteFrame("head_frame3"),this.cardspanel&&(this.cardspanel.children[0].getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas2.getSpriteFrame("left_cards_back3"))),this.lastcards)for(var e=0;e<this.lastcards.children.length;e++)this.lastcards.children[e]&&this.lastcards.children[e].emit("theme-changed");if(this.cardshand)for(e=0;e<this.cardshand.children.length;e++)this.cardshand.children[e]&&this.cardshand.children[e].emit("theme-changed")}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],DizhuSummaryDetail:[function(e,t,i){"use strict";cc._RF.push(t,"82768SA3iNK2IJnRjByGGWR","DizhuSummaryDetail");var a=e("HHCommon");cc.Class({extends:a,properties:{workitem:{default:null,type:cc.Node},myscore:{default:null,type:cc.Label},myexpscore:{default:null,type:cc.Label},mycareer:{default:null,type:cc.Label},myscoretype:{default:null,type:cc.Node},player_1:{default:null,type:cc.Node},player_1_score:{default:null,type:cc.Label},player_1_expscore:{default:null,type:cc.Label},player_1_career:{default:null,type:cc.Label},player_1_scoretype:{default:null,type:cc.Node},player_2:{default:null,type:cc.Node},player_2_score:{default:null,type:cc.Label},player_2_expscore:{default:null,type:cc.Label},player_2_career:{default:null,type:cc.Label},player_2_scoretype:{default:null,type:cc.Node},mygetout:{default:null,type:cc.Node},player1getout:{default:null,type:cc.Node},player2getout:{default:null,type:cc.Node},base:{default:null,type:cc.Node},win:{default:null,type:cc.Node},lose:{default:null,type:cc.Node},effect:cc.Node},onLoad:function(){this.disDialogEffect(this.base);var t=this;this.workitem.on("getout",function(e){cc.global.backToHall=!0,cc.global.user.roomid="",t.parent.loadding(),t.parent.rerenderPlayers=[],t.parent.isOnSummary=!1,t.parent.scene("hall",t.parent),e.stopPropagation()}),1==cc.global.game_theme_idx?(this.node.children[2].children[0].active=!0,this.node.children[2].children[1].active=!1):(this.node.children[2].children[0].active=!1,this.node.children[2].children[1].active=!0),this.node.height*=cc.global.narrowContentRatio;var e=this;this.iswin=!1,this.effect.getComponent(sp.Skeleton).setCompleteListener(function(){e.iswin?e.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_winloop",!0):e.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_loseloop",!0)})},create:function(e,t){var i=this;this.parent=e;for(var a=0;a<t.players.length;a++){var s=t.players[a];if(s.userid==cc.global.user.id&&"no"==cc.global.amObserve)this.process(s,null,this.myscore,this.myexpscore,null,null,this.mycareer,this.myscoretype),this.disLevelInfo(s),"no"==cc.global.amObserve&&(s.getout?setTimeout(function(){i.node&&i&&i.node&&i.node.dispatchEvent(new cc.Event.EventCustom("getout",!0))},4500):setTimeout(function(){i.node&&i&&i.node&&(i.parent.restart(),i.parent.summarypage.destroy(),i.parent.summarypage=null)},5e3));else{var r=e.getPlayer(s.userid);"yes"==cc.global.amObserve?0==r.seatid?this.process(s,null,this.myscore,this.myexpscore,null,this.mygetout,this.mycareer,this.myscoretype):1==r.seatid?this.process(s,null,this.player_1_score,this.player_1_expscore,null,this.player1getout,this.player_1_career,this.player_1_scoretype):2==r.seatid&&this.process(s,null,this.player_2_score,this.player_2_expscore,null,this.player2getout,this.player_2_career,this.player_2_scoretype):r.isRight?this.process(s,null,this.player_1_score,this.player_1_expscore,null,this.player1getout,this.player_1_career,this.player_1_scoretype):this.process(s,null,this.player_2_score,this.player_2_expscore,null,this.player2getout,this.player_2_career,this.player_2_scoretype)}}"yes"==cc.global.amObserve&&setTimeout(function(){i&&i.node&&(i.parent.restart(),i.parent.summarypage.destroy(),i.parent.summarypage=null)},5e3)},process:function(e,t,i,a,s,r,n,o){0<=e.score?i.string="+ "+this.numformat(e.score):i.string="- "+this.numformat(-1*e.score),0<=e.exp?a.string="+ "+this.numformat(e.exp):a.string="- "+this.numformat(Math.abs(e.exp)),null!=r&&(r.active=e.getout),"normal"==cc.global.user.selplayway?(o.children[0].active=!0,o.children[1].active=!1):"diamond"==cc.global.user.selplayway&&(o.children[0].active=!1,o.children[1].active=!0)},disLevelInfo:function(e){this.effect.active=!0,this.iswin=e.win,this.iswin?(this.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_win",!1),cc.global.audio.playSummaryAud("win")):(this.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_lose",!1),cc.global.audio.playSummaryAud("lose"))},onLeaveClick:function(){this.parent.onclickBack()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],Emoticon:[function(e,t,i){"use strict";cc._RF.push(t,"c974fkKY+dEUKIqJIm8sqWj","Emoticon");var a=e("HHCommon");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},btn_shortcut:{default:null,type:cc.Node},emoticons:{default:null,type:cc.Node},bg:cc.Node},onLoad:function(){this.closing=!0,this.base.getComponent(cc.Animation).play("show_dlg");var t=this;this.base.getComponent(cc.Animation).on("finished",function(e){"hide_dlg"==e.target.name&&(t.context.emoticonpage.destroy(),t.context.isemoticon=!1),t.closing=!1}),cc.global.audio.playDialogAud()},onclickEmoticon:function(e,t){if(this.ready()){var i=this.socket(),a={};a.extparams={emoticon:t},i.exec("selemoticon",a),null!=this.context&&this.onclickRestPart()}},onclickRestPart:function(){this.closing||(this.base.getComponent(cc.Animation).play("hide_dlg"),this.closing=!0)},init:function(e){this.context=e,this.isPortrait="tetris"==cc.global.cur_game_code||"onet"==cc.global.cur_game_code||"koni"==cc.global.cur_game_code||"yut"==cc.global.cur_game_code||"threek"==cc.global.cur_game_code||"popstar"==cc.global.cur_game_code||"animal"==cc.global.cur_game_code||"animal1"==cc.global.cur_game_code||"archery"==cc.global.cur_game_code||"paduk"==cc.global.cur_game_code,cc.global.cur_game_code,this.isPortrait?(this.bg.width=480,this.bg.height=400,this.emoticons.width=460,this.emoticons.height=380,this.bg.y=-10):(this.emoticons.width=920,this.emoticons.height=208,this.bg.width=940,this.bg.height=228)},onClickShortcut:function(){var e=JSON.parse(cc.sys.localStorage.getItem("emo_shortkey_show"));null==e&&(e=!0),e=!e,cc.sys.localStorage.setItem("emo_shortkey_show",JSON.stringify(e));for(var t=0;t<this.emoticons.children.length;t++)this.emoticons.children[t].children[0].active=e}}),cc._RF.pop()},{HHCommon:"HHCommon"}],Emptybutton3:[function(e,t,i){"use strict";cc._RF.push(t,"eee29tzyTJBmqLrqQT9TiQ2","Emptybutton3"),cc.Class({extends:cc.Component,properties:{img:{default:null,type:cc.Node},reddot:{default:null,type:cc.Node}},init:function(e,t,i,a){this.img.active=!1,this.reddot.active=!1,this.row=e,this.col=t,this.putflag=i,this.parent=a},onClick:function(){if("yes"!=cc.global.amObserve&&!this.parent.turnSeat)if(0==this.parent.stage){if(this.putflag)return;if(1==this.parent.nextmode)return;this.parent.on_clickempty(this.row,this.col)}else{if(1==this.parent.nextmode)return;if(!this.goFlag)return;this.parent.on_clickempty(this.row,this.col)}},setGeometry:function(e,t,i){this.node.setPosition(i),this.node.width=e,this.node.height=t,this.img.width=e,this.img.height=t},showBlack:function(e){this.img.active=e,this.putflag=e},showRed:function(e){this.reddot.active=e,this.goFlag=e},finalSlot:function(){this.reddot.active=!1,this.im.active=!1,this.goFlag=!1,this.putflag=!1}}),cc._RF.pop()},{}],EventStop:[function(e,t,i){"use strict";cc._RF.push(t,"ac10fSS3FxNYYcoAeXJyPOu","EventStop"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})}}),cc._RF.pop()},{}],FFABegin:[function(a,e,t){"use strict";cc._RF.push(e,"b6324gvdC5JSr2iAcDyC8Su","FFABegin");var i=a("HHCommon"),s=a("Deck"),r=a("FFASelCardsEngine");cc.Class({extends:i,properties:{global:{default:null,type:cc.Node},poker:{default:null,type:cc.Node},summary:{default:null,type:cc.Prefab},summaryForTwo:{default:null,type:cc.Prefab},summaryForSix:{default:null,type:cc.Prefab},touch:{default:null,type:cc.Node},effect:{default:null,type:cc.Node},back_players:{default:null,type:cc.Node},front_players:{default:null,type:cc.Node},btn_enter:{default:null,type:cc.Node},playersboard:{default:null,type:cc.Node},leavereq:{default:null,type:cc.Node},chat:{default:null,type:cc.Prefab},chatsearch:{default:null,type:cc.Prefab},emodlg:{default:null,type:cc.Prefab},unselect:{default:null,type:cc.Node},roominfo:{default:null,type:cc.Node},roomscore:cc.Label,observer:{default:null,type:cc.Prefab},obsbench:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},obschatbtn:{default:null,type:cc.Node},obsemojibtn:{default:null,type:cc.Node},btn_cardsort:{default:null,type:cc.Node},btn_robot:{default:null,type:cc.Node},raiseup:{default:null,type:cc.Node},gameboardmark:{default:null,type:cc.Node},btn_record_play:{default:null,type:cc.Node},lbl_record_status:{default:null,type:cc.Label},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},illegalconfirm:{default:null,type:cc.Prefab},room_cond_mode:{default:null,type:cc.Node},select_winner:{default:null,type:cc.Prefab},roomrankdialog:{default:null,type:cc.Prefab},roommarkatlas:{default:null,type:cc.SpriteAtlas},globaljsq:{default:null,type:cc.Node},timer_num:{default:null,type:cc.Label},last4_img:{default:null,type:cc.Node},btn_theme:{default:null,type:cc.Node},roomCondition:0,tipLabel1:{default:null,type:cc.Node},tipLabel2:{default:null,type:cc.Node},raiseAnim:{default:null,type:cc.Node},background:{default:null,type:cc.Node},buttons:{default:null,type:cc.Node},bar_bottom:{default:null,type:cc.Node},settinglayer:{default:null,type:cc.Node},settingback:{default:null,type:cc.Node},switchtogame:{default:null,type:cc.Node},cardgroup:cc.Node,watermark:cc.Node,dealingpanel:cc.Node,soundbtn:cc.Node,remainCards:{default:null,type:cc.Node}},onLoad:function(){var e=this;e.switchtogame.active=!0,setTimeout(function(){e.switchtogame.getComponent(cc.Animation).play("door_open"),cc.global.audio.playEffectAud("door")},50),this.turnCount=0,cc.global.amObserve="no",this.curTheme=parseInt(cc.global.game_theme_idx),this.changeTheme(this.curTheme),this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged(),e.onStartGame()},onStartGame:function(){this.show_setting=!1,this.tipLabel1.active=!1,this.tipLabel2.active=!1,this.initEventCallback(),this.curBgIdx=1,this.goRecovery=!1,this.initUI(),this.playerSlotPos=[cc.v2(-551/cc.global.narrowContentRatio,-79.4),cc.v2(551/cc.global.narrowContentRatio,-79.4),cc.v2(551/cc.global.narrowContentRatio,149),cc.v2(-551/cc.global.narrowContentRatio,149)],this.playerSlotPos3=[cc.v2(-551/cc.global.narrowContentRatio,-79.4),cc.v2(551/cc.global.narrowContentRatio,-79.4),cc.v2(551/cc.global.narrowContentRatio,149),cc.v2(-551/cc.global.narrowContentRatio,149)],this.altplayerSlotPos=[cc.v2(-551/cc.global.narrowContentRatio,-229.4),cc.v2(551/cc.global.narrowContentRatio,-229.4),cc.v2(551/cc.global.narrowContentRatio,99),cc.v2(-551/cc.global.narrowContentRatio,99)],this.player=new Array,this.observerlist=new Array,this.playerboard=new Array,this.pokercards=new Array,this.lastcards=new Array,this.cardsArr=new Array,this.summarypage=null,this.inited=!1,this.lasttip=null,this.score="1",this.play_status=0,this.KPMode=0,this.upCardsCount=0,this.rerenderPlayers=[],this.isOnSummary=!1,this.notReplay=!0,this.gameCleaned=!1,this.boardRatio=1,this.deck=new s,this.engine=new r,null!=cc.global&&(""!=cc.global.user.roomid&&this.recovery(),this.initgame()),cc.global.watchReplayData.onReplay&&this.prepareReplay()},raiseUp_event:function(){var e=this;this.raiseAnim.active=!0;var t=this.raiseAnim.children[0].getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"play",!1),cc.global.audio.playEffectAud("call"),setTimeout(function(){e&&e.raiseAnim&&(e.raiseAnim.active=!1)},2e3)},prepareReplay:function(){this.notReplay=!1,cc.global.amObserve="yes",this.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),this.replay_bar.active=!0,this.replayStep="ready_room",this.replaySeq=0,this.goReplay(),this.createReplayTimer(),this.bar_bottom.active=!1,this.buttons.children[2].active=this.buttons.children[3].active=!1},createReplayTimer:function(){var e=this;this.replayTimer=setInterval(function(){e.play_history&&(e.replayTimeDelay-=30*cc.global.watchReplayData.replaySpeedX,e.replayTimeDelay<=0&&e.play_history[e.replaySeq]&&e.goReplay())},30)},pauseReplayTimer:function(){clearInterval(this.replayTimer)},resumeReplayTimer:function(){this.createReplayTimer()},goReplay:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=!1;switch(this.replayStep){case"ready_room":this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"play":t=!0,this.replay_play_event(i,this);break;case"catch":this.catch_event(i,this);break;case"catchresult":this.catchresult_event(i,this);break;case"lasthands":this.lasthands_event(i,this);break;case"ffabet":t=!0,this.takecards_event(i,this);break;case"kp":t=!0,this.kp_event(i,this);break;case"turn":t=!0,this.turn_event(i,this);break;case"allcards":t=!0,this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.selemoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"players":this.players_event(i,this);break;case"exit":this.leave_event(i,this);break;case"sgr":t=!0,this.replay_sgr_event(i,this)}}""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,this.play_history[this.replaySeq]||(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.pauseReplayTimer()),e&&!t&&this.goReplay(!0)},exitPlay:function(){cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),clearTimeout(this.deal1_timer),clearTimeout(this.deal2_timer),clearTimeout(this.bankerSelfTimer),clearTimeout(this.bankerOtherTimer),this.rerenderPlayers=[],this.isOnSummary=!1,this.returnToHall()},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.gameTimerSpeedChange(!0),this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):(this.replayTimer&&clearInterval(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.gameTimerSpeedChange(!1),this.replay_bar.children[0].opacity=100,this.pauseReplayTimer())},onClickReplayStop:function(){},onClickReplaySpeedUp:function(){var e=this.getLanguageText("REPLAY_TIME")+" : ";cc.global.watchReplayData.replaySpeedX<5&&(cc.global.watchReplayData.replaySpeedX++,this.lbl_replaySpeedX.string=e+cc.global.watchReplayData.replaySpeedX+"x",this.gameTimerSpeedChange(!0),this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){var e=this.getLanguageText("REPLAY_TIME")+" : ";1<cc.global.watchReplayData.replaySpeedX&&(cc.global.watchReplayData.replaySpeedX--,this.lbl_replaySpeedX.string=e+cc.global.watchReplayData.replaySpeedX+"x",this.gameTimerSpeedChange(!0),this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},togglePlayToPause:function(){this.replayTimer&&clearInterval(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.gameTimerSpeedChange(!1),this.replay_bar.children[0].opacity=100,this.pauseReplayTimer()},onClickReplayNextTurn:function(){this.togglePlayToPause(),this.goReplay(!0)},onClickReplayPrevTurn:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.goReplay(!0))},gameTimerSpeedChange:function(e){if(this&&this.playerboard)for(var t=0;t<this.playerboard.length;t++){var i=this.playerboard[t].getComponent("FFAPlayerBoardRender");i&&i.rtgametimer&&(i.rtgametimer.isRunTimer?i.pauseTimer():i.resumeTimer())}},initUI:function(){cc.global.audio.playBGM("bgm_card"),JSON.parse(cc.sys.localStorage.getItem("sfx_on1"))?(this.soundbtn.children[0].active=!1,this.soundbtn.children[1].active=!0):(this.soundbtn.children[0].active=!0,this.soundbtn.children[1].active=!1)},onClickReady:function(){if(this.ready()){var e=this.socket(),t={};t.extparams={roomid:cc.global.extparams.roomid},e.exec("ready",t)}},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},initgame:function(){var t=this;if(this.ready()){var e=this.socket();if(this.game=this.getCommon("FFADataBind"),(cc.global.dizhubegin=this).map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("catch",this.catch_event),this.map("catchresult",this.catchresult_event),this.map("lasthands",this.lasthands_event),this.map("ffabet",this.takecards_event),this.map("kp",this.kp_event),this.map("turn",this.turn_event),this.map("play",this.play_event),this.map("allcards",this.allcards_event),this.map("rend",this.rend_event),this.map("cardtips",this.cardtips_event),this.map("roomready",this.roomready_event),this.map("playeready",this.playeready_event),this.map("rer",this.recovery_event),this.map("banker",this.banker_event),this.map("exit",this.leave_event),this.map("seltips",this.seltips_event),this.map("selemoticon",this.selemoticon_event),this.map("callplayer",this.callplayer_event),this.map("sendchat",this.sendchat_event),this.map("startrecordresult",this.startrecord_event),this.map("sgr",this.sgr_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)}),this.notReplay)if("NormalCreate"==cc.global.user.roomInType){var i={};null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i)}else"NormalJoin"==cc.global.user.roomInType?((i={}).extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i)):"NormalObserve"==cc.global.user.roomInType&&((i={}).extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i));5==cc.global.extparams.cond||12==cc.global.extparams.cond?(this.btn_theme.active=!1,this.changeTheme(1,!0)):this.changeTheme(this.curTheme),this.inited=!0}},joinroom_event:function(e,t){t.closeloadding(),t.roomCondition=e.cond,t.is2=7==e.cond||11==e.cond,t.is3=6==e.cond||13==e.cond,1==e.score&&(t.trainmode=!0),cc.global.extparams.roomid=e.id,cc.global.user.roomNo=e.id,cc.global.user.selplayway=e.name,2==e.cond||10==e.cond?(t.room_cond_mode.getComponent(cc.Label).string="(4)",t.room_cond_mode.active=!0,t.is_ptn_room=!0):7==e.cond||11==e.cond?(t.room_cond_mode.getComponent(cc.Label).string="(1:1)",t.room_cond_mode.active=!0,t.is_ptn_room=!1):5==e.cond||12==e.cond?(t.room_cond_mode.getComponent(cc.Label).string="(6)",t.room_cond_mode.active=!0,t.is_ptn_room=!0,t.changeTheme(1,!0)):(6==e.cond||13==e.cond?(t.room_cond_mode.getComponent(cc.Label).string="(Dizhu)",t.room_cond_mode.active=!0):t.room_cond_mode.active=!1,t.is_ptn_room=!1),8<e.cond?t.last4_img.active=!0:t.last4_img.active=!1,"champion"!=cc.global.user.selplayway&&(cc.global.championMode=0),cc.global.curPlaywayScore=e.score,t.score=e.score;var i=t.getLanguageText("ROOM_0");switch(t.roomscore.string=t.score*parseInt(null==e.ratio||null==e.ratio?t.boardRatio:e.ratio),t.roominfo.children[3].getComponent(cc.Label).string=e.id+i,"yes"==cc.global.amObserve?t.touch.active=!1:t.touch.active=!0,"ready"==cc.global.gamestatus?(cc.global.gamestatus="waiting",e.playerlist.length==e.players&&(cc.global.gamestatus="playing"),t.goRecovery=!0,t.players_event(e,t)):"waiting"==cc.global.gamestatus?(t.goRecovery=!0,t.players_event(e,t)):"playing"==cc.global.gamestatus&&(cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)),t.goRecovery=!1,t.watermark.children[0].active=!1,t.watermark.children[1].active=!1,t.watermark.children[2].active=!1,t.roomCondition){case 0:t.watermark.children[0].active=!0;break;case 2:t.watermark.children[1].active=!0;break;case 7:t.watermark.children[2].active=!0}},observer_event:function(e,t){t.obsbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i]),a.parent=t.obsbench,(t.observerlist[i]=a).getComponent("Observer").nickname.node.active=!1}},userready_event:function(e,t){e.userid==cc.global.user.id?t.game.playermysql.getComponent("FFAPlayerRender").amready.active=!0:t.getPlayerBoard(e.userid).amready.active=!0},roomready_event:function(e,t){1==e.cardroom&&null!=t.invite&&t.invite.destroy()},playeready_event:function(e,t){e.userid==cc.global.user.id&&(t.gamebtn.active=!1)},returnToHall:function(){this.loadding(),clearTimeout(this.restartTimer),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.scene("hall",this)},players_event:function(e,t){var i=t.is2?2:5==t.roomCondition||12==t.roomCondition?6:4;if(i=6==t.roomCondition||13==t.roomCondition?3:i,e.msg&&(cc.global.outReasonMsg=e.msg),0==e.playerlist.length||e.playerlist.length>i)t.returnToHall();else{e.playerlist.length==i?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting","champion"==cc.global.user.selplayway||"no"!=cc.global.amObserve||t.isOnSummary);for(var a=!0,s=0;s<e.playerlist.length;s++)if(e.playerlist[s].id==cc.global.user.id){a=!1;break}for(s=0;s<e.observerlist.length;s++)e.observerlist[s].id==cc.global.user.id&&(a=!1);if(a&&t.notReplay)t.exitPlay();else{if(t.observer_event(e,t),"playing"==cc.global.gamestatus&&0==t.goRecovery)return;if("yes"==cc.global.amObserve?(t.btn_cardsort.active=!1,0==t.play_status?"waiting"==cc.global.gamestatus&&0==t.isOnSummary?1==cc.global.championMode||2==cc.global.championMode?t.btn_enter.active=!1:0==cc.global.championMode&&t.notReplay&&(t.btn_enter.active=!0):t.btn_enter.active=!1:1==t.play_status&&(t.btn_enter.active=!1)):(t.btn_cardsort.active=!0,t.btn_enter.active=!1),t.rerenderPlayers=e.playerlist,t.rerenderPlayers.length<i&&t.showRaiseUp(0),t.isOnSummary)return;t.cleanGamePlayers(),t.game.restart(i),t.rerenderPlayers.length<i&&t.showRaiseUp(0),t.addBoardPlayers(i)}}},clearContextPlayers:function(){for(var e=0;e<this.player.length;e++)this.player[e].destroy();this.player.splice(0,this.player.length),this.player=new Array},addBoardPlayers:function(e){if("no"==cc.global.amObserve){for(var t=-1,i=0;i<this.rerenderPlayers.length;i++)this.rerenderPlayers[i].seatid=i,this.rerenderPlayers[i].id==cc.global.user.id&&(this.game.addSelfPlayer(this,this.rerenderPlayers[i],this.is2),this.game.giveContext(this),t=this.rerenderPlayers[i].seatid);for(i=0;i<this.rerenderPlayers.length;i++)if(this.rerenderPlayers[i].seatid!=t&&0==this.playerexist(this.rerenderPlayers[i],this)){var a=this.rerenderPlayers[i].seatid-t;a<0&&(a+=e),6==this.roomCondition||13==this.roomCondition?(2==a&&(a=3),1==a&&(a=2)):1==a&&this.is2&&(a=2),5==this.roomCondition||12==this.roomCondition?this.newplayerExt(this.player.length,this,this.rerenderPlayers[i],a,!1):this.newplayer(this.player.length,this,this.rerenderPlayers[i],a,!1)}}else for(i=0;i<this.rerenderPlayers.length;i++)1==i&&this.is2?this.rerenderPlayers[i].seatid=2:1==i&&this.is3?this.rerenderPlayers[i].seatid=2:2==i&&this.is3?this.rerenderPlayers[i].seatid=3:this.rerenderPlayers[i].seatid=i,0==this.playerexist(this.rerenderPlayers[i],this)&&(5==this.roomCondition||12==this.roomCondition?this.newplayerExt(this.player.length,this,this.rerenderPlayers[i],this.rerenderPlayers[i].seatid,!1):this.newplayer(this.player.length,this,this.rerenderPlayers[i],this.rerenderPlayers[i].seatid,!1))},removeBoardPlayers:function(){for(var e=0;e<this.player.length;e++){for(var t=this.player[e].getComponent("FFAPlayerRender"),i=!1,a=0;a<this.rerenderPlayers.length;a++)if(t.userdata.id==this.rerenderPlayers[a].id){i=!0;break}1!=i&&this.showRaiseUp(0),this.player[e].destroy(),this.player.splice(e,1),this.playerboard[e].destroy(),this.playerboard.splice(e,1)}},playerexist:function(e,t){for(var i=0;i<t.player.length;i++)if(null!=t.player[i]&&t.player[i].getComponent("FFAPlayerRender").userid==e.id)return!0;return!1},banker_event:function(e,t){if(cc.global.dizhubegin.banker_id=e.userid,e.userid==cc.global.user.id&&t.notReplay)t.bankerSelfTimer=setTimeout(function(){t&&t.game&&(t.game.showBanker(),t.game.speech("call"))},600);else{var i=600;t.notReplay||(i=0),t.bankerOtherTimer=setTimeout(function(){t&&t.game&&(t.getPlayerBoard(e.userid).showBanker(),t.getPlayer(e.userid).speech("call"))},i)}t.rtgametimer&&t.rtgametimer.stoptimer(t,t.globaljsq,t.timesrc),t.cardgroup.active=!1},catch_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay)t.game.catchtimer(e.timer,e.ratio),cc.global.user.doCatch=!0;else for(var i=0;i<t.playerboard.length;i++){var a=t.playerboard[i].getComponent("FFAPlayerBoardRender");a.userid&&a.userid==e.userid?a.catchtimer(e.timer):a.stopTimer()}},recovery_event:function(e,t){t.cleanGame(),-1!=e.status.indexOf("lucky")&&(cc.global.gamestatus="luckyre");var i=0;if(t.raiseUp(e.ratio),t.turnCount=e.count,"no"==cc.global.amObserve)if(-1!=e.status.indexOf("lucky")){if(cc.global.gamestatus=e.status,e.player&&-1!=e.player.luckycard){for(u=0;u<e.player.cnum;u++){var a=t.playcards(t.game,t,50*u-300,e.player.luckycard);t.registerProxy(a)}for(v=0;v<t.pokercards.length;v++)(n=t.pokercards[v]).getComponent("HHCard").order();t.layoutPokerCard()}}else if(e.player&&e.player.cards){var s=t.decode(e.player.cards);for(2==(i=t.hasRed(s))&&(t.game.hasRP=!0,t.game.isRedTeam=!0),u=0;u<s.length;u++){var r=t.playcards(t.game,t,50*u-300,s[u]);t.registerProxy(r)}for(v=0;v<t.pokercards.length;v++){var n=t.pokercards[v];n.getComponent("HHCard").order()}t.layoutPokerCard()}for(e.player&&e.player.bank&&t.game.showBanker(!1),v=0;v<e.others.length;v++)e.others[v].bank&&t.getPlayerBoard(e.others[v].playuser).showBanker(!1);if("calling"!=e.status){if("camping"==e.status&&t.runGlobalTimer(t,e.timer),e.player&&e.player.history&&0<e.player.history.length){var o=t.decode(e.player.history);t.game.lasttakecards(t.game,t,o.length,o)}if(null!=e.others&&0<e.others.length)for(v=0;v<e.others.length;v++){var l=t.getPlayerBoard(e.others[v].playuser);if(l&&e.others[v].history&&0<e.others[v].history.length){var c=t.decode(e.others[v].history);l.lasttakecards(t.game,t,c.length,c)}}if(e.expid==cc.global.user.id)t.game.playtimer(t.game,e.timer,1==e.bt,1<e.bt?e.bt-1:0);else{var h=t.getPlayerBoard(e.expid);h&&h.playtimer(t.game,e.timer)}}else{if(""!=e.expid)for("no"==cc.global.amObserve&&t.game.showRecoveryCatchResult(e.player.ratio),v=0;v<e.others.length;v++){var d=e.others[v].playuser;t.getPlayerBoard(d).showRecoveryCatchResult(e.others[v].ratio)}if(e.expid==cc.global.user.id)t.game.catchtimer(e.timer,e.ratio),cc.global.user.doCatch=!0;else for(u=0;u<t.playerboard.length;u++)if((m=t.playerboard[u].getComponent("FFAPlayerBoardRender")).userid&&m.userid==e.expid){m.catchtimer(e.timer);break}}if(e.sidemap)if(t.is2){t.show2Mode();for(var u=0;u<t.playerboard.length;u++){(m=t.playerboard[u].getComponent("FFAPlayerBoardRender")).userid&&m.sgr_event(parseInt(e.sidemap[m.userid]))}e.player&&t.game.sgr_event(parseInt(e.sidemap[e.player.playuser]))}else if(t.is3){var p=1==t.curTheme?cc.p(0,166):cc.p(0,59);t.remainCards.setPosition(p),t.remainCards.active=!0;for(i=0;i<8;i++){if(null==(g=t.remainCards.children[i])){var g=t.game.pokerpool.get();t.remainCards.addChild(g)}g.getComponent("HHCard").init(),g.active=!0}t.remainCards.getComponent(cc.Layout).spacingX=-100;for(u=0;u<t.rerenderPlayers.length;u++){var m;if((m=t.rerenderPlayers[u]).id)if(2<=parseInt(e.sidemap[m.id]))if(t.disableRemainCardInThreeMode(!1),m.id==cc.global.user.id&&t.notReplay)t.game.playermysql.getComponent("FFAPlayerRender").showAlarm(!0);else{var y=t.getPlayer(m.id);y&&y.showAlarm(!0)}}t.remainCards.getComponent(cc.Animation).play()}if(null!=e.others&&0<e.others.length)for(v=0;v<e.others.length;v++)t.getPlayerBoard(e.others[v].playuser).resetcards(e.others[v].cnum);var f=e.ratio;if(e.openred&&(f=8),t.game.callRank=t.getRatioStep(parseInt(f)),t.game.setBoardRank(),"no"==cc.global.amObserve&&(!(e.player.red||1<=i)||t.is_ptn_room||t.is2||t.is3||t.game.setRedTeam(!1,2==i)),"no"==cc.global.amObserve){var b=t.getRatioStep(parseInt(e.player.ratio));t.game.showCallStat(b)}for(var v=0;v<e.others.length;v++){var _=t.getRatioStep(parseInt(e.others[v].ratio)),C=t.getPlayerBoard(e.others[v].playuser),k=t.getPlayer(e.others[v].playuser);C.showCallStat(_),!e.others[v].red||t.is_ptn_room||t.is2||t.is3||k.setRedTeam(!1,2==i)}t.showRaiseUp(e.dummy),t.addTouchEvent(),(t.notReplay||0<t.player.length)&&(cc.global.user.selplayway,e.recording&&(t.lbl_record_status.string="..."))},getRatioStep:function(e){return 2==e?1:4==e?2:8==e?3:16==e?4:32==e?5:0},raiseUp:function(e,t){(this.boardRatio<e||t)&&(this.boardRatio=e,this.roomscore.string=parseInt(this.score)*parseInt(this.boardRatio),this.roomscore.node.runAction(cc.sequence(cc.scaleTo(.15,1.2,1.2),cc.scaleTo(.15,1,1))))},catchresult_event:function(e,t){if(t&&(t.raiseUp(e.ratio),t&&t.game&&(t.game.callRank=t.game.callRank<e.myratio?e.myratio:t.game.callRank,t.game.setBoardRank())),e.userid==cc.global.user.id&&t.notReplay)if(t.game.catchresult(e),cc.global.user.doCatch=!1,0<e.myratio)switch(parseInt(e.myratio)){case 1:t.showAnimation(12,e.userid);break;case 2:t.showAnimation(13,e.userid);break;case 3:t.showAnimation(15,e.userid);break;case 4:t.showAnimation(16,e.userid);break;case 5:t.showAnimation(14,e.userid)}else t.game.speech("pass");else if(t.getPlayerBoard(e.userid).catchresult(e),0<e.myratio)switch(parseInt(e.myratio)){case 1:t.getPlayer(e.userid).speech("call2");break;case 2:t.getPlayer(e.userid).speech("call4");break;case 3:t.getPlayer(e.userid).speech("call8");break;case 4:t.getPlayer(e.userid).speech("call16");break;case 5:t.getPlayer(e.userid).speech("callpig")}else t.getPlayer(e.userid).speech("pass")},hideAllCallStat:function(e){if(!(e<this.game.callRank)){var t=this.game.playermysql.getComponent("FFAPlayerRender");t.hideCallStat();for(var i=0;i<this.player.length;i++)(t=this.player[i].getComponent("FFAPlayerRender")).hideCallStat()}},lasthands_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay){for(t.game.lasthands(),i=0;i<t.playerboard.length;i++)(a=t.playerboard[i].getComponent("FFAPlayerBoardRender")).hideresult();t.game.playtimer(t.game,e.timer,!0),t.game.hideresult()}else{t.game.hideresult();for(var i=0;i<t.playerboard.length;i++){var a=t.playerboard[i].getComponent("FFAPlayerBoardRender");a.hideresult()}var s=t.getPlayerBoard(e.userid);s&&(s.lasthands(t,t.game,e),s.playtimer(t.game,e.timer))}},cleanAllLastCards:function(){if(this.playerboard){for(var e=0;e<this.playerboard.length;e++)this.playerboard[e].getComponent("FFAPlayerBoardRender").cleanLastCards(this.game);this.game.cleanCards(this.game)}},takecards_event:function(e,t){if(t.lasttip=null,t.dealed=!0,1==e.allow){if(e.count){var i=parseInt(e.count);if(t.notReplay&&t.turnCount+1!=i)return t.loadding(),void t.recovery();t.turnCount=parseInt(i)}1==e.clear&&t.cleanAllLastCards();var a=null,s=!1;if(e.cards?0<(a=t.decode(e.cards)).length&&cc.global.audio.playEffectAud("takecard"):e.userid==cc.global.user.id&&t.notReplay?t.game.speech("pass"):t.getPlayer(e.userid).speech("pass"),e.userid==cc.global.user.id&&t.notReplay)cc.global.user.myPlayTurn=!1,t.game.unselected(t,t.game),a&&0<a.length&&(e.type<5?t.game.disChPos("Play"):5<=e.type&&e.type<=9&&t.game.disChPos("Play_1")),t.game.lasttakecards(t.game,t,e.cnum,a,e),t.game.showRobot(e.robot),1==e.kp?(t.game.showKickPopBalloon("Kick"),t.game.speech("kick"),s=!0):2==e.kp&&(t.game.showKickPopBalloon("Pop"),t.game.speech("pop"),s=!0),!e.red||t.is_ptn_room||t.is2||t.is3||t.game.setRedTeam(!1,8==e.type);else{var r=t.getPlayerBoard(e.userid),n=t.getPlayer(e.userid);r&&(a&&0<a.length&&(e.type<5?n.disChPos("Play"):(5<=e.type||e.type<=9)&&n.disChPos("Play_1")),r.lasttakecards(t.game,t,e.cnum,a,e),n.showRobot(e.robot),1==e.kp?(n.showKickPopBalloon("Kick"),n.speech("kick"),s=!0):2==e.kp&&(n.showKickPopBalloon("Pop"),n.speech("pop"),s=!0),!e.red||t.is_ptn_room||t.is2||t.is3||n.setRedTeam(!1,8==e.type))}if(t.game.selectedcards.splice(0,t.game.selectedcards.length),e.nextid)if(e.nextid==cc.global.user.id&&t.notReplay)e.nextid==e.userid?setTimeout(function(){t.game.playtimer(t.game,e.timer,e.first)},1e3):t.game.playtimer(t.game,e.timer,e.first),cc.global.user.myPlayTurn=!0,1==e.first?cc.global.user.hardLiner=!0:cc.global.user.hardLiner=!1;else{var o=t.getPlayerBoard(e.nextid);e.nextid==e.userid?setTimeout(function(){o&&o.playtimer(t.game,e.timer)},1e3):o&&o.playtimer(t.game,e.timer)}var l=parseInt((a&&0<a.length?a[0]:0)/4)+3;13<l&&(l-=13),10==l&&a[0]%2==0&&(l=15),s||t.showAnimation(e.type,e.userid,l),e.multi&&!isNaN(e.multi)&&0<parseInt(e.multi)&&(t.raiseUp(2*t.boardRatio),t.raiseUp_event())}else t.game.notallow.active=!0,setTimeout(function(){t.game.notallow.active=!1},2e3),t.game.unselected(t,t.game);e.userid==cc.global.user.id&&t.pokerLayout(t)},kp_event:function(e,t){t.notReplay&&t.game.hideResultPlayBtn();var i=t.decode(e.msg);t.game.unselected(t,t.game);for(var a=0;a<i.length;a++)t.game.cardtips(t,i[a],i);t.game.playtimer(t.game,5,e.first,e.extmsg)},turn_event:function(e,t){t.game.unselected(t,t.game),t.notReplay&&t.game.hideResultPlayBtn();var i=parseInt(e.msg);if(!(i<=0))if(e.userid==cc.global.user.id&&t.notReplay)t.game.playtimer(t.game,i,1==parseInt(e.extmsg));else{var a=t.getPlayerBoard(e.userid);a&&a.playtimer(t.game,i)}},leave_event:function(e,t){e.userid==cc.global.user.id&&t.notReplay?t.disLeaveReq("true"==e.msg):t.getPlayer(e.userid).disLeaveReq("true"==e.msg)},selemoticon_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showEmoticon(e.msg);else{var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg)}var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},callplayer_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showCallPlayer(e.msg);else{var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg)}var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg)},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase;if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showCallPlayer(i,e.msg);else{var a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg)}var s=t.getObserver(e.userid);s&&s.showCallPlayer(i,e.msg)},showAnimation:function(e,t,i){var a=-1;switch(e){case 1:case 2:a=0;break;case 3:a=14;break;case 4:a=9;break;case 5:a=0;break;case 6:a=15;break;case 7:a=13;break;case 8:a=1;break;case 9:a=7;break;case 10:a=2;break;case 11:a=3;break;case 12:a=4;break;case 13:a=5;break;case 14:a=6;break;case 15:a=11;break;case 16:a=12}0<=a&&this.disEffect(a,t,e,i)},hideEffect:function(e){var t=this;setTimeout(function(){t.effect&&(t.effect.children[e].active=!1)},2e3)},disEffect:function(e,t,i,a){this.effect.children[e].active=!0;var s="",r=null;switch(cc.global.user.id==t&&this.notReplay?this.game&&this.game.playermysql&&(r=this.game.playermysql.getComponent("FFAPlayerRender")):r=this.getPlayer(t),e){case 0:1==i?(r&&r.speech("c"+a),this.effect.children[e].active=!1):2==i?(r&&r.speech("pair"),this.effect.children[e].active=!1):(s="last_3d1",cc.global.audio.playEffectAud("bomb"),5==i?r&&r.speech("bomb"):6==i&&r&&r.speech("44a"));break;case 1:s="doudizhu_huojian",cc.global.audio.playEffectAud("rocket"),7==i?r&&r.speech("rocket"):8==i&&r&&r.speech("pig");break;case 4:s="tongqian",cc.global.audio.playEffectAud("call"),r&&r.speech("call2");break;case 5:s="tongqian",cc.global.audio.playEffectAud("call"),r&&r.speech("call4");break;case 6:s="tongqian",cc.global.audio.playEffectAud("call"),r&&r.speech("callpig");break;case 7:s="doudizhu_huojian",cc.global.audio.playEffectAud("bomb"),r&&r.speech("blackpig");break;case 8:r&&r.speech("straight"),s="doudizhu_feiji",cc.global.audio.playEffectAud("plane"),this.effect.children[e].active=!1,e=9,this.effect.children[e].active=!0;break;case 9:s="doudizhu_feiji",cc.global.audio.playEffectAud("plane"),r&&r.speech("pair_straight");break;case 11:s="tongqian",cc.global.audio.playEffectAud("call"),r&&r.speech("call8");break;case 12:s="tongqian",cc.global.audio.playEffectAud("call"),r&&r.speech("call16");break;case 13:if(s="lujingzhu",cc.global.audio.playEffectAud("rocket"),r)switch(r.speech("rocket"),r.seatidx){case 0:this.effect.children[13].rotation=0,s="lujingzhu";break;case 1:this.is2?this.effect.children[13].rotation=0:this.effect.children[13].rotation=30,s="lujingyou";break;case 2:this.effect.children[13].rotation=0,s="lujingyou";break;case 3:this.effect.children[13].rotation=0,s="lujingzou"}break;case 14:cc.global.audio.playEffectAud("boat"),r&&r.speech("straight"),s="tonghou",0==r.seatidx||3==r.seatidx?this.effect.children[14].rotation=90:this.effect.children[14].rotation=-90;break;case 15:cc.global.audio.playEffectAud("bomb"),r&&r.speech("44a"),s="chupai"}if(""!=s){var n=this.effect.children[e].getComponent(sp.Skeleton);n.clearTracks(),13==e?(n.addAnimation(0,s,!1),n.addAnimation(0,"zha",!1)):n.setAnimation(0,s,!1)}this.hideEffect(e)},cardtips_event:function(e,t){if(t.game.unselected(t,t.game),e.extdata.cards){var i=t.decode(e.extdata.cards);t.lasttip=i.join(","),cc.global.tipsReady=!0,t.upCardsCount=i.length;for(var a=0;a<i.length;a++)t.game.cardtips(t,i[a],i)}else t.upCardsCount=0,t.game.cardtipsfornot(t,t.game),setTimeout(function(){t.noCards()},500)},seltips_event:function(e,t){var i=t.decode(e.cards);if(t.lasttip=i.join(","),0<i.length)for(var a=0;a<i.length;a++)t.game.cardtips(t,i[a],i);else t.checkSelEndCard();for(var s=0;s<t.cardsArr.length;s++){var r=t.cardsArr[s].getComponent("HHCard");r.touched=!1,r.selected}},hasRed:function(e){for(var t=0,i=0;i<e.length;i++)28==parseInt(e[i])&&t++,30==parseInt(e[i])&&t++;return t},replay_play_event:function(e,t){if(e.curgame==cc.global.cur_game_code){cc.global.gamestatus="playing";var i=[],a=0,s=this.getPlayer(e.playuser),r=this.getPlayerBoard(e.playuser);e.cards&&(i=t.decode(e.cards),2!=(a=t.hasRed(i))||t.is_ptn_room||t.is2||t.is3?1!=a||t.is_ptn_room||t.is2||t.is3||s.setRedTeam(!1,!1):s.setRedTeam(!1,!0),r.resetcards(i.length),r.setCards(i)),t.is2&&(t.show2Mode(),t.runGlobalTimer(t,t.trainmode?5:10)),t.is3&&t.initRemainCards(10)}},initRemainCards:function(e){var t=this;t.remainCards.active=!1;for(var i=0;i<8;i++){if(null==(a=t.remainCards.children[i])){var a=t.game.pokerpool.get();t.remainCards.addChild(a)}a.getComponent("HHCard").init(),a.active=!0}t.remainCards.getComponent(cc.Layout).spacingX=-100,setTimeout(function(){t.remainCards&&(t.remainCards.active=!0,t.remainCards.getComponent(cc.Animation).play())},e)},selCardGroup:function(e,t){this.cardgroup.active=!1,this.socket().exec("sg",{extparams:{side:t}})},play_event:function(e,a){if(e.curgame==cc.global.cur_game_code){a.isOnSummary=!1,a.summarypage&&a.summarypage.getComponent("FFASummaryDetail")&&(a.summarypage.destroy(),a.summarypage=null),a.restart(),cc.global.gamestatus="playing",a.lbl_record_status.string="";var s=[],t=0;e.cards&&(s=a.decode(e.cards),2==(t=a.hasRed(s))?(a.game.hasRP=!0,a.game.isRedTeam=!0):a.game.isRedTeam=1==t);var i=a.game.pokerpool.get(),r=a.game.pokerpool.get(),n=a.game.pokerpool.get(),o=a.game.pokerpool.get();i.parent=a.dealingpanel,r.parent=a.dealingpanel,n.parent=a.dealingpanel,o.parent=a.dealingpanel;var l=[0,-50];1==a.curTheme?l=[0,20]:2==a.curTheme&&(l=[0,-50]),i.setPosition(l[0],l[1]),i.setScale(.4,.4),r.setPosition(l[0],l[1]),r.setScale(.4,.4),n.setPosition(l[0],l[1]),n.setScale(.4,.4),o.setPosition(l[0],l[1]),o.setScale(.4,.4),a.is3&&a.initRemainCards(1e3);for(var c=0;c<a.playerboard.length;c++)a.playerboard[c].getComponent("FFAPlayerBoardRender").showCardsPanel();if(a.is2){a.show2Mode(),a.cardgroup.active=!0;var h=cc.callFunc(function(e,t){t.game&&(t.game.pokerpool.put(t.left),t.game.pokerpool.put(t.right),t.game.pokerpool.put(t.down),t.game.pokerpool.put(t.upon),t.game.pokerpool.get(),t.game.pokerpool.get(),t.game.pokerpool.get(),t.game.pokerpool.get()),t.self.runGlobalTimer(t.self,a.trainmode?5:10)},this,{game:a.game,self:a,left:i,right:r,down:n,upon:o});a.dealing1(a.game,4,a,0,i,r,n,o,s),cc.global.audio.playEffectAud("shuffle"),a.deal1_timer=setTimeout(function(){a.dealing1(a.game,4,a,1,i,r,n,o,s),a.deal2_timer=setTimeout(function(){a.dealing1(a.game,3,a,2,i,r,n,o,s,h)},250)},250)}else{h=cc.callFunc(function(e,t){if(t.game&&t.self){if(t.game.pokerpool.put(t.left),t.game.pokerpool.put(t.right),t.game.pokerpool.put(t.down),t.game.pokerpool.put(t.upon),5!=t.self.roomCondition&&12!=t.self.roomCondition||t.self.setPlayerFoldedCards(s),"no"==cc.global.amObserve){for(var i=0;i<t.self.pokercards.length;i++)t.self.pokercards[i].getComponent("HHCard").order();t.self.layoutPokerCard(),t.self.animatePokerCard()}t.self.reordering(a)}},this,{game:a.game,self:a,left:i,right:r,down:n,upon:o});5==a.roomCondition||12==a.roomCondition?a.dealingExt(h):(a.dealing(a.game,4,a,0,i,r,n,o,s),cc.global.audio.playEffectAud("shuffle"),a.deal1_timer=setTimeout(function(){a.dealing(a.game,4,a,1,i,r,n,o,s),a.deal2_timer=setTimeout(function(){6==a.roomCondition||13==a.roomCondition?a.dealing(a.game,4,a,2,i,r,n,o,s,h):a.dealing(a.game,3,a,2,i,r,n,o,s,h)},250)},250))}}},setPlayerFoldedCards:function(e){for(var t=0;t<this.playerboard.length;t++)this.playerboard[t].getComponent("FFAPlayerBoardRender").resetcards(0==t||3==t?14:15);if("no"==cc.global.amObserve)for(var i=0;i<e.length;i++){var a=this.current(this.game,this,50*i-300,e[i]);null!=a&&this.registerProxy(a)}},dealingExt:function(e){var a=this,s=[0,-50],r=[[0,140],[0,-140],[-340,70],[340,70],[340,-70],[-340,-70]];1==this.curTheme?s=[0,20]:2==this.curTheme&&(s=[0,-50]);var n=this.game.pokerpool.get();if(n){for(var t=0;t<3;t++)setTimeout(function(){for(var e=0;e<6;e++)!function(e){var t=cc.instantiate(n);t.parent=a.root(),t.setPosition(s[0],s[1]),t.setScale(.4,.4);var i=r[e%6];t.runAction(cc.moveBy(.2,i[0],i[1])),t.runAction(cc.sequence(cc.scaleTo(.2,.3,.3),cc.callFunc(function(){t.removeFromParent(),t.destroy()})))}(e)},240*t);setTimeout(function(){e&&a.node.runAction(e)},240)}else e&&this.node.runAction(e)},dealing:function(e,t,i,a,s,r,n,o,l,c){if(5==i.roomCondition||12==i.roomCondition)c&&i.node.runAction(c);else if(i.otherplayer(s,0,t,e,i,c),i.otherplayer(r,1,t,e,i,c),i.otherplayer(n,2,t,e,i,c),"yes"==cc.global.amObserve)i.otherplayer(o,3,t,e,i,c);else for(var h=null,d=0;d<t;d++){d==t-1&&(h=c);var u=i.current(e,i,300*a+50*d-300,l[4*a+d],h);null!=u&&i.registerProxy(u)}},otherplayer:function(e,t,i,a,s,r){if(s.player){var n=[0,-50];1==s.curTheme?n=[0,20]:2==s.curTheme&&(n=[0,-50]);var o={};if(0==t)o=cc.sequence(cc.spawn(cc.moveTo(.2,280,n[1]),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,n[0],n[1]),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(o);else if(1==t){var l=0;1==s.curTheme&&(l=70),o=cc.sequence(cc.spawn(cc.moveTo(.2,0,60+l),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,n[0],n[1]),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(o)}else 2==t?(o=cc.sequence(cc.spawn(cc.moveTo(.2,-280,n[1]),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,n[0],n[1]),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(o)):3==t&&(o=cc.sequence(cc.spawn(cc.moveTo(.2,0,-120),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,n[0],n[1]),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(o));if(null!=r&&"yes"==cc.global.amObserve&&(o=cc.sequence(cc.moveTo(0,0,-50),r),e.runAction(o)),null!=r&&null!=s.winPanel&&(o=cc.sequence(cc.moveTo(0,0,-50),r),e.runAction(o)),s.playerboard[t])for(var c=s.playerboard[t].getComponent("FFAPlayerBoardRender"),h=0;h<i;h++)c.countcards(1)}},dealing1:function(e,t,i,a,s,r,n,o,l,c){i.otherplayer1(s,0,t,e,i,c),i.otherplayer1(r,1,t,e,i,c),i.otherplayer1(n,2,t,e,i,c),i.otherplayer1(o,3,t,e,i,c)},otherplayer1:function(e,t,i,a,s,r){if(s.player){var n=[0,0];1==s.curTheme&&(n=[30,30]);var o={};0==t?(o=cc.sequence(cc.spawn(cc.moveTo(.2,230+n[0],-165+n[1]),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,n[0],n[1]),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(o)):1==t?(o=cc.sequence(cc.spawn(cc.moveTo(.2,230,70),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,n[0],n[1]),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(o)):2==t?(o=cc.sequence(cc.spawn(cc.moveTo(.2,-230,70),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,n[0],n[1]),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(o)):3==t&&(o=cc.sequence(cc.spawn(cc.moveTo(.2,-230-n[0],-165+n[1]),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,n[0],n[1]),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(o)),null!=r&&(o=cc.sequence(cc.moveTo(0,0,-50),r),e.runAction(o))}},show2Mode:function(){this.game.playermysql.getComponent("FFAPlayerRender").show2Mode();for(var e=0;e<this.playerboard.length;e++)this.playerboard[e].getComponent("FFAPlayerBoardRender").show2Mode()},sgr_event:function(e,t){if(e.extdata){var i=parseInt(e.extdata.side);if(e.userid==cc.global.user.id&&t.notReplay)t.game.sgr_event(i,!0);else for(var a=0;a<t.playerboard.length;a++){(s=t.playerboard[a].getComponent("FFAPlayerBoardRender")).userid&&s.userid==e.userid&&s.sgr_event(i,!0)}var s,r=null;if(e.extdata.cards&&(r=t.decode(e.extdata.cards)),t.pickingCards(r,e.userid,t),t.is3)if(t.disableRemainCardInThreeMode(!0),e.userid==cc.global.user.id&&t.notReplay)t.game.playermysql.getComponent("FFAPlayerRender").showAlarm(!0);else(s=t.getPlayer(e.userid))&&s.showAlarm(!0)}},disableRemainCardInThreeMode:function(e){for(var t=0,i=0;i<this.remainCards.children.length&&(1==this.remainCards.children[i].active&&(t++,this.remainCards.children[i].active=!1),2!=t);i++);if(e){var a=this.remainCards.getScale();this.remainCards.runAction(cc.sequence(cc.scaleTo(.2,a+.1),cc.scaleTo(.2,a)))}},pickingCards:function(e,t,i){if(null!=e){i.poker.removeAllChildren(),i.pokercards=[],14!=e.length&&4!=e.length||i.game.remakePokerPool();var a=i.hasRed(e);2==a?(i.game.hasRP=!0,i.game.isRedTeam=!0):i.game.isRedTeam=1==a}var s=cc.callFunc(function(e,t){if(t.game&&"no"==cc.global.amObserve){for(var i=0;i<t.self.pokercards.length;i++)t.self.pokercards[i].getComponent("HHCard").order();t.self.layoutPokerCard(),t.self.addTouchEvent()}},i,{game:i.game,self:i}),r=11;null!=e?r=e.length:i.is3&&(r=2),i.redealing(i.game,r,i,0,e,t,s),cc.global.audio.playEffectAud("shuffle")},redealing:function(e,t,i,a,s,r,n){if(null!=s)for(var o=0;o<t;o++){var l=i.current(e,i,300*a+50*o-300,s[4*a+o],n);null!=l&&i.registerProxy(l)}else i.reotherplayer(r,t,e,i,n)},reotherplayer:function(e,t,i,a,s){if(a.player)for(n=0;n<a.playerboard.length;n++){var r=a.playerboard[n].getComponent("FFAPlayerBoardRender");if(r.userid==e)for(var n=0;n<t;n++)r.countcards(1)}},replay_sgr_event:function(e,t){if(cc.global.gamestatus="playing",e.extdata){for(var i=parseInt(e.extdata.side),a=0;a<t.playerboard.length;a++){var s=t.playerboard[a].getComponent("FFAPlayerBoardRender");s.userid&&s.userid==e.userid&&s.sgr_event(i,!0)}var r=null;if(e.extdata.cards){r=t.decode(e.extdata.cards);var n=this.getPlayerBoard(e.userid);n.resetcards(r.length),n.setCards(r)}}t.is3&&t.disableRemainCardInThreeMode(!0)},allcards_event:function(e,t){t.gameCleaned=!1,t.hasRight=!1,t.game.hasRP=!1,e.finished=!0,t.turnCount=0,cc.global.gamestatus="waiting";var i=null;null!=e.cnt&&0<cc.global.championMode&&(t.currenRound=parseInt(e.cnt)+1);for(var a=0;a<e.players.length;a++){for(var s=e.players[a],r=0;r<t.rerenderPlayers.length;r++)t.rerenderPlayers[r].id==s.userid&&(t.rerenderPlayers[r].goldcoins=s.gold,t.rerenderPlayers[r].rank=s.rank,t.rerenderPlayers[r].exp=s.normalscore,t.rerenderPlayers[r].texp=s.texp,t.rerenderPlayers[r].explevel=s.explevel);if(s.userid==cc.global.user.id&&t.notReplay)cc.global.user.normalrank=s.normalrank,cc.global.user.goldcoins=s.gold,cc.global.user.texp=s.texp,cc.global.user.explevel=s.explevel,t.game.updateCareerAfterMatch(s),h="",2==s.win?h="Victory":0==s.win&&(h="Lost"),""!=h&&t.game.disChPos(h);else{i=s;var n=t.decode(s.cards),o=t.getPlayerBoard(s.userid);o.cleanCards();for(var l=0;l<n.length;l++)o.lasttakecards(t.game,t,n.length,n,e);var c=t.getPlayer(s.userid);c.updateCareerAfterMatch(s);var h="";2==s.win?h="Victory":0==s.win&&(h="Lost"),""!=h&&c.disChPos(h)}}if(t.showRaiseUp(e.dummy),t.isOnSummary=!0,cc.global.summaryDetailData=e,null!=i){if(t.updatepva(),t.closeOpenWin(),!t.summary||!t.summaryForSix)return;if(7==t.roomCondition?t.summarypage=cc.instantiate(t.summaryForTwo):t.summarypage=cc.instantiate(t.summary),null==t.summarypage||null==t.summarypage)return;t.summarypage.parent=t.root(),t.summarypage.getComponent("FFASummaryDetail").create(t,e,"yes"==cc.global.amObserve,t.is2)}if(t.is3){var d=t.decode(e.lasthands);for(a=0;a<t.remainCards.children.length;a++)t.remainCards.children[a].active=!1;for(a=0;a<d.length;a++){var u=t.remainCards.children[a];u&&(u.active=!0,u.getComponent("HHCard").setCard(d[a]),u.getComponent("HHCard").order())}}},rend_event:function(e,t){t.isOnSummary=!1,"no"==cc.global.amObserve&&t.socket().exec("rnr",{extparams:{roomid:cc.global.extparams.roomid}}),t.hasRight=!1},showRaiseUp:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;e<=0||null==e||null==e?this.raiseup.active=!1:(this.raiseup.runAction(cc.sequence(cc.scaleTo(.2,1.3,1.3),cc.scaleTo(.1,.9,.9),cc.scaleTo(.2,1,1))),this.raiseup.active=!0,"normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway?(this.raiseup.children[0].active=!0,this.raiseup.children[1].active=!1):"diamond"==cc.global.user.selplayway&&(this.raiseup.children[0].active=!1,this.raiseup.children[1].active=!0),this.raiseup.children[2].getComponent(cc.Label).string=this.numformat(e))},getPlayerBoard:function(e){if(this&&this.playerboard)for(var t=0;t<this.playerboard.length;t++){var i=this.playerboard[t].getComponent("FFAPlayerBoardRender");if(i.userid&&i.userid==e)return i}},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},startrecord_event:function(e,t){},getPlayer:function(e){if(this&&this.player)for(var t=0;t<this.player.length;t++){var i=this.player[t].getComponent("FFAPlayerRender");if(i.userid&&i.userid==e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},registerProxy:function(e){e&&e.getComponent("HHCard").proxy(this.game)},playcards:function(e,t,i,a){return t.current(e,t,i,a,null)},current:function(e,t,i,a,s){if(null==e||null==e)return null;if(null==e.pokerpool||null==e.pokerpool)return null;var r=e.pokerpool.get();if("no"==cc.global.amObserve){r.getComponent("HHCard").setCard(a),r.card=a,r.parent=t.poker,r.setPosition(0,200),r.setScale(1.1,1.1);var n=cc.global.theme.card_sort;if(null==n&&(n=!1),r.zIndex=1==n?a:100-a,t.pokercards.push(r),"luckyre"!=cc.global.gamestatus)if(null!=s){var o=cc.sequence(cc.moveTo(.2,i,0),s);r.runAction(o)}else{var l=cc.moveTo(.2,i,0);r.runAction(l)}else r.x=i,r.y=0}return r},reordering:function(e){if(null!=e.pokercards&&null!=e.pokercards&&"no"==cc.global.amObserve){for(var t=0;t<e.pokercards.length;t++)e.pokercards[t].parent=e.poker;e.addTouchEvent(),!e.game.isRedTeam||e.is_ptn_room||e.game.is2||e.game.is3||e.game.setRedTeam(!1,e.game.hasRP)}},newplayer:function(e,t,i,a,s){var r=this.is3?this.playerSlotPos3[a]:this.playerSlotPos[a],n=this.is3?this.playerSlotPos3[a]:this.playerSlotPos[a];this.is3&&this.game.playermysql.setPosition(this.playerSlotPos3[0]),"yes"==cc.global.amObserve&&(r=this.altplayerSlotPos[a],n=this.altplayerSlotPos[a]);var o=t.game,l=0!=a&&3!=a;if(o&&0<o.playerspool.size()){t.player[e]=o.playerspool.get(),t.player[e].parent=0<a?t.back_players:t.front_players,t.player[e].setPosition(r);var c=t.player[e].getComponent("FFAPlayerRender");c.initplayer(t,i,a,l,!0),t.is_ptn_room&&c.setTeamPartner(a%2)}if(o&&0<o.playerboardpool.size()){switch(t.playerboard[e]=o.playerboardpool.get(),t.playerboard[e].parent=t.playersboard,a){case 0:t.playerboard[e].zIndex=3;break;case 1:t.playerboard[e].zIndex=2,t.playerboard[e].scaleX=-1*t.playerboard[e].scaleX;break;case 2:t.playerboard[e].zIndex=1,t.playerboard[e].scaleX=-1*t.playerboard[e].scaleX;break;case 3:t.playerboard[e].zIndex=2}t.playerboard[e].setPosition(n),t.playerboard[e].getComponent("FFAPlayerBoardRender").initplayer(t,i,a,l,t.is2)}},newplayerExt:function(e,t,i,a){var s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],r=this.playerSlotPosExt[a],n=this.playerSlotPosExt[a];s&&(r=this.playerSlotPosExt[a],n=this.playerSlotPosExt[a]);var o=t.game,l=1==a||2==a||3==a;if(o&&0<o.playerspool.size()){t.player[e]=o.playerspool.get(),t.player[e].parent=0<a?t.back_players:t.front_players,t.player[e].setPosition(r);var c=t.player[e].getComponent("FFAPlayerRender");switch(c.initplayerExt(t,i,a,l,!0),t.is_ptn_room&&c.setTeamPartner(a%2),a){case 0:t.player[e].zIndex=3;break;case 1:t.player[e].zIndex=2;break;case 2:t.player[e].zIndex=1;break;case 3:t.player[e].zIndex=3;break;case 4:t.player[e].zIndex=1;break;case 5:t.player[e].zIndex=2}}if(o&&0<o.playerboardpool.size()){switch(t.playerboard[e]=o.playerboardpool.get(),t.playerboard[e].parent=t.playersboard,a){case 0:t.playerboard[e].zIndex=3;break;case 1:t.playerboard[e].zIndex=1;break;case 2:t.playerboard[e].zIndex=2;break;case 3:t.playerboard[e].zIndex=3;break;case 4:t.playerboard[e].zIndex=4;break;case 5:t.playerboard[e].zIndex=5}t.playerboard[e].setPosition(n),t.playerboard[e].getComponent("FFAPlayerBoardRender").initplayerExt(t,i,a,l,t.is2)}},givup:function(){this.ready()&&this.socket().exec("giveup",{})},cardtips:function(){if(this.ready()){var e=this.socket(),t={};null!=this.lasttip?t.extparams={cardtips:this.lasttip}:t.extparams={cardtips:""},e.exec("cardtips",t),this.lasttip=null}},docatch:function(e,t){this.ready()&&this.socket().exec("docatch",{extparams:{callx:t}})},doPlayCards:function(){if(this.ready()){var e=this.socket();this.game.selectedcards.splice(0,this.game.selectedcards.length);for(var t=0;t<this.pokercards.length;t++){var i=this.pokercards[t].getComponent("HHCard");1==i.selected&&(i.touched=!1,this.game.selectedcards.push(i.card))}if(this.game.selectedcards.length){var a={};a.extparams={cards:this.game.selectedcards.join(),roomid:cc.global.extparams.roomid,localturn:this.turnCount},e.exec("ffabet",a),cc.global.user.hardLiner=!1}}this.lasttip=null},noCards:function(){this.game.unselected(this,this.game),this.socket().exec("ffabet",{extparams:{roomid:cc.global.extparams.roomid,localturn:this.turnCount}}),this.lasttip=null},cleanGame:function(){for(var e=0;e<this.pokercards.length;e++){var t=this.pokercards[e];this.game.pokerpool.put(t)}for(this.pokercards.splice(0,this.pokercards.length),i=0;i<this.lastcards.length;i++)this.game.minpokerpool.put(this.lastcards[i]);this.lastcards.splice(0,this.lastcards.length);for(var i=0;i<this.player.length;i++){var a=this.playerboard[i].getComponent("FFAPlayerBoardRender");if(a){a.result&&(a.result.active=!1),a.cannot&&(a.cannot.active=!1),a.donot&&(a.donot.active=!1),a.lastcards&&(a.lastcards.active=!1),a.dizhu&&(a.dizhu.active=!1),a.hideCallStat(),a.resetcards(0);var s=this.player[i].getComponent("FFAPlayerRender");s.hideLeaveReq(),this.is_ptn_room||s.removeTeamMark()}}if(this.raiseUp(1,!0),this.cardgroup.active=!1,"no"==cc.global.amObserve&&(this.game.clean(this),this.raiseUp(1,!0)),this.dealed=!1,this.leavereq.active=!1,this.is3)for(i=0;i<this.remainCards.children.length;i++){var r=this.remainCards.children[i];null!=r&&(r.active=!1)}},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},removeGetoutPlayers:function(){var e=this;if(cc.global.summaryDetailData&&(e.deadPlayers=cc.global.summaryDetailData.players,e.deadPlayers&&e.deadPlayers))for(var t=0;t<e.deadPlayers.length;t++)for(var i=0;i<e.player.length;i++)e.player[i].getComponent("FFAPlayerRender").userdata.id==e.deadPlayers[t].userid&&e.deadPlayers[t].getout&&(e.player[i].destroy(),e.player.splice(i,1),e.playerboard[i].destroy(),e.playerboard.splice(i,1))},cleanGamePlayers:function(){for(var e=0;e<this.player.length;e++)this.player[e].destroy(),this.playerboard[e].destroy();this.player.splice(0,this.player.length),this.playerboard.splice(0,this.player.length),this.player=new Array,this.playerboard=new Array},restart:function(){var e=this.is2?2:5==this.roomCondition||12==this.roomCondition?6:4;e=6==this.roomCondition||13==this.roomCondition?3:e,this.gameCleaned||(this.gameCleaned=!0,this.cleanGame(),this.goRecovery=!1,cc.global.gamestatus="waiting",this.cleanGamePlayers(),this.game.restart(e),this.addBoardPlayers(e),"yes"==cc.global.amObserve&&this.rerenderPlayers.length<e&&(1==cc.global.championMode||2==cc.global.championMode?this.btn_enter.active=!1:0==cc.global.championMode&&this.notReplay&&(this.btn_enter.active=!0)),this.play_status=0,this.game.callRank=0,this.isOnSummary=!1)},onDestroy:function(){this.inited=!1,this.cleanmap(),cc.global.onBatteryChanged=null},addTouchEvent:function(){this.touch.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.touch.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.touch.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.touch.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.cardsArr=this.poker.getChildren()},onTouchStart:function(e){var t=e.getLocation(),i=this._beginPos=this.touch.convertToNodeSpaceAR(t);this.checkSelStartCard(i)},onTouchMove:function(e){var t=e.getLocation(),i=this.touch.convertToNodeSpaceAR(t);this.checkSelMoveCard(i)},onTouchEnd:function(e){this.checkSelEndCard()},checkSelStartCard:function(e){var t=this.cardsArr.length;this.beginCardId=-1,this.moveCardId=-1;for(var i=t-1;0<=i;i--){var a=this.cardsArr[i];if(a.getBoundingBox().contains(e))return a.getComponent("HHCard").touched=!0,void(this.beginCardId=i)}},checkSelMoveCard:function(e){for(var t=!1,i=this.cardsArr.length,a=i-1;0<=a;a--){var s=this.cardsArr[a];if(s.getBoundingBox().contains(e)){s.getComponent("HHCard").touched=!0,this.moveCardId=a,this.beginCardId=-1==this.beginCardId?a:this.beginCardId,t=!0;break}}if(-1!=this.beginCardId)for(var r=Math.min(this.beginCardId,this.moveCardId),n=Math.max(this.beginCardId,this.moveCardId),o=0;o<i;o++)this.cardsArr[o].getComponent("HHCard").touched=r<=o&&o<=n;return t},sendTouchCards:function(){for(var e=new Array,t=this.cardsArr.length,i=0;i<t;i++){var a=this.cardsArr[i].getComponent("HHCard");a.touched&&(e.push(a.card),a.doselect())}e=new Array;for(var s=0;s<this.cardsArr.length;s++){var r=this.cardsArr[s].getComponent("HHCard");r.touched&&(e.push(r.card),r.doselect())}this.beginCardId=-1,this.moveCardId=-1},checkSelEndCard:function(){for(var e=this.cardsArr.length,t=[],i=[],a=1,s=0;s<e;s++){var r=this.cardsArr[s].getComponent("HHCard");r.touched&&0==r.selected?(a=1,i.push(r.card),t.push(s)):r.touched&&1==r.selected&&(a=0,r.doselect()),r.touched=!1}if(1!=t.length)if(0!=i.length){var n=this.deck.makeEngineCardArray(i),o=this.engine.getPossibleCards(n,this.roomCondition);i=[];for(var l=0;l<o.size();l++)i.push(this.deck.getNumber(o.get(l)));this.upCardsCount=i.length,this.showSelCardsTip(i)}else 1==a&&(this.upCardsCount=0,this.game.unselected(this,this.game));else this.cardsArr[t[0]].getComponent("HHCard").doselect()},showSelCardsTip:function(s){for(var e=0;e<s.length;e++)for(var t=0;t<this.cardsArr.length;t++){var i=this.cardsArr[t].getComponent("HHCard");if(i.card==s[e]&&(i.doTipSelect(),0==function(e,t){for(var i=0,a=e;a<s.length;a++)s[a]===t&&i++;return i}(e+1,s[e])))break}},displayCardList:function(e){for(var t="cardlist : (",i=0;i<e.size();i++)t=t+e.get(i).getString()+",";t+=")"},disCardtips:function(e,t){},onclickBack:function(){this.ready()&&(this.notReplay&&(0<this.player.length||"no"==cc.global.amObserve)?this.socket().exec("leave",{}):this.exitPlay())},changeCharacter:function(){"no"==cc.global.amObserve&&this.game.disUserCharacter();for(var e=0;e<this.player.length;e++)this.player[e].getComponent("FFAPlayerRender").disUserCharacter()},onclickUnSel:function(){cc.global.tipsReady&&(cc.global.tipsReady=!1),this.upCardsCount=0,this.game.unselected(this,this.game)},showChatDialog:function(){this.onclickChat(1)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}this.chatpage.getComponent("Chat").onclickRestPart()}else e<0||(this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root(),this.chatpage.getComponent("Chat").init(this,e),this.ischat=!0)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;if(!(e<0)&&this.ready()){var t=this.socket(),i={};i.extparams={emoticon:e},t.exec("selemoticon",i),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1)}},onClickEmoticon:function(){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),this.isemoticon=!1;this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root(),this.emoticonpage.getComponent("Emoticon").init(this),this.isemoticon=!0},onclickUserlist:function(){this.socket().exec("totaluserlist",{})},disLeaveReq:function(e){this.leavereq.active=e},changeCardSortOrder:function(){for(var e=0;e<this.poker.children.length;e++)this.poker.children[e].zIndex=100-this.poker.children[e].zIndex;this.layoutPokerCard()},pokerLayout:function(e){var t=(1250/cc.global.narrowContentRatio-151-186.8)/(e.poker.children.length-1)-151;-60<t&&(t=-60),e.poker.getComponent(cc.Layout).spacingX=t},animatePokerCard:function(){var i=(1250/cc.global.narrowContentRatio-151-186.8)/(this.poker.children.length-1)-151;-60<i&&(i=-60),this.poker.getComponent(cc.Animation).play("card_dealing");this.poker.runAction(cc.sequence(cc.delayTime(.26),cc.callFunc(function(e,t){e.getComponent(cc.Animation).stop(),e.getComponent(cc.Layout).spacingX=i},this,null)));for(var e=0;e<this.poker.children.length;e++)this.poker.children[e].runAction(cc.sequence(cc.delayTime(.3+.03*e),cc.scaleTo(.08,1.15,1.15),cc.scaleTo(.08,1.1,1.1)))},layoutPokerCard:function(){for(var e=0;e<this.poker.children.length;e++)this.poker.children[e].y=0;this.layout(this.poker,function(e,t){return e.zIndex-t.zIndex}),this.pokerLayout(this)},onClickRecordPlay:function(){this.socket().exec("startrecord",{})},onClickFindEmptyRoom:function(){},initTheme1:function(e){},initTheme2:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(5<this.curBgIdx&&(this.curBgIdx=1),this.tipLabel1.active=!1,this.tipLabel2.active=!0,this.poker.setPosition(8,-240),this.poker.setScale(.7,.7),this.touch.setScale(.7,.7),this.effect.setPosition(0,-131),this.gameboardmark.setPosition(0,-40),this.game.changeTheme(2),this.raiseup.setPosition(428.1,-227.6),e)for(t=0;t<this.player.length;t++)this.player[t].getComponent("FFAPlayerRender").changeThemeExt(2),this.playerboard[t].getComponent("FFAPlayerBoardRender").changeThemeExt(2);else for(var t=0;t<this.player.length;t++)this.player[t].getComponent("FFAPlayerRender").changeTheme(2),this.playerboard[t].getComponent("FFAPlayerBoardRender").changeTheme(2);this.globaljsq.setPosition(-1,-31)},runGlobalTimer:function(e,t){e.globaljsq.active=!0;var i=a("GameTimer");e.rtgametimer=new i,e.timesrc=e.rtgametimer.runtimer(e,e.globaljsq,null,e.timer_num,e.timer_num,t)},onToggleSetting:function(){var e=this;!1===e.show_setting?(e.show_setting=!0,e.settingback.active=!0,e.settinglayer.getComponent(cc.Animation).play("setting_show"),null!=e.hideSetting&&clearTimeout(e.hideSetting),e.hideSetting=setTimeout(function(){e.onToggleSetting()},3e3)):(e.settingback.active=!1,null!=e.hideSetting&&clearTimeout(e.hideSetting),e.settinglayer.getComponent(cc.Animation).play("setting_hide"),e.show_setting=!1)},onToggleSound:function(){var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));e=!e,cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(e)),e?(this.soundbtn.children[0].active=!1,this.soundbtn.children[1].active=!0,cc.global.audio.playBGM("bgm_card"),cc.audioEngine.resumeAll()):(this.soundbtn.children[0].active=!0,this.soundbtn.children[1].active=!1,cc.audioEngine.pauseAll())},onChangeTheme:function(){var e=this;null!=e.hideSetting&&clearTimeout(e.hideSetting),e.hideSetting=setTimeout(function(){e.onToggleSetting()},3e3),e.curTheme=e.changeGameTheme(),e.changeTheme(e.curTheme,!0)},changeTheme:function(e,t){},onThemeChanged:function(e){if(cc.sys.localStorage.setItem("card_game_theme",JSON.stringify(cc.global.theme)),this.background.children[0].active=1==cc.global.theme.background,this.background.children[1].active=2==cc.global.theme.background,this.background.children[2].active=3==cc.global.theme.background,1==cc.global.theme.background||2==cc.global.theme.background?this.cardgroup.children[1].getComponent(cc.Sprite).spriteFrame=this.cardgroup.children[1].children[0].getComponent(cc.Sprite).spriteFrame=this.cardgroup.children[1].children[1].getComponent(cc.Sprite).spriteFrame=this.cardgroup.children[2].getComponent(cc.Sprite).spriteFrame=this.cardgroup.children[2].children[0].getComponent(cc.Sprite).spriteFrame=this.cardgroup.children[2].children[1].getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("poker_back"+cc.global.theme.background):this.cardgroup.children[1].getComponent(cc.Sprite).spriteFrame=this.cardgroup.children[1].children[0].getComponent(cc.Sprite).spriteFrame=this.cardgroup.children[1].children[1].getComponent(cc.Sprite).spriteFrame=this.cardgroup.children[2].getComponent(cc.Sprite).spriteFrame=this.cardgroup.children[2].children[0].getComponent(cc.Sprite).spriteFrame=this.cardgroup.children[2].children[1].getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas2.getSpriteFrame("poker_back3"),this.poker){for(var t=0;t<this.poker.children.length;t++)this.poker.children[t]&&this.poker.children[t].emit("theme-changed");if(1==cc.global.theme.card_size?this.poker.y=-248:this.poker.y=-226,this.game&&this.game.node.emit("theme-changed"),this.player)for(t=0;t<this.player.length;t++)this.player[t].emit("theme-changed");if(this.playerboard)for(t=0;t<this.playerboard.length;t++)this.playerboard[t].emit("theme-changed");this.pokerLayout(this)}},onClickThemeSetting:function(){var i=this;this.closeOpenWin(),cc.loader.loadRes("prefab/main/ThemeSelectDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("ThemeSelectDialog").init(i),cc.global.openwin.parent=i.root())})}}),cc._RF.pop()},{Deck:"Deck",FFASelCardsEngine:"FFASelCardsEngine",GameTimer:"GameTimer",HHCommon:"HHCommon"}],FFACardAnalyzer:[function(e,t,i){"use strict";cc._RF.push(t,"7ae9cnRSd5PEbF+QSarRSzU","FFACardAnalyzer"),t.exports=function(){this.numOfIndex=[15];for(var e=0;e<13;e++)this.numOfIndex[e]=4;this.numOfIndex[13]=1,this.numOfIndex[14]=1,this.update=function(e){for(var t=0;t<e.size();t++){var i=e.get(t).rank-3;this.numOfIndex[i]--}},this.checkNoBomb=function(){if(this.numOfIndex[13]+this.numOfIndex[14]==2)return!1;for(var e=0;e<13;e++)if(4==this.numOfIndex[e])return!1;return!0},this.checkExistRocket=function(){return 2==this.numOfIndex[13]+this.numOfIndex[14]},this.verifyForSupreme=function(e){var t=e.get(0).rank-3,i=e.size();if(4==i&&this.numOfIndex[13]+this.numOfIndex[14]==2)return!1;for(var a=t+1;a<15;a++)if(this.numOfIndex[a]>=i)return!1;return!0},this.verifyForStrongSupreme=function(e){var t=e.get(0).rank-3,i=e.size();if(4==i&&this.numOfIndex[13]+this.numOfIndex[14]==2)return!1;for(var a=t;a<15;a++)if(this.numOfIndex[a]>=i)return!1;return!0},this.display=function(){for(var e="analyzer:",t=0;t<15;t++)e=e+this.numOfIndex[t]+",";return e}},cc._RF.pop()},{}],FFADataBind:[function(n,e,t){"use strict";cc._RF.push(e,"612ceNf+AJHHa4QMPPtdKKZ","FFADataBind");var a=n("HHCommon");cc.Class({extends:a,properties:{player:{default:null,type:cc.Prefab},playerboard:{default:null,type:cc.Prefab},poker:{default:null,type:cc.Prefab},poker_min:{default:null,type:cc.Prefab},myself:{default:null,type:cc.Prefab},catchbtn:{default:null,type:cc.Node},timer:{default:null,type:cc.Node},timer_num:{default:null,type:cc.Label},lastcards:{default:null,type:cc.Node},playbtn:{default:null,type:cc.Node},notallow:{default:null,type:cc.Node},operesult:{default:null,type:cc.Node},donottake:{default:null,type:cc.Node},cardtipmsg:{default:null,type:cc.Node},timerplaynum:{default:null,type:cc.Label},callx2btn:{default:null,type:cc.Node},callx4btn:{default:null,type:cc.Node},callx8btn:{default:null,type:cc.Node},callx16btn:{default:null,type:cc.Node},redpig:{default:null,type:cc.Node},board_rank:{default:null,type:cc.Node},playclock:{default:null,type:cc.Node},playermysql:{default:null,type:cc.Node}},onLoad:function(){for(this.hasRP=!1,this.isRedTeam=!1,this.callRank=0,this.timer&&(this.timer.active=!1),this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1,this.callx16btn.active=!1,this.redpig.active=!1),this.playbtn&&(this.playbtn.active=!1),this.notallow&&(this.notallow.active=!1),this.operesult&&(this.operesult.active=!1),this.cardtipmsg&&(this.cardtipmsg.active=!1),(this.dizhu_databind_context=this).playerspool=new cc.NodePool,this.playerboardpool=new cc.NodePool,this.pokerpool=new cc.NodePool,this.minpokerpool=new cc.NodePool,this.selectedcards=new Array,this.cardslist=new Array,i=0;i<6;i++)this.playerspool.put(cc.instantiate(this.player)),this.playerboardpool.put(cc.instantiate(this.playerboard));for(i=0;i<27;i++)this.pokerpool.put(cc.instantiate(this.poker));for(i=0;i<60;i++)this.minpokerpool.put(cc.instantiate(this.poker));this.ready()&&(this.pva_format(cc.global.user.goldcoins,cc.global.user.cards,0,cc.global.user.championexp,this),this.pvalistener(this,function(e){e.pva_format(cc.global.user.goldcoins,cc.global.user.cards,0,cc.global.user.championexp,e)})),this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged()},addSelfPlayer:function(e,t,i){if(null!=cc.global){this.playermysql.active=!0;var a=this.playermysql.getComponent("FFAPlayerRender");this.playermysql.setPosition(-553/cc.global.narrowContentRatio,-79.4),a.initplayer(e,t,0,!1,!1,i),e.is_ptn_room&&a.setTeamPartner(0)}},giveContext:function(e){this.playermysql.getComponent("FFAPlayerRender").giveContext(e)},changeStageInfo:function(e){this.playermysql.getComponent("FFAPlayerRender").changeStageInfo(e)},showRoomNumber:function(e){this.playermysql.getComponent("FFAPlayerRender").showRoomNumber(e)},updateCareerAfterMatch:function(e){this.playermysql.getComponent("FFAPlayerRender").updateCareerAfterMatch(e)},setRedTeam:function(e,t){this.playermysql.getComponent("FFAPlayerRender").setRedTeam(e,t)},showRobot:function(e){this.playermysql.getComponent("FFAPlayerRender").showRobot(e)},setBoardRank:function(){for(var e=0;e<this.board_rank.children.length;e++)this.board_rank.children[e].active=!1;0<this.callRank&&(this.board_rank.children[this.callRank-1].active=!0)},hideBoardRank:function(){for(var e=0;e<this.board_rank.children.length;e++)this.board_rank.children[e].active=!1},pva_format:function(e,t,i,a,s){},catchtimer:function(e,t){if(this.playbtn&&(this.playbtn.active=!1),this.catchbtn)if(this.catchbtn.active=!0,this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1,this.callx16btn.active=!1,this.redpig.active=!1,cc.global.dizhubegin.is_ptn_room){switch(parseInt(t)){case 1:this.callx2btn.active=!0;break;case 2:this.callx4btn.active=!0;break;case 4:this.callx8btn.active=!0;break;case 8:this.callx16btn.active=!0}for(var i=0;i<cc.global.dizhubegin.playerboard.length;i++){var a=cc.global.dizhubegin.playerboard[i].getComponent("FFAPlayerBoardRender");if(2==a.seatid&&1==a.catchcall){this.callx4btn.active=!1;break}}}else if(cc.global.dizhubegin.is2)switch(parseInt(t)){case 1:this.callx2btn.active=!0;break;case 2:this.callx4btn.active=!0}else if(this.hasRP&&!cc.global.dizhubegin.is3)this.redpig.active=!0,cc.global.dizhubegin.banker_id&&cc.global.dizhubegin.banker_id==cc.global.user.id&&(this.redpig.active=!1);else switch(parseInt(t)){case 1:this.callx2btn.active=!0;break;case 2:this.callx4btn.active=!0;break;case 4:this.callx8btn.active=!0;break;case 8:this.callx16btn.active=!0}this.operesult&&(this.operesult.active=!1),this.timer&&(this.timer.active=!0);var s=n("GameTimer");this.rtgametimer=new s,this.timesrc=this.rtgametimer.runtimer(this,this.timer_num.node.parent,this.atlas,this.timer_num,this.timer_num,e)},showBanker:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(this.operesult){this.operesult.active=!0;for(var t=0;t<this.operesult.children.length;t++)this.operesult.children[t].active=!1;this.operesult.children[0].active=e,this.playermysql.getComponent("FFAPlayerRender").dizhu.active=!0}},showRecoveryCatchResult:function(e){this.operesult.active=!0;for(var t=0;t<this.operesult.children.length;t++)this.operesult.children[t].active=!1;switch(e){case 1:this.operesult.children[1].active=!0;break;case 2:this.operesult.children[2].active=!0;break;case 4:this.operesult.children[3].active=!0;break;case 8:this.operesult.children[4].active=!0;break;case 16:this.operesult.children[5].active=!0;break;case 32:this.operesult.children[6].active=!0}},catchresult:function(e){this.timer&&(this.timer.active=!1),this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1,this.callx16btn.active=!1,this.redpig.active=!1),this.playbtn&&(this.playbtn.active=!1),this.timesrc&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc),this.showCatchResult(e),this.playermysql.getComponent("FFAPlayerRender").showCallStat(e.myratio)},showCallStat:function(e){this.playermysql.getComponent("FFAPlayerRender").showCallStat(e)},hideresult:function(){this.operesult&&(this.operesult.active=!1)},lasthands:function(){this.hideBanker(),this.operesult&&(this.operesult.active=!1)},hideBanker:function(){this.playermysql.getComponent("FFAPlayerRender").hideBanker()},hideResultPlayBtn:function(){this.result&&(this.result.active=!1),this.playbtn&&(this.playbtn.active=!1)},lasttakecards:function(e,t,i,a){this.hideResultPlayBtn(),this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1,this.callx16btn.active=!1,this.redpig.active=!1),this.jsq&&(this.jsq.active=!1),this.lastcards&&(this.lastcards.active=!0),this.timesrc&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc);for(var s=0;s<this.cardslist.length;s++)this.pokerpool.put(this.cardslist[s]);if(this.cardslist.splice(0,this.cardslist.length),null!=a)for(s=0;s<a.length;s++)this.playcards(t,s,a[s],a);else this.showPassLastTakes();this.repositionLastCards()},showKickPopBalloon:function(e){this.playermysql.getComponent("FFAPlayerRender").showKickPopBalloon(e)},cardtips:function(e,t,i){for(var a=[].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(i)),s=0;s<e.pokercards.length;s++){var r=e.pokercards[s].getComponent("HHCard");if(r&&r.card==t&&!r.selected)for(var n=0;n<a.length;n++)if(a[n]==r.card){a.splice(n,1),r.doselect();break}}},cardtipsfornot:function(e,t){t.cardtipmsg.active=!0,setTimeout(function(){t.cardtipmsg.active=!1},1e3),t.unselected(e,t)},unselected:function(e,t){for(var i=0;i<e.pokercards.length;i++){var a=e.pokercards[i];if(a){var s=a.getComponent("HHCard");s&&s.unselected()}}},playcards:function(e,t,i,a){for(var s,r=0;r<e.pokercards.length;r++){var n=e.pokercards[r];if(n.card==i){s=n,e.pokercards.splice(r,1);break}}if(null!=s){for(i=0;i<s.children.length;i++)s.children[i].stopAllActions(),s.children[i].y=0;s.touched=!1,s.x=24*t,s.y=0,s.parent=this.lastcards,this.countcard(i,a),s.zIndex=t,this.cardslist.push(s)}},countcard:function(e,t){for(var i=parseInt(e/4),a=0,s=0;s<t.length;s++)i==parseInt(t[s]/4)&&(a+=1);return a},stopTimer:function(){this.rtgametimer.stoptimer(this,this.timer,this.timesrc)},playtimer:function(e,t,i){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;this.timesrc&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc),this.timer&&(this.timer.active=!0),this.playbtn&&(this.playbtn.active=!0,this.playbtn.children[2].active=!1,this.playbtn.children[3].active=!1,this.playbtn.children[4].active=!1,this.playbtn.children[5].active=!1),0==a?(this.playbtn.children[2].active=!0,this.playbtn.children[3].active=!0):1==a?this.playbtn.children[4].active=!0:2==a&&(this.playbtn.children[5].active=!0),this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.redpig.active=!1),this.lastcards&&(this.lastcards.active=!1),this.operesult&&(this.operesult.active=!1),1==i?this.donottake.active=!1:(this.donottake.active=!0,0==a?(this.donottake.children[0].active=!0,this.donottake.children[1].active=!1):1<=a&&(this.donottake.children[0].active=!1,this.donottake.children[1].active=!0)),4==a&&(this.playbtn.active=!0,this.playbtn.children[0].active=!1,this.playbtn.children[1].active=!0,this.playbtn.children[2].active=!1,this.playbtn.children[3].active=!1,this.playbtn.children[4].active=!1,this.playbtn.children[5].active=!1,this.playbtn.children[6].active=!0,this.catchbtn.active=!1,this.donottake.active=!1);for(var s=0;s<this.cardslist.length;s++)e.pokerpool.put(this.cardslist[s]);var r=n("GameTimer");this.rtgametimer=new r,this.timesrc=this.rtgametimer.runtimer(this,this.timerplaynum.node.parent,this.atlas,this.timerplaynum,this.timerplaynum,t),this.canTouch=!0},showCatchResult:function(e){this.operesult.active=!0;for(var t=0;t<this.operesult.children.length;t++)this.operesult.children[t].active=!1;switch(e.myratio){case 0:this.operesult.children[1].active=!0;break;case 1:this.operesult.children[2].active=!0;break;case 2:this.operesult.children[3].active=!0;break;case 3:this.operesult.children[4].active=!0;break;case 4:this.operesult.children[5].active=!0;break;case 5:this.operesult.children[6].active=!0}},showPassLastTakes:function(){this.operesult.active=!0;for(var e=0;e<this.operesult.children.length;e++)this.operesult.children[e].active=!1;this.operesult.children[1].active=!0},doSelectCard:function(e){null==this.selectedcards.find(function(e){e.card})&&this.selectedcards.push(e)},doUnSelectCard:function(e){var t=this.selectedcards.indexOf(e);0<=t&&this.selectedcards.splice(t,1)},clean:function(e){if(this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.redpig.active=!1),this.lastcards&&(this.lastcards.active=!1),this.operesult&&(this.operesult.active=!1),this.hideBoardRank(),"no"==cc.global.amObserve&&this.playermysql){var t=this.playermysql.getComponent("FFAPlayerRender");t&&(t.hideCallStat(),t.clean(e),t.parent.is_ptn_room||t.removeTeamMark())}},cleanCards:function(e){for(var t=0;t<this.cardslist.length;t++)this.pokerpool.put(this.cardslist[t]);this.cardslist.splice(0,this.cardslist.length),this.lastcards&&(this.lastcards.active=!1),this.operesult&&(this.operesult.active=!1)},restart:function(e){this.hideBoardRank(),this.playerspool.clear(),this.playerboardpool.clear();for(var t=0;t<e;t++)this.playerspool.put(cc.instantiate(this.player)),this.playerboardpool.put(cc.instantiate(this.playerboard));for(this.minpokerpool.clear(),i=0;i<60;i++)this.minpokerpool.put(cc.instantiate(this.poker));this.pokerpool.clear();for(var i=0;i<25;i++)this.pokerpool.put(cc.instantiate(this.poker))},remakePokerPool:function(){this.pokerpool.clear();for(var e=0;e<25;e++)this.pokerpool.put(cc.instantiate(this.poker))},disChPos:function(e){this.playermysql.getComponent("FFAPlayerRender").disChPos(e)},disChSitPos:function(e){this.playermysql.getComponent("FFAPlayerRender").disChSitPos()},disChEffectPos:function(){this.playermysql.getComponent("FFAPlayerRender").disChEffectPos()},disUserCharacter:function(){this.playermysql.getComponent("FFAPlayerRender").disUserCharacter()},showEmoticon:function(e){this.playermysql&&this.playermysql.getComponent("FFAPlayerRender")&&this.playermysql.getComponent("FFAPlayerRender").showEmoticon(e)},showCallPlayer:function(e,t){this.playermysql&&this.playermysql.getComponent("FFAPlayerRender")&&this.playermysql.getComponent("FFAPlayerRender").showCallPlayer(e,t)},onClickEmoticon:function(){this.playermysql&&this.playermysql.getComponent("FFAPlayerRender")&&this.playermysql.getComponent("FFAPlayerRender").onClickEmoticon()},speech:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";if(this.playermysql){var t=this.playermysql.getComponent("FFAPlayerRender");t&&t.speech(e)}},changeTheme:function(e){if(this.curTheme=e,this.playermysql){var t=this.playermysql.getComponent("FFAPlayerRender");t&&t.changeTheme(e,!0)}this.initTheme1(),this.repositionLastCards()},initTheme1:function(){},initTheme2:function(){},repositionLastCards:function(){if(this.lastcards&&0!=this.lastcards.children.length)if(2==this.curTheme)this.lastcards.width=24*(this.lastcards.children.length-1)+109;else if(1==this.curTheme){var e=6<=this.lastcards.children.length?6:this.lastcards.children.length;this.lastcards.width=24*(e-1)+109}this.lastcards&&this.lastcards.getComponent(cc.Animation)&&(this.lastcards.stopAllActions(),this.lastcards.getComponent(cc.Animation).play(),this.lastcards.x=-383,this.lastcards.runAction(cc.moveBy(.2,30,0).easing(cc.easeIn(.2))))},sgr_event:function(e,t){var i=this.playermysql.getComponent("FFAPlayerRender");if(0==e||1==e)if(t)switch(e){case 0:i.mode2left.active=!1;break;case 1:i.mode2right.active=!1}else switch(e){case 0:i.mode2right.active=!1;break;case 1:i.mode2left.active=!1}else 2==e&&(i.mode2left.active=!1,i.mode2right.active=!1)},onThemeChanged:function(e){1==cc.global.theme.card_size?this.timer.y=-35:this.timer.y=10;for(var t=0;t<this.lastcards.children.length;t++)this.lastcards.children[t]&&this.lastcards.children[t].emit("theme-changed");this.playermysql&&this.playermysql.emit("theme-changed")}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],FFAPlayerBoardRender:[function(s,e,t){"use strict";cc._RF.push(e,"dd8163YcmNHeLPvvFi1N12x","FFAPlayerBoardRender");var i=s("HHCommon");cc.Class({extends:i,properties:{dizhu:{default:null,type:cc.Node},callstat:{default:null,type:cc.Node},pokertag:{default:null,type:cc.Node},pokercards:{default:null,type:cc.Label},timer:{default:null,type:cc.Node},jsq:{default:null,type:cc.Node},amready:{default:null,type:cc.Node},catchplayresult:{default:null,type:cc.Node},timer_num:{default:null,type:cc.Label},result:{default:null,type:cc.Node},lastcards:{default:null,type:cc.Node},cannot:{default:null,type:cc.Node},donot:{default:null,type:cc.Node},resultx2:{default:null,type:cc.Node},resultx4:{default:null,type:cc.Node},resultx6:{default:null,type:cc.Node},resultx8:{default:null,type:cc.Node},resultx16:{default:null,type:cc.Node},effect:{default:null,type:cc.Node},cardbg:{default:null,type:cc.Prefab},cardspanel:{default:null,type:cc.Node},cardsreplay:{default:null,type:cc.Node},quality:!0,lt:{default:null,type:cc.Node},catchcall:0,mode2left:{default:null,type:cc.Node},mode2right:{default:null,type:cc.Node},extMode:!1},onLoad:function(){this.cardcount=0,this.cardslist=new Array,this.isRight=!1,this.remaincards=new Array,this.isFirstTheme=!0,this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged()},initplayer:function(e,t,i,a,s){if(this.parent=e,this.curTheme=e.curTheme,this.userdata=t,this.userid=t.id,this.isRight=a){this.timer.scaleX=-1*this.timer.scaleX,this.jsq.x=this.jsq.x+73,this.amready.scaleX=-1*this.amready.scaleX,this.callstat.scaleX=-1*this.callstat.scaleX,this.cardspanel.children[1].scaleX=-1*this.cardspanel.children[1].scaleX,this.lastcards.anchorX=1,this.lastcards.x=77,this.effect.scaleX=-1*this.effect.scaleX;for(var r=0;r<this.effect.children.length;r++)this.effect.children[r].x=-1*this.effect.children[r].x;this.catchplayresult.scaleX=-1*this.catchplayresult.scaleX;for(r=0;r<this.catchplayresult.children.length;r++)this.catchplayresult.children[r].anchorX=1,this.catchplayresult.children[r].children[0].x=-1*this.catchplayresult.children[r].children[0].x;this.oriposx=this.lastcards.x,this.cardsreplay.getComponent(cc.Layout).horizontalDirection=cc.Layout.HorizontalDirection.RIGHT_TO_LEFT}if(this.seatid=i,s&&0==i){var n=this.mode2left.x;this.mode2left.x=this.mode2right.x,this.mode2right.x=n}this.jsq&&(this.jsq.active=!1),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.changeTheme(this.curTheme)},updateCareerAfterMatch:function(e){this.userdata.goldcoins=e.gold,this.goldcoins.string=this.numformat(e.gold+e.diamond),this.userdata.nickname.indexOf("Com")<0&&(this.userdata.record.matchcount=e.totalmatches,this.userdata.record.win=e.winmatches,this.userdata.record.loss=e.lossmatches,this.userdata.record.draw=e.drawmatches,this.userdata.record.normalrank=e.normalrank,this.userlevel.string=this.numformat(e.normalrank)+"th")},countcards:function(e){this.cardcount=this.cardcount+e,this.resetcards(this.cardcount)},setCards:function(e){if(!this.parent.notReplay)for(var t=0;t<e.length;t++)if(null!=this.cardsreplay.children[t]){var i=this.cardsreplay.children[t].getComponent("HHCard");i.setCard(e[t]),i.order()}},resetcards:function(e){if(this.parent.notReplay)this.cardsreplay.active=!1;else if(this.cardsreplay.active=!0,this.cardspanel.active=!1,this.cardsreplay.removeAllChildren(),this.isRight)for(var t=0;t<e;t++){var i=cc.instantiate(this.cardbg);i.parent=this.cardsreplay,i.scaleX=-i.scaleX}else for(t=0;t<e;t++){cc.instantiate(this.cardbg).parent=this.cardsreplay}this.cardspanel.active=!0,0==e?(this.cardspanel.children[0].active=!1,this.cardspanel.children[1].active=!1,this.cardspanel.children[2].active=!1):(this.cardspanel.children[0].active=!0,this.cardspanel.children[1].active=!0,this.cardspanel.children[2].active=!1,this.cardcount=e,this.cardspanel.children[1].getComponent(cc.Label).string=this.cardcount,3<=e?(this.cardspanel.children[0].children[0].active=!0,this.cardspanel.children[0].children[1].active=!0):2==e?(this.cardspanel.children[0].children[0].active=!0,this.cardspanel.children[0].children[1].active=!1):1==e&&(this.cardspanel.children[0].children[0].active=!1,this.cardspanel.children[0].children[1].active=!1))},onClickCardLock:function(){},cleanCards:function(){this.cardspanel.active=!1,this.cardsreplay.active=!1},cleanLastCards:function(e){if(0<this.cardslist.length){for(var t=0;t<this.cardslist.length;t++)e.minpokerpool.put(this.cardslist[t]);this.cardslist.splice(0,this.cardslist.length)}this.lastcards&&(this.lastcards.active=!1),this.kick&&(this.kick.active=!1),this.pop&&(this.pop.active=!1),this.donot&&(this.donot.active=!1),this.cannot&&(this.cannot.active=!1)},showCardsPanel:function(){this.parent.notReplay?(this.cardsreplay.active=!1,this.cardspanel.active=!0):(this.cardsreplay.active=!0,this.cardspanel.active=!1)},catchtimer:function(e){this.jsq&&(this.jsq.active=!0),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1);var t=s("GameTimer");this.rtgametimer=new t,this.timesrc=this.rtgametimer.runtimer(this,this.jsq,this.atlas,this.timer_num,this.timer_num,e)},showBanker:function(){!(0<arguments.length&&void 0!==arguments[0])||arguments[0]},showCallStat:function(e){switch(parseInt(e)){case 1:this.callstat.children[0].active=!0;break;case 2:this.callstat.children[1].active=!0;break;case 3:this.callstat.children[2].active=!0;break;case 4:this.callstat.children[3].active=!0;break;case 5:this.callstat.children[4].active=!0}},hideCallStat:function(){this.callstat.children[0].active=!1,this.callstat.children[1].active=!1,this.callstat.children[2].active=!1,this.callstat.children[3].active=!1,this.callstat.children[4].active=!1},pauseTimer:function(){this.rtgametimer&&this.rtgametimer.pauseTimer(this,this.jsq,this.timesrc)},resumeTimer:function(){this.rtgametimer&&(this.timesrc=this.rtgametimer.resumeTimer(this,this.jsq,this.timer_num))},stopTimer:function(){this.rtgametimer&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc)},catchresult:function(e,t){if(this.rtgametimer)if(this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),0<e.myratio){switch(this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),parseInt(e.myratio)){case 0:this.cannot&&(this.cannot.active=!0),this.catchcall=0;break;case 1:this.resultx2&&(this.resultx2.active=!0,this.showEffect(0)),this.catchcall=1;break;case 2:this.resultx4&&(this.resultx4.active=!0,this.showEffect(1)),this.catchcall=5;break;case 3:this.resultx8&&(this.resultx8.active=!0,this.showEffect(1)),this.catchcall=3;break;case 4:this.resultx16&&(this.resultx16.active=!0,this.showEffect(1)),this.catchcall=4;break;case 5:this.resultx6.active=!0,this.showEffect(2),this.catchcall=3}this.showCallStat(e.myratio)}else this.result&&(this.result.active=!1),this.cannot&&!t&&(this.cannot.active=!0),this.donot&&(this.donot.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.catchcall=0,this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1)},hideresult:function(){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1)},lasthands:function(e,t,i){this.hideresult(),this.rtgametimer&&this.timesrc&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),this.userid==i.userid&&this.playtimer(t,i.timer),this.hideBanker()},hideBanker:function(){},setRedTeam:function(e){},removeTeamMark:function(){},lasttakecards:function(e,t,i,a,s){var r=this.parent.notReplay;if(this.rtgametimer&&this.timesrc&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.jsq&&(this.jsq.active=!1),this.lastcards&&(this.lastcards.active=!0),0<this.cardslist.length){for(n=0;n<this.cardslist.length;n++)e.minpokerpool.put(this.cardslist[n]);this.cardslist.splice(0,this.cardslist.length)}if(r?this.resetcards(i):(this.boardRemainCards=[],s&&""!=s.playercards&&null!=s.playercards?(this.boardRemainCards=this.decode(s.playercards),this.resetcards(this.boardRemainCards.length,this.boardRemainCards),this.setCards(this.boardRemainCards)):this.resetcards(0)),null!=a)for(var n=0;n<a.length;n++)this.playcards(e,n,a[n],a);else this.tipdonot();this.extMode?this.repositionLastCardsExt():this.repositionLastCards()},tipcannot:function(){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!0),this.donot&&(this.donot.active=!1)},tipdonot:function(){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!0)},playcards:function(e,t,i,a){var s=e.minpokerpool.get();s.parent=this.lastcards,this.cardslist.push(s);var r=s.getComponent("HHCard");r.setCard(i),r.order()},countcard:function(e,t){return parseInt(e/4)},playtimer:function(e,t){this.stopTimer(),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.lastcards&&(this.lastcards.active=!1);for(var i=0;i<this.cardslist.length;i++)e&&e.minpokerpool&&e.minpokerpool.put(this.cardslist[i]);var a=s("GameTimer");this.rtgametimer=new a,this.timesrc=this.rtgametimer.runtimer(this,this.jsq,this.atlas,this.timer_num,this.timer_num,t)},clean:function(e){for(var t=this.catchcall=0;t<this.cardslist.length;t++)e.minpokerpool.put(this.cardslist[t]);this.jsq&&(this.jsq.active=!1),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.cardcount=0},giveContext:function(e){this.dizhucontxt=e},changeStageInfo:function(e){var t=this.getLanguageText("BOARD_SCORE"),i=": "+e,a=this.getLanguageText("ROOM_0");this.box_stageinfo.string=t+i+a},showRoomNumber:function(e){var t=this.getLanguageText("ROOM_0");this.box_roominfo.string=e+t},hideEffect:function(e){var t=this;setTimeout(function(){t.effect&&(t.effect.children[e].active=!1)},1500)},showEffect:function(e){this.effect.children[e].active=!0;var t=this.effect.children[e].getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"tongqian",!1),cc.global.audio.playEffectAud("call"),this.hideEffect(e)},display:function(e){for(var t=": [",i=0;i<e.length;i++)t=t+e[i]+" , ";t+="]"},changeThemeExt:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;switch(this.curTheme=e){case 1:this.initTheme1Ext();break;case 2:this.initTheme2Ext()}},changeTheme:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;this.curTheme=e,this.initTheme1()},initTheme1:function(){this.cardspanel&&(this.seatid,this.repositionLastCards())},initTheme1Ext:function(){},initTheme2:function(){if(this.cardspanel){switch(this.lastcards.width=300,this.cardspanel.setScale(1.3,1.3),2!=this.seatid&&(this.cardspanel.skewX=-32,this.cardspanel.rotation=122),this.lastcards.setScale(.8,.8),this.seatid){case 1:this.node.setPosition(380,50),this.callstat.setPosition(-109,32);break;case 2:this.node.setPosition(-110,95),this.callstat.setPosition(-104,127);break;case 3:this.node.setPosition(-380,50),this.callstat.setPosition(-109,32);break;default:0==this.seatid&&"yes"==cc.global.amObserve&&(this.node.setPosition(-110,-150),this.cardspanel.skewX=0,this.cardspanel.rotation=90,this.callstat.setPosition(-189,67))}this.repositionLastCards()}},initTheme2Ext:function(){},repositionLastCards:function(){if(this.lastcards){for(var e=[],t=0;t<this.lastcards.children.length;t++)this.lastcards.children[t].getComponent("HHCard")&&e.push(1);this.lastcards.stopAllActions(),this.lastcards.getComponent(cc.Animation).play(),this.isRight?(this.lastcards.x=97,this.lastcards.runAction(cc.moveBy(.2,-20,0).easing(cc.easeIn(.2)))):(this.lastcards.x=-97,this.lastcards.runAction(cc.moveBy(.2,20,0).easing(cc.easeIn(.2))))}},repositionLastCardsExt:function(){},show2Mode:function(){this.mode2left.active=!0,this.mode2right.active=!0},sgr_event:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(0==e||1==e)switch(e){case 0:t?this.mode2left.active=!1:this.mode2right.active=!1;break;case 1:t?this.mode2right.active=!1:this.mode2left.active=!1}else 2==e&&(this.mode2left.active=!1,this.mode2right.active=!1)},onThemeChanged:function(){1==cc.global.theme.background||2==cc.global.theme.background?(this.cardspanel&&(this.cardspanel.children[0].getComponent(cc.Sprite).spriteFrame=this.cardspanel.children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.cardspanel.children[0].children[1].getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("left_cards_back"+cc.global.theme.background)),this.mode2left.getComponent(cc.Sprite).spriteFrame=this.mode2right.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("left_cards_back"+cc.global.theme.background)):(this.cardspanel&&(this.cardspanel.children[0].getComponent(cc.Sprite).spriteFrame=this.cardspanel.children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.cardspanel.children[0].children[1].getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas2.getSpriteFrame("left_cards_back3")),this.mode2left.getComponent(cc.Sprite).spriteFrame=this.mode2right.getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas2.getSpriteFrame("left_cards_back3")),1==cc.global.theme.card_size?(this.lastcards.getComponent(cc.Layout).spacingX=-80,this.cardspanel.scaleX=this.cardspanel.scaleY=1,this.cardspanel.x=-4,this.cardspanel.y=-4.3,this.lastcards.y=-69.4):(this.lastcards.getComponent(cc.Layout).spacingX=-60,this.cardspanel.scaleX=this.cardspanel.scaleY=1.5,this.cardspanel.x=3.4,this.cardspanel.y=11.3,this.lastcards.y=-54.5);for(var e=0;e<this.lastcards.children.length;e++)this.lastcards.children[e]&&this.lastcards.children[e].emit("theme-changed")}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],FFAPlayerRender:[function(i,e,t){"use strict";cc._RF.push(e,"91db48dF9hEL7tMISzaP/a7","FFAPlayerRender");var a=i("HHCommon");cc.Class({extends:a,properties:{username:{default:null,type:cc.Label},goldcoins:{default:null,type:cc.Label},goldcoins1:{default:null,type:cc.Label},freeicon:{default:null,type:cc.Node},dizhu:{default:null,type:cc.Node},callstat:{default:null,type:cc.Node},avatar:{default:null,type:cc.Sprite},btncharacter:{default:null,type:cc.Node},avatar_outline:{default:null,type:cc.Node},info_outline:{default:null,type:cc.Node},userinfonode:{default:null,type:cc.Node},userinfo:{default:null,type:cc.Prefab},character:{default:null,type:cc.Prefab},userinfopan:{default:null,type:cc.Node},userbaseinfo:{default:null,type:cc.Node},leave:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},kickpopbubble:{default:null,type:cc.Node},redteammark:{default:null,type:cc.Node},mode2left:{default:null,type:cc.Node},mode2right:{default:null,type:cc.Node},catchcall:0,seatidlbl:{default:null,type:cc.Label},robot:{default:null,type:cc.Node},alarm:{default:null,type:cc.Node}},onLoad:function(){this.isRight=!1,this.isFirstTheme=!0,this.isOpenRed=!1,this.showRobot(!1),this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged()},showRobot:function(e){this.robot&&(this.robot.active=!1)},initplayerExt:function(e,t,i,a){},initplayer:function(e,t,i,a,s){this.parent=e,this.curTheme=e.curTheme,this.seatidx=i,this.userdata=t,cc.global.user.id,t.id,this.username.string=t.nickname,this.userid=t.id,this.playcharacter=t.playcharacter,this.avatarurl=t.avatarurl,this.seatid=i,this.loadAvatar(t.avatarurl,t.gender),this.isRight=1==i||2==i,this.isRight?(this.userinfopan.x=-1*this.userinfopan.x,this.btncharacter.x=-1*this.btncharacter.x,this.callplayer.x=-1*this.callplayer.x,this.callplayer.scaleX=-1*this.callplayer.scaleX,this.callplayer.children[0].scaleX=-1*this.callplayer.children[0].scaleX,this.callplayer.children[0].anchorX=1,this.callplayer.children[1].anchorX=1,this.kickpopbubble.x=-1*this.kickpopbubble.x,this.kickpopbubble.scaleX=-1*this.kickpopbubble.scaleX,this.kickpopbubble.children[0].scaleX=-1*this.kickpopbubble.children[0].scaleX,this.kickpopbubble.children[1].scaleX=-1*this.kickpopbubble.children[1].scaleX,this.emoticon.x=-1*this.emoticon.x,this.userinfonode.x=-1*this.userinfonode.x,this.redteammark.x=-1*this.redteammark.x):(this.userid,cc.global.user.id),1==i||3==i||2==i||0==i&&cc.global.amObserve,3!=this.playcharacter&&this.playcharacter,this.dizhu&&(this.dizhu.active=!1),this.jsq&&(this.jsq.active=!1),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(t.goldcoins))),this.goldcoins1&&(this.goldcoins1.string=this.numformat(parseInt(t.goldcoins))),this.changeTheme(this.curTheme)},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins))),this.goldcoins1&&(this.goldcoins1.string=this.numformat(parseInt(this.userdata.goldcoins)))},updateCareerAfterMatch:function(e){this.userdata.goldcoins=e.gold,this.goldcoins.string=this.numformat(e.gold),this.goldcoins1&&(this.goldcoins1.string=this.numformat(parseInt(e.gold))),this.showAlarm(!1)},catchtimer:function(e){this.jsq&&(this.jsq.active=!0),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1);var t=i("GameTimer");this.rtgametimer=new t,this.timesrc=this.rtgametimer.runtimer(this,this.jsq,this.atlas,this.timer_num,this.timer_num,e)},showBanker:function(){this.result&&(this.result.active=!0,this.dizhu.active=!0)},showCallStat:function(e){switch(parseInt(e)){case 1:this.callstat.children[0].active=!0;break;case 2:this.callstat.children[1].active=!0;break;case 3:this.callstat.children[2].active=!0;break;case 4:this.callstat.children[3].active=!0;break;case 5:this.callstat.children[4].active=!0}},hideCallStat:function(){this.callstat&&(this.callstat.children[0].active=!1,this.callstat.children[1].active=!1,this.callstat.children[2].active=!1,this.callstat.children[3].active=!1,this.callstat.children[4].active=!1)},catchresult:function(e,t){if(this.rtgametimer)if(this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),e.docatch){switch(this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),parseInt(e.myratio)){case 0:this.cannot&&(this.cannot.active=!0),this.catchcall=0;break;case 1:this.resultx2&&(this.resultx2.active=!0,this.showEffect(0)),this.catchcall=1;break;case 2:this.resultx4&&(this.resultx4.active=!0,this.showEffect(1)),this.catchcall=5;break;case 3:this.resultx8&&(this.resultx8.active=!0,this.showEffect(1)),this.catchcall=3;break;case 4:this.resultx16&&(this.resultx16.active=!0,this.showEffect(1)),this.catchcall=4;break;case 5:this.resultx6.active=!0,this.showEffect(2),this.catchcall=3}this.showCallStat(e.myratio)}else this.catchcall=0;this.result&&(this.result.active=!1),this.cannot&&!t&&(this.cannot.active=!0),this.donot&&(this.donot.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1)},showKickPopBalloon:function(e){var t=this;"Kick"==e?(this.kickpopbubble.active=!0,this.kickpopbubble.children[0].active=!0,this.kickpopbubble.children[1].active=!1,setTimeout(function(){t&&t.kickpopbubble&&(t.kickpopbubble.active=!1)},2e3)):"Pop"==e?(this.kickpopbubble.active=!0,this.kickpopbubble.children[0].active=!1,this.kickpopbubble.children[1].active=!0,setTimeout(function(){t&&t.kickpopbubble&&(t.kickpopbubble.active=!1)},2e3)):this.kickpopbubble.active=!1},hideresult:function(){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1)},hideBanker:function(){this.dizhu.active=!1},setRedTeam:function(e,t){cc.global.dizhubegin.is3||this.isOpenRed||(this.isOpenRed=!0,t?(this.redteammark.children[0].active=!1,this.redteammark.children[1].active=!0):(this.redteammark.children[0].active=!0,this.redteammark.children[1].active=!1))},setTeamPartner:function(e){cc.global.dizhubegin.is3||(0==e?(this.redteammark.children[2].active=!0,this.redteammark.children[3].active=!1):1==e&&(this.redteammark.children[2].active=!1,this.redteammark.children[3].active=!0))},removeTeamMark:function(){this.isOpenRed=!1,this.redteammark.children[0].active=this.redteammark.children[1].active=!1},hideLeaveReq:function(){this.leave.active=!1},clean:function(e){this.parent.is_ptn_room||(this.info_outline.color=new cc.Color(255,255,255)),this.dizhu&&(this.dizhu.active=!1),this.jsq&&(this.jsq.active=!1),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.cardcount=0,this.catchcall=0},onClickDisInfo:function(){this.parent.notReplay&&(this.userid==cc.global.user.id?this.onClickEmoticon():this.onclickCallPlayer())},disChPos:function(e){},disLeaveReq:function(e){this.leave.active=e},showCallPlayer:function(e,t){var i=this;this.hideCallPlayer(),cc.global.audio.playVoiceChatWithType(this.playcharacter,t),this.callplayer.active=!0,this.callplayer.children[0].children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onclickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userid},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){this.dizhucontxt.onClickEmoticon()},onClickChat:function(){this.dizhucontxt.onclickChat()},onClickLobbyList:function(){this.dizhucontxt.onclickUserlist()},giveContext:function(e){this.dizhucontxt=e},speech:function(e){var t=this.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)},changeTheme:function(e,t){this.curTheme=e},show2Mode:function(){this.mode2left&&(this.mode2left.active=!0),this.mode2right&&(this.mode2right.active=!0)},selCardGroup:function(e,t){"no"==cc.global.amObserve&&this.mode2left&&this.mode2left.active&&this.mode2right&&this.mode2right.active&&this.socket().exec("sg",{extparams:{side:t}})},onThemeChanged:function(e){1==cc.global.theme.background||2==cc.global.theme.background?(this.avatar_outline.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("head_frame"+cc.global.theme.background),this.mode2left&&this.mode2right&&(this.mode2left.getComponent(cc.Sprite).spriteFrame=this.mode2right.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("left_cards_back"+cc.global.theme.background))):(this.avatar_outline.getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas2.getSpriteFrame("head_frame3"),this.mode2left&&this.mode2right&&(this.mode2left.getComponent(cc.Sprite).spriteFrame=this.mode2right.getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas2.getSpriteFrame("left_cards_back3")))},showAlarm:function(e){this.alarm&&(e?this.alarm.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,1.1),cc.scaleTo(.5,1)))):(this.alarm.stopAllActions(),this.alarm.setScale(1,1)))}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],FFASelCardsEngine:[function(e,t,i){"use strict";cc._RF.push(t,"5d30cxNvHJEcLAJD9yhgY/9","FFASelCardsEngine");var F=e("ArrayList"),a=e("FFACardAnalyzer"),E=e("CardInfo");t.exports=function(){this.cards=null,this.cardAnalyzer=new a,this.cardInfoList=new F,this.singleList=new F,this.pairList=new F,this.threeList=new F,this.straightList=new F,this.pairStraightList=new F,this.ffaList=new F,this.fourList=new F,this.rPigList=new F,this.bPigList=new F,this.bombList=new F,this.allSingles=new F,this.allSinglesForAI=new F,this.allPairs=new F,this.allPairsForAI=new F,this.allThrees=new F,this.allStraights=new F,this.allPairStraights=new F,this.allRecomendSingles=new F,this.allRecomendPairs=new F,this.weakList=new F,this.strongList=new F,this.analyzeCards=function(e){this.cards=new F,this.cards.addAll(e.getArray()),this.cardInfoList=new F,this.singleList=new F,this.pairList=new F,this.threeList=new F,this.straightList=new F,this.pairStraightList=new F,this.ffaList=new F,this.fourList=new F,this.rPigList=new F,this.bPigList=new F,this.bombList=new F,this.allSingles=new F,this.allSinglesForAI=new F,this.allPairs=new F,this.allPairsForAI=new F,this.allThrees=new F,this.allStraights=new F,this.allPairStraights=new F,this.allRedPigs=new F,this.allBlackPigs=new F,this.allRecomendSingles=new F,this.allRecomendPairs=new F,this.weakList=new F,this.strongList=new F;for(var t=[],i=0;i<12;i++)C=new E(i+3),t[i]=C;for(i=0;i<e.size();i++)t[e.get(i).rank-3].addCard(e.get(i));for(i=0;i<t.length;i++)0<t[i].totalSize&&this.cardInfoList.add(t[i]);for(i=0;i<this.cardInfoList.size();i++)if(10==(C=this.cardInfoList.get(i)).cardRank&&1<C.totalSize){for(P=0;P<C.cards.size();P++)(b=C.cards.get(P)).suit%2==1?(this.rPigList.add(b),2<=this.rPigList.size()&&(5==this.roomCondition||12==this.roomCondition)&&this.allRedPigs.add(this.rPigList.getSubList(0,this.rPigList.size()))):(this.bPigList.add(b),2<=this.bPigList.size()&&(5==this.roomCondition||12==this.roomCondition)&&this.allBlackPigs.add(this.bPigList.getSubList(0,this.bPigList.size())));this.bPigList.size()<2&&this.bPigList.clear(),this.rPigList.size()<2&&this.rPigList.clear()}for(i=0;i<this.cardInfoList.size();i++)0<(C=this.cardInfoList.get(i)).totalSize&&C.totalSize<5&&this.allSingles.add(C.cards.get(0)),0<C.totalSize&&C.totalSize<4&&this.allSinglesForAI.add(C.cards.get(0));for(i=0;i<this.cardInfoList.size();i++)2!=(C=this.cardInfoList.get(i)).totalSize&&3!=C.totalSize&&4!=C.totalSize||((S=new F).add(C.cards.get(0)),S.add(C.cards.get(1)),this.allPairs.add(S)),2!=C.totalSize&&3!=C.totalSize||((S=new F).add(C.cards.get(0)),S.add(C.cards.get(1)),this.allPairsForAI.add(S));var a=new F,s=new F;for(i=0;i<this.cardInfoList.size();i++)switch((C=this.cardInfoList.get(i)).totalSize){case 2:break;case 3:(S=new F).add(C.cards.get(0)),S.add(C.cards.get(1)),a.add(S);break;case 4:(S=new F).add(C.cards.get(0)),S.add(C.cards.get(1)),s.add(S)}for(i=0;i<this.cardInfoList.size();i++)if(3==(C=this.cardInfoList.get(i)).totalSize){var r=new F;r.addAll(C.cards.getArray()),this.allThrees.add(r)}var n=0;for(i=0;i<this.cardInfoList.size()-1;i++)if(m=new F,0<(C=this.cardInfoList.get(i)).totalSize&&C.cardRank<15&&(b=C.cards.get(0),m.add(b)),n<=i){for(P=i+1;P<this.cardInfoList.size()&&0<(y=this.cardInfoList.get(P)).totalSize&&y.cardRank<15&&Math.abs(y.cardRank-C.cardRank)==P-i;P++)f=y.cards.get(0),m.add(f),n=P;3<=m.size()&&this.allStraights.add(m)}for(i=n=0;i<this.cardInfoList.size()-1;i++)if(u=new F,1<(C=this.cardInfoList.get(i)).totalSize&&C.cardRank<15&&(u.add(C.cards.get(0)),u.add(C.cards.get(1))),n<=i){for(P=i+1;P<this.cardInfoList.size()&&1<(y=this.cardInfoList.get(P)).totalSize&&y.cardRank<15&&Math.abs(y.cardRank-C.cardRank)==P-i;P++)u.add(y.cards.get(0)),u.add(y.cards.get(1)),n=P;6<=u.size()&&this.allPairStraights.add(u)}var o=null,l=null;for(i=0;i<this.cardInfoList.size();i++)4==this.cardInfoList.get(i).cardRank&&(o=this.cardInfoList.get(i)),14==this.cardInfoList.get(i).cardRank&&(l=this.cardInfoList.get(i));for(;null!=o&&1<o.totalSize&&null!=l&&0<l.totalSize;)(L=new F).add(o.cards.get(0)),L.add(o.cards.get(1)),L.add(l.cards.get(0)),o.totalSize-=2,l.totalSize--,this.ffaList.add(L);var c=0;for(i=0;i<this.cardInfoList.size();i++){c=0;var h=null,d=null;if((2==(C=this.cardInfoList.get(i)).totalSize||3==C.totalSize)&&C.cardRank<15){var u=new F;for(2==C.totalSize?u.addAll(C.cards.getArray()):h=C,P=i+1;P<this.cardInfoList.size()&&(2==(y=this.cardInfoList.get(P)).totalSize||3==y.totalSize)&&Math.abs(C.cardRank-y.cardRank)==P-i&&y.cardRank<15;P++)if(2==(d=y).totalSize)u.addAll(y.cards.getArray());else{if(1<++c)break;u.add(y.cards.get(0)),u.add(y.cards.get(1))}if(4==u.size()&&0==c&&null!=h&&(u.addAtIndex(0,h.cards.get(0)),u.addAtIndex(0,h.cards.get(1))),7<u.size()&&3==d.totalSize&&(u.removeAtIndex(u.size()-1),u.removeAtIndex(u.size()-1)),5<u.size())for(this.pairStraightList.add(u),v=0;v<u.size();v++)for(var p=u.get(v),g=0;g<this.cardInfoList.size();g++)(_=this.cardInfoList.get(g)).cardRank==p.rank&&(2==_.totalSize?_.clear():3==_.totalSize&&(_.cards.removeAtIndex(0),_.cards.removeAtIndex(1),_.totalSize-=2))}}for(i=0;i<this.cardInfoList.size();i++){c=0;var m=new F;h=null,d=null;for(0<(C=this.cardInfoList.get(i)).totalSize&&C.totalSize<4&&C.cardRank<15&&(b=C.cards.get(0),1==C.totalSize&&m.add(b),3==C.totalSize&&(h=C,c++),2==C.totalSize&&(h=C,c+=.5)),P=i+1;P<this.cardInfoList.size();P++){var y=this.cardInfoList.get(P);if(!(0<y.totalSize&&y.totalSize<4&&y.cardRank<15&&Math.abs(C.cardRank-y.cardRank)==P-i))break;if(3==y.totalSize&&c++,2==y.totalSize&&(c+=.5),1<c)break;var f=y.cards.get(0);m.add(f),d=y}if(c<1&&2==m.size()&&null!=h){var b=h.cards.get(0);m.addAtIndex(0,b)}if(3<=m.size()){3<m.size()&&c==.5*(d.totalSize-1)&&0<c&&m.removeAtIndex(m.size()-1),this.straightList.add(m);for(var v=0;v<m.size();v++)for(p=m.get(v),g=0;g<this.cardInfoList.size();g++){var _=this.cardInfoList.get(g);if(p.rank==_.cardRank){_.cards.removeAtIndex(0),_.totalSize--;break}}}}for(i=0;i<this.cardInfoList.size();i++)1==(C=this.cardInfoList.get(i)).totalSize&&(this.singleList.addAll(C.cards.getArray()),(I=new F).add(C.cards.get(0)),this.allRecomendSingles.add(I),C.clear());if(!this.straightList.isEmpty())for(i=0;i<this.straightList.size();i++)for(P=(R=this.straightList.get(i)).size()-1;4<P;P--)A=R.get(P),(L=new F).add(A),this.allRecomendSingles.add(L);for(i=0;i<this.cardInfoList.size();i++){var C=this.cardInfoList.get(i),k=new F;2==C.totalSize&&(k.addAll(C.cards.getArray()),this.pairList.add(k),(I=new F).add(k.get(0)),this.allRecomendSingles.add(I),C.clear())}for(i=0;i<this.cardInfoList.size();i++){C=this.cardInfoList.get(i);var w=new F;3==C.totalSize&&(w.addAll(C.cards.getArray()),this.threeList.add(w),(I=new F).add(w.get(0)),this.allRecomendSingles.add(I),C.clear())}if(!this.pairStraightList.isEmpty())for(i=0;i<this.pairStraightList.size();i++){for(var T=this.pairStraightList.get(i),P=0;P<T.size();P+=2)(I=new F).add(T.get(P)),this.allRecomendSingles.add(I);for(P=0;P<T.size();P+=2)(S=new F).add(T.get(P)),S.add(T.get(P+1)),this.allRecomendPairs.add(S)}this.allRecomendPairs.addAll(a),this.allRecomendPairs.addAll(s);var x=new F;for(i=0;i<this.allPairs.size();i++){var S=this.allPairs.get(i);for(P=0;P<this.allRecomendPairs.size()&&S.get(0).rank!=this.allRecomendPairs.get(P).get(0).rank;P++);P>this.allRecomendPairs.size()-1&&x.add(S)}if(this.allRecomendPairs.addAll(x),!this.straightList.isEmpty())for(i=0;i<this.straightList.size();i++){var R=this.straightList.get(i);for(P=(R.size(),4);0<=P;P--){var A=R.get(P),L=new F;L.add(A),this.allRecomendSingles.add(L)}}for(i=0;i<this.cardInfoList.size();i++){C=this.cardInfoList.get(i);var N=new F;if(4==C.totalSize){N.addAll(C.cards.getArray()),this.fourList.add(N);var I=new F;I.add(N.get(0)),this.allRecomendSingles.add(I);var B=new F;B.addAll(C.cards.getSubList(0,3).getArray()),this.allThrees.add(B),C.clear()}}this.bombList=this.getBombList(),this.setStrategy()},this.getBombList=function(){for(var e=new F,t=0;t<this.threeList.size();t++)e.add(this.threeList.get(t));for(t=0;t<this.ffaList.size();t++)e.add(this.ffaList.get(t));for(t=0;t<this.fourList.size();t++)e.add(this.fourList.get(t));if(5==this.roomCondition||12==this.roomCondition)for(t=0;t<this.allRedPigs.size();t++)e.add(this.allRedPigs.get(t));else this.rPigList.isEmpty()||e.add(this.rPigList);return e},this.setStrategy=function(){for(this.weakList.clear(),this.strongList.clear(),s=0;s<this.singleList.size();s++){var e=new F;e.add(this.singleList.get(s)),this.cardAnalyzer.verifyForSupreme(e)?this.strongList.add(e):this.weakList.add(e)}for(s=0;s<this.pairList.size();s++){var t=this.pairList.get(s);this.cardAnalyzer.verifyForSupreme(t)?this.strongList.add(t):this.weakList.add(t)}for(s=0;s<this.pairStraightList.size();s++){var i=this.pairStraightList.get(s);14==i.get(i.size()-1).rank?this.strongList.add(i):this.weakList.add(i)}for(s=0;s<this.straightList.size();s++){var a=this.straightList.get(s);14==a.get(a.size()-1).rank?this.strongList.add(a):this.weakList.add(a)}for(this.sortGroupList(this.weakList),this.sortGroupList(this.strongList),s=0;s<this.threeList.size();s++)this.strongList.add(this.threeList.get(s));for(s=0;s<this.ffaList.size();s++)this.strongList.add(this.ffaList.get(s));for(s=0;s<this.fourList.size();s++)this.strongList.add(this.fourList.get(s));if(5==this.roomCondition||12==this.roomCondition){for(s=0;s<this.allRedPigs.size();s++)this.strongList.add(this.allRedPigs.get(s));for(var s=0;s<this.allBlackPigs.size();s++)this.strongList.add(this.allBlackPigs.get(s))}else this.rPigList.isEmpty()||this.strongList.add(this.rPigList),this.bPigList.isEmpty()||this.strongList.add(this.bPigList)},this.getPossibleCards=function(e,t){if(this.roomCondition=t,this.analyzeCards(e),0<this.getBetCardsType(e))return e;var i=new F,a=new F;if(this.allPairStraights.isEmpty()||(i=this.allPairStraights.get(0)),!this.allStraights.isEmpty())return a=this.allStraights.get(0),i.size()<=a.size()&&(i=a),i;i.clear();for(var s=0,r=0;r<this.weakList.size();r++)(n=this.weakList.get(r)).size()>s&&(s=n.size(),i=n);for(r=0;r<this.strongList.size();r++){var n=this.strongList.get(r);n.size()>s&&(s=n.size(),i=n)}return i},this.getBetCardsType=function(e){var t=e.size(),i=0;switch(t){case 1:return 1;case 2:if(10==e.get(0).rank&&10==e.get(1).rank&&e.get(0).suit%2==1&&e.get(1).suit%2==1)return 8;if(e.get(0).rank==e.get(1).rank)return 2;break;case 3:if(e.get(0).rank==e.get(1).rank&&e.get(0).rank==e.get(2).rank)return 5;for(var a=i=0,s=0;s<3;s++)4==e.get(s).rank&&i++,14==e.get(s).rank&&a++;if(2==i&&1==a)return 6;break;case 4:for(s=i=0;s<3;s++)e.get(s).rank==e.get(s+1).rank&&i++;if(3==i)return 7}if(t%2==0){i=0;var r=e.get(0).rank;for(s=0;s<t/2;s++)e.get(2*s).rank==e.get(2*s+1).rank&&e.get(2*s).rank==r+s&&i++;if(i==t/2&&e.get(t-1).rank-e.get(0).rank==t/2-1&&e.get(t-1).rank<15)return 4}var n=!0;for(s=0;s<t-1;s++)if(1!=Math.abs(e.get(s+1).rank-e.get(s).rank)){n=!1;break}return n?3:-1},this.sortGroupList=function(e){var t=e.getArray();e.clear();for(var i=1;i<t.length;i++){for(var a=t[i],s=i-1;0<=s&&t[s].get(0).rank>a.get(0).rank;)t[s+1]=t[s],s--;t[s+1]=a}e.addAll(t)}},cc._RF.pop()},{ArrayList:"ArrayList",CardInfo:"CardInfo",FFACardAnalyzer:"FFACardAnalyzer"}],FFASummaryDetail:[function(e,t,i){"use strict";cc._RF.push(t,"e620e9tKppBqrXcm66TTLTF","FFASummaryDetail");var a=e("HHCommon");cc.Class({extends:a,properties:{workitem:{default:null,type:cc.Node},entries:{default:[],type:cc.Node},base:{default:null,type:cc.Node},win:{default:null,type:cc.Node},draw:{default:null,type:cc.Node},lose:{default:null,type:cc.Node},player_1:{default:null,type:cc.Node},player_3:{default:null,type:cc.Node},effect:cc.Node},onLoad:function(){this.disDialogEffect(this.base);var t=this;this.workitem.on("getout",function(e){cc.global.backToHall=!0,cc.global.user.roomid="",t.parent.loadding(),t.parent.rerenderPlayers=[],t.parent.isOnSummary=!1,t.parent.scene("hall",t.parent),e.stopPropagation()}),1==cc.global.game_theme_idx?(this.node.children[2].children[0].active=!0,this.node.children[2].children[1].active=!1):(this.node.children[2].children[0].active=!1,this.node.children[2].children[1].active=!0),this.node.height*=cc.global.narrowContentRatio;var e=this;this.iswin=!1,this.effect.getComponent(sp.Skeleton).setCompleteListener(function(){e.iswin?e.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_winloop",!0):e.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_loseloop",!0)})},create:function(e,t,i){var a=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=this;if(this.parent=e,this.obsmode=i,s.entries&&!(s.entries.length<=0)){for(var r=0;r<s.entries.length;r++)s.entries[r].active=!1;for(r=0;r<t.players.length;r++){var n=t.players[r];if(n.userid==cc.global.user.id&&"no"==cc.global.amObserve)this.entries[0].active=!0,this.disLevelInfo(n),this.process(n,null,this.entries[0].children[3],this.entries[0].children[5],null,this.entries[0].children[0],this.entries[0].children[1],this.entries[0].children[2]),n.getout?setTimeout(function(){s&&s.node&&s.node.dispatchEvent(new cc.Event.EventCustom("getout",!0))},4500):setTimeout(function(){s&&s.node&&s.parent&&s.parent.summarypage&&(s.parent.restart(),s.parent.summarypage.destroy(),s.parent.summarypage=null)},5e3);else{var o=e.getPlayer(n.userid).seatidx;s.entries[o].active=!0,this.process(n,null,this.entries[o].children[3],this.entries[o].children[5],null,this.entries[o].children[0],this.entries[o].children[1],this.entries[o].children[2])}}a&&(this.player_1.active=!1,this.player_3.active=!1),"yes"==cc.global.amObserve&&setTimeout(function(){s&&s.node&&(s.parent.restart(),s.parent.summarypage.destroy(),s.parent.summarypage=null)},5e3)}},process:function(e,t,i,a,s,r,n,o){0<=e.score?i.getComponent(cc.Label).string="+ "+this.numformat(e.score):i.getComponent(cc.Label).string="- "+this.numformat(-1*e.score),0<=e.exp?a.getComponent(cc.Label).string="+ "+this.numformat(e.exp):a.getComponent(cc.Label).string="- "+this.numformat(Math.abs(e.exp)),null!=r&&(r.active=e.getout),"normal"==cc.global.user.selplayway?(o.children[0].active=!0,o.children[1].active=!1):"diamond"==cc.global.user.selplayway&&(o.children[0].active=!1,o.children[1].active=!0)},disLevelInfo:function(e){this.win.active=!1,this.draw.active=!1,this.lose.active=!1,this.effect.active=!1,this.iswin=2==e.win,2==e.win?(this.effect.active=!0,this.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_win",!1),cc.global.audio.playSummaryAud("win")):(1==e.win?this.draw.active=!0:(this.effect.active=!0,this.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_lose",!1)),cc.global.audio.playSummaryAud("lose"))},onLeaveClick:function(){this.parent.onclickBack()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],FFAWinCards:[function(e,t,i){"use strict";cc._RF.push(t,"201d62qaIZDSrzMLJZCUOYN","FFAWinCards");var a=e("HHCommon");cc.Class({extends:a,properties:{},start:function(){},init:function(e,t){this.cardnum=e,this.parent=t},setCardNum:function(e){this.cardnum=e},selectCard:function(){if(this.parent.pickAllow){var e=this.parent.selectedCard;null!=e&&e==this?e.releaseCard():(null!=e&&e.releaseCard(),this.parent.selectCard(this),this.node.y=10)}},releaseCard:function(){this.node.y=0,this.parent.selectedCard=null}}),cc._RF.pop()},{HHCommon:"HHCommon"}],FIVEBegin:[function(e,t,i){"use strict";cc._RF.push(t,"5339etk+JxCbbjQOdmeA7Q6","FIVEBegin");var a=e("HHCommon");cc.Class({extends:a,properties:{global:{default:null,type:cc.Node},poker:{default:null,type:cc.Node},leftovercards:{default:null,type:cc.Node},leftovercards3:{default:null,type:cc.Node},summary:{default:null,type:cc.Prefab},summary3:{default:null,type:cc.Prefab},touch:{default:null,type:cc.Node},effect:{default:null,type:cc.Node},back_players:{default:null,type:cc.Node},front_players:{default:null,type:cc.Node},btn_enter:{default:null,type:cc.Node},playersboard:{default:null,type:cc.Node},leavereq:{default:null,type:cc.Node},chat:{default:null,type:cc.Prefab},chatsearch:{default:null,type:cc.Prefab},emodlg:{default:null,type:cc.Prefab},unselect:{default:null,type:cc.Node},roominfo:{default:null,type:cc.Node},roomscore:{default:null,type:cc.Label},observer:{default:null,type:cc.Prefab},obsbench:{default:null,type:cc.Node},obsbench1:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},obschatbtn:{default:null,type:cc.Node},obsemojibtn:{default:null,type:cc.Node},raiseup:{default:null,type:cc.Node},btn_record_play:{default:null,type:cc.Node},lbl_record_status:{default:null,type:cc.Label},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},illegalconfirm:{default:null,type:cc.Prefab},thrown_cards:{default:null,type:cc.Node},only_100:{default:null,type:cc.Node},select_winner:{default:null,type:cc.Prefab},roomrankdialog:{default:null,type:cc.Prefab},roommarkatlas:{default:null,type:cc.SpriteAtlas},background:{default:null,type:cc.Node},buttons:{default:null,type:cc.Node},bar_bottom:{default:null,type:cc.Node},settinglayer:{default:null,type:cc.Node},settingback:{default:null,type:cc.Node},switchtogame:{default:null,type:cc.Node},watermark:cc.Node},onLoad:function(){this.switchtogame.active=!0,this.switchtogame.getComponent(cc.Animation).play("door_open"),cc.global.audio.playEffectAud("door",!1),this.curTheme=parseInt(cc.global.game_theme_idx),this.changeTheme(this.curTheme),this.onStartGame()},onStartGame:function(){this.show_setting=!1,this.loadding(),this.initEventCallback(),cc.game.setFrameRate(30),this.goRecovery=!1,this.initUI(),this.playerSlotPos=[cc.v2(-132/cc.global.narrowContentRatio,-282),cc.v2(567,-102),cc.v2(525,134),cc.v2(-525,134),cc.v2(-567,-102)],this.altPlayerPos=[cc.v2(-132,-282),cc.v2(567,-102),cc.v2(525,134),cc.v2(-525,134),cc.v2(-567,-102)],this.playerBoardSlotPos=[cc.v2(-132/cc.global.narrowContentRatio,-282),cc.v2(567,-102),cc.v2(525,134),cc.v2(-525,134),cc.v2(-567,-102)],this.altBoardPos=[cc.v2(-132,-282),cc.v2(567,-102),cc.v2(525,134),cc.v2(-525,134),cc.v2(-567,-102)],this.player=new Array,this.observerlist=new Array,this.playerboard=new Array,this.pokercards=new Array,this.lastcards=new Array,this.cardsArr=new Array,this.summarypage=null,this.inited=!1,this.lasttip=null,this.score="1",this.play_status=0,this.KPMode=0,this.upCardsCount=0,this.rerenderPlayers=[],this.isOnSummary=!1,this.notReplay=!0,this.gameCleaned=!1,this.myCallNum=0,this.boardCallStatus={callScore:0,masterRank:0,masterSuit:0,findRank:0,findSuit:0,exchanged:!1,fBM:!1},cc.global.amObserve="no",null!=cc.global&&(""!=cc.global.user.roomid&&this.recovery(),this.initgame()),cc.global.watchReplayData.onReplay&&this.prepareReplay()},prepareReplay:function(){this.notReplay=!1,cc.global.amObserve="yes",this.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),this.replay_bar.active=!0,this.replayStep="ready_room",this.replaySeq=0,this.goReplay(),this.createReplayTimer(),this.bar_bottom.active=!1,this.buttons.children[2].active=!1},createReplayTimer:function(){var e=this;this.replayTimer=setInterval(function(){e.play_history&&(e.replayTimeDelay-=30*cc.global.watchReplayData.replaySpeedX,e.replayTimeDelay<=0&&e.play_history[e.replaySeq]&&e.goReplay())},30)},pauseReplayTimer:function(){clearInterval(this.replayTimer)},resumeReplayTimer:function(){this.createReplayTimer()},goReplay:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=!1;switch(this.replayStep){case"ready_room":this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"play":t=!0,this.replay_play_event(i,this);break;case"catch":this.catch_event(i,this);break;case"catchresult":this.catchresult_event(i,this);break;case"lasthands":this.lasthands_event(i,this);break;case"callresult":t=!0,this.callresult_event(i,this);break;case"changeresult":t=!0,is.changeresult_event(i,this);break;case"bet":t=!0,this.takecards_event(i,this);break;case"turnend":t=!0,this.turnend_event(i,this);break;case"clear":t=!0,this.clear_event(i,this);break;case"allcards":t=!0,this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.selemoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"players":this.players_event(i,this);break;case"exit":this.leave_event(i,this)}}""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,this.play_history[this.replaySeq]||(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.pauseReplayTimer()),e&&!t&&this.goReplay(!0)},exitPlay:function(){cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),clearTimeout(this.deal1_timer),clearTimeout(this.deal2_timer),clearTimeout(this.bankerSelfTimer),clearTimeout(this.bankerOtherTimer),this.rerenderPlayers=[],this.isOnSummary=!1,this.returnToHall()},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.gameTimerSpeedChange(!0),this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):(this.replayTimer&&clearInterval(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.gameTimerSpeedChange(!1),this.replay_bar.children[0].opacity=100,this.pauseReplayTimer())},onClickReplayStop:function(){},onClickReplaySpeedUp:function(){var e=this.getLanguageText("REPLAY_TIME")+" : ";cc.global.watchReplayData.replaySpeedX<5&&(cc.global.watchReplayData.replaySpeedX++,this.lbl_replaySpeedX.string=e+cc.global.watchReplayData.replaySpeedX+"x",this.gameTimerSpeedChange(!0),this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){var e=this.getLanguageText("REPLAY_TIME")+" : ";1<cc.global.watchReplayData.replaySpeedX&&(cc.global.watchReplayData.replaySpeedX--,this.lbl_replaySpeedX.string=e+cc.global.watchReplayData.replaySpeedX+"x",this.gameTimerSpeedChange(!0),this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},togglePlayToPause:function(){this.replayTimer&&clearInterval(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.gameTimerSpeedChange(!1),this.replay_bar.children[0].opacity=100,this.pauseReplayTimer()},onClickReplayNextTurn:function(){this.togglePlayToPause(),this.goReplay(!0)},onClickReplayPrevTurn:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.goReplay(!0))},gameTimerSpeedChange:function(e){if(this&&this.playerboard)for(var t=0;t<this.playerboard.length;t++){var i=this.playerboard[t].getComponent("FIVEPlayerBoardRender");i&&i.rtgametimer&&(i.rtgametimer.isRunTimer?i.pauseTimer():i.resumeTimer())}},initUI:function(){cc.global.audio.playBGM("bgm_card"),JSON.parse(cc.sys.localStorage.getItem("sfx_on1"))?(this.settinglayer.children[2].children[2].children[0].children[0].active=!1,this.settinglayer.children[2].children[2].children[0].children[1].active=!0,cc.audioEngine.pauseAll()):(this.settinglayer.children[2].children[2].children[0].children[0].active=!0,this.settinglayer.children[2].children[2].children[0].children[1].active=!1,cc.audioEngine.resumeAll()),1==JSON.parse(cc.sys.localStorage.getItem("carsort_order"))?(this.settinglayer.children[2].children[1].children[0].children[0].active=!1,this.settinglayer.children[2].children[1].children[0].children[1].active=!0):(this.settinglayer.children[2].children[1].children[0].children[0].active=!0,this.settinglayer.children[2].children[1].children[0].children[1].active=!1)},onClickReady:function(){if(this.ready()){var e=this.socket(),t={};t.extparams={roomid:cc.global.extparams.roomid},e.exec("ready",t)}},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},initgame:function(){var t=this;if(this.ready()){var e=this.socket();if(this.game=this.getCommon("FIVEDataBind"),this.game.changeTheme(cc.global.game_theme_idx),this.game.initContext(this),(cc.global.dizhubegin=this).map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("catch",this.catch_event),this.map("catchresult",this.catchresult_event),this.map("lasthands",this.lasthands_event),this.map("callresult",this.callresult_event),this.map("changeresult",this.changeresult_event),this.map("bet",this.takecards_event),this.map("turnend",this.turnend_event),this.map("clear",this.clear_event),this.map("play",this.play_event),this.map("allcards",this.allcards_event),this.map("rend",this.rend_event),this.map("roomready",this.roomready_event),this.map("playeready",this.playeready_event),this.map("rer",this.recovery_event),this.map("banker",this.banker_event),this.map("exit",this.leave_event),this.map("selemoticon",this.selemoticon_event),this.map("callplayer",this.callplayer_event),this.map("sendchat",this.sendchat_event),this.map("startrecordresult",this.startrecord_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)}),this.notReplay)if("NormalCreate"==cc.global.user.roomInType){var i={};null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i)}else"NormalJoin"==cc.global.user.roomInType?((i={}).extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i)):"NormalObserve"==cc.global.user.roomInType&&((i={}).extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i),this.bar_bottom.active=!1);this.inited=!0,this.addTouchEvent()}},joinroom_event:function(e,t){t.closeloadding(),5==e.cond||6==e.cond?t.is3=!0:t.is3=!1,t.game.initGamemode(t.is3),cc.global.extparams.roomid=e.id,cc.global.user.roomNo=e.id,cc.global.user.selplayway=e.name,"champion"==cc.global.user.selplayway?cc.global.championMode=1:cc.global.championMode=0,cc.global.curPlaywayScore=e.score,t.score=e.score;var i=t.getLanguageText("ROOM_0");t.roomscore.string=t.score,t.roominfo.children[3].getComponent(cc.Label).string=e.id+i,"yes"==cc.global.amObserve?t.touch.active=!1:t.touch.active=!0,"diamond"==cc.global.user.selplayway&&(t.roominfo.children[2].children[1].children[0].active=!1,t.roominfo.children[2].children[1].children[1].active=!0),"ready"==cc.global.gamestatus?(cc.global.gamestatus="waiting",e.playerlist.length==e.players&&(cc.global.gamestatus="playing"),t.goRecovery=!0,t.players_event(e,t)):"waiting"==cc.global.gamestatus?(t.goRecovery=!0,t.players_event(e,t)):"playing"==cc.global.gamestatus&&(cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)),t.goRecovery=!1,1==e.cond||6==e.cond?(t.only_100.active=!0,t.only_100_mode=!0):t.only_100.active=!1,t.watermark.children[0].active=!1,t.watermark.children[1].active=!1,t.is3?t.watermark.children[1].active=!0:t.watermark.children[0].active=!0},observer_event:function(e,t){t.obsbench1.destroyAllChildren(),t.obsbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i]),a.parent=1<i?t.obsbench1:t.obsbench,(t.observerlist[i]=a).getComponent("Observer").nickname.node.active=!1,a.getComponent("Observer").right=1<i}},userready_event:function(e,t){e.userid==cc.global.user.id&&t.notReplay?t.game.playermysql.getComponent("FIVEPlayerRender").amready.active=!0:t.getPlayerBoard(e.userid).amready.active=!0},roomready_event:function(e,t){1==e.cardroom&&null!=t.invite&&t.invite.destroy()},playeready_event:function(e,t){e.userid==cc.global.user.id&&(t.gamebtn.active=!1)},returnToHall:function(){this.loadding(),clearTimeout(this.restartTimer),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.scene("hall",this)},players_event:function(e,t){var i=5;if(t.is3&&(i=3),e.msg&&(cc.global.outReasonMsg=e.msg),0==e.playerlist.length||e.playerlist.length>i)t.returnToHall();else{e.playerlist.length==i?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting","champion"==cc.global.user.selplayway||"no"!=cc.global.amObserve||t.isOnSummary);for(var a=!0,s=0;s<e.playerlist.length;s++)if(e.playerlist[s].id==cc.global.user.id){a=!1;break}for(s=0;s<e.observerlist.length;s++)e.observerlist[s].id==cc.global.user.id&&(a=!1);if(a&&t.notReplay)t.exitPlay();else{if(t.observer_event(e,t),"playing"==cc.global.gamestatus&&0==t.goRecovery)return;if("yes"==cc.global.amObserve?0==t.play_status?"waiting"==cc.global.gamestatus&&0==t.isOnSummary?1==cc.global.championMode||2==cc.global.championMode?t.btn_enter.active=!1:0==cc.global.championMode&&t.notReplay&&(t.btn_enter.active=!0):t.btn_enter.active=!1:1==t.play_status&&(t.btn_enter.active=!1):t.btn_enter.active=!1,t.rerenderPlayers=e.playerlist,t.rerenderPlayers.length<i&&t.showRaiseUp(0),t.isOnSummary)return;t.cleanGamePlayers(),t.game.restart(i),t.rerenderPlayers.length<i&&t.showRaiseUp(0),t.addBoardPlayers(i)}}},clearContextPlayers:function(){for(var e=0;e<this.player.length;e++)this.player[e].destroy();this.player.splice(0,this.player.length),this.player=new Array},addBoardPlayers:function(e){if("no"==cc.global.amObserve){for(var t=-1,i=0;i<this.rerenderPlayers.length;i++)this.rerenderPlayers[i].seatid=i,this.rerenderPlayers[i].id==cc.global.user.id&&(this.game.addSelfPlayer(this,this.rerenderPlayers[i]),this.game.giveContext(this),this.game.changeTheme(this.curTheme),t=this.rerenderPlayers[i].seatid);for(i=0;i<this.rerenderPlayers.length;i++)if(this.rerenderPlayers[i].seatid!=t&&0==this.playerexist(this.rerenderPlayers[i],this)){var a=this.rerenderPlayers[i].seatid-t;a<0&&(a+=e),2==a&&this.is3&&(a=4),this.newplayer(this.player.length,this,this.rerenderPlayers[i],a,!1)}}else for(i=0;i<this.rerenderPlayers.length;i++)2==i&&this.is3?this.rerenderPlayers[i].seatid=4:this.rerenderPlayers[i].seatid=i,0==this.playerexist(this.rerenderPlayers[i],this)&&this.newplayer(this.player.length,this,this.rerenderPlayers[i],this.rerenderPlayers[i].seatid,!0)},removeBoardPlayers:function(){for(var e=0;e<this.player.length;e++){for(var t=this.player[e].getComponent("FIVEPlayerRender"),i=!1,a=0;a<this.rerenderPlayers.length;a++)if(t.userdata.id==this.rerenderPlayers[a].id){i=!0;break}1!=i&&this.showRaiseUp(0),this.player[e].destroy(),this.player.splice(e,1),this.playerboard[e].destroy(),this.playerboard.splice(e,1)}},playerexist:function(e,t){for(var i=0;i<t.player.length;i++)if(null!=t.player[i]&&t.player[i].getComponent("FIVEPlayerRender").userid==e.id)return!0;return!1},banker_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay)t.bankerSelfTimer=setTimeout(function(){t&&t.game&&(t.game.showBanker(e,!0),t.game.speech("call"))},600);else{var i=600;t.notReplay||(i=0),t.bankerOtherTimer=setTimeout(function(){t&&t.game&&t.getPlayerBoard(e.userid)&&(t.getPlayerBoard(e.userid).showBanker(),t.getPlayer(e.userid).speech("call"))},i)}},catch_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay){var i=e.ratio;t.only_100_mode?i=95:t.is3&&i<80&&(i=75),t.game.catchtimer(e.timer,i),cc.global.user.doCatch=!0}else for(var a=0;a<t.playerboard.length;a++){var s=t.playerboard[a].getComponent("FIVEPlayerBoardRender");s.userid&&s.userid==e.userid?s.catchtimer(e.timer):s.stopTimer()}},ratio_value:function(e){return 1},recovery_event:function(e,t){if(t.roomscore.string=t.score,e.callset&&(t.boardCallStatus=e.callset,t.game.updateBoardCallStatus(!1,t.is3)),"no"==cc.global.amObserve&&e.player&&e.player.cards){for(var i=t.decode(e.player.cards),a=0;a<i.length;a++){var s=t.playcards(t.game,t,50*a-300,i[a]);t.registerProxy(s)}for(p=0;p<t.pokercards.length;p++)t.pokercards[p].getComponent("HHCard").order();t.resortCardOrder()}if(e.status.indexOf("calling")<0){if(e.player)if(e.player.history&&0<e.player.history.length){var r=t.decode(e.player.history);t.game.lasttakecards(t.game,t,r,{type:-1})}else""==e.player.history&&t.game.lasttakecards(t.game,t,-1,{type:-1});if(null!=e.others&&0<e.others.length)for(p=0;p<e.others.length;p++)if(h=t.getPlayerBoard(e.others[p].playuser))if(e.others[p].history&&0<e.others[p].history.length){var n=t.decode(e.others[p].history);h.lasttakecards(t.game,t,n.length,n,{type:-1})}else""==e.others[p].history&&h.lasttakecards(t.game,t,1,-1,{type:-1});if(e.expid==cc.global.user.id&&t.notReplay)t.game.playtimer(t.game,e.timer);else{var o=t.getPlayerBoard(e.expid);o&&o.playtimer(t.game,e.timer)}}else if(t.boardCallStatus.callScore=e.ratio,t.is3?(t.leftovercards3.active=!0,t.leftovercards3.getComponent(cc.Animation).play("five_leftover_spawn")):(t.leftovercards.active=!0,t.leftovercards.getComponent(cc.Animation).play("five_leftover_spawn")),"calling"==e.status){if(e.expid==cc.global.user.id){var l=e.ratio;t.only_100_mode?l=95:t.is3&&l<80&&(l=75),t.game.catchtimer(e.timer,l),cc.global.user.doCatch=!0}else for(a=0;a<t.playerboard.length;a++){var c=t.playerboard[a].getComponent("FIVEPlayerBoardRender");if(c.userid&&c.userid==e.expid){c.catchtimer(e.timer);break}}if(e.player&&1<e.player.ratio&&t.game.catchresult({docatch:1<e.player.ratio,myratio:e.player.ratio}),null!=e.others&&0<e.others.length)for(p=0;p<e.others.length;p++){var h=t.getPlayerBoard(e.others[p].playuser);h&&75<=e.others[p].ratio&&h.catchresult({docatch:1<e.others[p].ratio,myratio:e.others[p].ratio})}}else if("calling_call"==e.status){if(e.expid==cc.global.user.id)t.game.lasthands(e,!1,t.is3);else for(a=0;a<t.playerboard.length;a++)if(d=t.playerboard[a].getComponent("FIVEPlayerBoardRender"),(u=t.player[a].getComponent("FIVEPlayerRender"))&&d.userid&&d.userid==e.expid){d.playtimer(t.game,e.timer),u.showBetBalloon("Thinking",e.timer);break}}else if("calling_change"==e.status)if(e.expid==cc.global.user.id)t.game.showCardExchange(e);else for(a=0;a<t.playerboard.length;a++){var d=t.playerboard[a].getComponent("FIVEPlayerBoardRender"),u=t.player[a].getComponent("FIVEPlayerRender");if(u&&d.userid&&d.userid==e.expid){d.playtimer(t.game,e.timer),u.showBetBalloon("Exchange",e.timer);break}}if(null!=e.others&&0<e.others.length)for(p=0;p<e.others.length;p++)t.getPlayerBoard(e.others[p].playuser).resetcards(e.others[p].cnum);e.money&&"playing"==e.status&&t.game.setLoseCoins(e.money),e.player&&(e.player.buy&&t.game.setRedTeam(!0),e.player.blue&&t.game.setRedTeam(!1));for(var p=0;p<e.others.length;p++){var g=t.getPlayer(e.others[p].playuser);e.others[p].buy?g.setRedTeam(!0):e.others[p].blue&&g.setRedTeam(!1)}"playing"==e.status&&(t.boardCallStatus.exchanged=!0),t.showRaiseUp(e.dummy),t.addTouchEvent()},catchresult_event:function(e,t){if(t&&t.roomscore&&(t.roomscore.string=t.score),t.boardCallStatus.callScore=e.ratio,0<parseInt(e.myratio)){switch(parseInt(e.myratio)){case 100:t.showAnimation(0),cc.global.audio.playEffectAud("five/call_100")}0<parseInt(e.myratio)&&(e.userid==cc.global.user.id?t.game.speech(e.myratio):t.getPlayer(e.userid).speech(e.myratio))}else e.userid==cc.global.user.id?t.game.speech("pass"):t.getPlayer(e.userid).speech("pass");if(e.userid==cc.global.user.id&&t.notReplay)t.game.catchresult(e),cc.global.user.doCatch=!1,0<parseInt(e.myratio)&&cc.global.audio.playEffectAud("call");else{var i=t.getPlayerBoard(e.userid);t.getPlayer(e.userid),i&&i.catchresult(e),0<parseInt(e.myratio)&&cc.global.audio.playEffectAud("call")}},hideAllBalloons:function(){if(this&&this.game){this.game.hideBalloon();for(var e=0;e<this.playerboard.length;e++){var t=this.player[e].getComponent("FIVEPlayerRender");t&&t.hideBalloon()}}},lasthands_event:function(e,t){if(t.hideAllBalloons(),e.userid==cc.global.user.id&&t.notReplay){for("luckyre"!=cc.global.gamestatus&&t.game.lasthands(e,!0,t.is3),i=0;i<t.playerboard.length;i++)(a=t.playerboard[i].getComponent("FIVEPlayerBoardRender")).hideresult();t.game.hideresult()}else{t.game.hideresult();for(var i=0;i<t.playerboard.length;i++){var a=t.playerboard[i].getComponent("FIVEPlayerBoardRender");a.hideresult()}var s=t.getPlayerBoard(e.userid),r=t.getPlayer(e.userid);s&&s.lasthands(t,t.game,e),r&&(r.setRedTeam(!0),100==e.ratio?t.getPlayer(e.userid).showBetBalloon("Exchange",e.timer):"luckyre"!=cc.global.gamestatus&&t.getPlayer(e.userid).showBetBalloon("Thinking",e.timer))}t.initThrownCards(e)},initThrownCards:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(e.lasthands&&0<e.lasthands.length){var i=this.decode(e.lasthands);this.thrown_cards&&this.thrown_cards.getComponent("ThrownCards").init(i,!this.notReplay||t,t)}},callresult_event:function(e,t){if(t.boardCallStatus=e,!t.notReplay)for(var i=0;i<t.playerboard.length;i++)t.playerboard[i].getComponent("FIVEPlayerBoardRender").resortCardOrder();t.game.updateBoardCallStatus(!0,t.is3),t.game.hideDeclare(),t.resortCardOrder();var a=t.getPlayerBoard(e.userid);if(e.userid==cc.global.user.id&&t.notReplay?t.game.callresult(e):a&&a.callresult(t.game,e),100==t.boardCallStatus.callScore)e.userid==cc.global.user.id&&t.notReplay?t.game.playtimer(t.game,e.timer):a&&a.playtimer(t.game,e.timer),t.is3?t.leftovercards3.getComponent(cc.Animation).play("five_leftover_catched"):t.leftovercards.getComponent(cc.Animation).play("five_leftover_catched"),t.hideAllBalloons();else{var s=t.getPlayer(e.userid);s&&s.showBetBalloon("Exchange",e.timer)}100!=t.boardCallStatus.callScore&&t.initThrownCards(e)},setPokerCards:function(e){if(!(e.length<=0)){for(t=0;t<this.poker.children.length;t++)this.game.pokerpool.put(this.poker.children[t]);this.poker.destroyAllChildren(),this.poker.removeAllChildren();for(var t=0;t<e.length;t++){var i=this.game.pokerpool.get(),a=i.getComponent("HHCommon");i.parent=this.poker,i.setScale(1,1),a.setCard(e[t]),a.order()}this.resortCardOrder()}},changeresult_event:function(e,t){t.boardCallStatus.exchanged=!0;var i=t.getPlayer(e.userid),a=t.getPlayerBoard(e.userid);e.userid==cc.global.user.id&&t.notReplay?(0<e.lasthands.length&&t.setPokerCards(t.decode(e.lasthands)),t.game.changeresult(e,t.is3)):a&&t.getPlayerBoard(e.userid).changeresult(t.game,e),100!=t.boardCallStatus.callScore?(e.userid==cc.global.user.id&&t.notReplay?t.game.playtimer(t.game,e.timer):(a&&a.playtimer(t.game,e.timer),i&&i.hideBalloon()),t.is3?t.leftovercards3.getComponent(cc.Animation).play("five_leftover_catched"):t.leftovercards.getComponent(cc.Animation).play("five_leftover_catched")):i&&i.showBetBalloon("Exchange",e.timer),t.turnFirstCard=null,t.thrown_cards.active=!1},cleanAllLastCards:function(){if(this.playerboard){for(var e=0;e<this.playerboard.length;e++)this.playerboard[e].getComponent("FIVEPlayerBoardRender").cleanLastCards(this.game);this.game.cleanCards(this.game)}},takecards_event:function(e,t){var i=["mastercard","stop","captain","joker2","joker1"],a=["Mater","Chang","SpadeA","sJoker","BJocker"];t.leftovercards.active=!1,t.thrown_cards.active=!1,t.lasttip=null,t.dealed=!0;var s=-1;if(e.cards&&(s=t.decode(e.cards)[0]),null==t.turnFirstCard&&null!=e.start&&null!=e.start&&(t.turnFirstCard=e.start),cc.global.audio.playEffectAud("takecard"),e.userid==cc.global.user.id&&t.notReplay)t.game.lasttakecards(t.game,t,s,e),t.game.showBetBalloon(a[parseInt(e.type)-1]);else{var r=t.getPlayerBoard(e.userid),n=t.getPlayer(e.userid);r&&n&&(r.lasttakecards(t.game,t,e.cnum,s,e),n.takecards(e),n.showBetBalloon(a[parseInt(e.type)-1]))}if(e.nextid==cc.global.user.id&&t.notReplay)t.game.playtimer(t.game,e.timer);else{var o=t.getPlayerBoard(e.nextid);o&&o.playtimer(t.game,e.timer)}if(e.blue){var l=t.boardCallStatus.userid==e.userid;if(e.userid==cc.global.user.id&&t.notReplay)t.game.setRedTeam(l);else{var c=t.getPlayer(e.userid);c&&c.setRedTeam(l)}}switch(parseInt(e.type)){case 2:t.showAnimation(1),cc.global.audio.playEffectAud("five/spear");break;case 4:t.showAnimation(2),cc.global.audio.playEffectAud("five/tiger");break;case 5:t.showAnimation(3),cc.global.audio.playEffectAud("five/tiger")}i[e.type-1]&&(e.userid==cc.global.user.id?t.game.speech(i[e.type-1]):t.getPlayer(e.userid)&&t.getPlayer(e.userid).speech(i[e.type-1]))},turnend_event:function(e,t){if(t.turnFirstCard=null,e.mts)for(var i=0;i<e.mts.length;i++){var a=t.decode(e.mts[i].extdata.cards)[0];if(e.mts[i].userid==cc.global.user.id&&t.notReplay)t.game.lasttakecards(t.game,t,a,e.mts[i],!1);else{var s=t.getPlayerBoard(e.mts[i].userid);s&&s.lasttakecards(t.game,t,null,a,e.mts[i],!1)}}if(e.sdp){var r=t.boardCallStatus.userid==e.sdp;if(e.sdp==cc.global.user.id&&t.notReplay)t.game.setRedTeam(r);else{var n=t.getPlayer(e.sdp);n&&n.setRedTeam(r)}}t&&t.game&&t.game.setLoseCoins(e.money),e.lasthands&&0<e.lasthands.length&&(t.initThrownCards(e,!0),t.game.setLoseCoins(t.thrown_cards.getComponent("ThrownCards").money))},clear_event:function(e,t){if(t.turnWinner=e.userid,t.cleanAllLastCards(),e&&e.userid)if(e.userid==cc.global.user.id&&t.notReplay)t.game.playtimer(t.game,e.msg);else{var i=t.getPlayerBoard(e.userid);i&&i.playtimer(t.game,e.msg)}},leave_event:function(e,t){e.userid==cc.global.user.id&&t.notReplay?t.disLeaveReq("true"==e.msg):t.getPlayer(e.userid).disLeaveReq("true"==e.msg)},selemoticon_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showEmoticon(e.msg);else{var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg)}var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},callplayer_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showCallPlayer(e.msg);else{var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg)}var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg)},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase;if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showCallPlayer(i,e.msg);else{var a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg)}var s=t.getObserver(e.userid);s&&s.showCallPlayer(i,e.msg)},showAnimation:function(e,t){0<=e&&this.disEffect(e,t)},hideEffect:function(e){var t=this;setTimeout(function(){t.effect&&(t.effect.children[e].active=!1)},1500)},disEffect:function(e,t){if(this&&this.effect){this.effect.children[e].active=!0;var i="";switch(e){case 0:i="fire";break;case 1:i="tonghou";break;case 2:i="mother";break;case 3:i="father"}if(""!=i){var a=this.effect.children[e].getComponent(sp.Skeleton);a.clearTracks(),a.setAnimation(0,i,!1)}this.hideEffect(e)}},replay_play_event:function(e,t){if(e.curgame==cc.global.cur_game_code){t.summarypage&&t.summarypage.getComponent("FIVESummaryDetail")&&(t.summarypage.destroy(),t.summarypage=null),cc.global.gamestatus="playing";var i=[],a=(this.getPlayer(e.playuser),this.getPlayerBoard(e.playuser));e.cards&&(i=t.decode(e.cards),a.resetcards(i.length),a.setCards(i))}},play_event:function(e,t){if(t.closeloadding(),e.curgame==cc.global.cur_game_code){t.isOnSummary=!1,t.summarypage&&t.summarypage.getComponent("FIVESummaryDetail")&&(t.summarypage.destroy(),t.summarypage=null),t.restart(),cc.global.gamestatus="playing";var i=[];e.cards&&(i=t.decode(e.cards));var a=t.game.pokerpool.get(),s=t.game.pokerpool.get(),r=t.game.pokerpool.get(),n=t.game.pokerpool.get(),o=t.game.pokerpool.get();a.parent=t.root(),s.parent=t.root(),r.parent=t.root(),n.parent=t.root(),o.parent=t.root(),a.setPosition(0,-50),a.setScale(.4,.4),s.setPosition(0,-50),s.setScale(.4,.4),r.setPosition(0,-50),r.setScale(.4,.4),n.setPosition(0,-50),n.setScale(.4,.4),o.setPosition(0,-50),o.setScale(.4,.4);for(var l=0;l<t.playerboard.length;l++)t.playerboard[l].getComponent("FIVEPlayerBoardRender").showCardsPanel();var c=cc.callFunc(function(e,t){if(t.game){if(t.game.pokerpool.put(t.left),t.game.pokerpool.put(t.right),t.game.pokerpool.put(t.down1),t.game.pokerpool.put(t.down2),t.game.pokerpool.put(t.upon),"no"==cc.global.amObserve){for(var i=0;i<t.self.pokercards.length;i++)t.self.pokercards[i].getComponent("HHCard").order();t.self.resortCardOrder()}t.self.is3?(t.self.leftovercards3.active=!0,t.self.leftovercards3.getComponent(cc.Animation).play("five_leftover_spawn")):(t.self.leftovercards.active=!0,t.self.leftovercards.getComponent(cc.Animation).play("five_leftover_spawn"))}},this,{game:t.game,self:t,left:a,right:s,down1:r,down2:n,upon:o});t.is3?(t.dealing3(t.game,3,t,0,a,s,o,i),cc.global.audio.playEffectAud("shuffle"),t.deal1_timer=setTimeout(function(){t.dealing3(t.game,3,t,1,a,s,o,i),t.deal2_timer=setTimeout(function(){t.dealing3(t.game,3,t,2,a,s,o,i,c),t.reordering(t)},250)},250)):(t.dealing(t.game,3,t,0,a,s,r,n,o,i),cc.global.audio.playEffectAud("shuffle"),t.deal1_timer=setTimeout(function(){t.dealing(t.game,3,t,1,a,s,r,n,o,i),t.deal2_timer=setTimeout(function(){t.dealing(t.game,4,t,2,a,s,r,n,o,i,c),t.reordering(t)},250)},250))}},allcards_event:function(e,t){t.closeConfirm(),t.gameCleaned=!1,t.hideAllBalloons(),t.game.hidePlayBtn(),t.leftovercards.active=!1,t.leftovercards3.active=!1,t.hasRight=!1,t.game.hasRP=!1,e.finished=!0,cc.global.gamestatus="waiting",null!=e.cnt&&0<cc.global.championMode&&(t.currenRound=parseInt(e.cnt)+1);for(var i=null,a=0;a<e.players.length;a++){for(var s=e.players[a],r=0;r<t.rerenderPlayers.length;r++)t.rerenderPlayers[r].id==s.userid&&(t.rerenderPlayers[r].goldcoins=s.gold,t.rerenderPlayers[r].rank=s.rank,t.rerenderPlayers[r].exp=s.normalscore,t.rerenderPlayers[r].texp=s.texp,t.rerenderPlayers[r].explevel=s.explevel);if(s.userid==cc.global.user.id&&t.notReplay)cc.global.user.normalrank=s.normalrank,cc.global.user.goldcoins=s.gold,cc.global.user.texp=s.texp,cc.global.user.explevel=s.explevel,t.game.updateCareerAfterMatch(s),t.game.stopTimer(),h="",2==s.win?h="Victory":0==s.win&&(h="Lost"),t.game.disChPos(h),"suicide"==e.title&&e.master&&cc.global.user.id==e.master&&(t.game.showBetBalloon("Give up",0),t.game.speech("suicide"));else{i=s;var n=t.decode(s.cards),o=t.getPlayerBoard(s.userid);if(o.stopTimer(),"punish"==e.title&&t.initThrownCards(e,!0),null!=n&&0<n.length)o.resetcards(n.length,!0),o.setCards(n);else{o.cleanCards();for(var l=0;l<n.length;l++)o.lasttakecards(t.game,t,n.length,n,e)}var c=t.getPlayer(s.userid);c.updateCareerAfterMatch(s);var h="";2==s.win?h="Victory":0==s.win&&(h="Lost"),c.disChPos(h),"suicide"==e.title&&e.master&&s.userid==e.master&&(c.showBetBalloon("Give up",0),c.speech("suicide"))}}if("openend"==e.title&&e.master)if(e.master==cc.global.user.id&&t.notReplay)t.game.showBetBalloon("Perfect",0),t.game.speech("letsfinish");else{var d=t.getPlayer(e.master);d&&(d.showBetBalloon("Perfect",0),d.speech("letsfinish"))}if(t.isOnSummary=!0,t.showRaiseUp(e.dummy),cc.global.summaryDetailData=e,null!=i){if(t.updatepva(),t.closeOpenWin(),!t.summary)return;if(t.summarypage=cc.instantiate(t.is3?t.summary3:t.summary),null==t.summarypage||null==t.summarypage)return;t.summarypage.parent=t.root(),t.summarypage.getComponent("FIVESummaryDetail").create(t,e,"yes"==cc.global.amObserve,t.is3)}},rend_event:function(e,t){t.isOnSummary=!1,"no"==cc.global.amObserve&&t.socket().exec("rnr",{extparams:{roomid:cc.global.extparams.roomid}}),t.hasRight=!1},getPlayerBoard:function(e){if(this&&this.playerboard)for(var t=0;t<this.playerboard.length;t++){var i=this.playerboard[t].getComponent("FIVEPlayerBoardRender");if(i.userid&&i.userid==e)return i}},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},startrecord_event:function(e,t){},getPlayer:function(e){if(this&&this.player)for(var t=0;t<this.player.length;t++){var i=this.player[t].getComponent("FIVEPlayerRender");if(i.userid&&i.userid==e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},dealing:function(e,t,i,a,s,r,n,o,l,c,h){if(i.otherplayer(s,0,t,e,i,h),i.otherplayer(n,1,t,e,i,h),i.otherplayer(o,2,t,e,i,h),i.otherplayer(r,3,t,e,i,h),"yes"==cc.global.amObserve)i.otherplayer(l,4,t,e,i,h);else for(var d=0;d<t;d++){var u=i.current(e,i,300*a+50*d-300,c[3*a+d],h);null!=u&&i.registerProxy(u)}},dealing3:function(e,t,i,a,s,r,n,o,l){if(i.otherplayer3(s,0,t,e,i,l),i.otherplayer3(r,1,t,e,i,l),"yes"==cc.global.amObserve)i.otherplayer3(n,2,t,e,i,l);else for(var c=0;c<t;c++){var h=i.current(e,i,300*a+50*c-300,o[3*a+c],l);null!=h&&i.registerProxy(h)}},otherplayer:function(e,t,i,a,s,r){if(s.player){var n={};0==t?(n=cc.sequence(cc.spawn(cc.moveTo(.2,280,-60),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,0,-50),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(n)):1==t?(n=cc.sequence(cc.spawn(cc.moveTo(.2,100,60),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,0,-50),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(n)):2==t?(n=cc.sequence(cc.spawn(cc.moveTo(.2,-100,60),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,0,-50),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(n)):3==t?(n=cc.sequence(cc.spawn(cc.moveTo(.2,-280,-60),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,0,-50),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(n)):4==t&&(n=cc.sequence(cc.spawn(cc.moveTo(.2,0,-120),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,0,-50),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(n)),null!=r&&"yes"==cc.global.amObserve&&(n=cc.sequence(cc.moveTo(0,0,-50),r),e.runAction(n));for(var o=s.playerboard[t].getComponent("FIVEPlayerBoardRender"),l=0;l<i;l++)o.countcards(1)}},otherplayer3:function(e,t,i,a,s,r){if(s.player){var n={};0==t?(n=cc.sequence(cc.spawn(cc.moveTo(.2,280,-60),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,0,-50),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(n)):1==t?(n=cc.sequence(cc.spawn(cc.moveTo(.2,-280,-60),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,0,-50),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(n)):2==t&&(n=cc.sequence(cc.spawn(cc.moveTo(.2,0,-120),cc.scaleTo(.2,.3,.3)),cc.moveTo(0,0,-50),cc.scaleTo(0,r?1:.4,r?1:.4)),e.runAction(n)),null!=r&&"yes"==cc.global.amObserve&&(n=cc.sequence(cc.moveTo(0,0,-50),r),e.runAction(n));for(var o=s.playerboard[t].getComponent("FIVEPlayerBoardRender"),l=0;l<i;l++)o.countcards(1)}},registerProxy:function(e){e&&e.getComponent("HHCard").proxy(this.game)},playcards:function(e,t,i,a){return t.current(e,t,i,a,null)},current:function(e,t,i,a,s){if(null==e||null==e)return null;if(null==e.pokerpool||null==e.pokerpool)return null;var r=e.pokerpool.get();if("no"==cc.global.amObserve)if(r.getComponent("HHCard").setCard(a),r.card=a,r.parent=t.poker,r.setPosition(0,200),r.setScale(1,1),t.pokercards.push(r),"luckyre"!=cc.global.gamestatus)if(null!=s){var n=cc.sequence(cc.moveTo(.2,i,0),s);r.runAction(n)}else{var o=cc.moveTo(.2,i,0);r.runAction(o)}else r.x=i,r.y=0;return r},getCardzIndex:function(e){var t=this.boardCallStatus.masterSuit,i=this.boardCallStatus.masterRank,a=e%4,s=(e-e%4)/4+3,r=100*a;return 52<=e&&(r=800),47==e&&(r=700),48<=e&&e<=51&&(r=500),a+1==t&&0==i&&(e<=46?r=400:48<=e&&e<=51&&(r=600)),s==i&&0==t&&e<=46&&(r=400),0!=i&&0!=t&&a+1==t&&s==i&&(r=400),r+e},reordering:function(e){if(null!=e.pokercards&&null!=e.pokercards&&"no"==cc.global.amObserve){for(var t=0;t<e.pokercards.length;t++)e.pokercards[t].parent=e.poker,e.pokercards[t].scaleX=e.pokercards[t].scaleY=1.1;e.addTouchEvent()}},newplayer:function(e,t,i,a,s){var r=this.playerSlotPos[a],n=this.playerBoardSlotPos[a];s&&(r=this.altPlayerPos[a],n=this.altBoardPos[a]);var o=t.game,l=1==a||2==a;if(o&&0<o.playerspool.size()&&(t.player[e]=o.playerspool.get(),t.player[e].parent=0<a?t.back_players:t.front_players,t.player[e].setPosition(r),t.player[e].x=t.player[e].x/cc.global.narrowContentRatio,this.is3&&0!=a&&(t.player[e].y+=200),t.player[e].getComponent("FIVEPlayerRender").initplayer(t,i,a,l),t.player[e].getComponent("FIVEPlayerRender").changeTheme(t.curTheme)),o&&0<o.playerboardpool.size()){switch(t.playerboard[e]=o.playerboardpool.get(),t.playerboard[e].parent=t.playersboard,a){case 0:t.playerboard[e].zIndex=3,t.player[e].zIndex=4;break;case 1:t.playerboard[e].zIndex=2,t.player[e].scaleX=-1*t.player[e].scaleX,t.playerboard[e].scaleX=-1*t.playerboard[e].scaleX,t.player[e].zIndex=3;break;case 2:t.playerboard[e].zIndex=1,t.player[e].scaleX=-1*t.player[e].scaleX,t.player[e].zIndex=2,t.playerboard[e].scaleX=-1*t.playerboard[e].scaleX;break;case 3:t.playerboard[e].zIndex=2,t.player[e].zIndex=2;break;case 4:t.playerboard[e].zIndex=4,t.player[e].zIndex=4}t.playerboard[e].setPosition(n),t.playerboard[e].x=t.playerboard[e].x/cc.global.narrowContentRatio,this.is3&&0!=a&&(t.playerboard[e].y+=200),t.playerboard[e].getComponent("FIVEPlayerBoardRender").initplayer(t,i,a,l)}},givup:function(){this.ready()&&this.socket().exec("giveup",{})},docatch:function(){this.ready()&&this.socket().exec("docatch",{})},doPlayCards:function(){if(this.ready()){for(var e=this.socket(),t=[],i=0;i<this.poker.children.length;i++){var a=this.poker.children[i].getComponent("HHCard");if(1==a.selected){a.touched=!1,t.push(a.card);break}}if(t.length){var s={};s.extparams={cards:t.join()},e.exec("bet",s),cc.global.user.hardLiner=!1}}this.lasttip=null},noCards:function(){},clean:function(e){for(var t=0;t<this.pokercards.length;t++){var i=this.pokercards[t];this.game.pokerpool.put(i)}for(this.pokercards.splice(0,this.pokercards.length),a=0;a<this.lastcards.length;a++)this.game.minpokerpool.put(this.lastcards[a]);for(this.lastcards.splice(0,this.lastcards.length),a=0;a<this.player.length;a++)(s=this.player[a].getComponent("FIVEPlayerRender")).clean(this.game);if(null!=e&&null!=e.player)for(var a=0;a<3;a++)for(var s=this.player[a].getComponent("FIVEPlayerRender"),r=0;r<e.player.length;r++)s.userdata.id==e.player[r].id&&e.player[r].getout&&this.player.splice(a,1);this.game.clean(this),this.roomscore.string=this.score,this.dealed=!1,this.leavereq.active=!1},cleanGame:function(){this.hideAllBalloons();for(var e=0;e<this.pokercards.length;e++){var t=this.pokercards[e];this.game.pokerpool.put(t)}for(this.pokercards.splice(0,this.pokercards.length),i=0;i<this.lastcards.length;i++)this.game.minpokerpool.put(this.lastcards[i]);this.lastcards.splice(0,this.lastcards.length);for(var i=0;i<this.player.length;i++){var a=this.playerboard[i].getComponent("FIVEPlayerBoardRender");if(a){a.result&&(a.result.active=!1),a.cannot&&(a.cannot.active=!1),a.donot&&(a.donot.active=!1),a.lastcards&&(a.lastcards.active=!1),a.dizhu&&(a.dizhu.active=!1),a.resetcards(0);var s=this.player[i].getComponent("FIVEPlayerRender");s.hideLeaveReq(),s.removeTeamMark()}}"no"==cc.global.amObserve&&(this.game.clean(this),this.roomscore.string=this.score),this.dealed=!1,this.leavereq.active=!1},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},removeGetoutPlayers:function(){var e=this;if(cc.global.summaryDetailData&&(e.deadPlayers=cc.global.summaryDetailData.players,e.deadPlayers&&e.deadPlayers))for(var t=0;t<e.deadPlayers.length;t++)for(var i=0;i<e.player.length;i++)e.player[i].getComponent("FIVEPlayerRender").userdata.id==e.deadPlayers[t].userid&&e.deadPlayers[t].getout&&(e.player[i].destroy(),e.player.splice(i,1),e.playerboard[i].destroy(),e.playerboard.splice(i,1))},cleanGamePlayers:function(){for(var e=0;e<this.player.length;e++)this.player[e].destroy(),this.playerboard[e].destroy();this.player.splice(0,this.player.length),this.playerboard.splice(0,this.player.length),this.player=new Array,this.playerboard=new Array},restart:function(){var e=this.is3?3:5;this.gameCleaned||(this.gameCleaned=!0,this.cleanGame(),this.goRecovery=!1,cc.global.gamestatus="waiting",this.cleanGamePlayers(),this.game.restart(e),this.addBoardPlayers(e),"yes"==cc.global.amObserve&&this.rerenderPlayers.length<e&&(1==cc.global.championMode||2==cc.global.championMode?this.btn_enter.active=!1:0==cc.global.championMode&&this.notReplay&&(this.btn_enter.active=!0)),this.play_status=0,this.isOnSummary=!1,this.boardCallStatus={callScore:0,masterRank:0,masterSuit:0,findRank:0,findSuit:0,fBM:!1},this.game.initMasterCall(),this.poker.destroyAllChildren(),this.poker.removeAllChildren(),this.turnFirstCard=null,this.thrown_cards.active=!1)},onDestroy:function(){this.inited=!1,this.cleanmap(),cc.global.onBatteryChanged=null},addTouchEvent:function(){this.touch.on(cc.Node.EventType.TOUCH_START,this.onCardClick,this),this.cardsArr=this.poker.getChildren()},onCardClick:function(e){var t=e.getLocation(),i=this._beginPos=this.touch.convertToNodeSpaceAR(t);this.processClickCard(i)},processClickCard:function(e){for(var t=this.cardsArr.length,i=null,a=!1,s=t-1;0<=s;s--){var r=(i=this.cardsArr[s]).getComponent("HHCard"),n=cc.pRotateByAngle(e,i.getPosition(),i.rotation*Math.PI/180),o=i.width*i.scaleX,l=i.height*i.scaleY;if(cc.rect(-i.anchorX*o+i.x,-i.anchorY*l+i.y,o,l).contains(n)){0==r.touched&&(r.selected?1==this.game.playbtn.active?this.doPlayCards():r.unselected():(r.doselect(),a=!0));break}}if(this.boardCallStatus.exchanged&&a)for(s=t-1;0<=s;s--){var c=this.cardsArr[s];c!=i&&(r=c.getComponent("HHCard")).unselected()}},onclickBack:function(){this.ready()&&(this.notReplay&&(0<this.player.length||"no"==cc.global.amObserve)?this.socket().exec("leave",{}):this.exitPlay())},onclickUnSel:function(){cc.global.tipsReady&&(cc.global.tipsReady=!1),this.upCardsCount=0,this.game.unselected(this,this.game)},showChatDialog:function(){this.onclickChat(1)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}e<0||(this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root(),this.chatpage.getComponent("Chat").init(this,e),this.ischat=!0)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;if(!(e<0)&&this.ready()){var t=this.socket(),i={};i.extparams={emoticon:e},t.exec("selemoticon",i),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1)}},onClickEmoticon:function(){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),this.isemoticon=!1;this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root(),this.emoticonpage.getComponent("Emoticon").init(this),this.isemoticon=!0},onclickUserlist:function(){this.socket().exec("totaluserlist",{})},disLeaveReq:function(e){this.leavereq.active=e},changeCardSortOrder:function(){var e=JSON.parse(cc.sys.localStorage.getItem("carsort_order"));null==e&&(e=!1);for(var t=0;t<this.poker.children.length;t++)this.poker.children[t].zIndex=100-this.poker.children[t].zIndex;this.layoutPokerCard()},resortCardOrder:function(){var e=JSON.parse(cc.sys.localStorage.getItem("carsort_order"));if(null==e&&(e=!1),1==e)for(t=0;t<this.poker.children.length;t++)this.poker.children[t].zIndex=this.getCardzIndex(this.poker.children[t].getComponent("HHCard").card);else for(var t=0;t<this.poker.children.length;t++)this.poker.children[t].zIndex=1e3-this.getCardzIndex(this.poker.children[t].getComponent("HHCard").card);this.layoutPokerCard()},layoutPokerCard:function(){for(var e=0;e<this.poker.children.length;e++)this.poker.children[e].y=0;this.layout(this.poker,function(e,t){return e.zIndex-t.zIndex}),this.repositionPokerCards()},repositionPokerCards:function(){var e=this.poker.children.length,t=parseInt(e/2);if(e%2==0)for(var i=0;i<t;i++)this.poker.children[t+i].rotation=3+6*i,this.poker.children[t-i-1].rotation=-3-6*i,this.poker.children[t-i-1].y=this.poker.children[t+i].y=45-Math.tan((3+6*i)*Math.PI/180)*(167.61-80)*(i+1)/3;else{this.poker.children[t].rotation=0,this.poker.children[t].y=45;for(i=0;i<t;i++)this.poker.children[t+i+1].rotation=6*(i+1),this.poker.children[t-i-1].rotation=-6*(i+1),this.poker.children[t-i-1].y=this.poker.children[t+i+1].y=45-Math.tan((6+6*i)*Math.PI/180)*(167.61-80)*(i+1)/3}},onClickRecordPlay:function(){this.socket().exec("startrecord",{})},onClickFindEmptyRoom:function(){var i=this;i.socket().exec("fnr",{}),cc.global.socket.on("fnr",function(e){var t=JSON.parse(e);i.alert(t.extmsg)})},showRaiseUp:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;e<=0||null==e||null==e?this.raiseup.active=!1:(this.raiseup.runAction(cc.sequence(cc.scaleTo(.2,1.3,1.3),cc.scaleTo(.1,.9,.9),cc.scaleTo(.2,1,1))),this.raiseup.active=!0,"normal"==cc.global.user.selplayway||"hnormal"==cc.global.user.selplayway?(this.raiseup.children[0].active=!0,this.raiseup.children[1].active=!1):"diamond"==cc.global.user.selplayway&&(this.raiseup.children[0].active=!1,this.raiseup.children[1].active=!0),this.raiseup.children[2].getComponent(cc.Label).string=this.numformat(e))},onToggleSetting:function(){var e=this;!1===e.show_setting?(e.show_setting=!0,e.settingback.active=!0,e.settinglayer.getComponent(cc.Animation).play("setting_show"),null!=e.hideSetting&&clearTimeout(e.hideSetting),e.hideSetting=setTimeout(function(){e.onToggleSetting()},3e3)):(e.settingback.active=!1,null!=e.hideSetting&&clearTimeout(e.hideSetting),e.settinglayer.getComponent(cc.Animation).play("setting_hide"),e.show_setting=!1)},onClickCardSort:function(){var e=this;null!=e.hideSetting&&clearTimeout(e.hideSetting),e.hideSetting=setTimeout(function(){e.onToggleSetting()},3e3);var t=JSON.parse(cc.sys.localStorage.getItem("carsort_order"));1==t?(t=0,this.settinglayer.children[2].children[1].children[0].children[0].active=!0,this.settinglayer.children[2].children[1].children[0].children[1].active=!1):(t=1,this.settinglayer.children[2].children[1].children[0].children[0].active=!1,this.settinglayer.children[2].children[1].children[0].children[1].active=!0),cc.sys.localStorage.setItem("carsort_order",JSON.stringify(t)),e.changeCardSortOrder()},onToggleSound:function(){var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));e=!e,cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(e)),e?(this.settinglayer.children[2].children[2].children[0].children[0].active=!0,this.settinglayer.children[2].children[2].children[0].children[1].active=!1,cc.audioEngine.resumeAll()):(this.settinglayer.children[2].children[2].children[0].children[0].active=!1,this.settinglayer.children[2].children[2].children[0].children[1].active=!0,cc.audioEngine.pauseAll())},onChangeTheme:function(){var e=this;null!=e.hideSetting&&clearTimeout(e.hideSetting),e.hideSetting=setTimeout(function(){e.onToggleSetting()},3e3),e.curTheme=e.changeGameTheme(),e.changeTheme(e.curTheme)},changeTheme:function(e){switch(e){case 1:this.background.children[0].active=!0,this.background.children[1].active=!1,this.bar_bottom.children[0].active=!0,this.bar_bottom.children[1].active=!1;for(var t=0;t<2;t++)this.buttons.children[t].children[0].active=!0,this.buttons.children[t].children[1].active=!1,this.buttons.children[2].children[t].children[0].active=!0,this.buttons.children[2].children[t].children[1].active=!1;this.roominfo.children[1].children[0].active=!0,this.roominfo.children[1].children[1].active=!1,this.roominfo.children[0].children[0].active=!0,this.roominfo.children[0].children[1].active=!1,this.settinglayer.children[0].active=!0,this.settinglayer.children[1].active=!1;for(t=0;t<this.settinglayer.children[2].children.length;t++)for(var i=0;i<this.settinglayer.children[2].children[t].children.length;i++){this.settinglayer.children[2].children[t].children[i].color=cc.hexToColor("#84bbee");for(var a=0;a<this.settinglayer.children[2].children[t].children[i].children.length;a++)this.settinglayer.children[2].children[t].children[i].children[a].color=cc.hexToColor("#84bbee")}break;case 2:this.background.children[0].active=!1,this.background.children[1].active=!0,this.bar_bottom.children[0].active=!1,this.bar_bottom.children[1].active=!0;for(t=0;t<2;t++)this.buttons.children[t].children[0].active=!1,this.buttons.children[t].children[1].active=!0,this.buttons.children[2].children[t].children[0].active=!1,this.buttons.children[2].children[t].children[1].active=!0;this.roominfo.children[1].children[0].active=!1,this.roominfo.children[1].children[1].active=!0,this.roominfo.children[0].children[0].active=!1,this.roominfo.children[0].children[1].active=!0,this.settinglayer.children[0].active=!1,this.settinglayer.children[1].active=!0;for(t=0;t<this.settinglayer.children[2].children.length;t++)for(i=0;i<this.settinglayer.children[2].children[t].children.length;i++){this.settinglayer.children[2].children[t].children[i].color=cc.hexToColor("#d3b67f");for(a=0;a<this.settinglayer.children[2].children[t].children[i].children.length;a++)this.settinglayer.children[2].children[t].children[i].children[a].color=cc.hexToColor("#d3b67f")}}if(this.player)for(t=0;t<this.player.length;t++)this.player[t].getComponent("FIVEPlayerRender").changeTheme(e,!1);this.game&&this.game.changeTheme(e);for(t=0;t<this.leftovercards.children.length;t++)this.leftovercards.children[t].getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("poker_back"+e);for(t=0;t<this.leftovercards3.children.length;t++)this.leftovercards3.children[t].getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("poker_back"+e)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],FIVEButton:[function(e,t,i){"use strict";cc._RF.push(t,"d0b844rPpJOMphTLuDaRVC7","FIVEButton");var a=e("HHCommon");cc.Class({extends:a,properties:{helpdlg:{default:null,type:cc.Prefab},setting:{default:null,type:cc.Prefab}},onLoad:function(){},start:function(){},onClickHelp:function(){cc.global.openwin=cc.instantiate(this.helpdlg),cc.global.openwin.getComponent("HelpDialog").init(this,3),cc.global.openwin.parent=this.root()},onSettingClick:function(){cc.global.openwin=cc.instantiate(this.setting),cc.global.openwin.parent=this.root(),cc.global.openwin.getComponent("SettingDialog").init()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],FIVEDataBind:[function(r,e,t){"use strict";cc._RF.push(e,"04b27H0FAdNgrpSI1Hno9ai","FIVEDataBind");var a=r("HHCommon");cc.Class({extends:a,properties:{player:{default:null,type:cc.Prefab},playerboard:{default:null,type:cc.Prefab},poker:{default:null,type:cc.Prefab},poker_min:{default:null,type:cc.Prefab},myself:{default:null,type:cc.Prefab},lastcards:{default:null,type:cc.Node},catchbtn:{default:null,type:cc.Node},callselnum:{default:null,type:cc.Node},flame_100:{default:null,type:cc.Node},btnbuybg:{default:null,type:cc.Node},callnums:{default:null,type:cc.Node},callnumatlas:{default:null,type:cc.SpriteAtlas},declaredlg:{default:null,type:cc.Node},declaredlg3:{default:null,type:cc.Node},cardexchange:{default:null,type:cc.Node},boardCallStatus:{default:null,type:cc.Node},playbtn:{default:null,type:cc.Node},notallow:{default:null,type:cc.Node},operesult:{default:null,type:cc.Node},cardtipmsg:{default:null,type:cc.Node},timerplaynum:{default:null,type:cc.Node},catchclock:{default:null,type:cc.Node},declareclock:{default:null,type:cc.Node},selfpos:cc.Node},onLoad:function(){for(5==cc.global.extparams.cond&&(this.declaredlg=this.declaredlg3),this.hasRP=!1,this.isRedTeam=!1,this.callRank=0,this.catchbtn&&(this.catchbtn.active=!1),this.playbtn&&(this.playbtn.active=!1),this.notallow&&(this.notallow.active=!1),this.operesult&&(this.operesult.active=!1),this.cardtipmsg&&(this.cardtipmsg.active=!1),(this.dizhu_databind_context=this).playerspool=new cc.NodePool,this.playerboardpool=new cc.NodePool,this.myselfpool=new cc.NodePool,this.pokerpool=new cc.NodePool,this.minpokerpool=new cc.NodePool,this.myselfpool,this.selectedcards=new Array,this.cardslist=new Array,i=0;i<5;i++)this.playerspool.put(cc.instantiate(this.player)),this.playerboardpool.put(cc.instantiate(this.playerboard));for(i=0;i<10;i++)this.pokerpool.put(cc.instantiate(this.poker));for(i=0;i<60;i++)this.minpokerpool.put(cc.instantiate(this.poker_min));this.myselfpool.put(cc.instantiate(this.myself)),this.ready()&&(this.pva_format(cc.global.user.goldcoins+0,cc.global.user.cards,0,cc.global.user.championexp,this),this.pvalistener(this,function(e){e.pva_format(cc.global.user.goldcoins,cc.global.user.cards,0,cc.global.user.championexp,e)})),this.canTouch=!1},initContext:function(e){this.game=e},initGamemode:function(e){e&&(this.declaredlg=this.declaredlg3)},addSelfPlayer:function(e,t){0<this.myselfpool.size()&&null!=cc.global&&(this.playermysql=this.myselfpool.get(),this.playermysql.parent=this.selfpos,this.playermysql.setPosition(0,-267),this.playermysql.getComponent("FIVEPlayerRender").initplayer(e,t,0,!1,!1))},giveContext:function(e){this.playermysql.getComponent("FIVEPlayerRender").giveContext(e)},changeStageInfo:function(e){this.playermysql.getComponent("FIVEPlayerRender").changeStageInfo(e)},showRoomNumber:function(e){this.playermysql.getComponent("FIVEPlayerRender").showRoomNumber(e)},updateCareerAfterMatch:function(e){this.playermysql.getComponent("FIVEPlayerRender").updateCareerAfterMatch(e)},pva_format:function(e,t,i,a,s){},initMasterCall:function(){this.catchbtn&&(this.catchbtn.active=!1,this.resetCallNumSelStatus()),this.declaredlg&&(this.declaredlg.active=!1,this.declaredlg.getComponent("DeclarePanel").clearAll()),this.boardCallStatus&&(this.boardCallStatus.active=!1,this.boardCallStatus.getComponent("BoardCallStatus").clearAll())},catchtimer:function(e,t){if(this.playbtn&&(this.playbtn.active=!1),this.catchbtn){this.myCallNum=0,this.resetCallNumSelStatus(),this.catchbtn.active=!0;var i=-1;1<t&&(i=5-(100-t)/5);for(var a=0;a<this.callnums.children.length;a++)this.callnums.children[a].active=!(a<=i)}this.operesult&&(this.operesult.active=!1);var s=r("GameTimer");this.rtgametimer=new s,this.timesrc=this.rtgametimer.runtimerBmpFnt(this,this.catchclock,e)},setLoseCoins:function(e){this.boardCallStatus&&this.boardCallStatus.getComponent("BoardCallStatus").setLoseCoins(e)},showBanker:function(){if(this.operesult){this.operesult.active=!0;for(var e=0;e<this.operesult.children.length;e++)this.operesult.children[e].active=!1;this.operesult.children[0].active=!0}},catchresult:function(e){this.catchbtn&&(this.catchbtn.active=!1),this.playbtn&&(this.playbtn.active=!1),this.timesrc&&this.rtgametimer.stoptimer(this,this.catchclock,this.timesrc),this.showCatchResult(e)},hideresult:function(){this.operesult&&(this.operesult.active=!1)},setRedTeam:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.playermysql.getComponent("FIVEPlayerRender").setRedTeam(e)},lasthands:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(this.playermysql.getComponent("FIVEPlayerRender").setRedTeam(!0),this.operesult&&(this.operesult.active=!1),100==e.ratio&&t){if(this.cardexchange){var a=this.decode(e.lasthands);this.cardexchange.active=!0,this.cardexchange.getComponent("CardExchange").init(this,a,e)}}else this.declaredlg&&(this.declaredlg.active=!0,this.declaredlg.getComponent("DeclarePanel").init(e,i))},showCardExchange:function(e){if(this.cardexchange){var t=this.decode(e.remains);this.cardexchange.active=!0,this.cardexchange.getComponent("CardExchange").init(this,t,e)}},hideDeclare:function(){this.declaredlg&&(this.declaredlg.active=!1)},callresult:function(e){if(this.hideDeclare(),e.callScore<100&&this.cardexchange){var t=this.decode(e.lasthands);this.cardexchange.active=!0,this.cardexchange.getComponent("CardExchange").init(this,t,e)}},updateBoardCallStatus:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.boardCallStatus&&(this.boardCallStatus.active=!0,this.boardCallStatus.getComponent("BoardCallStatus").init(this.game.boardCallStatus,t),e?this.boardCallStatus.getComponent(cc.Animation).play():this.boardCallStatus.getComponent("BoardCallStatus").showLoseCoins()),this.boardCallStatus.getComponent(cc.Animation).play()},changeresult:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.cardexchange&&(this.cardexchange.getComponent("CardExchange").finish(),this.cardexchange.active=!1);for(var i=0;i<this.game.poker.children.length;i++)this.game.poker.children[i].getComponent("HHCard").unselected();this.game.resortCardOrder(),100!=this.game.boardCallStatus.callScore||this.declaredlg&&(this.declaredlg.active=!0,this.declaredlg.getComponent("DeclarePanel").init(e,t))},lasttakecards:function(e,t,a,s){var r=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];this.result&&(this.result.active=!1),this.playbtn&&(this.playbtn.active=!1),this.catchbtn&&(this.catchbtn.active=!1),this.jsq&&(this.jsq.active=!1),this.lastcards&&(this.lastcards.active=!0),this.timesrc&&this.rtgametimer.stoptimer(this,this.catchclock,this.timesrc),this.playcards(t,i,a,s.type,r),this.lastcards.width=26*this.lastcards.children.length+108,0==s.red&&1==s.blue&&this.playermysql.getComponent("FIVEPlayerRender").setRedTeam(!1)},hidePlayBtn:function(){this.playbtn&&(this.playbtn.active=!1)},stopTimer:function(){this.timesrc&&this.rtgametimer.stoptimer(this,this.catchclock,this.timesrc),"luckyre"==cc.global.gamestatus&&(this.playbtn.active=!1)},showBetBalloon:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2;this.playermysql&&this.playermysql.getComponent("FIVEPlayerRender").showBetBalloon(e,t)},hideBalloon:function(){this.playermysql&&this.playermysql.getComponent("FIVEPlayerRender").hideBalloon()},cardtips:function(e,t,i){for(var a,s=0;s<e.pokercards.length;s++){var r=e.pokercards[s];if(r.getComponent("HHCard").card==t){a=r;break}}null!=a&&a.getComponent("HHCard").doselect()},cardtipsfornot:function(e,t){t.cardtipmsg.active=!0,setTimeout(function(){t.cardtipmsg.active=!1},1e3),t.unselected(e,t)},unselected:function(e,t){for(var i=0;i<e.pokercards.length;i++){var a=e.pokercards[i];if(a){var s=a.getComponent("HHCard");s&&s.unselected()}}},playcards:function(e,t,i,a){var s=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];if(this.lastcards.destroyAllChildren(),this.lastcards.removeAllChildren(),s)for(r=0;r<e.poker.children.length;r++)(n=e.poker.children[r].getComponent("HHCard"))&&(n.unselected(),n.touched=!1);for(var r=0;r<e.poker.children.length;r++){var n=e.poker.children[r].getComponent("HHCard");if(n&&n.card==i){e.poker.children[r].destroy(),e.poker.children[r].removeFromParent(!0);break}}e.repositionPokerCards();var o=cc.instantiate(this.poker_min);o.parent=this.lastcards,-1!=i&&(o.getComponent("HHCard").setCard(i),o.getComponent("HHCard").order())},playtimer:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this.playbtn.children[1].active=!0,this.playbtn.children[2].active=!1,this.playbtn.active=!1,null!=this.orgPosY&&(this.playbtn.y=this.orgPosY),this.catchbtn&&(this.catchbtn.active=!1),this.operesult&&(this.operesult.active=!1),4==i&&(this.orgPosY=this.playbtn.y,this.playbtn.active=!0,this.playbtn.children[1].active=!1,this.playbtn.children[2].active=!0,this.catchbtn.active=!1,this.operesult.active=!1);var a=r("GameTimer");this.rtgametimer=new a,this.timesrc=this.rtgametimer.runtimerBmpFnt(this,this.timerplaynum,t),this.checkCardAvailable(),this.playbtn&&(this.playbtn.active=!0)},checkCardAvailable:function(){if(null!=this.game.turnFirstCard){for(var e=0,t=0;t<this.game.poker.children.length;t++){var i=!0,a=(o=this.game.poker.children[t].getComponent("HHCard")).card%4+1,s=(o.card-o.card%4)/4+3;if(47<=this.game.turnFirstCard)47<=o.card?i=o.touched=!1:0!=this.game.boardCallStatus.masterSuit&&0!=this.game.boardCallStatus.masterRank?a==this.game.boardCallStatus.masterSuit&&s==this.game.boardCallStatus.masterRank&&(i=o.touched=!1):0!=this.game.boardCallStatus.masterSuit?a==this.game.boardCallStatus.masterSuit&&(i=o.touched=!1):0!=this.game.boardCallStatus.masterRank&&s==this.game.boardCallStatus.masterRank&&(i=o.touched=!1);else{var r=this.game.turnFirstCard%4+1,n=(this.game.turnFirstCard-this.game.turnFirstCard%4)/4+3;0!=this.game.boardCallStatus.masterSuit&&0!=this.game.boardCallStatus.masterRank?r==this.game.boardCallStatus.masterSuit&&n==this.game.boardCallStatus.masterRank?47<=o.card?i=o.touched=!1:n==s&&r==a&&(i=o.touched=!1):a==r&&(r==this.game.boardCallStatus.masterSuit?s!=this.game.boardCallStatus.masterRank&&o.card<=46&&(i=o.touched=!1):r!=this.game.boardCallStatus.masterSuit&&o.card<=46&&(i=o.touched=!1)):0!=this.game.boardCallStatus.masterSuit?r==this.game.boardCallStatus.masterSuit?47<=o.card?i=o.touched=!1:r==a&&(i=o.touched=!1):r==a&&o.card<=46&&(i=o.touched=!1):0!=this.game.boardCallStatus.masterRank&&(n==this.game.boardCallStatus.masterRank?47<=o.card?i=o.touched=!1:n==s&&(i=o.touched=!1):r==a&&s!=this.game.boardCallStatus.masterRank&&o.card<=46&&(i=o.touched=!1))}i&&(o.touched=!0,e++)}if(e==this.game.poker.children.length)for(t=0;t<this.game.poker.children.length;t++)(o=this.game.poker.children[t].getComponent("HHCard")).touched=!1;for(t=0;t<this.game.poker.children.length;t++){var o=this.game.poker.children[t].getComponent("HHCard");o.touched&&o.unselected()}}},showCatchResult:function(e){this.catchbtn.active=!1,this.operesult.active=!0;for(var t=0;t<this.operesult.children.length;t++)this.operesult.children[t].active=!1;if(e)if(1<parseInt(e.myratio)){this.operesult.children[2].active=!0;var i="game_buy_btn_"+e.myratio;this.operesult.children[2].getComponent(cc.Sprite).spriteFrame=this.callnumatlas.getSpriteFrame(i)}else this.operesult.children[1].active=!0,this.operesult.children[2].getComponent(cc.Sprite).spriteFrame=void 0},showPassLastTakes:function(){this.operesult.active=!0;for(var e=0;e<this.operesult.children.length;e++)this.operesult.children[e].active=!1;this.operesult.children[1].active=!0},doSelectCard:function(e){null==this.selectedcards.find(function(e){e.card})&&this.selectedcards.push(e)},doUnSelectCard:function(e){var t=this.selectedcards.indexOf(e);0<=t&&this.selectedcards.splice(t,1)},clean:function(e){if(this.catchbtn&&(this.catchbtn.active=!1),this.lastcards&&(this.lastcards.active=!1),this.operesult&&(this.operesult.active=!1),"no"==cc.global.amObserve&&this.playermysql){var t=this.playermysql.getComponent("FIVEPlayerRender");t&&(t.clean(e),t.removeTeamMark())}},cleanCards:function(e){this.cardslist.splice(0,this.cardslist.length),this.lastcards&&(this.lastcards.active=!1),this.operesult&&(this.operesult.active=!1)},restart:function(e){this.playerspool.clear(),this.playerboardpool.clear();for(var t=0;t<e;t++)this.playerspool.put(cc.instantiate(this.player)),this.playerboardpool.put(cc.instantiate(this.playerboard));for(this.pokerpool.clear(),this.minpokerpool.clear(),i=0;i<25;i++)this.pokerpool.put(cc.instantiate(this.poker));for(var i=0;i<60;i++)this.minpokerpool.put(cc.instantiate(this.poker_min));this.myselfpool.active=!0,this.myCallNum=0},disChPos:function(e){this.playermysql.getComponent("FIVEPlayerRender").disChPos(e)},disChSitPos:function(e){this.playermysql.getComponent("FIVEPlayerRender").disChSitPos()},disChEffectPos:function(){this.playermysql.getComponent("FIVEPlayerRender").disChEffectPos()},disUserCharacter:function(){this.playermysql.getComponent("FIVEPlayerRender").disUserCharacter()},showEmoticon:function(e){this.playermysql&&this.playermysql.getComponent("FIVEPlayerRender")&&this.playermysql.getComponent("FIVEPlayerRender").showEmoticon(e)},showCallPlayer:function(e,t){this.playermysql&&this.playermysql.getComponent("FIVEPlayerRender")&&this.playermysql.getComponent("FIVEPlayerRender").showCallPlayer(e,t)},onClickEmoticon:function(){this.playermysql&&this.playermysql.getComponent("FIVEPlayerRender")&&this.playermysql.getComponent("FIVEPlayerRender").onClickEmoticon()},onExchangeCard:function(e){for(var t=[],i=[],a=0;a<this.game.poker.children.length;a++){var s=this.game.poker.children[a],r=s.getComponent("HHCard");r.selected&&(t.push(s),i.push(parseInt(r.card)))}if(t.length==e.length&&0!=t.length&&0!=e.length){for(a=0;a<e.length;a++){var n=t[a].getComponent("HHCard");n.setCard(e[a].getComponent("HHCard").card),n.order(),n.doselect()}this.cardexchange.getComponent("CardExchange").cardReplace(i)}else this.alert("Please select exchange cards.")},resetCallNumSelStatus:function(){"no"==cc.global.amObserve&&(this.catchbtn.children[1].active=!1),this.btnbuybg.getComponent(cc.Sprite).spriteFrame=this.callnumatlas.getSpriteFrame("btn-buy-disabled"),this.callselnum.getComponent(cc.Sprite).spriteFrame=this.callnumatlas.getSpriteFrame("buy-select"),1==this.curTheme?this.callselnum.color=cc.hexToColor("#5BA4D8"):this.callselnum.color=cc.hexToColor("#efcd98")},onSelectCallNum:function(e,t){this.myCallNum=parseInt(t),this.btnbuybg.getComponent(cc.Sprite).spriteFrame=this.callnumatlas.getSpriteFrame("btn-buy"),this.callselnum.getComponent(cc.Sprite).spriteFrame=this.callnumatlas.getSpriteFrame("game_buy_"+this.myCallNum),this.callselnum.color=cc.hexToColor("#ffffff"),this.flame_100.active=!1,100==this.myCallNum&&(this.flame_100.active=!0,this.flame_100.getComponent(cc.Animation).play())},onClickBuyCallNum:function(){if(this.ready()){if(0==this.myCallNum)return void this.alert("Select a Level.");this.socket().exec("docatch",{extparams:{callx:this.myCallNum}})}},giveUpGame:function(){this.cardexchange&&(this.cardexchange.active=!1)},speech:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";if(this.playermysql){var t=this.playermysql.getComponent("FIVEPlayerRender");t&&t.speech(e)}},changeTheme:function(e){if(this.curTheme=e,this.playermysql&&this.playermysql.getComponent("FIVEPlayerRender").changeTheme(e,!0),1==e){this.catchbtn.children[2].children[0].active=this.declaredlg.children[2].children[0].active=!0,this.catchbtn.children[2].children[1].active=this.declaredlg.children[2].children[1].active=!1,this.catchbtn.children[3].getComponent(cc.Sprite).spriteFrame=this.declaredlg.children[3].getComponent(cc.Sprite).spriteFrame=this.callnumatlas.getSpriteFrame("game_buysetting_box_blue"),this.catchbtn.children[4].children[0].active=!0,this.catchbtn.children[4].children[1].active=!1,this.catchbtn.children[5].color=cc.hexToColor("#5BA4D8");for(var t=0;t<this.callnums.children.length;t++)this.callnums.children[t].children[0].color=cc.hexToColor("#BFF1FF");this.declaredlg.children[4].color=this.declaredlg.children[5].color=cc.hexToColor("#56ACFF"),this.boardCallStatus.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("panel_bg_blue"),this.boardCallStatus.children[1].children[0].color=this.boardCallStatus.children[2].children[0].color=cc.hexToColor("#56ACFF"),this.declaredlg.getComponent("DeclarePanel").tab_sd.getComponent(cc.Sprite).spriteFrame=this.declaredlg.getComponent("DeclarePanel").tab_ad.getComponent(cc.Sprite).spriteFrame=this.callnumatlas.getSpriteFrame("tab_selected_blue"),this.declaredlg.getComponent("DeclarePanel").tab_sd.children[0].color=this.declaredlg.getComponent("DeclarePanel").tab_ad.children[0].color=cc.hexToColor("#2C63A9"),this.declaredlg.getComponent("DeclarePanel").tab_sd.children[1].color=this.declaredlg.getComponent("DeclarePanel").tab_ad.children[1].color=cc.hexToColor("#85BFFA")}else{this.catchbtn.children[2].children[0].active=this.declaredlg.children[2].children[0].active=this.catchbtn.children[2].children[1].active=this.declaredlg.children[2].children[1].active=this.catchbtn.children[3].getComponent(cc.Sprite).spriteFrame=this.declaredlg.children[3].getComponent(cc.Sprite).spriteFrame=this.callnumatlas.getSpriteFrame("game_buysetting_box_brown"),this.catchbtn.children[4].children[0].active=!1,this.catchbtn.children[4].children[1].active=!0,this.catchbtn.children[5].color=cc.hexToColor("#efcd98");for(t=0;t<this.callnums.children.length;t++)this.callnums.children[t].children[0].color=cc.hexToColor("#fedf9d");this.declaredlg.children[4].color=this.declaredlg.children[5].color=cc.hexToColor("#d6bb85"),this.boardCallStatus.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("panel_bg_brown"),this.boardCallStatus.children[1].children[0].color=this.boardCallStatus.children[2].children[0].color=cc.hexToColor("#fedf9d"),this.declaredlg.getComponent("DeclarePanel").tab_sd.getComponent(cc.Sprite).spriteFrame=this.declaredlg.getComponent("DeclarePanel").tab_ad.getComponent(cc.Sprite).spriteFrame=this.callnumatlas.getSpriteFrame("tab_selected_brown"),this.declaredlg.getComponent("DeclarePanel").tab_sd.children[0].color=this.declaredlg.getComponent("DeclarePanel").tab_ad.children[0].color=cc.hexToColor("#8e6e3e"),this.declaredlg.getComponent("DeclarePanel").tab_sd.children[1].color=this.declaredlg.getComponent("DeclarePanel").tab_ad.children[1].color=cc.hexToColor("#d9ba91")}}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],FIVEPlayerBoardRender:[function(s,e,t){"use strict";cc._RF.push(e,"53559AkWyRGza9ee+emtaHz","FIVEPlayerBoardRender");var i=s("HHCommon");cc.Class({extends:i,properties:{seatid:{default:null,type:cc.Label},dizhu:{default:null,type:cc.Node},callstat:{default:null,type:cc.Node},pokertag:{default:null,type:cc.Node},pokercards:{default:null,type:cc.Label},timer:{default:null,type:cc.Node},jsq:{default:null,type:cc.Node},amready:{default:null,type:cc.Node},banker:{default:null,type:cc.Node},catchplayresult:{default:null,type:cc.Node},timer_num:{default:null,type:cc.Label},lastcards:{default:null,type:cc.Node},donot:{default:null,type:cc.Node},effect:{default:null,type:cc.Node},cardbg:{default:null,type:cc.Prefab},cardspanel:{default:null,type:cc.Node},flame_100:{default:null,type:cc.Node},callnumatlas:{default:null,type:cc.SpriteAtlas},boardRemainCards:cc.Array},onLoad:function(){this.cardcount=0,this.cardslist=new Array,this.isRight=!1,this.remaincards=new Array,this.isFirstTheme=!0},initplayer:function(e,t,i,a){if(this.parent=e,this.curTheme=e.curTheme,1<=i&&(this.seatid.string=i),this.userdata=t,this.userid=t.id,this.isRight=a,1==(this.seatid=i)||2==i){this.timer.scaleX=-1*this.timer.scaleX,this.jsq.x=-this.jsq.x,this.banker.x=-this.banker.x,this.amready.scaleX=-1*this.amready.scaleX,this.callstat.scaleX=-1*this.callstat.scaleX,this.effect.scaleX=-1*this.effect.scaleX;for(var s=0;s<this.effect.children.length;s++)this.effect.children[s].x=-1*this.effect.children[s].x;for(s=0;s<this.catchplayresult.children.length;s++)this.catchplayresult.children[s].x=-1*this.catchplayresult.children[s].x;this.catchplayresult.x=-this.catchplayresult.x,this.lastcards.x=-this.lastcards.x,this.flame_100.x=-this.flame_100.x,this.oriposx=this.lastcards.x,this.cardspanel.getComponent(cc.Layout).horizontalDirection=cc.Layout.HorizontalDirection.RIGHT_TO_LEFT}this.jsq&&(this.jsq.active=!1),this.banker&&(this.banker.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.parent.notReplay?this.cardspanel.active=!1:this.cardspanel.active=!0,this.changeTheme(this.curTheme)},updateCareerAfterMatch:function(e){this.userdata.goldcoins=e.gold,this.goldcoins.string=this.numformat(e.gold+e.diamond),this.userdata.nickname.indexOf("Com")<0&&(this.userdata.record.matchcount=e.totalmatches,this.userdata.record.win=e.winmatches,this.userdata.record.loss=e.lossmatches,this.userdata.record.draw=e.drawmatches,this.userdata.record.normalrank=e.normalrank,this.userlevel.string=this.numformat(e.normalrank)+"th")},countcards:function(e){this.cardcount=this.cardcount+e,this.resetcards(this.cardcount)},setCards:function(e){for(var t=0;t<e.length;t++){var i=this.cardspanel.children[t].getComponent("HHCard");i.setCard(e[t]),i.order()}this.resortCardOrder()},resetcards:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.cardspanel.removeAllChildren();var i=this.parent.notReplay;if(this.parent.notReplay?this.cardspanel.active=!1:this.cardspanel.active=!0,this.cardcount=e,i&&0==t&&(e=0<e?1:0),0<e){if(this.isRight)for(s=0;s<e;s++){var a=cc.instantiate(this.cardbg);a.parent=this.cardspanel,a.scaleX=-a.scaleX}else for(s=0;s<e;s++){cc.instantiate(this.cardbg).parent=this.cardspanel}for(var s=0;s<this.cardspanel.children.length;s++)this.cardspanel.children[s].children[3].getComponent(cc.Label).string="";i&&0==t&&0<this.cardspanel.children.length&&(this.cardspanel.children[this.cardspanel.children.length-1].children[3].active=i,this.cardspanel.children[this.cardspanel.children.length-1].children[3].getComponent(cc.Label).string=this.cardcount)}},cleanCards:function(){this.cardspanel.active=!1},cleanLastCards:function(e){if(0<this.cardslist.length){for(var t=0;t<this.cardslist.length;t++)e.minpokerpool.put(this.cardslist[t]);this.cardslist.splice(0,this.cardslist.length)}this.lastcards&&(this.lastcards.active=!1)},showCardsPanel:function(){this.parent.notReplay?this.cardspanel.active=!1:this.cardspanel.active=!0},catchtimer:function(e){this.jsq&&(this.jsq.active=!0),this.banker&&(this.banker.active=!1),this.donot&&(this.donot.active=!1);var t=s("GameTimer");this.rtgametimer=new t,this.timesrc=this.rtgametimer.runtimer(this,this.jsq,this.atlas,this.timer_num,this.timer_num,e)},showBanker:function(){this.banker&&(this.banker.active=!0)},pauseTimer:function(){this.rtgametimer&&this.rtgametimer.pauseTimer(this,this.jsq,this.timesrc)},resumeTimer:function(){this.rtgametimer&&(this.timesrc=this.rtgametimer.resumeTimer(this,this.jsq,this.timer_num))},stopTimer:function(){this.rtgametimer&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc)},catchresult:function(e){if(this.rtgametimer&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),e)if(1<parseInt(e.myratio)){this.donot.active=!1;var t="game_buy_btn_"+e.myratio;this.catchplayresult.children[1].getComponent(cc.Sprite).spriteFrame=this.callnumatlas.getSpriteFrame(t),100==e.myratio?(this.flame_100.active=!0,this.flame_100.getComponent(cc.Animation).play()):this.flame_100.active=!1}else this.donot.active=!0,this.catchplayresult.children[1].getComponent(cc.Sprite).spriteFrame=""},hideresult:function(){this.banker&&(this.banker.active=!1),this.donot&&(this.donot.active=!1,this.catchplayresult.children[1].getComponent(cc.Sprite).spriteFrame="")},lasthands:function(e,t,i){this.hideBanker(),this.rtgametimer&&this.timesrc&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),this.playtimer(t,i.timer)},callresult:function(e,t){this.stopTimer(),this.playtimer(e,t.timer)},changeresult:function(e,t){this.stopTimer(),this.playtimer(e,t.timer)},hideBanker:function(){},setRedTeam:function(e){if(!e)return this.avatar_outline.color=new cc.Color(255,0,0),void(this.info_outline.color=new cc.Color(255,0,0));this.userid==e.userid?(this.avatar_outline.color=new cc.Color(255,0,0),this.info_outline.color=new cc.Color(255,0,0)):(this.avatar_outline.color=new cc.Color(255,255,255),this.info_outline.color=new cc.Color(255,255,255))},removeTeamMark:function(){this.avatar_outline.color=new cc.Color(255,255,255),this.info_outline.color=new cc.Color(255,255,255)},lasttakecards:function(e,t,i,a,s){var r=!(5<arguments.length&&void 0!==arguments[5])||arguments[5],n=t.notReplay;if(this.rtgametimer&&this.timesrc&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),this.banker&&(this.banker.active=!1),this.donot&&(this.donot.active=!1),this.jsq&&(this.jsq.active=!1),this.lastcards&&(this.lastcards.active=!0),0<this.cardslist.length){for(var o=0;o<this.cardslist.length;o++)e.minpokerpool.put(this.cardslist[o]);this.cardslist.splice(0,this.cardslist.length)}r&&(n?null!=i&&this.resetcards(i):(this.boardRemainCards=[],""!=s.playercards&&null!=s.playercards?(this.boardRemainCards=this.decode(s.playercards),this.resetcards(this.boardRemainCards.length,this.boardRemainCards),this.setCards(this.boardRemainCards)):this.resetcards(0))),this.playcards(e,o,a,s.type)},tipcannot:function(){this.banker&&(this.banker.active=!1),this.donot&&(this.donot.active=!1)},tipdonot:function(){this.banker&&(this.banker.active=!1),this.donot&&(this.donot.active=!0)},playcards:function(e,t,i,a){this.lastcards.destroyAllChildren(),this.lastcards.removeAllChildren();var s=e.minpokerpool.get();s.parent=this.lastcards,this.cardslist.push(s);var r=s.getComponent("HHCard");r.setCard(i),-1==i?r.init():r.order()},countcard:function(e,t){return parseInt(e/4)},playtimer:function(e,t){null!=this.orgPos&&this.jsq.setPosition(this.orgPos),this.banker&&(this.banker.active=!1),this.donot&&(this.donot.active=!1),this.lastcards&&(this.lastcards.active=!1);for(var i=0;i<this.cardslist.length;i++)e.minpokerpool.put(this.cardslist[i]);if("luckyre"==cc.global.gamestatus)switch(this.orgPos=this.jsq.position,this.seatid){case 0:this.jsq.y=this.jsq.y-40;break;case 1:this.jsq.x=this.jsq.x+40;break;case 2:case 3:this.jsq.y=this.jsq.y+40;break;case 4:this.jsq.x=this.jsq.x-40}var a=s("GameTimer");this.rtgametimer=new a,this.timesrc=this.rtgametimer.runtimer(this,this.jsq,this.atlas,this.timer_num,this.timer_num,t)},clean:function(e){for(var t=0;t<this.cardslist.length;t++)e.minpokerpool.put(this.cardslist[t]);this.jsq&&(this.jsq.active=!1),this.banker&&(this.banker.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.cardcount=0},giveContext:function(e){this.dizhucontxt=e},changeStageInfo:function(e){this.getLanguageText("BOARD_SCORE");var t=": "+e;this.box_stageinfo.string=t},showRoomNumber:function(e){var t=this.getLanguageText("ROOM_0");this.box_roominfo.string=e+t},hideEffect:function(e){var t=this;setTimeout(function(){t.effect&&(t.effect.children[e].active=!1)},1500)},showEffect:function(e){this.effect.children[e].active=!0;var t=this.effect.children[e].getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"tongqian",!1),cc.global.audio.playEffectAud("call"),this.hideEffect(e)},disCardtips:function(e){for(a=0;a<this.cardspanel.children.length;a++)this.cardspanel.children[a].y=0;if(0<e){for(var t=new Array,i=new Array,a=0;a<this.cardspanel.children.length;a++)t.push(a);var s=0;for(a=0;a<e;a++)i.push(t[s]),t.splice(s,1),s=(s+3)%t.length;for(a=0;a<i.length;a++)this.cardspanel.children[i[a]].y=10}},display:function(e){for(var t=" [",i=0;i<e.length;i++)t=t+e[i]+" , ";t+="]"},resortCardOrder:function(){var e=JSON.parse(cc.sys.localStorage.getItem("carsort_order"));if(null==e&&(e=!1),1==e)for(t=0;t<this.cardspanel.children.length;t++)this.cardspanel.children[t].zIndex=this.getCardzIndex(this.cardspanel.children[t].getComponent("HHCard").card);else for(var t=0;t<this.cardspanel.children.length;t++)this.cardspanel.children[t].zIndex=1e3-this.getCardzIndex(this.cardspanel.children[t].getComponent("HHCard").card);this.layoutPokerCard()},layoutPokerCard:function(){for(var e=0;e<this.cardspanel.children.length;e++)this.cardspanel.children[e].y=0;this.layout(this.cardspanel,function(e,t){return e.zIndex-t.zIndex})},getCardzIndex:function(e){var t=this.parent.boardCallStatus.masterSuit,i=this.parent.boardCallStatus.masterRank,a=e%4,s=100*a;return 52<=e&&(s=700),47==e&&(s=600),48<=e&&e<=51&&(s=500),a+1==t&&0==i&&e<=46&&(s=400),(e-e%4)/4+3==i&&0==t&&e<=46&&(s=400),s+e},changeTheme:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;this.curTheme=e}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],FIVEPlayerRender:[function(e,t,i){"use strict";cc._RF.push(t,"cf4b2n2PAxDnJdIZbdlM4IO","FIVEPlayerRender");var a=e("HHCommon");cc.Class({extends:a,properties:{seatid:{default:null,type:cc.Label},username:{default:null,type:cc.Label},goldcoins:{default:null,type:cc.Label},freeicon:{default:null,type:cc.Node},dizhu:{default:null,type:cc.Node},callstat:{default:null,type:cc.Node},avatar:{default:null,type:cc.Sprite},avatar_outline:{default:null,type:cc.Node},info_outline:{default:null,type:cc.Node},userinfo:{default:null,type:cc.Prefab},userinfopan:{default:null,type:cc.Node},userinfosubpan:{default:null,type:cc.Node},leave:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},bubble:{default:null,type:cc.Node},btncharacter:{default:null,type:cc.Node},redteammark:{default:null,type:cc.Node}},onLoad:function(){this.isRight=!1,this.isFirstTheme=!0},initplayer:function(e,t,i,a,s){this.parent=e,1<=i&&(this.seatid.string=i),this.curTheme=e.curTheme,this.seatidx=i,this.userdata=t,this.username.string=t.nickname,this.userid=t.id,this.avatarurl=t.avatarurl,this.playcharacter=t.playcharacter,this.loadAvatar(t.avatarurl,t.gender),1==(this.isRight=a)&&(this.callplayer.children[0].scaleX=-1*this.callplayer.children[0].scaleX,this.callplayer.children[0].anchorX=1,this.userinfosubpan.scaleX=-1*this.userinfosubpan.scaleX,this.bubble.children[0].scaleX=-1*this.bubble.children[0].scaleX,this.redteammark.scaleX=-1*this.redteammark.scaleX),this.userlevel&&(1==cc.global.championMode||cc.global.championMode,this.userlevel.string=t.explevel+"lv/"+this.numformat(t.rank)+"th"),this.expscore&&(1==cc.global.championMode||cc.global.championMode,this.expscore.string=this.numformat(t.exp)+"/"+this.numformat(t.texp)),this.jsq&&(this.jsq.active=!1),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(t.goldcoins))),this.goldcoins.node.parent.active=!0,this.changeTheme(this.curTheme)},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},updateCareerAfterMatch:function(e){this.userdata.goldcoins=e.gold,this.goldcoins.string=this.numformat(e.gold)},takecards:function(e){0==e.selfcall&&1==e.sameside&&this.setRedTeam(!1)},showBanker:function(){},setRedTeam:function(e){e?(this.redteammark.children[0].active=!0,this.redteammark.children[1].active=!1):(this.redteammark.children[0].active=!1,this.redteammark.children[1].active=!0)},removeTeamMark:function(){this.redteammark.children[0].active=this.redteammark.children[1].active=!1},hideLeaveReq:function(){this.leave.active=!1},clean:function(e){this.dizhu&&(this.dizhu.active=!1,this.avatar_outline.color=cc.hexToColor("#FFFFFF"),this.info_outline.color=cc.hexToColor("#FFFFFF")),this.jsq&&(this.jsq.active=!1),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.cardcount=0},onClickDisInfo:function(){this.parent.notReplay&&(this.userid==cc.global.user.id?this.onClickEmoticon():this.onclickCallPlayer())},disLeaveReq:function(e){this.leave.active=e},showCallPlayer:function(e,t){var i=this;this.hideCallPlayer(),cc.global.audio.playVoiceChatWithType(this.playcharacter,t),this.callplayer.active=!0,this.callplayer.children[0].children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},showBetBalloon:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2;if(""!=e&&null!=e){var i=this;i.bubble.active=!0,i&&i.bubble&&(i.bubble.children[0].getComponent(cc.Label).string=e),0<t&&setTimeout(function(){i&&i.bubble&&(i.bubble.active=!1)},1e3*t)}},hideBalloon:function(){this.bubble.active=!1},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onClickEmoticon:function(){this.dizhucontxt.onClickEmoticon()},onclickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userid},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},giveContext:function(e){this.dizhucontxt=e},disUserCharacter:function(){},speech:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=this.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)},disChPos:function(e){},changeTheme:function(e,t){this.curTheme=e,this.avatar_outline.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("head_frame"+e)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],FIVESummaryDetail:[function(e,t,i){"use strict";cc._RF.push(t,"3da34/xLhlBHoVuJQyS6FXa","FIVESummaryDetail");var a=e("HHCommon");cc.Class({extends:a,properties:{workitem:{default:null,type:cc.Node},myscore:{default:null,type:cc.Label},myexpscore:{default:null,type:cc.Label},mycareer:{default:null,type:cc.Label},myscoretype:{default:null,type:cc.Node},player_1_score:{default:null,type:cc.Label},player_1_expscore:{default:null,type:cc.Label},player_1_career:{default:null,type:cc.Label},player_1_scoretype:{default:null,type:cc.Node},player_2_score:{default:null,type:cc.Label},player_2_expscore:{default:null,type:cc.Label},player_2_career:{default:null,type:cc.Label},player_2_scoretype:{default:null,type:cc.Node},player_3_score:{default:null,type:cc.Label},player_3_expscore:{default:null,type:cc.Label},player_3_career:{default:null,type:cc.Label},player_3_scoretype:{default:null,type:cc.Node},player_4_score:{default:null,type:cc.Label},player_4_expscore:{default:null,type:cc.Label},player_4_career:{default:null,type:cc.Label},player_4_scoretype:{default:null,type:cc.Node},mygetout:{default:null,type:cc.Node},player1getout:{default:null,type:cc.Node},player2getout:{default:null,type:cc.Node},player3getout:{default:null,type:cc.Node},player4getout:{default:null,type:cc.Node},base:{default:null,type:cc.Node},win:{default:null,type:cc.Node},draw:{default:null,type:cc.Node},lose:{default:null,type:cc.Node},judge:{default:null,type:cc.Node},player_2:{default:null,type:cc.Node},player_3:{default:null,type:cc.Node},effect:cc.Node},onLoad:function(){this.disDialogEffect(this.base);var t=this;this.workitem.on("getout",function(e){cc.global.backToHall=!0,cc.global.user.roomid="",t.parent.loadding(),t.parent.rerenderPlayers=[],t.parent.isOnSummary=!1,t.parent.scene("hall",t.parent),e.stopPropagation()}),1==cc.global.game_theme_idx?(this.node.children[2].children[0].active=!0,this.node.children[2].children[1].active=!1):(this.node.children[2].children[0].active=!1,this.node.children[2].children[1].active=!0),this.node.height*=cc.global.narrowContentRatio;var e=this;this.iswin=!1,this.effect.getComponent(sp.Skeleton).setCompleteListener(function(){e.iswin?e.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_winloop",!0):e.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_loseloop",!0)})},create:function(e,t,i){var a=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=this;this.parent=e,this.obsmode=i;for(var r=0;r<t.players.length;r++){var n=t.players[r];if(n.userid==cc.global.user.id&&"no"==cc.global.amObserve)this.process(n,null,this.myscore,this.myexpscore,null,null,this.mycareer,this.myscoretype),this.makeTitle(t.title,n),"no"==cc.global.amObserve&&(n.getout?setTimeout(function(){s&&s.node&&s.node.dispatchEvent(new cc.Event.EventCustom("getout",!0))},4500):setTimeout(function(){s&&s.node&&(s.parent.restart(),s.parent.summarypage.destroy(),s.parent.summarypage=null)},5e3));else switch(e.getPlayer(n.userid).seatidx){case 0:this.process(n,null,this.myscore,this.myexpscore,null,this.mygetout,this.mycareer,this.myscoretype);break;case 1:this.process(n,null,this.player_1_score,this.player_1_expscore,null,this.player1getout,this.player_1_career,this.player_1_scoretype);break;case 2:this.process(n,null,this.player_2_score,this.player_2_expscore,null,this.player2getout,this.player_2_career,this.player_2_scoretype);break;case 3:this.process(n,null,this.player_3_score,this.player_3_expscore,null,this.player3getout,this.player_3_career,this.player_3_scoretype);break;case 4:this.process(n,null,this.player_4_score,this.player_4_expscore,null,this.player4getout,this.player_4_career,this.player_4_scoretype)}}a&&(this.player_2.active=!1,this.player_3.active=!1),"yes"==cc.global.amObserve&&setTimeout(function(){s&&s.node&&(s.parent.restart(),s.parent.summarypage.destroy(),s.parent.summarypage=null)},5e3)},process:function(e,t,i,a,s,r,n,o){0<=e.score?i.string="+ "+this.numformat(e.score):i.string="- "+this.numformat(-1*e.score),0<=e.exp?a.string="+ "+this.numformat(e.exp):a.string="- "+this.numformat(-1*e.exp),null!=r&&(r.active=e.getout),"normal"==cc.global.user.selplayway?(o.children[0].active=!0,o.children[1].active=!1):"diamond"==cc.global.user.selplayway&&(o.children[0].active=!1,o.children[1].active=!0)},disLevelInfo:function(e,t){this.win.active=!1,this.draw.active=!1,this.lose.active=!1,this.judge.active=!1,this.effect.active=!1,"suicide"!=t&&(2==e.win?(this.iswin=!0,this.effect.active=!0,this.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_win",!1),cc.global.audio.playSummaryAud("win")):(1==e.win?"punish"==t?this.judge.active=!0:this.draw.active=!0:"punish"==t?this.judge.active=!0:(this.iswin=!1,this.effect.active=!0,this.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_lose",!1)),cc.global.audio.playSummaryAud("lose")))},makeTitle:function(e,t){this.disLevelInfo(t,e)},onLeaveClick:function(){this.parent.onclickBack()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],FiveDeclareCard:[function(e,t,i){"use strict";cc._RF.push(t,"70b63bqPkdJg6CjLZiDVuEj","FiveDeclareCard");var a=e("HHCommon");cc.Class({extends:a,properties:{sm_card_suit:{default:null,type:cc.Node},sm_card_suit_big:{default:null,type:cc.Node},sm_card_num:{default:null,type:cc.Node},card_suit:{default:null,type:cc.Node},card_num:{default:null,type:cc.Node},card_type:{default:null,type:cc.Node},card_type_label:{default:null,type:cc.Node},bg:{default:null,type:cc.Node},atlas:{default:null,type:cc.SpriteAtlas}},onLoad:function(){this.init(0,0),this.sm_card_suit.active=!1,this.sm_card_num.active=!1,this.sm_card_suit_big.active=!1,this.card_suit.active=!1,this.card_num.active=!1,this.card_type.active=!1,this.card_type_label.active=!1,this.bg.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("b-small_bg"),this.opacity=0},init:function(e,t,i,a){if(this.sm_card_suit.active=!1,this.sm_card_num.active=!1,this.sm_card_suit_big.active=!1,this.card_suit.active=!1,this.card_num.active=!1,this.card_type.active=!1,this.card_type_label.active=!1,(this.node.opacity=0)!=e||0!=t||a){this.node.opacity=255;var s="",r="";if(a)this.card_type_label.getComponent(cc.Label).string="First Money",this.card_type_label.active=!0;else if(0<e&&e<=15&&0<t&&t<=4){13==(n=e-1)?n=0:14==n&&(n=1),s="b-bigtag_"+(t-1).toString(),r="b-"+(t%2==0?"black":"red")+"_"+n.toString(),this.sm_card_suit.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(s),this.sm_card_num.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(r),this.sm_card_suit.active=!0,this.sm_card_num.active=!0}else if(0<e&&e<=15&&0==t){var n;13==(n=e-1)?n=0:14==n&&(n=1),r="b-black_"+n.toString(),this.card_num.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(r),this.card_num.active=!0}else 0==e&&0<t&&t<=4?(s="b-bigtag_"+(t-1).toString(),this.card_suit.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(s),this.card_suit.active=!0):15==e&&0==t?(this.card_type_label.getComponent(cc.Label).string="Master 2",this.card_type_label.active=!0):16==e&&5==t?(this.card_type.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("b-bigtag_4"),this.card_type.active=!0):17==e&&6==t?(this.card_type.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("b-bigtag_5"),this.card_type.active=!0):7==t?(this.card_type.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("call_firstmoney"),this.card_type.active=!0):8==t&&(this.card_type.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("call_alone"),this.card_type.active=!0)}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],Floor:[function(e,t,i){"use strict";cc._RF.push(t,"819b7vsLg5LFKhuUXmFm0C4","Floor"),Object.defineProperty(i,"__esModule",{value:!0}),i.Floor=void 0;var a=function(){function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}}(),s=e("./Wall");i.Floor=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.Wall),a(t,[{key:"onTouch",value:function(e){var t,i=e.getSpeedy();if(0<i){if(e.isStop())return e.stopAll(),e.setY(this.coordinate),void e.stopRolling();var a=e.getLasty(),s=e.getY(),r=e.getLastspeedy();if(i-r<2)t=(i-r)/2;else t=r+(i-r)*(this.coordinate-a)/(s-a);e.setY(this.coordinate);var n=t*this.rate;n<5?(e.stopY(),this.updateRolling(e)):(this.updateRolling(e),e.setSpeedy(-n)),this.updateBallFrames(e)}}},{key:"updateRolling",value:function(e){var t=e.getSpeedz()-10;t<-20&&(t=-20),e.setSpeedz(t)}},{key:"updateBallFrames",value:function(e){e.setRollingSpeed(.04467507*e.getSpeedz())}},{key:"isCross",value:function(e){return e.getY()>this.getCoordinate()}}]),t}();cc._RF.pop()},{"./Wall":"Wall"}],FrontWall:[function(e,t,i){"use strict";cc._RF.push(t,"4b6acoBK/lG1aKM7vQH8Okg","FrontWall"),Object.defineProperty(i,"__esModule",{value:!0}),i.FrontWall=void 0;var a=function(){function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}}(),s=e("./Wall");i.FrontWall=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.Wall),a(t,[{key:"onTouch",value:function(e){e.setStop(!0),e.setZ(this.coordinate),e.stopZ(),e.stopX(),e.stopRolling()}},{key:"isCross",value:function(e){return e.getZ()<this.getCoordinate()}}]),t}();cc._RF.pop()},{"./Wall":"Wall"}],FtkBegin:[function(e,t,i){"use strict";cc._RF.push(t,"bcd95rtMTJKpIwPN7ih2lBe","FtkBegin");var a=e("HHCommon"),s=e("Deck"),r=e("FtkSelCardsEngine");cc.Class({extends:a,properties:{global:{default:null,type:cc.Node},poker:{default:null,type:cc.Node},ratio:{default:null,type:cc.Label},summary:{default:null,type:cc.Prefab},touch:{default:null,type:cc.Node},effect:{default:null,type:cc.Node},players:{default:null,type:cc.Node},btn_enter:{default:null,type:cc.Node},roomid:{default:null,type:cc.Label},leavereq:{default:null,type:cc.Node},chat:{default:null,type:cc.Prefab},emodlg:{default:null,type:cc.Prefab},lbl_task:{default:null,type:cc.Label},unselect:{default:null,type:cc.Node},roominfo:{default:null,type:cc.Node},roomscore:{default:null,type:cc.Label},roomnumber:{default:null,type:cc.Label},observer:{default:null,type:cc.Prefab},obsbench:{default:null,type:cc.Node},obsbench1:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},obschatbtn:{default:null,type:cc.Node},obsemojibtn:{default:null,type:cc.Node},btn_record_play:{default:null,type:cc.Node},lbl_record_status:{default:null,type:cc.Label},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},roomCondition:0,turnscoreval:0,lastcardprefab:{default:null,type:cc.Prefab},background:{default:null,type:cc.Node},buttons:{default:null,type:cc.Node},switchtogame:{default:null,type:cc.Node},raiseAni:{default:null,type:cc.Node},soundbtn:cc.Node,remaincardpanel:cc.Node,turnscore:cc.Label},onLoad:function(){var e=this;e.switchtogame.active=!0,e.switchtogame.getComponent(cc.Animation).play("door_open"),cc.global.audio.playEffectAud("door"),setTimeout(function(){e.onStartGame()},700),this.curTheme=parseInt(cc.global.game_theme_idx),this.changeTheme(this.curTheme),this.turnscoreval=0,this.resetTurnScore(this,this.turnscoreval),this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged(),this.remaincardpanel.active=!1},onStartGame:function(){this.show_setting=!1,this.initEventCallback(),cc.game.setFrameRate(30),this.curBgIdx=1,this.goRecovery=!1,this.initUI(),this.playerSlotPos=[cc.v2(-551/cc.global.narrowContentRatio,-79.4),cc.v2(551/cc.global.narrowContentRatio,-79.4),cc.v2(551/cc.global.narrowContentRatio,149),cc.v2(-551/cc.global.narrowContentRatio,149)],this.altplayerSlotPos=[cc.v2(-551/cc.global.narrowContentRatio,-229.4),cc.v2(551/cc.global.narrowContentRatio,-229.4),cc.v2(551/cc.global.narrowContentRatio,99),cc.v2(-551/cc.global.narrowContentRatio,99)],this.player=new Array,this.observerlist=new Array,this.pokercards=new Array,this.lastcards=new Array,this.cardsArr=new Array,this.summarypage=null,this.inited=!1,this.lasttip=null,this.score="1",this.play_status=0,this.rerenderPlayers=[],this.isOnSummary=!1,this.notReplay=!0,this.gameCleaned=!1,cc.global.amObserve="no",null!=cc.global&&(""!=cc.global.user.roomid&&this.recovery(),this.initgame()),cc.global.watchReplayData.onReplay&&this.prepareReplay(),this.deck=new s,this.engine=new r,this.touch.width=this.touch.width/cc.global.narrowContentRatio,this.boardRatio=1},initUI:function(){cc.global.audio.playBGM("bgm_card");JSON.parse(cc.sys.localStorage.getItem("show_record"));JSON.parse(cc.sys.localStorage.getItem("sfx_on1"))?(this.soundbtn.children[1].active=!0,this.soundbtn.children[0].active=!1):(this.soundbtn.children[0].active=!0,this.soundbtn.children[1].active=!1)},prepareReplay:function(){this.notReplay=!1,cc.global.amObserve="yes",this.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),this.replay_bar.active=!0,this.replayStep="ready_room",this.replaySeq=0,this.replayTimeDelay=0,this.createReplayTimer(),this.buttons.children[2].active=!1},createReplayTimer:function(){var e=this;this.replayTimer=setInterval(function(){e.play_history&&(e.replayTimeDelay-=30*cc.global.watchReplayData.replaySpeedX,e.replayTimeDelay<=0&&e.play_history[e.replaySeq]&&e.goReplay())},30)},pauseReplayTimer:function(){clearInterval(this.replayTimer)},resumeReplayTimer:function(){this.createReplayTimer()},goReplay:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=!1;switch(this.replayStep){case"ready_room":this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"play":t=!0,this.replay_play_event(i,this);break;case"catch":this.catch_event(i,this);break;case"catchresult":this.catchresult_event(i,this);break;case"lasthands":this.lasthands_event(i,this);break;case"ftknewcards":this.ftknewcards_event(i,this);break;case"bet":t=!0,this.takecards_event(i,this);break;case"newturn":t=!0,this.newturn_event(i,this);break;case"stips":t=!0,this.seltips_event(i,this);break;case"ratio":t=!0,this.ratio_event(i,this);break;case"allcards":t=!0,this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.selemoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"players":this.players_event(i,this);break;case"exit":this.leave_event(i,this)}}""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,this.play_history[this.replaySeq]||(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.pauseReplayTimer()),e&&!t&&this.goReplay(!0)},exitPlay:function(){cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearInterval(this.replayTimer),clearTimeout(this.deal1_timer),clearTimeout(this.deal2_timer),clearTimeout(this.bankerSelfTimer),clearTimeout(this.bankerOtherTimer),this.rerenderPlayers=[],this.isOnSummary=!1,this.returnToHall()},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.gameTimerSpeedChange(!0),this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):(this.replayTimer&&clearInterval(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.gameTimerSpeedChange(!1),this.replay_bar.children[0].opacity=100,this.pauseReplayTimer())},onClickReplayStop:function(){},onClickReplaySpeedUp:function(){if(cc.global.watchReplayData.replaySpeedX<5){cc.global.watchReplayData.replaySpeedX++;var e=this.getLanguageText("REPLAY_TIME");this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.gameTimerSpeedChange(!0),this.pauseReplayTimer(),this.resumeReplayTimer()}this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){if(1<cc.global.watchReplayData.replaySpeedX){cc.global.watchReplayData.replaySpeedX--;var e=this.getLanguageText("REPLAY_TIME");this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.gameTimerSpeedChange(!0),this.pauseReplayTimer(),this.resumeReplayTimer()}this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},togglePlayToPause:function(){this.replayTimer&&clearInterval(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.gameTimerSpeedChange(!1),this.replay_bar.children[0].opacity=100,this.pauseReplayTimer()},onClickReplayNextTurn:function(){this.togglePlayToPause(),this.goReplay(!0)},onClickReplayPrevTurn:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.goReplay(!0))},gameTimerSpeedChange:function(e){if(this&&this.player)for(var t=0;t<this.player.length;t++){var i=this.player[t].getComponent("FtkPlayerRender");i&&i.rtgametimer&&(i.rtgametimer.isRunTimer?i.pauseTimer():i.resumeTimer())}},onClickReady:function(){if(this.ready()){var e=this.socket(),t={};t.extparams={roomid:cc.global.extparams.roomid},e.exec("ready",t)}},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},initgame:function(){var t=this;if(this.ready()){var e=this.socket();if(this.game=this.getCommon("FtkDataBind"),this.map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("catch",this.catch_event),this.map("catchresult",this.catchresult_event),this.map("lasthands",this.lasthands_event),this.map("ftknewcards",this.ftknewcards_event),this.map("bet",this.takecards_event),this.map("newturn",this.newturn_event),this.map("ratio",this.ratio_event),this.map("play",this.play_event),this.map("allcards",this.allcards_event),this.map("cardtips",this.cardtips_event),this.map("roomready",this.roomready_event),this.map("playeready",this.playeready_event),this.map("rer",this.recovery_event),this.map("banker",this.banker_event),this.map("exit",this.leave_event),this.map("stips",this.seltips_event),this.map("selemoticon",this.selemoticon_event),this.map("callplayer",this.callplayer_event),this.map("sendchat",this.sendchat_event),this.map("selectcards",this.selectcards_event),this.map("startrecordresult",this.startrecord_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)}),this.notReplay){if("NormalCreate"==cc.global.user.roomInType){var i={};null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i)}else"NormalJoin"==cc.global.user.roomInType?((i={}).extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i)):"NormalObserve"==cc.global.user.roomInType&&((i={}).extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i));this.inited=!0}this.changeTheme(t.curTheme)}},joinroom_event:function(e,t){cc.global.extparams.roomid=e.id,cc.global.user.roomNo=e.id,cc.global.user.selplayway=e.name,"champion"!=cc.global.user.selplayway&&(cc.global.championMode=0),cc.global.curPlaywayScore=e.score,t.score=e.score,t.roomCondition=e.cond,t.is2=22==t.roomCondition,t.is2&&(t.remaincardpanel.active=!0,t.resetRemainCardpanel(t,54)),t.ratio.string=t.score*parseInt(null==e.ratio||null==e.ratio?t.boardRatio:e.ratio);var i=t.getLanguageText("ROOM_0");t.roomnumber.string=e.id+i;var a=0;"yes"==cc.global.amObserve?t.touch.active=!1:t.touch.active=!0,"diamond"==cc.global.user.selplayway&&(a=1,t.roominfo.children[1].children[1].children[0].active=!1,t.roominfo.children[1].children[1].children[1].active=!0),t.changeTable(a),"ready"==cc.global.gamestatus?(cc.global.gamestatus="waiting",e.playerlist.length==e.players&&(cc.global.gamestatus="playing"),t.goRecovery=!0,t.players_event(e,t)):"waiting"==cc.global.gamestatus?(t.goRecovery=!0,t.players_event(e,t)):"playing"==cc.global.gamestatus&&(cc.global.amObserve&&"yes"==cc.global.amObserve?t.observer_event(e,t):t.players_event(e,t)),t.goRecovery=!1},observer_event:function(e,t){t.obsbench1.destroyAllChildren(),t.obsbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i]),a.parent=2<i?t.obsbench1:t.obsbench,(t.observerlist[i]=a).getComponent("Observer").nickname.node.active=!1}},userready_event:function(e,t){e.userid==cc.global.user.id?t.game.playermysql.getComponent("FtkPlayerRender").amready.active=!0:t.getPlayer(e.userid).amready.active=!0},roomready_event:function(e,t){1==e.cardroom&&null!=t.invite&&t.invite.destroy()},returnToHall:function(){this.loadding(),clearTimeout(this.restartTimer),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.scene("hall",this)},players_event:function(e,t){if(e.msg&&(cc.global.outReasonMsg=e.msg),0==e.playerlist.length||4<e.playerlist.length)t.returnToHall();else{4==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)e.observerlist[a].id==cc.global.user.id&&(i=!1);if(i&&t.notReplay)t.exitPlay();else{if(t.observer_event(e,t),"playing"==cc.global.gamestatus&&0==t.goRecovery)return;if("yes"==cc.global.amObserve?0==t.play_status?"waiting"==cc.global.gamestatus&&0==t.isOnSummary?1==cc.global.championMode||2==cc.global.championMode?t.btn_enter&&(t.btn_enter.active=!1):0==cc.global.championMode&&t.notReplay&&t.btn_enter&&(t.btn_enter.active=!0):t.btn_enter&&(t.btn_enter.active=!1):1==t.play_status&&t.btn_enter&&(t.btn_enter.active=!1):t.btn_enter&&(t.btn_enter.active=!1),t.rerenderPlayers=e.playerlist,t.isOnSummary)return;t.cleanGamePlayers(),t.game.restart(),t.addBoardPlayers()}}},addBoardPlayers:function(){if("no"==cc.global.amObserve){for(var e=-1,t=0;t<this.rerenderPlayers.length;t++)this.rerenderPlayers[t].seatid=t,this.rerenderPlayers[t].id==cc.global.user.id&&(this.game.addSelfPlayer(this,this.rerenderPlayers[t]),this.game.giveContext(this),e=this.rerenderPlayers[t].seatid);for(t=0;t<this.rerenderPlayers.length;t++)this.rerenderPlayers[t].seatid!=e&&0==this.playerexist(this.rerenderPlayers[t],this)&&(this.is2?this.newplayer(this.player.length,this,this.rerenderPlayers[t],3,this.rerenderPlayers[t].seatid):this.newplayer(this.player.length,this,this.rerenderPlayers[t],(this.rerenderPlayers[t].seatid-e+4)%4,this.rerenderPlayers[t].seatid))}else for(t=0;t<this.rerenderPlayers.length;t++)this.rerenderPlayers[t].seatid=t,0==this.playerexist(this.rerenderPlayers[t],this)&&(this.is2?this.newplayer(this.player.length,this,this.rerenderPlayers[t],0==this.rerenderPlayers[t].seatid?0:3,this.rerenderPlayers[t].seatid):this.newplayer(this.player.length,this,this.rerenderPlayers[t],this.rerenderPlayers[t].seatid,this.rerenderPlayers[t].seatid))},playerexist:function(e,t){for(var i=0;i<t.player.length;i++)if(null!=t.player[i]&&t.player[i].getComponent("FtkPlayerRender").userid==e.id)return!0;return!1},banker_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay)t.bankerSelfTimer=setTimeout(function(){t&&t.game&&(t.game.showBanker(e,!0),t.game.speech("call"))},1e3);else{var i=1e3;t.notReplay||(i=0),t.bankerOtherTimer=setTimeout(function(){t&&t.game&&(t.getPlayer(e.userid).showBanker(),t.getPlayer(e.userid).speech("call"))},i)}},catch_event:function(e,t){for(i=0;i<t.player.length;i++){(a=t.player[i].getComponent("FtkPlayerRender")).stopTimer()}if(t.ratio.string=parseInt(t.score)*e.ratio,e.userid==cc.global.user.id&&t.notReplay)t.game.catchtimer(e.timer,e.ratio),cc.global.user.doCatch=!0;else for(var i=0;i<t.player.length;i++){var a;(a=t.player[i].getComponent("FtkPlayerRender")).userid&&a.userid==e.userid?a.catchtimer(e.timer):a.stopTimer()}},recovery_event:function(e,t){if(t.cleanGame(),t.ratio.string=parseInt(t.score)*e.ratio,t.raiseUp(parseInt(e.ratio)),t.resetRemainCardpanel(t,e.decknum),e.remains)for(var i=t.decode(e.remains),a=0;a<t.lastcards.length;a++){(n=t.lastcards[a].getComponent("HHCard")).setCard(i[a]),n.order()}if("no"==cc.global.amObserve){var s=t.decode(e.player.cards);for(a=0;a<s.length;a++){var r=t.playcards(t.game,t,50*a-300,s[a]);t.registerProxy(r)}t.layoutPokerCard()}for(a=0;a<t.pokercards.length;a++){var n;(n=t.pokercards[a]).getComponent("HHCard").order()}if(""!=e.expid)for("no"==cc.global.amObserve&&t.game.showRecoveryCatchResult(e.player.ratio),a=0;a<e.others.length;a++)t.getPlayer(e.others[a].playuser).showRecoveryCatchResult(e.others[a].ratio);if("playing"==e.status){if(e.player&&e.player.buy&&t.game.lasthands(t,t.game,!0),e.player)if(e.player.history&&0<e.player.history.length){var o=t.decode(e.player.history);t.game.lasttakecards(t.game,t,o.length,o,{donot:!1,userid:e.player.playuser,type:t.engine.getBetCardsType(t.deck.makeEngineCardArray(o))})}else t.game.lasttakecards(t.game,t,0,null,{donot:!0,userid:e.player.playuser});if(null!=e.others&&0<e.others.length)for(a=0;a<e.others.length;a++){if((l=t.getPlayer(e.others[a].playuser))&&e.others[a].history&&0<e.others[a].history.length){o=t.decode(e.others[a].history);l.lasttakecards(t.game,t,o.length,o,{donot:!1,finished:!1,userid:e.others[a].playuser,type:t.engine.getBetCardsType(t.deck.makeEngineCardArray(o))})}else l.lasttakecards(t.game,t,0,null,{donot:!0,finished:!1,userid:e.others[a].playuser})}if(e.expid==cc.global.user.id)t.game.playtimer(t,t.game,e.timer,1==e.bt);else(l=t.getPlayer(e.expid))&&l.playtimer(t.game,e.timer)}else if("calling"==e.status)if(e.expid==cc.global.user.id)t.game.catchtimer(e.timer,e.ratio),cc.global.user.doCatch=!0;else for(a=0;a<t.player.length;a++){var l;if((l=t.player[a].getComponent("FtkPlayerRender")).userid&&l.userid==e.expid){l.catchtimer(e.timer);break}}if(null!=e.others&&0<e.others.length)for(a=0;a<e.others.length;a++)t.getPlayer(e.others[a].playuser).resetcards(e.others[a].cnum);t.addTouchEvent()},ratio_event:function(e,t){var i=t;if(t.raiseUp(parseInt(e.msg)),t.ratio.string=parseInt(t.score)*parseInt(e.msg),t.raiseAni&&0<t.raiseAni.children.length){t.raiseAni.active=!0;var a=t.raiseAni.children[0].getComponent(sp.Skeleton);a.clearTracks(),a.setAnimation(0,"play",!1),cc.global.audio.playEffectAud("call"),setTimeout(function(){i&&i.raiseAni&&(i.raiseAni.active=!1)},2e3)}},catchresult_event:function(e,t){if(t.ratio.string=parseInt(t.score)*parseInt(e.ratio),t.raiseUp(parseInt(e.ratio)),e.userid==cc.global.user.id&&t.notReplay){if("no"==cc.global.amObserve)if(t.game.catchresult(e),cc.global.user.doCatch=!1,0<parseInt(e.myratio))switch(parseInt(e.myratio)){case 1:t.showAnimation(16,e.userid);break;case 2:t.showAnimation(17,e.userid);break;case 3:t.showAnimation(18,e.userid)}else t.game.speech("pass")}else t.getPlayer(e.userid).catchresult(e)},lasthands_event:function(e,t){for(i=0;i<t.player.length;i++){t.player[i].getComponent("FtkPlayerRender").stopTimer()}if(t.notReplay,e.userid==cc.global.user.id&&t.notReplay){if("no"==cc.global.amObserve){for(i=0;i<t.player.length;i++){t.player[i].getComponent("FtkPlayerRender").hideresult()}t.game.playtimer(t,t.game,e.timer,!0)}}else{t.game.hideresult();for(var i=0;i<t.player.length;i++){t.player[i].getComponent("FtkPlayerRender").hideresult()}t.getPlayer(e.userid).playtimer(t.game,e.timer)}},ftknewcards_event:function(e,t){t.resetRemainCardpanel(t,e.extdata.remaincards);for(var i=e.extdata.users,a=0;a<i.length;a++)t.getPlayer(parseInt(i[a]))&&t.getPlayer(parseInt(i[a])).resetcards(e.extdata.cnums[a]);if(e.userid==cc.global.user.id&&t.notReplay&&"no"==cc.global.amObserve){var s=[];e.extdata.cards&&(s=t.decode(e.extdata.cards));for(a=0;a<s.length;a++)t.current(t.game,t,300*a,cards[a],null)}},newturn_event:function(i,a){22==a.roomCondition&&a.resetRemainCardpanel(a,i.remaincards);for(var e=1e3,t=0;t<i.players.length;t++){var s=[];if(i.players[t].boardcards&&0<i.players[t].boardcards.length&&(s=a.decode(i.players[t].boardcards)),i.players[t].userid==cc.global.user.id){if(22==a.roomCondition&&i.players[t].changed&&i.cards&&a.notReplay&&"no"==cc.global.amObserve){var r=[];i.cards&&(r=a.decode(i.cards));for(var n=cc.callFunc(function(e,t){for(var i=0;i<t.tempcontext.pokercards.length;i++)t.tempcontext.pokercards[i].y=0,t.tempcontext.pokercards[i].card=r[i],t.tempcontext.pokercards[i].getComponent("HHCard").setCard(r[i]),t.tempcontext.pokercards[i].getComponent("HHCard").order();t.tempcontext&&t.tempcontext.layout(t.tempcontext.poker,function(e,t){return e.zIndex-t.zIndex}),t.tempcontext.layoutPokerCard()},this,{tempcontext:a}),o=a.pokercards.length;o<r.length;o++)a.current(a.game,a,0,r[o],n)}a.game.setPlayerScore(i.players[t].money),1==i.players[t].fold?a.game.setPlayerPassive():a.game.setPlayerActive(),s.length}else{var l=a.getPlayer(i.players[t].userid);if(l.setPlayerScore(i.players[t].money),l.resetcards(i.players[t].cnum),1==i.players[t].fold?l.setPlayerPassive():l.setPlayerActive(),l.stopTimer(),0<s.length){for(o=0;o<s.length;o++){var c=0;5==a.deck.getCard(s[o]).rank||10==a.deck.getCard(s[o]).rank?c=a.deck.getCard(s[o]).rank:13==a.deck.getCard(s[o]).rank&&(c=10),0<c&&a.resetTurnScore(a,a.turnscoreval+c)}l.showLastCards(!0),l.clearLastCards(a.game);for(var h=0;h<s.length;h++)l.playcards(a.game,h,s[h],s);e<2e3&&(e=2e3)}}}a.game&&a.game.stopTimer(),setTimeout(function(){a.resetTurnScore(a,0);for(var e=0;e<i.players.length;e++){if(i.players[e].userid!=cc.global.user.id)(t=a.getPlayer(i.players[e].userid)).clearLastCards(a.game),t.toggleMastercardBubble(!1);else a.game.toggleMastercardBubble(!1),a.game.clearLastCards(a.game)}var t;""!=i.nextid&&(i.nextid==cc.global.user.id&&a.notReplay?(a.game.playtimer(a,a.game,i.timer,!0,i.mastercard,[]),cc.global.user.myPlayTurn=!0,1==i.first?cc.global.user.hardLiner=!0:cc.global.user.hardLiner=!1):(t=a.getPlayer(i.nextid))&&t.playtimer(a.game,i.timer))},e)},takecards_event:function(i,a){var e="";a.lasttip=null,a.dealed=!0,i.first&&setTimeout(function(){for(var e=0;e<i.players.length;e++)if(i.players[e].userid!=cc.global.user.id){var t=a.getPlayer(i.players[e].userid);t.clearLastCards(a.game),t.toggleMastercardBubble(!1)}else a.game.toggleMastercardBubble(!1),a.game.clearLastCards(a.game)},i.cards?1500:500);for(var t=0;t<i.players.length;t++){var s=[];if(i.players[t].userid==cc.global.user.id)a.game.setPlayerScore(i.players[t].money),1==i.players[t].fold?a.game.setPlayerPassive():a.game.setPlayerActive(),a.game.setHandCards(s);else(o=a.getPlayer(i.players[t].userid)).setPlayerScore(i.players[t].money),1==i.players[t].fold?o.setPlayerPassive():o.setPlayerActive(),o.setHandCards(s)}if(1==i.allow){if(a.showAnimation(i.type,i.userid),i.cards){s=a.decode(i.cards);for(t=0;t<s.length;t++){var r=0;5==a.deck.getCard(s[t]).rank||10==a.deck.getCard(s[t]).rank?r=a.deck.getCard(s[t]).rank:13==a.deck.getCard(s[t]).rank&&(r=10),0<r&&a.resetTurnScore(a,a.turnscoreval+r)}if(0<s.length)switch(cc.global.audio.playEffectAud("takecard"),parseInt(i.type)){case 1:var n=parseInt(s[0]/4)+3;e=52==s[0]?"joker2":53==s[0]?"joker1":13<n?"c"+(n-13):"c"+n,i.mastercard&&(e="mastercard",i.userid==cc.global.user.id?a.game.toggleMastercardBubble(!0):a.getPlayer(i.userid).toggleMastercardBubble(!0));break;case 2:e="pair";break;case 3:e="three";break;case 4:e="straight";break;case 5:e="pair_straight";break;case 6:e="three_1";break;case 7:e="three_2";break;case 8:case 9:case 10:e="";break;case 11:case 12:case 13:case 14:case 15:case 16:case 17:cc.global.audio.playEffectAud("bomb"),e="bomb";break;case 18:case 19:case 20:cc.global.audio.playEffectAud("bomb"),e="rocket"}""!=e&&(i.userid==cc.global.user.id?a.game.speech(e):(o=a.getPlayer(i.userid))&&o.speech(e))}else i.userid==cc.global.user.id?a.game.speech("pass"):(o=a.getPlayer(i.userid))&&o.speech("pass");if(i.userid==cc.global.user.id&&a.notReplay)cc.global.user.myPlayTurn=!1,a.game.unselected(a,a.game),a.game.lasttakecards(a.game,a,i.cnum,s,i);else(o=a.getPlayer(i.userid))&&o.lasttakecards(a.game,a,i.cnum,s,i);if(a.game.selectedcards.splice(0,a.game.selectedcards.length),i.nextid)if(i.nextid==cc.global.user.id&&a.notReplay){s=[];i.mastercard&&i.playercards&&0<i.playercards.length&&(s=a.decode(i.playercards)),1==i.first?setTimeout(function(){a.game.playtimer(a,a.game,i.timer,i.first,i.mastercard,s)},i.cards?1500:500):a.game.playtimer(a,a.game,i.timer,i.first,i.mastercard,s),cc.global.user.myPlayTurn=!0,1==i.first?cc.global.user.hardLiner=!0:cc.global.user.hardLiner=!1}else{var o=a.getPlayer(i.nextid);1==i.first?setTimeout(function(){o&&o.playtimer(a.game,i.timer)},i.cards?1500:500):o&&o.playtimer(a.game,i.timer)}}else a.game.notallow.active=!0,setTimeout(function(){a.game.notallow.active=!1},2e3),a.game.unselected(a,a.game);i.userid==cc.global.user.id&&a.pokerLayout(a)},leave_event:function(e,t){e.userid==cc.global.user.id&&t.notReplay?t.disLeaveReq("true"==e.msg):t.getPlayer(e.userid).disLeaveReq("true"==e.msg)},raiseUp:function(e,t){(this.boardRatio<e||t)&&(this.boardRatio=e)},selemoticon_event:function(e,t){if("itr"==e.msg.substring(0,3)){var i,a,s=e.msg.split("_"),r=(parseInt(s[1]),parseInt(s[2]));parseInt(s[3]);return e.userid==cc.global.user.id?i=cc.v2(90.2*cc.global.narrowContentRatio-640,-277.1*cc.global.narrowContentRatio):((i=t.getPlayer(e.userid).node.getPosition()).y+=65.4,i.x*=cc.global.narrowContentRatio,i.y*=cc.global.narrowContentRatio,i.x+=22,0<i.x?i.x+=22:i.x-=22),void(r==cc.global.user.id?a=cc.v2(90.2*cc.global.narrowContentRatio-640,-277.1*cc.global.narrowContentRatio):((a=t.getPlayer(r).node.getPosition()).y+=65.4,a.x*=cc.global.narrowContentRatio,a.y*=cc.global.narrowContentRatio,0<a.x?a.x+=22:a.x-=22))}if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showEmoticon(e.msg);else{var n=t.getPlayer(e.userid);n&&n.showEmoticon(e.msg)}var o=t.getObserver(e.userid);o&&o.showEmoticon(e.msg)},callplayer_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showCallPlayer(e.msg);else{var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg)}var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg)},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase;if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showCallPlayer(i);else{var a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg)}var s=t.getObserver(e.userid);s&&s.showCallPlayer(i,e.msg)},displayCardsCount:function(e){},showAnimation:function(e,t){var i=-1;switch(e){case 4:i=0;break;case 5:i=1;break;case 6:case 7:i=0;break;case 8:case 9:case 10:i=1;break;case 14:i=2;break;case 15:i=3;break;case 20:i=7;break;case 16:i=4;break;case 17:i=5;break;case 18:i=6}0<=i&&this.disEffect(i,t)},hideEffect:function(e){var t=this;setTimeout(function(){t&&t.effect&&(t.effect.children[e].active=!1)},1500)},disEffect:function(e,t){this.effect.children[e].active=!0;var i="",a=null;switch(cc.global.user.id==t?this.game&&this.game.playermysql&&(a=this.game.playermysql.getComponent("FtkPlayerRender")):a=this.getPlayer(t),e){case 0:cc.global.audio.playEffectAud("boat"),i="tonghou",0==a.seatidx||2==a.seatidx?this.effect.children[e].rotation=-90:this.effect.children[e].rotation=90;break;case 1:i="doudizhu_feiji",cc.global.audio.playEffectAud("plane");break;case 2:i="doudizhu zha",cc.global.audio.playEffectAud("bomb");break;case 3:i="doudizhu_huojian",cc.global.audio.playEffectAud("rocket");break;case 4:i="tongqian",cc.global.audio.playEffectAud("call"),a&&a.speech("call2");break;case 5:i="tongqian",cc.global.audio.playEffectAud("call"),a&&a.speech("call4");break;case 6:i="tongqian",cc.global.audio.playEffectAud("call"),a&&a.speech("call8");break;case 7:i="ddz_cj_win",cc.global.audio.playEffectAud("call");break;case 8:i="tongqian"}if(""!=i){var s=this.effect.children[e].getComponent(sp.Skeleton);s.clearTracks(),s.setAnimation(0,i,!1)}this.hideEffect(e)},cardtips_event:function(e,t){if(t.game.unselected(t,t.game),e.extdata.cards){var i=t.decode(e.extdata.cards);t.lasttip=i.join(","),cc.global.tipsReady=!0;for(var a=0;a<i.length;a++)t.game.cardtips(t,i[a],i)}else t.game.cardtipsfornot(t,t.game)},seltips_event:function(e,t){t.disCardtips(e.userid,parseInt(e.msg))},replay_play_event:function(e,t){if(e.curgame==cc.global.cur_game_code){cc.global.gamestatus="playing";var i=[],a=this.getPlayer(e.playuser);e.cards&&(i=t.decode(e.cards),a.resetcards(i.length),a.setCards(i)),t.is2&&t.resetRemainCardpanel(t,34)}},play_event:function(e,a){if(e.curgame==cc.global.cur_game_code){a.isOnSummary=!1,a.summarypage&&a.summarypage.getComponent("FtkSummaryDetail")&&(a.summarypage.destroy(),a.summarypage=null),a.restart(),cc.global.gamestatus="playing";var t=[];e.cards&&(t=a.decode(e.cards));var i=a.game.pokerpool.get(),s=a.game.pokerpool.get(),r=a.game.pokerpool.get(),n=a.game.pokerpool.get(),o=a.game.pokerpool.get();i.parent=a.root(),s.parent=a.root(),r.parent=a.root(),n.parent=a.root(),o.parent=a.root(),i.setPosition(0,0),i.setScale(.6,.6),s.setPosition(0,0),s.setScale(.6,.6),r.setPosition(0,0),r.setScale(.6,.6),n.setPosition(0,0),n.setScale(.6,.6),o.setPosition(0,0),o.setScale(.6,.6);for(var l=0;l<a.player.length;l++)a.player[l].getComponent("FtkPlayerRender").showCardsPanel();var c=cc.callFunc(function(e,t){if(t.game){if(t.game.pokerpool.put(t.current),t.game.pokerpool.put(t.left),t.game.pokerpool.put(t.right),t.game.pokerpool.put(t.down),t.game.pokerpool.put(t.upon),"no"==cc.global.amObserve)for(var i=0;i<t.self.pokercards.length;i++)t.self.pokercards[i].getComponent("HHCard").order();t.self.layoutPokerCard(),t.self.animatePokerCard(),a.resetRemainCardpanel(a,38)}},this,{game:a.game,self:a,left:s,right:r,current:i,down:n,upon:o});a.is2?(a.resetRemainCardpanel(54),a.dealing(a.game,4,a,0,s,r,n,o,t),cc.global.audio.playEffectAud("shuffle"),a.deal1_timer=setTimeout(function(){a.resetRemainCardpanel(a,46),a.dealing(a.game,4,a,1,s,r,n,o,t),a.deal2_timer=setTimeout(function(){a.resetRemainCardpanel(a,38),a.dealing(a.game,2,a,2,s,r,n,o,t,c),a.reordering(a)},250)},250)):(a.dealing(a.game,9,a,0,s,r,n,o,t),cc.global.audio.playEffectAud("shuffle"),a.deal1_timer=setTimeout(function(){a.dealing(a.game,9,a,1,s,r,n,o,t),a.deal2_timer=setTimeout(function(){a.dealing(a.game,5,a,2,s,r,n,o,t,c),a.reordering(a)},250)},250))}},allcards_event:function(e,t){t.gameCleaned=!1,t.hasRight=!1,cc.global.gotLastHands=!1,e.finished=!0,t.boardRatio=1,t.game.hideCallStat(),t.game.stopTimer(),cc.global.gamestatus="waiting";var i=null;null!=e.cnt&&0<cc.global.championMode&&(t.currenRound=parseInt(e.cnt)+1);for(var a=0;a<e.players.length;a++){for(var s=e.players[a],r=0;r<t.rerenderPlayers.length;r++)t.rerenderPlayers[r].id==s.userid&&(t.rerenderPlayers[r].goldcoins=s.gold,t.rerenderPlayers[r].rank=s.rank,t.rerenderPlayers[r].exp=s.normalscore,t.rerenderPlayers[r].texp=s.texp,t.rerenderPlayers[r].explevel=s.explevel);if(s.userid==cc.global.user.id&&t.notReplay)cc.global.user.normalrank=s.normalrank,cc.global.user.goldcoins=s.gold,cc.global.user.texp=s.texp,cc.global.user.explevel=s.explevel,t.game.updateCareerAfterMatch(s),t.game.disChPos(s.win?"Victory":"Lost");else{i=s;var n=t.decode(s.cards),o=t.getPlayer(s.userid);o.cleancards();for(var l=0;l<n.length;l++)o.lasttakecards(t.game,t,n.length,n,e);o.updateCareerAfterMatch(s),o.disChPos(s.win?"Victory":"Lost")}}if(t.ratio.string=parseInt(t.score)*parseInt(e.ratio),t.isOnSummary=!0,cc.global.summaryDetailData=e,null!=i){if(t.updatepva(),t.closeOpenWin(),t.summarypage=cc.instantiate(t.summary),null==t.summarypage||null==t.summarypage)return;t.summarypage.parent=t.root(),t.summarypage.getComponent("FtkSummaryDetail").create(t,e,"yes"==cc.global.amObserve)}},rend_event:function(e,t){t.isOnSummary=!1,"no"==cc.global.amObserve&&t.socket().exec("rnr",{extparams:{roomid:cc.global.extparams.roomid}}),t.hasRight=!1},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},startrecord_event:function(e,t){},getPlayer:function(e){if(this.player)for(var t=0;t<this.player.length;t++){var i=this.player[t].getComponent("FtkPlayerRender");if(i.userid&&i.userid==e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},dealing:function(e,t,i,a,s,r,n,o,l,c){if(i.otherplayer(s,0,t,e,i,c),i.is2)if("yes"==cc.global.amObserve)i.otherplayer(r,1,t,e,i,c);else for(h=0;h<t;h++){null!=(d=i.current(e,i,300*a+50*h-300,l[4*a+h],c))&&i.registerProxy(d)}else if(i.otherplayer(r,1,t,e,i,c),i.otherplayer(n,2,t,e,i,c),"yes"==cc.global.amObserve)i.otherplayer(o,3,t,e,i,c);else for(var h=0;h<t;h++){var d;null!=(d=i.current(e,i,300*a+50*h-300,l[9*a+h],c))&&i.registerProxy(d)}},otherplayer:function(e,t,i,a,s,r){if(s.player){var n={};if(0==t?(n=cc.sequence(cc.spawn(cc.moveTo(.2,-310,30),cc.scaleTo(.2,.1,.1)),cc.moveTo(0,0,r?200:0),cc.scaleTo(0,r?1:.6,r?1:.6)),e.runAction(n)):1==t?(n=cc.sequence(cc.spawn(cc.moveTo(.2,310,30),cc.scaleTo(.2,.1,.1)),cc.moveTo(0,0,r?200:0),cc.scaleTo(0,r?1:.6,r?1:.6)),e.runAction(n)):2==t&&(n=cc.sequence(cc.spawn(cc.moveTo(.2,0,-100),cc.scaleTo(.2,.1,.1)),cc.moveTo(0,0,r?200:0),cc.scaleTo(0,r?1:.6,r?1:.6)),e.runAction(n)),null!=r&&"yes"==cc.global.amObserve&&e.runAction(r),null!=s.player&&null!=s.player)for(var o=s.player[t].getComponent("FtkPlayerRender"),l=0;l<i;l++)o.countcards(1)}},showLastHands:function(e,t,i,a){},registerProxy:function(e){e&&e.getComponent("HHCard").proxy(this.game)},playcards:function(e,t,i,a){return t.current(e,t,i,a,null)},current:function(e,t,i,a,s){if(null==e||null==e)return null;if(null==e.pokerpool||null==e.pokerpool)return null;var r=e.pokerpool.get(),n=cc.global.theme.card_sort;if("no"==cc.global.amObserve){if(r.getComponent("HHCard").setCard(a),r.emit("theme-changed"),r.card=a,r.parent=t.poker,r.setPosition(0,200),r.setScale(1,1),r.zIndex=1==n?a:100-a,t.pokercards.push(r),"luckyre"!=cc.global.gamestatus)if(null!=s){var o=cc.sequence(cc.moveTo(.2,i,0),cc.delayTime(.1),s);r.runAction(o)}else{var l=cc.moveTo(.2,i,0);r.runAction(l)}}else r.x=i,r.y=0;return t.pokerLayout(t),r},reordering:function(e){if(e.pokerLayout(e),null!=e.pokercards&&null!=e.pokercards&&"no"==cc.global.amObserve){for(var t=0;t<e.pokercards.length;t++)e.pokercards[t].parent=e.poker;e.addTouchEvent()}},newplayer:function(e,t,i,a,s){var r=this.playerSlotPos[a],n=(this.playerSlotPos[a],cc.v2(-524/cc.global.narrowContentRatio,70)),o=1==a||2==a;n=r,"yes"==cc.global.amObserve&&null!=s&&0==s&&(n=cc.v2(-360,-251));var l=t.game;if(l&&0<l.playerspool.size()){t.player[e]=l.playerspool.get(),t.player[e].parent=t.players,t.player[e].setPosition(n),null!=s&&0==s&&(t.player[e].zIndex=1);var c=t.player[e].getComponent("FtkPlayerRender");c.initplayer(t,i,a,o,"yes"==cc.global.amObserve);var h=0;"diamond"==cc.global.user.selplayway&&(h=1),c.changeTable(h)}},givup:function(){this.ready()&&this.socket().exec("giveup",{})},cardtips:function(){if(this.ready()){var e=this.socket(),t={};null!=this.lasttip?t.extparams={cardtips:this.lasttip}:t.extparams={cardtips:""},e.exec("cardtips",t),this.lasttip=null}},docatch:function(e,t){this.ready()&&this.socket().exec("docatch",{extparams:{callx:t}})},doPlayCards:function(){if(this.ready()){var e=this.socket();this.game.selectedcards.splice(0,this.game.selectedcards.length);for(var t=0;t<this.pokercards.length;t++){var i=this.pokercards[t].getComponent("HHCard");1==i.selected&&this.game.selectedcards.push(i.card)}if(this.game.selectedcards.length){var a={};a.extparams={cards:this.game.selectedcards.join()},e.exec("bet",a),cc.global.user.hardLiner=!1}}this.lasttip=null},noCards:function(){this.ready()&&this.socket().exec("bet",{}),this.lasttip=null},cleanPokerCards:function(){for(var e=0;e<this.pokercards.length;e++){var t=this.pokercards[e];this.game.pokerpool.put(t)}this.pokercards.splice(0,this.pokercards.length)},cleanGame:function(){for(this.cleanPokerCards(),t=0;t<this.lastcards.length;t++){var e=this.lastcards[t].getComponent("HHCard");e.setCard(0),e.init()}this.resetRemainCardpanel(this,54);for(var t=0;t<this.player.length;t++){var i=this.player[t].getComponent("FtkPlayerRender");i&&(i.result&&(i.result.active=!1),i.cannot&&(i.cannot.active=!1),i.donot&&(i.donot.active=!1),i.lastcards&&(i.lastcards.active=!1),i.resetcards(0))}this.game.clean(this),this.ratio.string=parseInt(this.score),this.dealed=!1,this.leavereq.active=!1,this.hideRobot()},cleanGamePlayers:function(){for(var e=0;e<this.player.length;e++)this.player[e].destroy();this.player.splice(0,this.player.length),this.player=new Array},restart:function(e){this.gameCleaned||(this.gameCleaned=!0,this.cleanGame(),this.goRecovery=!1,cc.global.gamestatus="waiting",this.cleanGamePlayers(),this.game.restart(),this.addBoardPlayers(),"yes"==cc.global.amObserve&&(this.rerenderPlayers.length<4&&!this.is2||this.is2&&this.rerenderPlayers.length<2)&&(1!=cc.global.championMode&&2!=cc.global.championMode||!this.btn_enter?0==cc.global.championMode&&this.notReplay&&this.btn_enter&&(this.btn_enter.active=!0):this.btn_enter.active=!1),this.play_status=0,this.isOnSummary=!1)},continuegame:function(){this.restart("begin")},statictimer:function(e,t){this.waittimer=cc.instantiate(this.waitting),this.waittimer.parent=this.root();var i=this.waittimer.getComponent("HHTimer");i&&i.init(e,t,this.waittimer)},onDestroy:function(){this.inited=!1,this.cleanmap(),cc.global.onBatteryChanged=null},addTouchEvent:function(){this.touch.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.touch.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.touch.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.cardsArr=this.poker.getChildren(),this.touch.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},onTouchStart:function(e){var t=e.getLocation(),i=this._beginPos=this.touch.convertToNodeSpaceAR(t);this.checkSelStartCard(i)},onTouchMove:function(e){var t=e.getLocation(),i=this.touch.convertToNodeSpaceAR(t);this.checkSelMoveCard(i)},onTouchEnd:function(e){this.checkSelEndCard()},checkSelStartCard:function(e){var t=this.cardsArr.length;this.beginCardId=-1,this.moveCardId=-1;for(var i=t-1;0<=i;i--){var a=this.cardsArr[i];if(a.getBoundingBox().contains(e))return a.getComponent("HHCard").touched=!0,void(this.beginCardId=i)}},checkSelMoveCard:function(e){for(var t=this.cardsArr.length,i=t-1;0<=i;i--){var a=this.cardsArr[i];if(a.getBoundingBox().contains(e)){a.getComponent("HHCard").touched=!0,this.moveCardId=i,this.beginCardId=-1==this.beginCardId?i:this.beginCardId;break}}if(-1!=this.beginCardId){var s=Math.min(this.beginCardId,this.moveCardId),r=Math.max(this.beginCardId,this.moveCardId);for(i=0;i<t;i++)this.cardsArr[i].getComponent("HHCard").touched=s<=i&&i<=r}},sendTouchCards:function(){},checkSelEndCard:function(){for(var e=this.cardsArr.length,t=[],i=[],a=1,s=0;s<e;s++){var r=this.cardsArr[s].getComponent("HHCard");r.touched&&0==r.selected?(a=1,i.push(r.card),t.push(s)):r.touched&&1==r.selected&&(a=0,r.doselect()),r.touched=!1}if(1!=t.length)if(0!=i.length){var n=this.deck.makeEngineCardArray(i),o=this.engine.getPossibleCards(n,this.roomCondition);i=[];for(var l=0;l<o.size();l++)i.push(this.deck.getNumber(o.get(l)));this.upCardsCount=i.length,this.showSelCardsTip(i)}else 1==a&&(this.upCardsCount=0,this.game.unselected(this,this.game));else this.cardsArr[t[0]].getComponent("HHCard").doselect()},sendSelectedCardsCount:function(){if("yes"!=cc.global.amObserve)for(var e=0;e<this.cardsArr.length;e++)1==this.cardsArr[e].getComponent("HHCard").selected&&0},showSelCardsTip:function(s){for(var e=0;e<s.length;e++)for(var t=0;t<this.cardsArr.length;t++){var i=this.cardsArr[t].getComponent("HHCard");if(i.card==s[e]&&(i.doTipSelect(),0==function(e,t){for(var i=0,a=e;a<s.length;a++)s[a]===t&&i++;return i}(e+1,s[e])))break}},disRobot:function(){this.robot=!0,this.game.displayRobotScreen()},hideRobot:function(){},disCardtips:function(e,t){e!=cc.global.user.id&&this.getPlayer(e).disCardtips(parseInt(t))},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},onClickToggleRobot:function(){this.ready()&&"playing"==cc.global.gamestatus&&"no"==cc.global.amObserve&&0<this.pokercards.length&&(this.disRobot(),this.socket().exec("robot",{}))},onclickRobot:function(){this.ready()&&(this.hideRobot(),this.socket().exec("notrobot",{}))},onclickBack:function(){this.ready()&&(this.notReplay&&(0<this.player.length||"no"==cc.global.amObserve)?this.socket().exec("leave",{}):this.exitPlay())},changeTable:function(e){},changeCharacter:function(){"no"==cc.global.amObserve&&this.game.disUserCharacter();for(var e=0;e<this.player.length;e++)this.player[e].getComponent("FtkPlayerRender").disUserCharacter()},onclickUnSel:function(){cc.global.tipsReady&&(cc.global.tipsReady=!1);var e=this.game.unselected(this,this.game);(this.upCardsCount=0)<e&&this.sendSelectedCardsCount()},onToggleSfx:function(){},showChatDialog:function(){this.onclickChat(1)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}e<0||(this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root(),this.chatpage.getComponent("Chat").init(this,e),this.ischat=!0)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;if(!(e<0)&&this.ready()){var t=this.socket(),i={};i.extparams={emoticon:e},t.exec("selemoticon",i),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1)}},onClickEmoticon:function(){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),void(this.isemoticon=!1);this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root(),this.emoticonpage.getComponent("Emoticon").init(this),this.isemoticon=!0},disLeaveReq:function(e){this.leavereq.active=e},changeCardSortOrder:function(){var e=cc.global.theme.card_sort;null==e&&(e=!1);for(var t=0;t<this.poker.children.length;t++)this.poker.children[t].zIndex=100-this.poker.children[t].zIndex;this.layoutPokerCard()},pokerLayout:function(e){var t=1449/(e.poker.children.length-1)-151;-60<t&&(t=-60),e.poker.getComponent(cc.Layout).spacingX=t},animatePokerCard:function(){this.pokerLayout(this),this.poker.getComponent(cc.Animation).play("card_dealing");var i=1449/(this.poker.children.length-1)-151;-60<i&&(i=-60),this.poker.runAction(cc.sequence(cc.delayTime(.26),cc.callFunc(function(e,t){e.getComponent(cc.Animation).stop(),e.getComponent(cc.Layout).spacingX=i},this,null)));for(var e=0;e<this.poker.children.length;e++)this.poker.children[e].runAction(cc.sequence(cc.delayTime(.3+.03*e),cc.scaleTo(.08,1.15,1.15),cc.scaleTo(.08,1,1)))},layoutPokerCard:function(){for(var e=0;e<this.poker.children.length;e++)this.poker.children[e].y=0;this.layout(this.poker,function(e,t){return e.zIndex-t.zIndex})},onClickRecordPlay:function(){this.socket().exec("startrecord",{})},onClickFindEmptyRoom:function(){},onClickRemainCardsLock:function(){cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.getComponent("ToastCtrl").init("",""),cc.global.opentoast.parent=this.node},initTheme1:function(){if(this.game&&this.game.changeTheme(1),this.player)for(var e=0;e<this.player.length;e++)this.player[e].getComponent("FtkPlayerRender").changeTheme(1,!1)},initTheme2:function(){if(this.game&&this.game.changeTheme(2),this.player)for(var e=0;e<this.player.length;e++)this.player[e].getComponent("FtkPlayerRender").changeTheme(2,!1)},shiYishiBg:function(){},changeCardsCountMode:function(){},onToggleCardsCountMode:function(){},changeTheme:function(e){},onChangeTheme:function(){},onToggleSetting:function(){var i=this;this.closeOpenWin(),cc.loader.loadRes("prefab/main/ThemeSelectDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("ThemeSelectDialog").init(i),cc.global.openwin.getComponent("ThemeSelectDialog").sizes.active=!1,cc.global.openwin.parent=i.root())})},onClickCardSort:function(){},onToggleSound:function(){var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));e=!e,cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(e)),e?(this.soundbtn.children[0].active=!1,this.soundbtn.children[1].active=!0,cc.global.audio.playBGM("bgm_card"),cc.audioEngine.resumeAll()):(this.soundbtn.children[0].active=!0,this.soundbtn.children[1].active=!1,cc.audioEngine.pauseAll())},onToggleRecord:function(){if(this.notReplay){var e=JSON.parse(cc.sys.localStorage.getItem("show_record"));e=!e,cc.sys.localStorage.setItem("show_record",JSON.stringify(e))}},onThemeChanged:function(e){cc.sys.localStorage.setItem("card_game_theme",JSON.stringify(cc.global.theme)),this.background.children[0].active=1==cc.global.theme.background,this.background.children[1].active=2==cc.global.theme.background,this.background.children[2].active=3==cc.global.theme.background,this.remaincardpanel.children[0].children[0].active=!1,this.remaincardpanel.children[0].children[1].active=!1,this.remaincardpanel.children[0].children[2].active=!1,this.remaincardpanel.children[0].children[cc.global.theme.background-1].active=!0;for(var t=0;t<3;t++)this.buttons.children[2].children[t].children[0].active=1==cc.global.theme.background,this.buttons.children[2].children[t].children[1].active=2==cc.global.theme.background,this.buttons.children[2].children[t].children[2].active=3==cc.global.theme.background;if(this.poker)for(t=0;t<this.poker.children.length;t++)this.poker.children[t]&&this.poker.children[t].emit("theme-changed");if(this.game&&this.game.node.emit("theme-changed"),this.player)for(t=0;t<this.player.length;t++)this.player[t].emit("theme-changed");if(this.playerboard)for(t=0;t<this.playerboard.length;t++)this.playerboard[t].emit("theme-changed")},resetRemainCardpanel:function(e,t){22==e.roomCondition&&(0==(e.remainCardsCount=t)?e.remaincardpanel.active=!1:(e.remaincardpanel.children[1].getComponent(cc.Label).string=t,e.remaincardpanel.active=!0))},resetTurnScore:function(e,t){(e.turnscoreval=t)?(e.turnscore.node.active=!0,e.turnscore.string=t,e.turnscore.node.stopAllActions(),e.turnscore.node.setScale(1,1),e.turnscore.node.runAction(cc.sequence(cc.scaleTo(.2,1.5,1.5),cc.scaleTo(.2,1,1)))):e.turnscore.node.active=!1}}),cc._RF.pop()},{Deck:"Deck",FtkSelCardsEngine:"FtkSelCardsEngine",HHCommon:"HHCommon"}],FtkButton:[function(e,t,i){"use strict";cc._RF.push(t,"b7fd20CnKlDd7L5HfKwD81h","FtkButton");var a=e("HHCommon");cc.Class({extends:a,properties:{helpdlg:{default:null,type:cc.Prefab},setting:{default:null,type:cc.Prefab}},onClickHelp:function(){cc.global.openwin=cc.instantiate(this.helpdlg),cc.global.openwin.getComponent("HelpDialog").init(this,3),cc.global.openwin.parent=this.root()},onSettingClick:function(){cc.global.openwin=cc.instantiate(this.setting),cc.global.openwin.parent=this.root(),cc.global.openwin.getComponent("SettingDialog").init()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],FtkCardAnalyzer:[function(e,t,i){"use strict";cc._RF.push(t,"f6e08kepTpAG43cd6jp8h4k","FtkCardAnalyzer"),t.exports=function(){this.numOfIndex=[15];for(var e=0;e<13;e++)this.numOfIndex[e]=4;this.numOfIndex[13]=1,this.numOfIndex[14]=1,this.update=function(e){for(var t=0;t<e.size();t++){var i=e.get(t).rank-3;this.numOfIndex[i]--}},this.checkNoBomb=function(){if(this.numOfIndex[13]+this.numOfIndex[14]==2)return!1;for(var e=0;e<13;e++)if(4==this.numOfIndex[e])return!1;return!0},this.checkExistRocket=function(){return 2==this.numOfIndex[13]+this.numOfIndex[14]},this.verifyForSupreme=function(e){var t=e.get(0).rank-3,i=e.size();if(4==i&&this.numOfIndex[13]+this.numOfIndex[14]==2)return!1;for(var a=t+1;a<15;a++)if(this.numOfIndex[a]>=i)return!1;return!0},this.verifyForStrongSupreme=function(e){var t=e.get(0).rank-3,i=e.size();if(4==i&&this.numOfIndex[13]+this.numOfIndex[14]==2)return!1;for(var a=t;a<15;a++)if(this.numOfIndex[a]>=i)return!1;return!0},this.display=function(){for(var e="analyzer:",t=0;t<15;t++)e=e+this.numOfIndex[t]+",";return e}},cc._RF.pop()},{}],FtkDataBind:[function(c,e,t){"use strict";cc._RF.push(e,"c0d66pncnRApJaECi31miId","FtkDataBind");var a=c("HHCommon");cc.Class({extends:a,properties:{player:{default:null,type:cc.Prefab},poker:{default:null,type:cc.Prefab},poker_min:{default:null,type:cc.Prefab},myself:{default:null,type:cc.Prefab},catchbtn:{default:null,type:cc.Node},timer:{default:null,type:cc.Node},timer_num:{default:null,type:cc.Label},lastcards:{default:null,type:cc.Node},playbtn:{default:null,type:cc.Node},notallow:{default:null,type:cc.Node},operesult:{default:null,type:cc.Node},donottake:{default:null,type:cc.Node},cardtipmsg:{default:null,type:cc.Node},timerplaynum:{default:null,type:cc.Label},callx2btn:{default:null,type:cc.Node},callx4btn:{default:null,type:cc.Node},callx8btn:{default:null,type:cc.Node},callx16btn:{default:null,type:cc.Node},catchclock:{default:null,type:cc.Node},playclock:{default:null,type:cc.Node},bubble:{default:null,type:cc.Node},playermysql:cc.Node,callstat:{default:null,type:cc.Node}},onLoad:function(){for(this.changeTheme(),this.timer&&(this.timer.active=!1),this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1,this.callx16btn.active=!1),this.playbtn&&(this.playbtn.active=!1),this.notallow&&(this.notallow.active=!1),this.operesult&&(this.operesult.active=!1),this.cardtipmsg&&(this.cardtipmsg.active=!1),(this.ftk_databind_context=this).playerspool=new cc.NodePool,this.myselfpool=new cc.NodePool,this.pokerpool=new cc.NodePool,this.minpokerpool=new cc.NodePool,this.myselfpool,this.selectedcards=new Array,this.cardslist=new Array,i=0;i<4;i++)this.playerspool.put(cc.instantiate(this.player));for(i=0;i<27;i++)this.pokerpool.put(cc.instantiate(this.poker));for(i=0;i<108;i++)this.minpokerpool.put(cc.instantiate(this.poker_min));this.myselfpool.put(cc.instantiate(this.myself)),this.ready()&&(this.pva_format(cc.global.user.goldcoins,cc.global.user.cards,0,cc.global.user.championexp,this),this.pvalistener(this,function(e){e.pva_format(cc.global.user.goldcoins,cc.global.user.cards,0,cc.global.user.championexp,e)})),this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged()},addSelfPlayer:function(e,t){0<this.myselfpool.size()&&null!=cc.global&&(this.playermysql.active=!0,this.playermysql.setPosition(-551/cc.global.narrowContentRatio,-79.4),this.playermysql.getComponent("FtkPlayerRender").initplayer(e,t,0,!1,!1,!1))},giveContext:function(e){this.playermysql.getComponent("FtkPlayerRender").giveContext(e)},showRoomNumber:function(e){this.playermysql.getComponent("FtkPlayerRender").showRoomNumber(e)},showCardsCount:function(e){this.playermysql.getComponent("FtkPlayerRender").displayCardsCount(e)},updateCareerAfterMatch:function(e){this.playermysql.getComponent("FtkPlayerRender").updateCareerAfterMatch(e)},pva_format:function(e,t,i,a,s){},catchtimer:function(e,t){if(this.playbtn&&(this.playbtn.active=!1),this.timer&&(this.timer.active=!0),this.catchbtn)switch(this.catchbtn.active=!0,this.catchbtn.opacity=0,this.catchbtn.runAction(cc.fadeIn(.2)),this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1,this.callx16btn.active=!1,parseInt(t)){case 1:this.callx2btn.active=!0;break;case 2:this.callx4btn.active=!0;break;case 4:this.callx8btn.active=!0;break;case 8:this.callx16btn.active=!0;break;case 16:this.giveup()}this.operesult&&(this.operesult.active=!1);var i=c("GameTimer");this.rtgametimer=new i,this.timesrc=this.rtgametimer.runtimer(this,this.timer_num.node.parent,this.atlas,this.timer_num,this.timer_num,e)},giveup:function(){this.ready()&&this.socket().exec("giveup",{})},showBanker:function(){this.doOperatorResult("catch",!0,0)},showRecoveryCatchResult:function(e){this.playermysql&&this.playermysql.getComponent("FtkPlayerRender").showRecoveryCatchResult(e)},stopTimer:function(){this.rtgametimer&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc)},showCallStat:function(e){this.playermysql&&this.playermysql.getComponent("FtkPlayerRender").showCallStat(e)},hideCallStat:function(){this.playermysql&&this.playermysql.getComponent("FtkPlayerRender").hideCallStat()},catchresult:function(e,t){this.timer&&(this.timer.active=!1),this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1,this.callx16btn.active=!1),0<e.myratio&&this.showCallStat(parseInt(e.myratio)),this.playbtn&&(this.playbtn.active=!1),this.timesrc&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc),t?this.doOperatorResult("catch",t,e.myratio):this.doOperatorResult("catch",0<e.myratio,e.myratio)},hideresult:function(){this.operesult&&(this.operesult.active=!1)},lasthands:function(e,t,i){this.operesult&&(this.operesult.active=!1)},lasttakecards:function(e,t,i,a,s){for(this.result&&(this.result.active=!1),this.playbtn&&(this.playbtn.active=!1),this.catchbtn&&(this.catchbtn.active=!1),this.callx2btn&&(this.callx2btn.active=!1),this.callx4btn&&(this.callx4btn.active=!1),this.callx8btn&&(this.callx8btn.active=!1),this.callx16btn&&(this.callx16btn.active=!1),this.jsq&&(this.jsq.active=!1),this.lastcards&&(this.lastcards.active=!0),this.timesrc&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc),r=0;r<this.cardslist.length;r++)this.pokerpool.put(this.cardslist[r]);if(this.cardslist.splice(0,this.cardslist.length),a)for(var r=0;r<a.length;r++)this.playcards(t,r,a[r],a,s.type);else this.doOperatorResult("lasttakecards",!0);this.repositionLastCards()},repositionLastCards:function(){if(this.lastcards&&0!=this.lastcards.children.length)if(2==this.curTheme)this.lastcards.width=24*(this.lastcards.children.length-1)+109;else if(1==this.curTheme){var e=6<=this.lastcards.children.length?6:this.lastcards.children.length;this.lastcards.width=24*(e-1)+109}this.lastcards.stopAllActions(),this.lastcards.x=-5,this.lastcards.setScale(.4,.4),this.lastcards.runAction(cc.scaleTo(.2,.6,.6).easing(cc.easeIn(.2))),this.lastcards.runAction(cc.moveBy(.2,5,0).easing(cc.easeIn(.2)))},cardtips:function(e,t,i){for(var a,s=0;s<e.pokercards.length;s++){var r=e.pokercards[s];r.getComponent("HHCard").card!=t||r.getComponent("HHCard").selected||(a=r)}null!=a&&a.getComponent("HHCard").doselect()},cardtipsfornot:function(e,t){t.cardtipmsg.active=!0,setTimeout(function(){t.cardtipmsg.active=!1},1e3),t.unselected(e,t)},unselected:function(e,t){for(var i=0,a=0;a<e.pokercards.length;a++){var s=e.pokercards[a];if(s){var r=s.getComponent("HHCard");r&&(i+=r.unselected())}}return i},playcards:function(e,t,i,a,s){for(var r,n=0;n<e.pokercards.length;n++){var o=e.pokercards[n];if(o.card==i){r=o,e.pokercards.splice(n,1);break}}if(null!=r)for(n=0;n<r.children.length;n++)r.children[n].stopAllActions(),r.children[n].y=0;else r=this.pokerpool.get();r.x=0,r.y=0,r.parent=this.lastcards,this.countcard(i,a),r.zIndex=t,this.cardslist.push(r),r.getComponent("HHCard").setCard(i),r.getComponent("HHCard").order()},countcard:function(e,t){for(var i=parseInt(e/4),a=0,s=0;s<t.length;s++)i==parseInt(t[s]/4)&&(a+=1);return a},playtimer:function(e,t,i,a,s,r){if(this.timer&&(this.timer.active=!0),this.playbtn&&(this.playbtn.active=!0),this.playbtn.opacity=0,this.playbtn.runAction(cc.fadeIn(.3)),this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1,this.callx16btn.active=!1),this.lastcards&&(this.lastcards.active=!1),this.operesult&&(this.operesult.active=!1),this.donottake.active=1!=a,this.playbtn.children[0].active=!0,this.playbtn.children[1].active=!0,this.playbtn.children[3].active=!0,s&&0<r.length||a)for(var n in this.playbtn.children[0].active=!1,this.unselected(e,this),r)this.cardtips(e,r[n],r);else s&&(this.playbtn.children[1].active=!1,this.playbtn.children[3].active=!1);for(var o=0;o<this.cardslist.length;o++)t.pokerpool.put(cc.instantiate(this.poker));var l=c("GameTimer");this.rtgametimer=new l,this.timesrc=this.rtgametimer.runtimer(this,this.timerplaynum.node.parent,this.atlas,this.timerplaynum,this.timerplaynum,i),this.canTouch=!0},doOperatorResult:function(e,t,i){if(this.operesult.active=!0,"catch"==e)if(1==t)for(a=0;a<this.operesult.children.length;a++)this.operesult.children[a].active=!1,"call"==this.operesult.children[a].name&&(this.operesult.children[a].active=!0),"callx2"==this.operesult.children[a].name&&1==i&&(this.operesult.children[0].active=!1,this.operesult.children[a].active=!0),"callx4"==this.operesult.children[a].name&&2==i&&(this.operesult.children[0].active=!1,this.operesult.children[a].active=!0),"callx8"==this.operesult.children[a].name&&3==i&&(this.operesult.children[0].active=!1,this.operesult.children[a].active=!0);else for(a=0;a<this.operesult.children.length;a++)this.operesult.children[a].active=!1,"pass"==this.operesult.children[a].name&&(this.operesult.children[a].active=!0);else if("lasttakecards"==e)for(var a=0;a<this.operesult.children.length;a++)this.operesult.children[a].active=!1,"pass"==this.operesult.children[a].name&&(this.operesult.children[a].active=!0)},doSelectCard:function(e){null==this.selectedcards.find(function(e){e.card})&&this.selectedcards.push(e)},doUnSelectCard:function(e){var t=this.selectedcards.indexOf(e);0<=t&&this.selectedcards.splice(t,1)},clean:function(e){if(this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.callx8btn.active=!1,this.callx16btn.active=!1),this.lastcards&&(this.lastcards.active=!1),this.operesult&&(this.operesult.active=!1),"no"==cc.global.amObserve){var t=this.playermysql.getComponent("FtkPlayerRender");t&&t.clean(e)}},setHandCards:function(e){var t=this.playermysql.getComponent("FtkPlayerRender");t&&t.setHandCards(e)},restart:function(){this.playerspool.clear();for(var e=0;e<4;e++)this.playerspool.put(cc.instantiate(this.player));for(t=0;t<27;t++)this.pokerpool.put(cc.instantiate(this.poker));for(var t=0;t<60;t++)this.minpokerpool.put(cc.instantiate(this.poker_min));this.myselfpool.active=!0},disChPos:function(e){this.playermysql.getComponent("FtkPlayerRender").disChPos(e)},disChSitPos:function(e){this.playermysql.getComponent("FtkPlayerRender").disChSitPos()},disChEffectPos:function(){this.playermysql.getComponent("FtkPlayerRender").disChEffectPos()},disUserCharacter:function(){this.playermysql.getComponent("FtkPlayerRender").disUserCharacter()},showEmoticon:function(e){this.playermysql&&this.playermysql.getComponent("FtkPlayerRender")&&this.playermysql.getComponent("FtkPlayerRender").showEmoticon(e)},showCallPlayer:function(e,t){this.playermysql&&this.playermysql.getComponent("FtkPlayerRender")&&this.playermysql.getComponent("FtkPlayerRender").showCallPlayer(e,t)},onClickEmoticon:function(){this.playermysql&&this.playermysql.getComponent("FtkPlayerRender")&&this.playermysql.getComponent("FtkPlayerRender").onClickEmoticon()},showFuncStatus:function(){},setPlayerPassive:function(){this.playermysql&&this.playermysql.getComponent("FtkPlayerRender")&&this.playermysql.getComponent("FtkPlayerRender").setPlayerPassive()},setPlayerActive:function(){this.playermysql&&this.playermysql.getComponent("FtkPlayerRender")&&this.playermysql.getComponent("FtkPlayerRender").setPlayerActive()},setPlayerScore:function(e){this.playermysql&&this.playermysql.getComponent("FtkPlayerRender")&&this.playermysql.getComponent("FtkPlayerRender").setPlayerScore(e)},setPlayerScoreAdd:function(e){var t=this.playermysql.getComponent("FtkPlayerRender");t&&t.setPlayerScoreAdd(e)},clearLastCards:function(e){for(i=0;i<this.cardslist.length;i++)this.pokerpool.put(this.cardslist[i]);this.cardslist.splice(0,this.cardslist.length)},playCardAnimation:function(){},changeTheme:function(){switch(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1){case 1:this.initTheme1();break;case 2:this.initTheme2()}},initTheme1:function(){if(this.playermysql){var e=this.playermysql.getComponent("FtkPlayerRender");e&&e.changeTheme(1,!0)}},initTheme2:function(){if(this.playermysql){var e=this.playermysql.getComponent("FtkPlayerRender");e&&e.changeTheme(2,!0)}},speech:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";if(this.playermysql){var t=this.playermysql.getComponent("FtkPlayerRender");t&&t.speech(e)}},onThemeChanged:function(e){for(var t=0;t<this.lastcards.children.length;t++)this.lastcards.children[t]&&this.lastcards.children[t].emit("theme-changed");this.playermysql&&this.playermysql.emit("theme-changed")},toggleMastercardBubble:function(e){this.bubble.active=!!e}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],FtkPlayerRender:[function(s,e,t){"use strict";cc._RF.push(e,"893bfTfBxxBZrrtkV59QkuX","FtkPlayerRender");var i=s("HHCommon");cc.Class({extends:i,properties:{username:{default:null,type:cc.Label},freeicon:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},timer:{default:null,type:cc.Node},jsq:{default:null,type:cc.Node},amready:{default:null,type:cc.Node},timer_num:{default:null,type:cc.Label},result:{default:null,type:cc.Node},lastcards:{default:null,type:cc.Node},cannot:{default:null,type:cc.Node},donot:{default:null,type:cc.Node},avatar:{default:null,type:cc.Sprite},bubble_talk:{default:null,type:cc.Node},avatar_outline:{default:null,type:cc.Node},info_outline:{default:null,type:cc.Node},userinfonode:{default:null,type:cc.Node},resultx2:{default:null,type:cc.Node},resultx4:{default:null,type:cc.Node},resultx8:{default:null,type:cc.Node},resultx16:{default:null,type:cc.Node},userinfopan:{default:null,type:cc.Node},leave:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},effect:{default:null,type:cc.Node},cardspanel:{default:null,type:cc.Node},cardshand:{default:null,type:cc.Node},cardbg:{default:null,type:cc.Prefab},quality:!0,score_label:{default:null,type:cc.Label},bubble:{default:null,type:cc.Node},callstat:{default:null,type:cc.Node},teammark:cc.Node},onLoad:function(){this.cardcount=0,this.cardslist=new Array,this.isRight=!1,this.remaincards=new Array,this.isFirstTheme=!0,this.hiddencardlist=new Array,this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged(),this.money=0},initplayer:function(e,t,i,a,s,r){this.curTheme=e.curTheme,this.parent=e;if(this.userdata=t,cc.global.user.id,t.id,this.username.string=t.nickname,this.userid=t.id,this.playcharacter=t.playcharacter,this.avatarurl=t.avatarurl,this.seatid=i,23==this.parent.roomCondition?(this.teammark.active=!0,this.teammark.children[0].active=!1,this.teammark.children[1].active=!1,i%2==0?this.teammark.children[0].active=!0:this.teammark.children[1].active=!0):this.teammark.active=!1,this.obsmode=s,0==this.seatid&&1==s&&1.2,this.hidenCards=[],this.showCHPCrown(),this.showFuncStatus(),this.loadAvatar(t.avatarurl,t.gender),1==a){this.score_label.node.parent.x=-1*this.score_label.node.parent.x,this.bubble.scaleX=-1*this.bubble.scaleX,this.bubble.children[0].children[0].scaleX=-1*this.bubble.children[0].children[0].scaleX,this.timer.x=-1*this.timer.x,this.result.x=-1*this.result.x,this.resultx2.x=-1*this.resultx2.x,this.resultx4.x=-1*this.resultx4.x,this.resultx8.x=-1*this.resultx8.x,this.resultx16.x=-1*this.resultx16.x,this.userinfopan.x=-1*this.userinfopan.x,this.amready.x=-1*this.amready.x,this.cardspanel.x=-1*this.cardspanel.x,this.callstat.x=-1*this.callstat.x,this.cannot.x=-1*this.cannot.x,this.donot.x=-1*this.donot.x,this.jsq.x=-1*this.jsq.x,this.lastcards.x=-1*this.lastcards.x,this.lastcards.anchorX=1,this.emoticon.x=-1*this.emoticon.x,this.callplayer.x=-1*this.callplayer.x,this.callplayer.scaleX=-1*this.callplayer.scaleX,this.callplayer.children[1].scaleX=-1*this.callplayer.children[1].scaleX,this.callplayer.children[1].anchorX=1,this.effect.x=-1*this.effect.x,this.userinfonode.x=-1*this.userinfonode.x,this.leave.x=-1*this.leave.x,this.leave.scaleX=-1*this.leave.scaleX,this.leave.children[1].scaleX*=-1;for(var n=0;n<this.effect.children.length;n++)this.effect.children[n].x=-1*this.effect.children[n].x;this.isRight=a,this.cardshand.scaleX=-this.cardshand.scaleX,this.cardshand.getComponent(cc.Layout).horizontalDirection=cc.Layout.HorizontalDirection.RIGHT_TO_LEFT,this.cardshand.x=-this.cardshand.x,this.oriposx=this.lastcards.x,this.score_label.node.children[0].x=-this.score_label.node.children[0].x,this.score_label.node.children[0].anchorX=1}else this.userid,cc.global.user.id;0==this.seatid&&this.obsmode,this.jsq&&(this.jsq.active=!1),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(t.goldcoins))),this.goldcoins.node.parent.getComponent(cc.Label)&&(this.goldcoins.node.parent.getComponent(cc.Label).string=this.numformat(parseInt(t.goldcoins))),this.goldcoins.node.parent.active=!0,this.showMedals(),this.changeTheme(this.curTheme),this.cardshand.active=!0,this.cardshand.removeAllChildren();for(var o=0;o<27;o++){var l=cc.instantiate(this.cardbg);l.parent=this.cardshand,l.active=!1,a&&(l.scaleX=-l.scaleX)}},updateBalance:function(){this.goldcoins.node.parent.getComponent(cc.Label)&&(this.goldcoins.node.parent.getComponent(cc.Label).string=this.numformat(parseInt(this.userdata.goldcoins))),this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},updateCareerAfterMatch:function(e){this.goldcoins.node.parent.getComponent(cc.Label)&&(this.goldcoins.node.parent.getComponent(cc.Label).string=this.numformat(parseInt(e.gold)))},setPlayerPassive:function(){this.avatar.node.opacity=100},setPlayerActive:function(){this.avatar.node.opacity=255},setPlayerScore:function(e){var t=this;if(!isNaN(e)){var i=parseInt(e);i!=this.money&&(t.setPlayerScoreAdd(i-t.money),setTimeout(function(){t.money=i,t.score_label.string=i},1e3))}},showCallStat:function(e){switch(parseInt(e)){case 1:this.callstat.children[0].active=!0;break;case 2:this.callstat.children[1].active=!0;break;case 3:this.callstat.children[2].active=!0;break;case 4:this.callstat.children[3].active=!0;break;case 5:this.callstat.children[4].active=!0}},hideCallStat:function(){this.callstat.children[0].active=!1,this.callstat.children[1].active=!1,this.callstat.children[2].active=!1,this.callstat.children[3].active=!1,this.callstat.children[4].active=!1},setPlayerScoreAdd:function(e){var t=this.score_label.node.children[0];t.getComponent(cc.Label).string=0<e?"+"+e:e,t.stopAllActions(),t.opacity=0,t.runAction(cc.sequence(cc.fadeIn(.1),cc.delayTime(.8),cc.fadeOut(.1))),t.setScale(.5,.5),t.runAction(cc.sequence(cc.scaleTo(.1,1,1),cc.scaleTo(.4,1.2,1.2),cc.scaleTo(.4,1,1),cc.scaleTo(.1,.5,.5)))},countcards:function(e){this.cardcount=this.cardcount+e,this.resetcards(this.cardcount)},addAndShowCards:function(e){if(this.parent.is2?this.resetcards(10):this.resetcards(23),!this.parent.notReplay){for(var t=[],i=0;i<this.cardshand.children.length;i++)t[i]=this.cardshand.children[i].getComponent("HHCard").card;t=t.concat(e),this.setCards(t)}},setCards:function(e){for(var t=0;t<e.length;t++)if(this.cardshand.children[t]){var i=this.cardshand.children[t].getComponent("HHCard");i.setCard(e[t]),i.order()}},resetcards:function(e){this.cardspanel&&(0==(this.cardcount=e)?(this.cardspanel.children[0].active=!1,this.cardspanel.children[1].active=!1,this.cardspanel.children[2].active=!1):(this.cardspanel.children[0].active=!0,this.cardspanel.children[1].active=!0,this.cardspanel.children[2].active=!1,this.cardcount=e,this.cardspanel.children[1].getComponent(cc.Label).string=this.cardcount))},cleancards:function(){this.cardspanel.active=!1},showCardsPanel:function(){this.cardspanel.active=!0},catchtimer:function(e){this.jsq&&(this.jsq.active=!0),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1);var t=s("GameTimer");this.rtgametimer=new t,this.timesrc=this.rtgametimer.runtimer(this,this.jsq,this.atlas,this.timer_num,this.timer_num,e)},showBanker:function(){this.result&&(this.result.active=!0)},showRecoveryCatchResult:function(e){switch(parseInt(e)){case 2:this.callstat.children[0].active=!0;break;case 4:this.callstat.children[1].active=!0;break;case 8:this.callstat.children[2].active=!0;break;case 16:this.callstat.children[3].active=!0}},catchresult:function(e,t){if(this.rtgametimer)if(this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),0<e.myratio){switch(this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),parseInt(e.myratio)){case 1:this.resultx2&&(this.resultx2.active=!0,this.showEffect(0),this.speech("call2"));break;case 2:this.resultx4&&(this.resultx4.active=!0,this.showEffect(1),this.speech("call4"));break;case 3:this.resultx8&&(this.resultx8.active=!0,this.showEffect(2),this.speech("call8"));break;case 4:this.resultx16&&(this.resultx16.active=!0,this.showEffect(2),this.speech("call16"))}this.showCallStat(e.myratio)}else this.speech("pass"),this.result&&(this.result.active=!1),this.cannot&&!t&&(this.cannot.active=!0),this.donot&&(this.donot.active=!0),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1)},hideresult:function(){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1)},lasthands:function(e,t,i,a){this.hideresult(),this.rtgametimer&&this.timesrc&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),this.userid==i&&(this.parent.notReplay?-1==cc.global.gamestatus.indexOf("lucky")&&this.countcards(3):-1==cc.global.gamestatus.indexOf("lucky")&&this.addAndShowCards(a),this.playtimer(t,25))},clearLastCards:function(e){if(0<this.cardslist.length){for(var t=0;t<this.cardslist.length;t++)e.minpokerpool.put(this.cardslist[t]);this.cardslist.splice(0,this.cardslist.length)}},showLastCards:function(e){this.lastcards&&(this.lastcards.active=e)},lasttakecards:function(e,t,i,a,s){var r=this.parent.notReplay;if(this.rtgametimer&&this.timesrc&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.jsq&&(this.jsq.active=!1),this.lastcards&&(this.lastcards.active=!0),0<this.cardslist.length){for(n=0;n<this.cardslist.length;n++)e.minpokerpool.put(this.cardslist[n]);this.cardslist.splice(0,this.cardslist.length)}if(a){r?this.resetcards(i):(this.boardRemainCards=[],""!=s.playercards&&null!=s.playercards?(this.boardRemainCards=this.decode(s.playercards),this.resetcards(this.boardRemainCards.length,this.boardRemainCards),this.setCards(this.boardRemainCards)):this.resetcards(0));for(var n=0;n<a.length;n++)this.playcards(e,n,a[n],a)}else t.getPlayer(s.userid).tipdonot();this.disCardtips(0)},setHandCards:function(e){for(var t=e.length;t<this.cardshand.children.length;t++)this.cardshand.children[t].active=!1;for(t=0;t<e.length;t++){this.cardshand.children[t].active=!0;var i=this.cardshand.children[t].getComponent("HHCard");i.setCard(e[t]),i.order()}},tipcannot:function(){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!0),this.donot&&(this.donot.active=!1)},tipdonot:function(){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!0)},playcards:function(e,t,i,a){var s=e.minpokerpool.get();s.parent=this.lastcards,this.cardslist.push(s);var r=s.getComponent("HHCard");r.setCard(i),0<=i&&r.order(),64==i&&r.init()},countcard:function(e,t){return parseInt(e/4)},playtimer:function(e,t){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.lastcards&&(this.lastcards.active=!1);for(var i=0;i<this.cardslist.length;i++)e.minpokerpool.put(this.cardslist[i]);var a=s("GameTimer");this.rtgametimer=new a,this.timesrc=this.rtgametimer.runtimer(this,this.jsq,this.atlas,this.timer_num,this.timer_num,t)},pauseTimer:function(){this.rtgametimer&&this.rtgametimer.pauseTimer(this,this.jsq,this.timesrc)},resumeTimer:function(){this.rtgametimer&&(this.timesrc=this.rtgametimer.resumeTimer(this,this.jsq,this.timer_num))},stopTimer:function(){this.rtgametimer&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc)},clean:function(e){for(var t=0;t<this.cardslist.length;t++)e.minpokerpool.put(this.cardslist[t]);this.jsq&&(this.jsq.active=!1),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx8&&(this.resultx8.active=!1),this.resultx16&&(this.resultx16.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.cardcount=0,this.money=0,this.score_label.string=0},onClickDisInfo:function(){this.parent.notReplay&&(this.userid==cc.global.user.id?this.onClickEmoticon():this.onclickCallPlayer())},disLeaveReq:function(e){this.leave.active=e},showCallPlayer:function(e,t){var i=this;this.hideCallPlayer(),cc.global.audio.playVoiceChatWithType(this.userdata.playcharacter,t),this.callplayer.active=!0,this.callplayer.children[0].getComponent(cc.Label).string=this.callplayer.children[1].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onclickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userid},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){this.ftkcontext.onClickEmoticon()},onClickChat:function(){this.ftkcontext.onclickChat()},onClickLobbyList:function(){this.ftkcontext.onclickUserlist()},giveContext:function(e){this.ftkcontext=e},hideEffect:function(e){var t=this;setTimeout(function(){t&&t.effect&&(t.effect.children[e].active=!1)},1500)},showEffect:function(e){this.effect.children[e].active=!0;var t=this.effect.children[e].getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"tongqian",!1),cc.global.audio.playEffectAud("call"),this.hideEffect(e)},disCardtips:function(e){},disChPos:function(e){},display:function(e){for(var t=": [",i=0;i<e.length;i++)t=t+e[i]+" , ";t+="]"},changeTable:function(e){},onclickRobot:function(){this.ftkcontext.onclickRobot()},displayRobot:function(){},hideRobot:function(){},showCHPCrown:function(){},showFuncStatus:function(){},showMedals:function(){},changeTheme:function(e,t){this.repositionCards()},repositionCards:function(){if(this.lastcards)for(var e=[],t=0;t<this.lastcards.children.length;t++)this.lastcards.children[t].getComponent("HHCard")&&e.push(1)},speech:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";if(""!=e){var t=this.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)}},onThemeChanged:function(){if(1==cc.global.theme.background||2==cc.global.theme.background?(this.avatar_outline.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("head_frame"+cc.global.theme.background),this.cardspanel&&(this.cardspanel.children[0].getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("left_cards_back"+cc.global.theme.background))):(this.avatar_outline.getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas2.getSpriteFrame("head_frame3"),this.cardspanel&&(this.cardspanel.children[0].getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas2.getSpriteFrame("left_cards_back3"))),this.lastcards)for(var e=0;e<this.lastcards.children.length;e++)this.lastcards.children[e]&&this.lastcards.children[e].emit("theme-changed");if(this.cardshand)for(e=0;e<this.cardshand.children.length;e++)this.cardshand.children[e]&&this.cardshand.children[e].emit("theme-changed")},toggleMastercardBubble:function(e){this.bubble.active=!!e}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],FtkSelCardsEngine:[function(e,t,i){"use strict";cc._RF.push(t,"e0774Rsv0xGP43P3ftbHJs0","FtkSelCardsEngine");var F=e("ArrayList"),a=e("FtkCardAnalyzer"),E=e("CardInfo");t.exports=function(){this.cards=null,this.cardAnalyzer=new a,this.cardInfoList=new F,this.kingList=new F,this.singleList=new F,this.pairList=new F,this.threeList=new F,this.straightList=new F,this.pairStraightList=new F,this.threeStraightList=new F,this.bombList=new F,this.allSingles=new F,this.allSinglesForAI=new F,this.allPairs=new F,this.allPairsForAI=new F,this.allThrees=new F,this.allStraights=new F,this.allPairStraights=new F,this.allRecomendSingles=new F,this.allRecomendPairs=new F,this.weakList=new F,this.strongList=new F,this.analyzeCards=function(e){this.cards=new F,this.cards.addAll(e.getArray()),this.cardInfoList=new F,this.kingList=new F,this.singleList=new F,this.pairList=new F,this.threeList=new F,this.straightList=new F,this.pairStraightList=new F,this.threeStraightList=new F,this.bombList=new F,this.allSingles=new F,this.allSinglesForAI=new F,this.allPairs=new F,this.allPairsForAI=new F,this.allThrees=new F,this.allStraights=new F,this.allPairStraights=new F,this.allRecomendSingles=new F,this.allRecomendPairs=new F,this.weakList=new F,this.strongList=new F;for(var t=[],i=0;i<15;i++)k=new E(i+3),t[i]=k;for(i=0;i<e.size();i++)t[e.get(i).rank-3].addCard(e.get(i));for(i=0;i<t.length;i++)0<t[i].totalSize&&this.cardInfoList.add(t[i]);for(i=0;i<this.cardInfoList.size();i++)16!=(k=this.cardInfoList.get(i)).cardRank&&17!=k.cardRank||this.kingList.add(k.cards.get(0));for(i=0;i<this.cardInfoList.size();i++)0<(k=this.cardInfoList.get(i)).totalSize&&k.totalSize<5&&this.allSingles.add(k.cards.get(0)),0<k.totalSize&&k.totalSize<4&&this.allSinglesForAI.add(k.cards.get(0));for(i=0;i<this.kingList.size();i++)for(var a=this.kingList.get(i),s=0;s<this.cardInfoList.size();s++)k=this.cardInfoList.get(s),a.rank==k.cardRank&&k.clear();for(i=0;i<this.cardInfoList.size();i++)2!=(k=this.cardInfoList.get(i)).totalSize&&3!=k.totalSize&&4!=k.totalSize||((S=new F).add(k.cards.get(0)),S.add(k.cards.get(1)),this.allPairs.add(S)),2!=k.totalSize&&3!=k.totalSize||((S=new F).add(k.cards.get(0)),S.add(k.cards.get(1)),this.allPairsForAI.add(S));var r=new F,n=new F;for(i=0;i<this.cardInfoList.size();i++)switch((k=this.cardInfoList.get(i)).totalSize){case 2:break;case 3:(S=new F).add(k.cards.get(0)),S.add(k.cards.get(1)),r.add(S);break;case 4:(S=new F).add(k.cards.get(0)),S.add(k.cards.get(1)),n.add(S)}for(i=0;i<this.cardInfoList.size();i++)if(3==(k=this.cardInfoList.get(i)).totalSize){var o=new F;o.addAll(k.cards.getArray()),this.allThrees.add(o)}var l=0;for(i=0;i<this.cardInfoList.size()-1;i++)if(f=new F,0<(k=this.cardInfoList.get(i)).totalSize&&k.cardRank<15&&(a=k.cards.get(0),f.add(a)),l<=i){for(s=i+1;s<this.cardInfoList.size()&&0<(b=this.cardInfoList.get(s)).totalSize&&b.cardRank<15&&Math.abs(b.cardRank-k.cardRank)==s-i;s++)v=b.cards.get(0),f.add(v),l=s;5<=f.size()&&this.allStraights.add(f)}for(i=l=0;i<this.cardInfoList.size()-1;i++)if(y=new F,1<(k=this.cardInfoList.get(i)).totalSize&&k.cardRank<15&&(y.add(k.cards.get(0)),y.add(k.cards.get(1))),l<=i){for(s=i+1;s<this.cardInfoList.size()&&1<(b=this.cardInfoList.get(s)).totalSize&&b.cardRank<15&&Math.abs(b.cardRank-k.cardRank)==s-i;s++)y.add(b.cards.get(0)),y.add(b.cards.get(1)),l=s;6<=y.size()&&this.allPairStraights.add(y)}for(i=0;i<this.cardInfoList.size();i++)if(3==(k=this.cardInfoList.get(i)).totalSize&&k.cardRank<15){var c=new F;for(c.addAll(k.cards.getArray()),s=i+1;s<this.cardInfoList.size()&&3==(C=this.cardInfoList.get(s)).totalSize&&Math.abs(C.cardRank-k.cardRank)==s-i&&C.cardRank<15;s++)c.addAll(C.cards.getArray());if(3<c.size())for(this.threeStraightList.add(c),_=0;_<c.size();_++)for(var h=c.get(_),d=0;d<this.cardInfoList.size();d++){var u=this.cardInfoList.get(d);h.rank==u.cardRank&&u.clear()}}var p=0;for(i=0;i<this.cardInfoList.size();i++){p=0;var g=null,m=null;if((2==(k=this.cardInfoList.get(i)).totalSize||3==k.totalSize)&&k.cardRank<15){var y=new F;for(2==k.totalSize?y.addAll(k.cards.getArray()):g=k,s=i+1;s<this.cardInfoList.size()&&(2==(b=this.cardInfoList.get(s)).totalSize||3==b.totalSize)&&Math.abs(k.cardRank-b.cardRank)==s-i&&b.cardRank<15;s++)if(2==(m=b).totalSize)y.addAll(b.cards.getArray());else{if(1<++p)break;y.add(b.cards.get(0)),y.add(b.cards.get(1))}if(4==y.size()&&0==p&&null!=g&&(y.addAtIndex(0,g.cards.get(0)),y.addAtIndex(0,g.cards.get(1))),7<y.size()&&3==m.totalSize&&(y.removeAtIndex(y.size()-1),y.removeAtIndex(y.size()-1)),5<y.size())for(this.pairStraightList.add(y),_=0;_<y.size();_++)for(h=y.get(_),d=0;d<this.cardInfoList.size();d++)(C=this.cardInfoList.get(d)).cardRank==h.rank&&(2==C.totalSize?C.clear():3==C.totalSize&&(C.cards.removeAtIndex(0),C.cards.removeAtIndex(1),C.totalSize-=2))}}for(i=0;i<this.cardInfoList.size();i++){p=0;var f=new F;g=null,m=null;for(0<(k=this.cardInfoList.get(i)).totalSize&&k.totalSize<4&&k.cardRank<15&&(a=k.cards.get(0),1==k.totalSize&&f.add(a),3==k.totalSize&&(g=k,p++),2==k.totalSize&&(g=k,p+=.5)),s=i+1;s<this.cardInfoList.size();s++){var b=this.cardInfoList.get(s);if(!(0<b.totalSize&&b.totalSize<4&&b.cardRank<15&&Math.abs(k.cardRank-b.cardRank)==s-i))break;if(3==b.totalSize&&p++,2==b.totalSize&&(p+=.5),1<p)break;var v=b.cards.get(0);f.add(v),m=b}if(p<1&&4==f.size()&&null!=g&&(a=g.cards.get(0),f.addAtIndex(0,a)),5<=f.size()){5<f.size()&&p==.5*(m.totalSize-1)&&0<p&&f.removeAtIndex(f.size()-1),this.straightList.add(f);for(var _=0;_<f.size();_++)for(h=f.get(_),d=0;d<this.cardInfoList.size();d++){var C=this.cardInfoList.get(d);if(h.rank==C.cardRank){C.cards.removeAtIndex(0),C.totalSize--;break}}}}for(i=0;i<this.cardInfoList.size();i++)1==(k=this.cardInfoList.get(i)).totalSize&&(this.singleList.addAll(k.cards.getArray()),(B=new F).add(k.cards.get(0)),this.allRecomendSingles.add(B),k.clear());if(!this.straightList.isEmpty())for(i=0;i<this.straightList.size();i++)for(s=(A=this.straightList.get(i)).size()-1;4<s;s--)L=A.get(s),(N=new F).add(L),this.allRecomendSingles.add(N);for(i=0;i<this.cardInfoList.size();i++){var k=this.cardInfoList.get(i),w=new F;2==k.totalSize&&(w.addAll(k.cards.getArray()),this.pairList.add(w),(B=new F).add(w.get(0)),this.allRecomendSingles.add(B),k.clear())}for(i=0;i<this.cardInfoList.size();i++){k=this.cardInfoList.get(i);var T=new F;3==k.totalSize&&(T.addAll(k.cards.getArray()),this.threeList.add(T),(B=new F).add(T.get(0)),this.allRecomendSingles.add(B),k.clear())}if(!this.pairStraightList.isEmpty())for(i=0;i<this.pairStraightList.size();i++){var P=this.pairStraightList.get(i);for(s=0;s<P.size();s+=2)(B=new F).add(P.get(s)),this.allRecomendSingles.add(B);if(P.size()<7)for(s=0;s<P.size();s+=2)(S=new F).add(P.get(s)),S.add(P.get(s+1)),this.allRecomendPairs.add(S);else for(s=P.size()-1;0<=s;s-=2)(S=new F).add(P.get(s)),S.add(P.get(s-1)),this.allRecomendPairs.add(S)}this.allRecomendPairs.addAll(r),this.allRecomendPairs.addAll(n);var x=new F;for(i=0;i<this.allPairs.size();i++){var S=this.allPairs.get(i);for(s=0;s<this.allRecomendPairs.size()&&S.get(0).rank!=this.allRecomendPairs.get(s).get(0).rank;s++);s>this.allRecomendPairs.size()-1&&x.add(S)}if(this.allRecomendPairs.addAll(x),!this.threeStraightList.isEmpty())for(i=0;i<this.threeStraightList.size();i++){var R=this.threeStraightList.get(i);for(s=0;s<R.size();s+=3)(B=new F).add(R.get(s)),this.allRecomendSingles.add(B)}if(!this.straightList.isEmpty())for(i=0;i<this.straightList.size();i++){var A=this.straightList.get(i);for(s=(A.size(),4);0<=s;s--){var L=A.get(s),N=new F;N.add(L),this.allRecomendSingles.add(N)}}for(1==this.kingList.size()&&((B=new F).add(this.kingList.get(0)),this.allRecomendSingles.add(B),this.singleList.add(this.kingList.removeAtIndex(0))),i=0;i<this.cardInfoList.size();i++){k=this.cardInfoList.get(i);var I=new F;4==k.totalSize&&(I.addAll(k.cards.getArray()),this.bombList.add(I),(B=new F).add(I.get(0)),this.allRecomendSingles.add(B),this.allThrees.add(k.cards.getSubList(0,3)),k.clear())}if(2==this.kingList.size()){var B=new F;B.add(this.kingList.get(0)),this.allRecomendSingles.add(B),(B=new F).add(this.kingList.get(1)),this.allRecomendSingles.add(B)}this.setStrategy()},this.setStrategy=function(){for(this.weakList.clear(),this.strongList.clear(),d=0;d<this.threeStraightList.size();d++){var e=new F;e.addAll(this.threeStraightList.get(d).getArray());var t=Math.floor(e.size()/3);if(this.singleList.size()>=t)for(n=0;n<t;n++){var i=this.singleList.removeAtIndex(0);e.add(i)}else if(this.pairList.size()>=t)for(n=0;n<t;n++)o=this.pairList.removeAtIndex(0),e.addAll(o.getArray());this.weakList.add(e)}for(d=0;d<this.threeList.size();d++){var a=new F;a.addAll(this.threeList.get(d).getArray());var s=this.cardAnalyzer.verifyForSupreme(a);if(!this.singleList.isEmpty())for(n=0;n<this.singleList.size();n++){var r=new F;if(r.add(this.singleList.get(n)),!this.cardAnalyzer.verifyForSupreme(r)||4==this.cards.size()){a.add(this.singleList.removeAtIndex(n));break}}if(3==a.size()&&!this.pairList.isEmpty())for(var n=0;n<this.pairList.size();n++)if(o=this.pairList.get(n),!this.cardAnalyzer.verifyForSupreme(o)||5==this.cards.size()){a.addAll(this.pairList.removeAtIndex(n).getArray());break}s?this.strongList.add(a):this.weakList.add(a)}for(d=0;d<this.singleList.size();d++)(h=new F).add(this.singleList.get(d)),this.cardAnalyzer.verifyForSupreme(h)?this.strongList.add(h):this.weakList.add(h);for(d=0;d<this.pairList.size();d++){var o=this.pairList.get(d);this.cardAnalyzer.verifyForSupreme(o)?this.strongList.add(o):this.weakList.add(o)}for(d=0;d<this.pairStraightList.size();d++){var l=this.pairStraightList.get(d);14==l.get(l.size()-1).rank?this.strongList.add(l):this.weakList.add(l)}for(d=0;d<this.straightList.size();d++){var c=this.straightList.get(d);14==c.get(c.size()-1).rank?this.strongList.add(c):this.weakList.add(c)}for(this.sortGroupList(this.weakList),this.sortGroupList(this.strongList),d=0;d<this.bombList.size();d++)this.strongList.add(this.bombList.get(d));if(2==this.kingList.size()){for(var h=new F,d=0;d<this.kingList.size();d++)h.add(this.kingList.get(d));this.strongList.add(h)}},this.getPossibleCards=function(e){if(this.analyzeCards(e),0<this.getBetCardsType(e))return e;var t=new F,i=new F;if(this.allPairStraights.isEmpty()||(t=this.allPairStraights.get(0)),!this.allStraights.isEmpty())return i=this.allStraights.get(0),t.size()<=i.size()&&(t=i),t;if(t.clear(),0<this.bombList.size()&&1<this.allPairsForAI.size())return t.addAll(this.bombList.get(0)),t.addAll(this.allPairsForAI.get(0)),t.addAll(this.allPairsForAI.get(1)),t;if(t.clear(),0<this.bombList.size()&&1<this.allSinglesForAI.size())return t.addAll(this.bombList.get(0)),t.add(this.allSinglesForAI.get(0)),t.add(this.allSinglesForAI.get(1)),t;t.clear();for(var a=0,s=0;s<this.weakList.size();s++)(r=this.weakList.get(s)).size()>a&&(a=r.size(),t=r);for(s=0;s<this.strongList.size();s++){var r=this.strongList.get(s);r.size()>a&&(a=r.size(),t=r)}return t},this.getBetCardsType=function(e){var t=e.size();switch(t){case 1:return 1;case 2:if(15<e.get(0).rank&&15<e.get(1).rank)return 14;if(e.get(0).rank==e.get(1).rank)return 2;break;case 3:if(e.get(0).rank==e.get(1).rank&&e.get(0).rank==e.get(2).rank)return 3;break;case 4:for(var i=0,a=0;a<3;a++)e.get(a).rank==e.get(a+1).rank&&i++;if(3==i)return 13;if(e.get(0).rank==e.get(1).rank&&e.get(0).rank==e.get(2).rank)return 6;if(e.get(1).rank==e.get(2).rank&&e.get(1).rank==e.get(3).rank)return 6;break;case 5:for(i=0,a=0;a<4;a++)e.get(a).rank==e.get(a+1).rank&&i++;if(4==i)return 14;if(2<=i)return 7;for(a=0;a<t-1;a++)if(e.get(a+1).rank-e.get(a).rank!=1)return-1;if(e.get(t-1).rank<15)return 4;break;default:for(i=0,a=0;a<4;a++)e.get(a).rank==e.get(a+1).rank&&i++;if(6==t&&5==i)return 15;if(7==t&&6==i)return 16;if(8==t&&7==i)return 17;if(t%2==0){i=0;var s=e.get(0).rank;for(a=0;a<t/2;a++)e.get(2*a).rank==e.get(2*a+1).rank&&e.get(2*a).rank==s+a&&i++;if(i==t/2&&e.get(t-1).rank-e.get(0).rank==t/2-1&&e.get(t-1).rank<15)return 5}var r=[];for(a=0;a<15;a++){var n=new E(a+3);r[a]=n}for(a=0;a<t;a++)r[e.get(a).rank-3].addCard(e.get(a));var o=0,l=0,c=0,h=0,d=-1,u=0;for(a=0;a<r.length;a++)4==r[a].totalSize&&o++,3==r[a].totalSize&&r[a].cardRank<15&&(-1==d?(d=a,l++):a-d==1&&(d=a,l++)),2==r[a].totalSize&&c++,1==r[a].totalSize&&(h++,15<r[a].cardRank&&u++);if(0==h&&0==c&&0==o&&1<l)return 8;if(0==c&&0==o&&1<l&&l==h&&u<2)return 9;if(0==h&&0==o&&1<l&&l==c)return 10;if(0==c&&0==l&&1==o&&2==h&&u<2)return 11;if(2==c&&0==l&&1==o&&0==h)return 12;for(a=0;a<t-1;a++)if(1!=Math.abs(e.get(a+1).rank-e.get(a).rank))return-1;if(e.get(t-1).rank<15)return 4}return-1},this.sortGroupList=function(e){var t=e.getArray();e.clear();for(var i=1;i<t.length;i++){for(var a=t[i],s=i-1;0<=s&&t[s].get(0).rank>a.get(0).rank;)t[s+1]=t[s],s--;t[s+1]=a}e.addAll(t)}},cc._RF.pop()},{ArrayList:"ArrayList",CardInfo:"CardInfo",FtkCardAnalyzer:"FtkCardAnalyzer"}],FtkSummaryDetail:[function(e,t,i){"use strict";cc._RF.push(t,"48e3eqGgw9Mjqv2xoGiA96T","FtkSummaryDetail");var a=e("HHCommon");cc.Class({extends:a,properties:{workitem:{default:null,type:cc.Node},entries:{default:[],type:cc.Node},base:{default:null,type:cc.Node},win:{default:null,type:cc.Node},draw:{default:null,type:cc.Node},lose:{default:null,type:cc.Node},player_1:{default:null,type:cc.Node},player_3:{default:null,type:cc.Node},effect:cc.Node},onLoad:function(){this.disDialogEffect(this.base);var t=this;this.workitem.on("getout",function(e){cc.global.backToHall=!0,cc.global.user.roomid="",t.parent.loadding(),t.parent.rerenderPlayers=[],t.parent.isOnSummary=!1,t.parent.scene("hall",t.parent),e.stopPropagation()}),1==cc.global.game_theme_idx?(this.node.children[2].children[0].active=!0,this.node.children[2].children[1].active=!1):(this.node.children[2].children[0].active=!1,this.node.children[2].children[1].active=!0),this.node.height*=cc.global.narrowContentRatio;var e=this;this.iswin=!1,this.effect.getComponent(sp.Skeleton).setCompleteListener(function(){e.iswin?e.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_winloop",!0):e.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_loseloop",!0)})},create:function(e,t,i){var a=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=this;if(this.parent=e,this.obsmode=i,s.entries&&!(s.entries.length<=0)){for(var r=0;r<s.entries.length;r++)s.entries[r].active=!1;for(r=0;r<t.players.length;r++){var n=t.players[r];if(n.userid==cc.global.user.id&&"no"==cc.global.amObserve)this.entries[0].active=!0,this.disLevelInfo(n),this.process(n,null,this.entries[0].children[3],this.entries[0].children[5],this.entries[0].children[6],null,this.entries[0].children[0],this.entries[0].children[1],this.entries[0].children[2]),n.getout?setTimeout(function(){s&&s.node&&s.node.dispatchEvent(new cc.Event.EventCustom("getout",!0))},4500):setTimeout(function(){s&&s.node&&s.parent&&s.parent.summarypage&&(s.parent.restart(),s.parent.summarypage.destroy(),s.parent.summarypage=null)},5e3);else{var o=e.getPlayer(n.userid).seatid;s.entries[o].active=!0,this.process(n,null,this.entries[o].children[3],this.entries[o].children[5],this.entries[o].children[6],null,this.entries[o].children[0],this.entries[o].children[1],this.entries[o].children[2])}}a&&(this.player_1.active=!1,this.player_3.active=!1),"yes"==cc.global.amObserve&&setTimeout(function(){s&&s.node&&(s.parent.restart(),s.parent.summarypage.destroy(),s.parent.summarypage=null)},5e3)}},process:function(e,t,i,a,s,r,n,o,l){0<=e.score?i.getComponent(cc.Label).string="+ "+this.numformat(e.score):i.getComponent(cc.Label).string="- "+this.numformat(-1*e.score),0<=e.exp?a.getComponent(cc.Label).string="+ "+this.numformat(e.exp):a.getComponent(cc.Label).string="- "+this.numformat(Math.abs(e.exp)),s.getComponent(cc.Label).string=e.rank+" th",null!=n&&(n.active=e.getout),"normal"==cc.global.user.selplayway?(l.children[0].active=!0,l.children[1].active=!1):"diamond"==cc.global.user.selplayway&&(l.children[0].active=!1,l.children[1].active=!0)},disLevelInfo:function(e){this.win.active=!1,this.draw.active=!1,this.lose.active=!1,this.effect.active=!1,this.iswin=2==e.win,2==e.win?(this.effect.active=!0,this.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_win",!1),cc.global.audio.playSummaryAud("win")):(1==e.win?this.draw.active=!0:(this.effect.active=!0,this.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_lose",!1)),cc.global.audio.playSummaryAud("lose"))},onLeaveClick:function(){this.parent.onclickBack()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],GameCanvas:[function(e,t,i){"use strict";cc._RF.push(t,"fe9dek6hJJFeJYZj+QXN6db","GameCanvas"),cc.Class({extends:cc.Canvas,properties:{label:{default:null,type:cc.Label},orientation:{default:1,type:cc.Integer}},onLoad:function(){var e=cc.view.getFrameSize();cc.director.getWinSize(),cc.director.getWinSizeInPixels();cc.sys.isMobile&&this.orientation!=cc.global.orientation&&(cc.view.setFrameSize(e.height,e.width),jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","setOrientation","(I)V",this.orientation),cc.global.orientation=this.orientation,1==this.orientation?cc.view.setDesignResolutionSize(720,1280,cc.ResolutionPolicy.FIXED_HEIGHT):cc.view.setDesignResolutionSize(1280,720,cc.ResolutionPolicy.FIXED_WIDTH))},onclick:function(){}}),cc._RF.pop()},{}],GameHall1:[function(e,t,i){"use strict";cc._RF.push(t,"3aa1aJFBqBOl4We5bRE29HO","GameHall1");var a=e("HHCommon");cc.Class({extends:a,properties:{exitButton:cc.Node,username:{default:null,type:cc.Label},goldcoins:{default:null,type:cc.Label},avatar:{default:null,type:cc.Sprite},main:{default:null,type:cc.Node},gmidtitle:{default:null,type:cc.Label},myinfoview:{default:null,type:cc.Prefab},freeroomtypes:{default:null,type:cc.Node},gamelist:{default:null,type:cc.Node},switchtogame:{default:null,type:cc.Node},dialogpos:{default:null,type:cc.Node},stopevent:cc.Node,show_menu_btn:cc.Node,show_menu_btn_top:cc.Node,hide_menu_btn:cc.Node,menu_layer:cc.Node,playways:cc.Node,back_button:cc.Node,user_layer:cc.Node,gametitle:cc.Node,gametitleatlas:cc.SpriteAtlas,scroll_top:cc.Node,scroll_bottom:cc.Node,hall_toast:cc.Node,btnNewsBubble:{default:null,type:cc.Node},tutorial_base:cc.Node,tutorial_text:cc.Label,tutorial_message:cc.Node,train_btn:cc.Node,find_btn:cc.Node,total_players:cc.Node,total_users:cc.Node,holiday_banner:cc.Node,search_form:cc.Node,search_result:cc.Node,game_icon_prefab:cc.Prefab,folder_node:cc.Node,recentlist:cc.Node,view_tab:cc.Node,scroll_view:cc.Node,scroll_content:cc.Node,free_bonus_label:cc.Label,offline_node:cc.Node,ads_view:cc.Node,total_count:cc.Node},onLoad:function(){if(cc.global.isOffline)cc.global.cur_game_code="",cc.global.user.roomid="",this.checkOffline(),this.offline_node.active=!0;else{var e=JSON.parse(cc.sys.localStorage.getItem("hall_view_tab"));e||(e=2,cc.sys.localStorage.setItem("hall_view_tab",JSON.stringify(e))),e=2,this.hall_view_tab=3-e,this.toggle_hall_view(),this.offline_node.active=!1}if(cc.global.stopevent=!1,this.initTotalGame(),cc.global.enter_observer_room&&1==cc.global.enter_observer_room){cc.global.user.selplayway="normal",cc.global.user.roomInType="NormalJoin";var t={roomid:cc.global.extparams.roomid};this.enterGame(t)}else{this.addRecentGameIcon("");(new Date).getHours();if(cc.global.isDark=!0,this.stopevent.active=!1,this.ready()){this.initLayout(),cc.global.replayState&&cc.global.replayState.enterReplay&&this.onClickHistory(),this.curScreen="",this.username.string=cc.global.user.nickname,this.loadAvatar(cc.global.user.avatarurl,cc.global.user.gender),this.playway_down=!1,this.onClickResizeScrollView();var a=this;if(this.main.getComponent(cc.Animation).on("finished",function(e){a.onAnimationFinshed(e.target.name)}),this.main.getComponent(cc.Animation).on("play",function(e){a.onAnimationStarted(e.target.name)}),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.global.show_menu_indicator=0,this.updateNotifyBadge(),"chess"==cc.global.cur_game_code||"koni"==cc.global.cur_game_code||"paduk"==cc.global.cur_game_code||"miner"==cc.global.cur_game_code||"basket"==cc.global.cur_game_code||"animal"==cc.global.cur_game_code||"animal1"==cc.global.cur_game_code||"ftk"==cc.global.cur_game_code||"order"==cc.global.cur_game_code?this.train_btn.active=!1:this.train_btn.active=!0,"basket"==cc.global.cur_game_code||"miner"==cc.global.cur_game_code?this.find_btn.active=!1:this.find_btn.active=!0,this.switchtogame.active=!1,cc.global.socket.on("gpc",function(e){a.initLobbyData(e.command),a.updateHallTabs()}),cc.global.socket.on("sel_game",function(e){if(e&&e.command){var t=e.command.split("\n");"00"==t[0]?a.sel_roomtype&&a.sel_roomtype.showLoading&&a.sel_roomtype.showLoading(!0):"01"!=t[0]&&t[1]&&("."==t[1]&&cc.global.audio.playVoiceSpeech("support/1_no_open_time"),a.alert(t[1]))}}),cc.global.socket.on("enr",function(e){var t=e.command.split("\n");if(t&&"00"==t[0])if(a.stopevent.active=!0,cc.global.cur_game_condition=t[4],cc.global.cur_game_code=t[3],cc.global.curPlaywayScore=t[2],cc.global.user.selplayway="normal",cc.global.user.roomInType="NormalJoin","play"==t[5])cc.global.user.roomid=t[1],a.enterGame({});else{var i={roomid:t[1]};a.enterGame(i)}}),this.initEventCallback(),cc.game.setFrameRate(30),null!=cc.global&&null!=cc.global.user&&!cc.global.isOffline){this.getDailyReward(),this.isRSBarOn=!1,this.roomSpawnTimer=-1,cc.global.gamestatus="ready",this.updateBalance(),this.checkGameStatus();a=this;cc.global.user.goldcoins<30&&this.alert("."),cc.global.outReasonMsg&&"limittime"==cc.global.outReasonMsg&&(cc.global.outReasonMsg="",this.alert("."))}cc.global.audio.playHallBgm();var i=cc.sys.localStorage.getItem("tutorial_off");this.tutorial_off=null!=i&&!1!==i,this.tutorial_off=!0,this.tutorial_id=cc.sys.localStorage.getItem("current_tutorial"),!this.tutorial_id||isNaN(this.tutorial_id)||parseInt(this.tutorial_id)<1?this.tutorial_id=1:this.tutorial_id=parseInt(this.tutorial_id),this.tutorial_base.active=!1,cc.global.holiday&&cc.global.holiday.banner?(this.holiday_banner.active=!0,cc.global.holiday.banner_label&&(this.holiday_banner.children[0].getComponent(cc.Label).string=cc.global.holiday.banner_label)):this.holiday_banner.active=!1,this.searchId=0,null!=cc.global.feedback&&""!=cc.global.feedback&&(this.alert(cc.global.feedback),cc.global.feedback=""),this.schedule(this.animatePageView,3)}}},onDestroy:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),this.stopevent.active=!1},onKeyDown:function(e){switch(e.keyCode){case cc.KEY.escape:case cc.KEY.back:return void(0==this.stopevent.active&&(null!=cc.global.alertdialog?this.closealert():1==this.show_dialog?this.closeDialog(cc.global.openwin.getComponent("HHCommon")):null!=cc.global.openwin?this.closeOpenWin():this.onClickExit()))}},enterGame:function(e){cc.global.enter_observer_room=!1,this.closeOpenWin(),this.node.stopAllActions(),this.hall_toast.active=!1;var t=cc.global.cur_game_code;"ffa"==t||"chess"==t||"ofc"==t||"miner"==t||"ftk"==t||"order"==t?this.switchtogame.children[0].children[0].rotation=this.switchtogame.children[1].children[0].rotation=0:(this.switchtogame.children[0].children[0].rotation=-90,this.switchtogame.children[1].children[0].rotation=90),this.switchtogame.active=!0,this.switchtogame.getComponent(cc.Animation).play("door_close"),cc.global.audio.playEffectAud("door",!1);var i=this;setTimeout(function(){i.preload(e,i)},700)},initLayout:function(){this.playways.parent.y=1280*(1-1/cc.global.narrowContentRatio)/2*cc.global.narrowContentRatio;var e=1280/cc.global.narrowContentRatio-762;this.playways.children[0].y=157/cc.global.narrowContentRatio,e<685?this.ads_view.active=!1:(this.ads_view.active=!0,this.ads_view.y=360/cc.global.narrowContentRatio-this.playways.parent.y),cc.global.isOffline&&(this.ads_view.active=!0),this.gametitle.children[2].children[0].getComponent(cc.Sprite).spriteFrame=this.gametitle.children[2].children[2].getComponent(cc.Sprite).spriteFrame=this.gametitleatlas.getSpriteFrame("decoration_"+(1+cc.global.theme_idx%2)),this.search_form.y=600/cc.global.narrowContentRatio-this.playways.parent.y},addRecentGameIcon:function(e){if(!cc.global.isOffline){var t=["basket_0","yut_0","archery_0","paduk_0"],i=JSON.parse(cc.sys.localStorage.getItem("recent"));if(i||(i=["basket_0","yut_0","archery_0","paduk_0"]),cc.global.newgameTabIdx[e]){for(var a=[],s=!1,r=0;r<i.length;r++)a.push(i[r]),i[r]==e&&(s=!0);for(r=a.length;r<4;r++)for(var n=0;n<4;n++)if(-1==a.indexOf(t[n])){a.push(t[n]);break}for(i=a,s||i.unshift(e);4<i.length;)i.pop()}cc.sys.localStorage.setItem("recent",JSON.stringify(i)),this.recentlist.removeAllChildren();for(r=0;r<4;r++)if(cc.global.newgameTabIdx[i[r]]){var o=cc.instantiate(this.game_icon_prefab);o.getComponent("GameIcon").init(this,i[r]),o.parent=this.recentlist}}},start:function(){this.updateHall(),this.ani_game_idx=0,this.checkTutorial()},gameSelect:function(e){var t=this;this.sel_roomtype=e,this.loadding(),setTimeout(function(){t.closeloadding(),cc.global.isOffline&&cc.global.cur_game_code&&(cc.global.curPlaywayScore=1,t.enterGame({}))},300),cc.global.isOffline||this.socket().send("sel_game",cc.global.hallTabIdx,cc.global.curPlaywayScore)},updateBalance:function(){if(this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(cc.global.user.goldcoins))),this.goldcoins)if(0<cc.global.user.loan_amount){var e="";1==cc.global.user.loan_date?e+=".":0<cc.global.user.loan_date?e+=cc.global.user.loan_date+".":e+="Loan date!.",this.goldcoins.node.children[1].active=!0,this.goldcoins.node.children[1].getComponent(cc.Label).string=e}else this.goldcoins.node.children[1].active=!1},getDailyReward:function(){if(cc.global.user.drewards){var i=this;cc.global.audio.playVoiceSpeech("support/11_hellow"),cc.loader.loadRes("prefab/main/DailyRewardDlg",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("DailyRewardDlg").init(i,cc.global.user.drewards),cc.global.openwin.parent=i.root())})}},animateGameIcon:function(){},updateHallTabs:function(){if(this.gamelist){for(var e=0;e<this.gamelist.children.length;e++){var t=!1;if(null!=(r=this.gamelist.children[e].getComponent("NotifyTabButton"))&&null!=cc.global.newgameTabIdx[r.node.name]){var i=cc.global.newgameTabIdx[r.node.name].idx,a=0;r&&i==cc.global.hallTabIdx&&(t=!0),r&&null!=cc.global.allgames[i]&&(a=cc.global.allgames[i].players),r.init(t,a)}}var s=this.getLanguageText("PLAYERS_0");this.total_players.getComponent(cc.Label).string=this.numformat(cc.global.totalUsersinRoom)+" "+s,this.total_users.getComponent(cc.Label).string=this.numformat(cc.global.totalUsers)+" "+s;for(e=0;e<this.freeroomtypes.children.length;e++){var r;(r=this.freeroomtypes.children[e].getComponent("RoomType")).changeStates(this,e)}}},hideAllRoomLoading:function(){for(var e=0;e<this.freeroomtypes.children.length;e++){this.freeroomtypes.children[e].getComponent("RoomType").showLoading(!1)}},updatePlaywayModes:function(){if(0!=this.freeroomtypes.length)for(var e=new cc.Color(132,132,132),t=0;t<this.freeroomtypes.children.length;t++){var i=0,a=this.freeroomtypes.children[t].getComponent("RoomType").playway;if(cc.global.lobbyrooms)for(var s=0;s<cc.global.lobbyrooms.length;s++)cc.global.lobbyrooms[s].game==cc.global.cur_game_code&&"champion"!=cc.global.lobbyrooms[s].name&&cc.global.lobbyrooms[s].score==a.score&&0<cc.global.lobbyrooms[s].playerlist.length&&i++;0<a.score?a.score==cc.global.curPlaywayScore?this.freeroomtypes.children[t].getComponent("NotifyTabButton").init(!0,i,!1,e,cc.Color.WHITE,cc.v2(10,0)):this.freeroomtypes.children[t].getComponent("NotifyTabButton").init(!1,i,!1,e,cc.Color.WHITE,cc.v2(10,0)):a.score==cc.global.curPlaywayScore?this.freeroomtypes.children[t].getComponent("NotifyTabButton").init(!0,0,!1,e,cc.Color.WHITE,cc.v2(10,0)):this.freeroomtypes.children[t].getComponent("NotifyTabButton").init(!1,0,!1,e,cc.Color.WHITE,cc.v2(10,0))}},onChangeTab:function(e,t){cc.global.hallTabIdx!=t&&(cc.global.hallTabIdx=parseInt(t))},changeTitle:function(){var e="";for(var t in cc.global.newgameTabIdx)if(cc.global.newgameTabIdx[t].idx==this.currentGameData().idx){e=this.getLanguageText(t.toUpperCase());break}this.currentGameData()&&(this.gametitle.children[2].children[1].getComponent(cc.Label).string=e)},updateHall:function(){if(null==this.currentGameData())return this.playway_down&&(this.playway_down=!1,this.main.getComponent(cc.Animation).play("playways_down")),cc.global.hallTabIdx=0,cc.global.curPlaywayScore=0,this.gameSelect(),void this.updateHallTabs();cc.global.hallTabIdx=this.currentGameData().idx,cc.global.curPlaywayScore=0;var e=cc.callFunc(this.changeTitle,this);cc.global.isOffline||(this.playway_down?(this.main.getComponent(cc.Animation).play("playways_sel"),this.gametitle.runAction(cc.sequence(cc.scaleTo(.3,0,0),e,cc.scaleTo(.4,1.2,1.2),cc.scaleTo(.2,1,1)))):(this.playway_down=!0,this.main.getComponent(cc.Animation).play("playways_up"),this.gametitle.scaleX=this.gametitle.scaleY=0,this.gametitle.runAction(cc.sequence(cc.delayTime(.3),e,cc.scaleTo(.4,1.2,1.2),cc.scaleTo(.2,1,1))))),this.hideAllRoomLoading(),this.updateHallTabs(),this.gameSelect()},onClick:function(e,t){cc.global.audio.playEffectAud("hall_click_game");if(4==this.tutorial_id&&this.goNextTutorial(),this.curScreen!=t){if("more"!=(this.curScreen=t)){var i=t.split(",")[0];2==i.split("_").length&&(cc.global.cur_game_code=i.split("_")[0],cc.global.cur_game_condition=i.split("_")[1],"chess"==cc.global.cur_game_code||"koni"==cc.global.cur_game_code||"paduk"==cc.global.cur_game_code||"miner"==cc.global.cur_game_code||"basket"==cc.global.cur_game_code||"animal"==cc.global.cur_game_code||"animal1"==cc.global.cur_game_code||"ftk"==cc.global.cur_game_code||"order"==cc.global.cur_game_code?this.train_btn.active=!1:this.train_btn.active=!0,"basket"==cc.global.cur_game_code||"miner"==cc.global.cur_game_code?this.find_btn.active=!1:this.find_btn.active=!0)}else this.curScreen="",cc.global.cur_game_code="",cc.global.cur_game_condition=0;this.updateHall()}},checkGameStatus:function(){""!=cc.global.user.roomid&&(this.closeOpenWin(),this.enterGame({}))},onClickCreatePrivateRoom:function(){this.hall_toast.children[5].children[2].active=!1,7==this.tutorial_id&&this.goNextTutorial();var i={gameidx:cc.global.hallTabIdx,score:cc.global.curPlaywayScore};cc.global.curPlaywayScore=0,this.onClickCancelGame();var a=this;this.closeOpenWin(),cc.loader.loadRes("prefab/main/CreateOrJoinDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("CreateOrJoinDialog").init(a,i),cc.global.openwin.parent=a.dialogpos)})},onClickJoinPrivateRoom:function(){this.tutorial_base.children[1].children[1].active=!1,8==this.tutorial_id&&this.goNextTutorial(),this.closeOpenWin();var i=this;cc.loader.loadRes("prefab/main/CreateOrJoinDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("CreateOrJoinDialog").init(i,null),cc.global.openwin.parent=i.dialogpos)})},onClickHelp:function(){var i=this;this.closeOpenWin(),cc.loader.loadRes("prefab/main/HelpDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("HelpDialog").init(i,0),cc.global.openwin.parent=i.dialogpos,i.openDialog())})},onClickFeedBack:function(){cc.sys.isNative&&jsb.reflection.callStaticMethod("org.cocos2dx.javascript.LoginController","goFeedback","()V")},onClickShop:function(){},onClickRank:function(){if(cc.global.isOffline)this.confirmToOnline();else{var i=this;this.closeOpenWin(),cc.loader.loadRes("prefab/main/RankDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("RankDialog").init(i,0),cc.global.openwin.parent=i.dialogpos,i.openDialog())})}},onClickRankHistory:function(){if(cc.global.isOffline)this.confirmToOnline();else{var i=this;this.closeOpenWin(),cc.loader.loadRes("prefab/main/RewardHistory",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("RewardHistory").init(i),cc.global.openwin.parent=i.dialogpos,i.openDialog())})}},onClickRecord:function(){if(cc.global.isOffline)this.confirmToOnline();else{var i=this;this.closeOpenWin(),cc.loader.loadRes("prefab/main/RecordDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("RecordDialog").init(i,0),cc.global.openwin.parent=i.dialogpos,i.openDialog())})}},onClickMissions:function(){if(cc.global.isOffline)this.confirmToOnline();else{this.closeOpenWin();var n=this;n.loadding(),cc.global.http.httpPost("/hall/checkmission",{},function(e){if(n.closeloadding(),null!=e){var t=e.split("$$$");if(1<t.length&&"00"==t[0]){for(var i=JSON.parse(t[1]),a=0;a<cc.global.missions.length;a++)for(var s=0;s<i.length;s++)i[s].mission==cc.global.missions[a].id&&(i[s].description=cc.global.missions[a].description,i[s].game=cc.global.missions[a].game,i[s].reward=cc.global.missions[a].reward,i[s].daily=cc.global.missions[a].daily);cc.global.newMissions=0,cc.loader.loadRes("prefab/main/MissionDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("MissionDialog").init("hall",n,i),cc.global.openwin.parent=n.dialogpos,n.openDialog())})}else{var r=n.getLanguageText("ERROR_IN_SERVER_RESPONSE");n.alert(r+": 02")}}else{r=n.getLanguageText("ERROR_IN_SERVER_RESPONSE");n.alert(r+": 01")}},function(){n.closeloadding();var e=n.getLanguageText("CONNECTING_FAILED_0");n.alert(e)})}},onClickAvatar:function(){this.username.node.children[0].active=!1,1==this.tutorial_id&&this.goNextTutorial();var i=this;this.closeOpenWin(),cc.loader.loadRes("prefab/main/AvatarDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("AvatarDialog").init(i),cc.global.openwin.parent=i.dialogpos,i.openDialog())})},onClickHoliday:function(){var e=this;e.closeOpenWin(),this.holiday_banner.active=!1,cc.global.holiday.msg_content&&this.alertForCallBack(cc.global.holiday.msg_content,function(){e.closealert(),cc.global.openwin=cc.instantiate(e.myinfoview),cc.global.openwin.getComponent("ChargeDialog").init(e,2),cc.global.openwin.parent=e.dialogpos,e.openDialog()},{title:cc.global.holiday.msg_title})},onClickMyInfo:function(){cc.global.isOffline?this.confirmToOnline():(this.closeOpenWin(),this.goldcoins.node.children[0].active=!1,2==this.tutorial_id&&this.goNextTutorial(),cc.global.openwin=cc.instantiate(this.myinfoview),cc.global.openwin.getComponent("ChargeDialog").init(this,0),cc.global.openwin.parent=this.dialogpos,this.openDialog())},onClickNews:function(){var i=this;this.closeOpenWin(),cc.loader.loadRes("prefab/main/NewsDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("NewsDialog").init(i,0),cc.global.openwin.parent=i.dialogpos,i.openDialog())})},onClickTrain:function(){if(cc.global.curPlaywayScore=1,"tetris"!=cc.global.cur_game_code)this.gameSelect();else{cc.global.cur_game_condition=20,cc.global.user.roomInType="NormalJoin";var e={roomid:this.getLanguageText("TRAINING_ROOM_0")};this.enterGame(e)}},onClickLive:function(){this.closeOpenWin();var i=this;cc.loader.loadRes("prefab/main/LiveDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("LiveDialog").init(i),cc.global.openwin.parent=i.dialogpos,i.openDialog())})},onClickHistory:function(){if(cc.global.isOffline)this.confirmToOnline();else{this.closeOpenWin();var i=cc.global.replayState.enterReplay,a=this;cc.loader.loadRes("prefab/main/GamePlayHisDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("GamePlayHisDialog").init(a),cc.global.openwin.parent=a.dialogpos,i?(a.exitButton.active=!1,a.show_dialog=!0,a.main.x=-cc.global.ratioWidth,a.stopevent.active=!1):a.openDialog())})}},onClickSetting:function(){var i=this;this.closeOpenWin(),cc.loader.loadRes("prefab/main/SettingDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("SettingDialog").init(i,0),cc.global.openwin.parent=i.dialogpos,i.openDialog())})},onClickLanguage:function(){var i=this;this.closeOpenWin(),cc.loader.loadRes("prefab/main/LanguageDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("SettingDialog").init(i,0),cc.global.openwin.parent=i.dialogpos,i.openDialog())})},onClickShowMenu:function(){this.playway_down?(this.orgCurScreen=this.curScreen,this.curScreen="",cc.global.cur_game_code="",cc.global.cur_game_condition=0,this.updateHall()):(this.main.getComponent(cc.Animation).play("show_bottommenu"),this.show_menu_btn.children[0].children[0].active=!1,3==this.tutorial_id&&this.goNextTutorial())},onClickCancelGame:function(){cc.global.cur_game_condition=0,this.hideAllRoomLoading(),this.hall_toast.active=!1,cc.global.curPlaywayScore=0,this.gameSelect(),this.hall_toast.children[4].children[2].active=!1,this.tutorial_base.active=!1,6==this.tutorial_id&&this.goNextTutorial()},onClickHideMenu:function(){this.main.getComponent(cc.Animation).play("hide_bottommenu")},onClickPlaywaysDown:function(){this.orgCurScreen=this.curScreen,this.curScreen="",cc.global.cur_game_code="",cc.global.cur_game_condition=0,this.updateHall()},onClickResizeScrollView:function(){this.playway_down?(this.scroll_view.y=180+1280*(1-cc.global.narrowContentRatio),this.scroll_view.height=549+1280*(1-cc.global.narrowContentRatio)):(this.scroll_view.y=320/cc.global.narrowContentRatio,this.scroll_view.height=730/cc.global.narrowContentRatio-730*(1-cc.global.narrowContentRatio))},onAnimationStarted:function(e){switch(this.stopevent.active=!0,this.holiday_banner.active=!1,this.scroll_top.height=0,this.scroll_bottom.height=0,e){case"playways_down":this.show_menu_btn.children[0].active=!0,this.show_menu_btn.children[1].active=!1,this.scroll_view.stopAllActions(),this.scroll_view.runAction(cc.moveTo(.5,cc.p(0,320/cc.global.narrowContentRatio)));break;case"playways_up":this.back_button.active=!0,this.free_bonus_label.node.parent.active=!1,this.show_menu_btn.children[0].active=!1,this.show_menu_btn.children[1].active=!0,this.scroll_view.stopAllActions(),this.scroll_view.runAction(cc.moveTo(.5,cc.p(0,180+1280*(1-cc.global.narrowContentRatio))));break;case"show_bottommenu":this.hide_menu_btn.active=!0,this.show_menu_btn.children[0].active=!1,this.show_menu_btn.children[1].active=!0,this.scroll_view.active=!1,this.total_count.active=!1,this.offline_node.active=!1,this.free_bonus_label.node.parent.active=!1;break;case"hide_bottommenu":this.hide_menu_btn.active=!1,this.show_menu_btn.children[0].active=!0,this.show_menu_btn.children[1].active=!1,this.offline_node.active=!1,this.total_count.active=!1}},onAnimationFinshed:function(e){switch(this.stopevent.active=!1,e){case"playways_down":this.back_button.active=!1,cc.global.isOffline||(this.free_bonus_label.node.parent.active=!0);break;case"playways_up":case"show_bottommenu":break;case"hide_bottommenu":cc.global.isOffline?(this.offline_node.active=!0,this.total_count.active=!0):this.free_bonus_label.node.parent.active=!0,this.scroll_view.active=!0}this.checkTutorial(),this.onClickResizeScrollView()},openDialog:function(){this.exitButton.active=!1,this.show_dialog=!0,this.stopevent.active=!0;var i=this;if(cc.global.replayState.enterReplay)return this.main.x=-cc.global.ratioWidth,void(i.stopevent.active=!1);this.main.stopAllActions(),this.main.x=0,this.main.runAction(cc.sequence(cc.moveTo(.3,cc.p(-cc.global.ratioWidth,this.main.y)),cc.callFunc(function(e,t){i.main.x=-cc.global.ratioWidth,i.stopevent.active=!1})))},closeDialog:function(i){if(this.show_dialog){this.show_dialog=!1,this.main.x=-cc.global.ratioWidth,this.stopevent.active=!0,this.main.stopAllActions();var a=this;this.main.runAction(cc.sequence(cc.moveTo(.3,cc.p(0,this.main.y)),cc.callFunc(function(e,t){a.main.x=0,a.stopevent.active=!1,i.closeloadding(),i.closeOpenWin(),i.node.parent.removeChild(i.node),i.node.destroy(),a.exitButton.active=!0,a.checkTutorial()}))),this.updateNotifyBadge()}else this.main.x=0},updateNotifyBadge:function(){var e=!1,t=this.menu_layer.children[1].children[7].children[0].children[0];0<cc.global.newMissions?(t&&(t.active=!0),e=!0):t&&(t.active=!1),this.show_menu_btn.children[2].active=e},onScrollEvent:function(e,t){var i;switch(t){case 12:if(!e.content.position)return;this.scollpos=e.content.position;break;case 11:if(!e.content.position)return;if(!this.scollpos)return;e.content.position.x-this.scollpos.x,i=e.content.position.y-this.scollpos.y,this.scroll_top.height=0,this.scroll_bottom.height=0,this.playway_down&&i<=-40?this.onClickPlaywaysDown():!this.playway_down&&40<=i&&null==this.orgCurScreen&&(this.orgCurScreen="chess_0");break;case 4:if(!this.scollpos||!e.content.position)return;e.content.position.x-this.scollpos.x,i=e.content.position.y-this.scollpos.y,this.playway_down?(this.scroll_top.height=i<0?Math.min(80,-i):0,this.scroll_bottom.height=0):(this.scroll_top.height=0,this.scroll_bottom.height=0<i?Math.min(80,i):0)}},onClickTutrialOff:function(){this.tutorial_off=!0,cc.sys.localStorage.setItem("tutorial_off",!0),this.tutorial_base.active=!1,this.username.node.children[0].active=!1,this.goldcoins.node.children[0].active=!1,this.show_menu_btn.children[0].children[0].active=!1,this.freeroomtypes.children[0].children[1].active=!1,this.hall_toast.children[4].children[2].active=!1},goNextTutorial:function(){this.tutorial_off||7<=this.tutorial_id||(this.tutorial_id++,this.tutorial_base.active=!1,cc.sys.localStorage.setItem("current_tutorial",this.tutorial_id))},changeTutorial:function(e){this.tutorial_base.active=!0,this.tutorial_text.string=e;var t=this.tutorial_message.children[0].height;this.tutorial_message.children[0].y=t,this.tutorial_message.children[0].runAction(cc.moveTo(.2,cc.p(0,0)).easing(cc.easeOut(.4)))},checkTutorial:function(){if(!this.tutorial_off){var e=this;setTimeout(function(){e.processTutorial()},1e3)}},processTutorial:function(){if(!this.tutorial_off&&this.tutorial_base&&!(this.tutorial_base.active||7<=this.tutorial_id)){switch(this.tutorial_id){case 1:if(null==cc.global.openwin)return this.changeTutorial("1. ."),this.username.node.children[0].active=!0,void this.username.node.children[0].getComponent("sp.Skeleton").setAnimation(0,"znq_xsyd_05",!0);break;case 2:if(null==cc.global.openwin)return this.changeTutorial("2. ."),this.goldcoins.node.children[0].active=!0,void this.goldcoins.node.children[0].getComponent("sp.Skeleton").setAnimation(0,"znq_xsyd_09",!0);break;case 3:if(null==cc.global.openwin)return this.changeTutorial("3. ."),this.show_menu_btn.children[0].children[0].active=!0,void this.show_menu_btn.children[0].children[0].getComponent("sp.Skeleton").setAnimation(0,"znq_xsyd_05",!0);break;case 4:if(null==cc.global.openwin&&this.playways.children[1].active)return void this.changeTutorial("4. .");break;case 5:if(null==cc.global.openwin&&""!=this.curScreen)return this.changeTutorial("5. ."),this.freeroomtypes.children[0].children[1].active=!0,void this.freeroomtypes.children[0].children[1].getComponent("sp.Skeleton").setAnimation(0,"znq_xsyd_07",!0)}this.tutorial_base.active=!1}},onChangeKeyWordType:function(){switch(this.searchId++,2<this.searchId&&(this.searchId=0),this.searchId){case 0:this.search_form.children[1].children[0].getComponent(cc.Label).string="Nickname",this.search_form.children[1].children[2].active=!0,this.search_form.children[1].children[2].getComponent(cc.Label).string="",this.search_form.children[1].children[3].children[0].active=!1,this.search_form.children[1].children[3].children[1].active=!0;break;case 1:this.search_form.children[1].children[0].getComponent(cc.Label).string="Username",this.search_form.children[1].children[2].active=!0,this.search_form.children[1].children[2].getComponent(cc.Label).string="",this.search_form.children[1].children[3].children[0].active=!0,this.search_form.children[1].children[3].children[1].active=!1;break;case 2:this.search_form.children[1].children[0].getComponent(cc.Label).string="RoomNumber",this.search_form.children[1].children[2].active=!1,this.search_form.children[1].children[3].children[0].active=!1,this.search_form.children[1].children[3].children[1].active=!0}this.search_form.children[2].active=!1,this.search_form.children[1].children[3].children[0].getComponent(cc.EditBox).string="",this.search_form.children[1].children[3].children[1].getComponent(cc.EditBox).string="",this.onClickSearch()},onChangeKeyWordUserType:function(){},onChangeKeyword:function(){var e=this.search_form.children[1].children[3].children[1].getComponent(cc.EditBox).string;1==this.searchId&&(e=this.search_form.children[1].children[3].children[0].getComponent(cc.EditBox).string),this.search_form.children[2].active=""!=e},onClickCancelSearch:function(){this.search_form.children[2].active=!1,this.search_form.children[1].children[3].children[0].getComponent(cc.EditBox).string="",this.search_form.children[1].children[3].children[1].getComponent(cc.EditBox).string="",this.onClickSearch()},fadeSearchResult:function(){this.search_result.active=!0,this.search_result.opacity=0,this.search_result.stopAllActions(),this.search_result.runAction(cc.sequence(cc.fadeTo(.5,255),cc.delayTime(30),cc.fadeTo(.2,0)))},onClickSearch:function(){var a=this,e=this.search_form.children[1].children[3].children[1].getComponent(cc.EditBox).string;if(1==this.searchId&&(e=this.search_form.children[1].children[3].children[0].getComponent(cc.EditBox).string),""==e)return a.search_result.active=!1,void(a.search_result.children[0].getComponent(cc.Label).string="no Search result.");this.loadding(),cc.global.http.httpPost("/hall/search",{type:this.searchId<2?"Username":"Room Number",prefix:this.search_form.children[1].children[2].getComponent(cc.Label).string,keyword:e},function(e){a.closeloadding(),a.fadeSearchResult();var t=a.parse(e);if(a.search_player_roomid="",t&&"00"==t.status)if("user"==t.result){a.search_result.children[0].active=!1,a.search_result.children[1].active=!0,a.search_result.children[2].active=!1;var i=a.search_result.children[1];a.loadAvatar(t.avatarurl,t.gender,i.children[0].children[0]),i.children[1].getComponent(cc.Label).string=t.username,t.online?(i.children[2].children[0].active=!1,i.children[2].children[1].active=!0,t.inroom?(a.search_player_roomid=t.roomid,i.children[2].children[1].children[1].active=!0,i.children[2].children[1].children[1].getComponent(cc.Label).string=t.roominfo,i.children[2].children[1].children[2].getComponent(cc.Label).string=t.playerstatus,i.children[3].children[0].active=!0):(i.children[2].children[1].children[1].active=!1,i.children[2].children[1].children[2].getComponent(cc.Label).string="Pending",i.children[3].children[0].active=!1)):(i.children[2].children[0].active=!0,i.children[2].children[1].active=!1,i.children[3].children[0].active=!1)}else a.search_result.children[0].active=!1,a.search_result.children[1].active=!1,a.search_result.children[2].active=!0,a.search_result.children[2].getComponent("GameLiveRow").init(a,t.room);else t&&t.msg?a.search_result.children[0].getComponent(cc.Label).string=t.msg:a.search_result.children[0].getComponent(cc.Label).string="No search result.",a.search_result.children[0].active=!0,a.search_result.children[1].active=!1,a.search_result.children[2].active=!1},function(){a.closeloadding(),a.fadeSearchResult(),a.search_result.children[0].getComponent(cc.Label).string="No search result.",a.search_result.active=!0,a.search_result.children[0].active=!0,a.search_result.children[1].active=!1})},onClickObserveRoom:function(){if(this.search_player_roomid){var i=this;i.loadding(),cc.global.http.httpPost("/hall/observe",{roomid:this.search_player_roomid},function(e){i.closeloadding();var t=i.parse(e);"00"===t.status&&(cc.global.cur_game_code=t.playway,cc.global.user.roomInType="NormalObserve",i.enterGame({roomid:t.roomid}))},function(e){i.closeloadding()})}},update:function(e){if(0<cc.global.user.free_bonus_time&&cc.global.user.free_bonus_time>cc.global.logintime){var t=cc.global.user.free_bonus_time-cc.global.logintime,i=Math.floor(t/1e3),a=Math.floor(i/60);i%=60;var s=Math.floor(a/60);s<10&&(s="0"+s),(a%=60)<10&&(a="0"+a),i<10&&(i="0"+i);t=s+":"+a+":"+i;return this.free_bonus_label.string=t,void(this.free_bonus_label.node.parent.opacity=230)}},onClickFreeBonus:function(){var i=this;-15!=cc.global.user.loan_date?0<cc.global.user.free_bonus_time&&cc.global.user.free_bonus_time>cc.global.logintime||this.checkConfirm(cc.global.free_bonus_interval+" "+cc.global.free_bonus_amount+" "+cc.global.free_bonus_amount+" "+cc.global.free_bonus_interval,function(){i.loadding(),cc.global.http.httpPost("/hall/getfreebonustimer",{},function(e){i.closeloadding();var t=i.parse(e);0<t.free_bonus_time&&(cc.global.user.free_bonus_time=i.reviseTimezone(1e3*t.free_bonus_time))},function(e){i.closeloadding()})},function(){},0,{},"Get","Cancel"):this.alert(" "+cc.global.free_bonus_interval+" "+cc.global.free_bonus_amount+".")},onClickAdmin:function(){cc.global.isadmin&&(cc.global.webviewurl="",cc.director.loadScene("webview"))},onClickGameType:function(e,t){if(0<t&&t<5){this.gamelist.active=!1,this.folder_node.active=!0,this.recentlist.active=!1,this.folder_node.getComponent(cc.Animation).play(),this.folder_node.children[1].children[1].getComponent(cc.Label).string=cc.global.newgameGroups[t].name;var i=this.folder_node.children[1].children[0];for(var a in i.removeAllChildren(),cc.global.newgameTabIdx)if(cc.global.newgameTabIdx[a].type==t&&!cc.global.newgameTabIdx[a].istest){var s=cc.instantiate(this.game_icon_prefab);s.getComponent("GameIcon").init(this,a),s.parent=i}9<i.children.length?(i.scaleX=i.scaleY=1,i.width=610,i.height=840):6<i.children.length?(i.scaleX=i.scaleY=1,i.width=610,i.height=650):(i.scaleX=i.scaleY=1,i.width=610,i.height=480),this.folder_node.height=i.height}else this.gamelist.active=!0,this.folder_node.active=!1,this.recentlist.active=!0},onClickCloseGameType:function(e,t){1==this.folder_node.active&&(this.gamelist.active=!0,this.folder_node.active=!1,this.recentlist.active=!0,this.scroll_content.active=!1)},toggle_hall_view:function(e,t){this.hall_view_tab=3-this.hall_view_tab,1==this.hall_view_tab?(this.view_tab.children[0].active=!1,this.view_tab.children[1].active=!1,this.gamelist.active=!0,this.recentlist.active=!0,this.folder_node.active=!1,this.scroll_content.active=!1):(this.view_tab.children[0].active=!1,this.view_tab.children[1].active=!1,this.gamelist.active=!1,this.recentlist.active=!1,this.folder_node.active=!1,this.scroll_content.active=!0),cc.global.isOffline||cc.sys.localStorage.setItem("hall_view_tab",JSON.stringify(this.hall_view_tab))},initTotalGame:function(){for(var e in this.scroll_content.removeAllChildren(),cc.global.newgameTabIdx)if(cc.global.newgameTabIdx[e]&&0<cc.global.newgameTabIdx[e].idx){var t=cc.instantiate(this.game_icon_prefab);t.getComponent("GameIcon").init(this,e),t.parent=this.scroll_content}},checkOffline:function(){cc.global.isOffline&&(this.search_form.active=!1,this.hall_view_tab=1,this.toggle_hall_view(),this.view_tab.active=!1,this.free_bonus_label.node.parent.active=!1,this.goldcoins.node.parent.active=!1,this.total_count.active=!1,cc.global.user.msg&&this.alert(cc.global.user.msg))},onClickToOnline:function(){this.scene("loading")},animatePageView:function(e,t){}}),cc._RF.pop()},{HHCommon:"HHCommon"}],GameIcon:[function(e,t,i){"use strict";cc._RF.push(t,"54b9fpSkIFGiZ1WjwSZEKJG","GameIcon");var a=e("HHCommon");cc.Class({extends:a,properties:{label:cc.Label,icon:cc.Sprite,badge:cc.Node,badge_label:cc.Label,line:cc.Node},start:function(){},init:function(e,t){this.parent=e,this.code=t,this.game=cc.global.newgameTabIdx[t];var i=t.toUpperCase(),a=cc.global.languageData[cc.global.curLanguage][i];a||(a=this.game.name),this.label.string=a,10<this.game.name.length&&(this.label.string=a.substring(0,10)+"..."),cc.global.gameIcons[this.game.idx]&&(this.icon.spriteFrame=cc.global.gameIcons[this.game.idx]),this.line.width=25*Math.min(this.label.string.length,5),this.player=0,this.game.istest?this.node.active=!1:this.node.active=!0,this.line.scaleX=0},update:function(){this.game.idx&&cc.global.allgames[this.game.idx]?this.player=cc.global.allgames[this.game.idx].players:this.player=0,0==this.player?this.badge.active=!1:(this.badge.active=!0,this.badge_label.string=this.player),this.line&&(cc.global.hallTabIdx!=this.game.idx?this.line.active=!1:(this.line.active=!0,(0==this.line.scaleX||this.line.scaleX<1)&&(this.line.scaleX+=.1)))},onClick:function(){if(this.game.istest)this.alert("Testing.");else{var e=this.code;2==e.split("_").length&&(cc.global.cur_game_code=e.split("_")[0],cc.global.cur_game_condition=e.split("_")[1]),cc.global.hallTabIdx=this.currentGameData().idx,cc.global.curPlaywayScore=0,this.parent.onClick(null,e),this.parent.addRecentGameIcon(this.code),this.line.scaleX=0}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],GameLiveRow:[function(e,t,i){"use strict";cc._RF.push(t,"d9537WHVOhMco6putYq6EyF","GameLiveRow");var a=e("HHCommon");cc.Class({extends:a,properties:{gamemode:{default:null,type:cc.Label},roomnumber:{default:null,type:cc.Label},roomtype:{default:null,type:cc.Label},score:{default:null,type:cc.Label},remark:{default:null,type:cc.Label},watchcount:{default:null,type:cc.Label},datetime:{default:null,type:cc.Label},illegal:{default:null,type:cc.Label},playerlist:{default:null,type:cc.Node},msnBg:{default:null,type:cc.Node},greenBackground:cc.SpriteFrame,blueBackground:cc.SpriteFrame},init:function(e,t){this.parent=e,this.initTheme(),this.data=t;var i=this.getLanguageText("ROOM_0");this.roomnumber&&(this.roomnumber.string=t.id+i),this.score&&(this.score.string=this.numformat(t.score)),this.roomtype&&cc.global.hallTabIdx!=t.game_idx&&(this.roomtype.node.active=!0,this.roomtype.string=t.kname),this.watchcount&&(this.watchcount.string=this.numformat(t.ops));var a=t.players;switch(a){case 2:this.playerlist.getComponent(cc.Layout).spacingX=200;break;case 3:this.playerlist.getComponent(cc.Layout).spacingX=80;break;case 4:this.playerlist.getComponent(cc.Layout).spacingX=40;break;case 5:default:this.playerlist.getComponent(cc.Layout).spacingX=20}for(var s=0;s<this.playerlist.children.length;s++)a<=s?this.playerlist.children[s].active=!1:(this.playerlist.children[s].active=!0,s<=t.playerlist.length&&this.playerlist.children[s].getComponent("Observer").init(t.playerlist[s],this));5<a&&this.playerlist.getComponent(cc.Animation).play()},initTheme:function(){4===cc.global.theme_idx?this.msnBg&&this.msnBg.getComponent(cc.Sprite)&&(this.msnBg.getComponent(cc.Sprite).spriteFrame=this.blueBackground):this.msnBg&&this.msnBg.getComponent(cc.Sprite)&&(this.msnBg.getComponent(cc.Sprite).spriteFrame=this.greenBackground)},onClickGoReplay:function(){this.loadding();var i=this;cc.global.http.httpPost("/hall/observe",{roomid:this.data.id},function(e){i.closeloadding();var t=i.parse(e);"00"===t.status&&(cc.global.user.roomInType="NormalObserve",t.playway&&(cc.global.cur_game_code=t.playway),i.parent.parent&&i.parent.parent.enterGame({roomid:t.roomid}),i.parent.enterGame&&i.parent.enterGame({roomid:t.roomid}))},function(e){i.closeloadding()})}}),cc._RF.pop()},{HHCommon:"HHCommon"}],GameOpenTimer:[function(e,t,i){"use strict";cc._RF.push(t,"0bcb8jb0qNEMpdRgxq8W27y","GameOpenTimer"),cc.Class({extends:cc.Component,properties:{hours:cc.Label,minutes:cc.Label,seconds:cc.Label},onLoad:function(){this.anim=!1},update:function(e){if(this.node.opacity=0,!cc.global.isOpen){if(isNaN(cc.global.openTime)||isNaN(cc.global.logintime))return;var t=Math.abs(parseInt(cc.global.openTime)-parseInt(cc.global.logintime));if(t<0)return;var i=Math.floor(t/1e3),a=Math.floor(i/60);i%=60;var s=Math.floor(a/60);a%=60,this.seconds.string=9<i?i:"0"+i,this.minutes.string=9<a?a:"0"+a,this.hours.string=9<s?s:"0"+s,this.node.opacity=255}}}),cc._RF.pop()},{}],GamePlayHisDialog:[function(e,t,i){"use strict";cc._RF.push(t,"4d895akDGpJ/4MDxlJsMJ5P","GamePlayHisDialog");var a=e("HallDialog");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},title:{default:null,type:cc.Label},tabs:{default:null,type:cc.Node},contentView:{default:null,type:cc.Node},itemPrefab:{default:null,type:cc.Prefab},searchDate:{default:null,type:cc.EditBox},keywordInput:{default:null,type:cc.EditBox},remarkInput:{default:null,type:cc.EditBox},pagenum:{default:null,type:cc.Label},watchcards:{default:null,type:cc.Label},totalreplays:{default:null,type:cc.Label},scrollview:{default:null,type:cc.ScrollView},noContent:{default:null,type:cc.Node},btnClear:{default:null,type:cc.Node}},init:function(e){2<arguments.length&&void 0!==arguments[2]&&arguments[2]&&(this.data=arguments[2]),this.parent=e,this.listdata=[],this.sortdirection=0,this.initState()},initState:function(){this.curPage=1,this.curTab=0,this.curGame="ofc";for(var e=0;e<this.tabs.children.length;e++)if(this.tabs.children[e].name==cc.global.cur_game_code){this.curTab=e,this.curGame=cc.global.cur_game_code;break}this.updateTab()},updateTab:function(){for(var e=0;e<this.tabs.children.length;e++)e==this.curTab?this.tabs.children[e].getComponent("NotifyTabButton").init(!0,0):this.tabs.children[e].getComponent("NotifyTabButton").init(!1,0);this.curPage=1,this.updatePage()},onClickTab:function(e,t){var i=t.split(",");this.curTab!=parseInt(i[0])&&(this.curTab=parseInt(i[0]),this.curGame=i[1],this.updateTab())},onClickPrevPage:function(){this.curPage<=1||(this.curPage--,this.updatePage())},onClickNextPage:function(){this.listdata.length<5||(this.curPage++,this.updatePage())},onClickClose:function(){this.parent.closeDialog(this)},onClickSort:function(e,t){e.target.rotation=180-e.target.rotation,180==e.target.rotation?this.sortdirection=1:this.sortdirection=0,this.updatePage()},search:function(){this.curPage=1,this.updatePage()},onSearchDateChanged:function(e){var t=e[e.length-1],i=parseInt(t);"."!=t&&(0<=i&&i<=9||(this.searchDate.string=e.slice(0,e.length-1)))},sanitizeKeyname:function(e){return e=(e=e.replace(/pt/g,"")).replace(/Normal/g,"normal")},updatePage:function(){if(cc.global.replayState&&cc.global.replayState.enterReplay)return this.curPage=cc.global.replayState.curPage,this.keywordInput.string=cc.global.replayState.keyname,this.renderPageContent(cc.global.replayState.listData),0<this.keywordInput.string.length&&(this.btnClear.active=!0),void(cc.global.replayState.enterReplay=!1);this.sanitizeDate(this.searchDate.string);var s=this.sanitizeKeyname(this.keywordInput.string),r=(this.remarkInput.string,this);r.loadding(),cc.global.http.httpPost("/hall/historymatches",{game:this.curGame,page:this.curPage,keyname:s,asc:this.sortdirection},function(e){if(r.closeloadding(),null!=e&&""!=e){var t=e.split("$$$");if(1<t.length&&"00"==t[0]){var i=JSON.parse(t[1]);cc.global.replayState&&(cc.global.replayState.curPage=r.curPage,cc.global.replayState.listData=i,cc.global.replayState.keyname=s),r.renderPageContent(i)}else{a=r.getLanguageText("ERROR_IN_SERVER_RESPONSE");r.alert(a+": "+t[0])}}else{var a=r.getLanguageText("ERROR_IN_SERVER_RESPONSE");r.alert(a+": 01")}},function(){r.closeloadding();var e=r.getLanguageText("CONNECTING_FAILED_0");r.alert(e)})},renderPageContent:function(e){var t=this;if(t&&t.scrollview&&t.scrollview.scrollToTop(.1),t&&t.contentView){t.contentView.destroyAllChildren(),t.contentView.removeAllChildren();var i=t.numformat(t.curPage)+"/"+t.numformat(parseInt(e.totalcount/5)+1);if(t.pagenum.string=i,t.listdata=e.list,0==e.totalcount?t.totalreplays.string="":t.totalreplays.string=t.numformat(e.totalcount),e.list.length)for(var a=0;a<e.list.length;a++){var s=cc.instantiate(t.itemPrefab);s.parent=t.contentView,s.getComponent("GamePlayHisRow").init(t,e.list[a])}t.noContent&&(t.noContent.active=!(0<e.totalcount))}},onClickBtnClear:function(){this.keywordInput.string="",this.btnClear.active=!1,cc.global.replayState&&""!=cc.global.replayState.keyname&&this.search()},onChangeKeyword:function(e){0<this.keywordInput.string.length?this.btnClear.active=!0:this.btnClear.active=!1}}),cc._RF.pop()},{HallDialog:"HallDialog"}],GamePlayHisRow:[function(e,t,i){"use strict";cc._RF.push(t,"1c1bc3+LxhBbJeveka9CYcD","GamePlayHisRow");var a=e("HHCommon");cc.Class({extends:a,properties:{gamemode:{default:null,type:cc.Label},roomnumber:{default:null,type:cc.Label},score:{default:null,type:cc.Label},remark:{default:null,type:cc.Label},watchcount:{default:null,type:cc.Label},datetime:{default:null,type:cc.Label},illegal:{default:null,type:cc.Label},playerlist:{default:null,type:cc.Node},msnBg:{default:null,type:cc.Node},greenBackground:cc.SpriteFrame,blueBackground:cc.SpriteFrame},init:function(e,t){for(this.parent=e,this.initTheme(),this.data=t;0<=t.title.indexOf("http://");)t.title=t.title.replace("http://","");var i=t.title.split(":");if(this.gamemode){var a="Normal";"champion"==i[1]?(a="match",this.score.node.parent.children[0].children[0].active=!0):"diamond"==i[1]?(a="",this.score.node.parent.children[0].children[1].active=!0):(a="Normal",this.score.node.parent.children[0].children[0].active=!0),this.gamemode.string=a}this.roomnumber&&(this.roomnumber.string=i[2]+""),this.score&&(this.score.string=this.numformat(i[3])),this.remark&&t.remark&&(this.remark.string=t.remark),this.watchcount&&(this.watchcount.string=this.numformat(t.watches)),this.datetime&&(this.datetime.string=this.getDateFromTimestamp(this.reviseTimezone(t.createtime),!0));var s=i.length-4;switch(s){case 2:this.playerlist.getComponent(cc.Layout).spacingX=200;break;case 3:this.playerlist.getComponent(cc.Layout).spacingX=80;break;case 4:this.playerlist.getComponent(cc.Layout).spacingX=40;break;case 5:default:this.playerlist.getComponent(cc.Layout).spacingX=20}for(var r=0;r<this.playerlist.children.length;r++)s<=r&&this.playerlist.children[r].destroy();var n=[];for(null!=t.winners&&""!=t.winners&&(n=t.winners.split(",")),r=4;r<i.length;r++)if(this.playerlist.children[r-4]){i[r]=i[r].replace("null","");var o=i[r].split("(");t={nickname:o[0].split("#")[0],avatarurl:o[1].split(")")[0]};if(this.playerlist.children[r-4].getComponent("Observer").init(t,this),null!=n&&0<n.length)for(var l=0;l<n.length;l++){var c=o[0].split("#");if(null!=c&&1<c.length&&n[l]==c[1]){this.playerlist.children[r-4].children[1].color=cc.hexToColor("#FFED19");break}}}5<s&&this.playerlist.getComponent(cc.Animation).play()},initTheme:function(){4===cc.global.theme_idx?this.msnBg&&this.msnBg.getComponent(cc.Sprite)&&(this.msnBg.getComponent(cc.Sprite).spriteFrame=this.blueBackground):this.msnBg&&this.msnBg.getComponent(cc.Sprite)&&(this.msnBg.getComponent(cc.Sprite).spriteFrame=this.greenBackground)},onClickGoReplay:function(){var n=this;n.loadding(),cc.global.http.httpPost("/hall/watchmatch",{matchid:this.data.id},function(e){if(null!=e&&""!=e){var t=e.split("$$$");if(1<t.length&&"00"==t[0]){var i=JSON.parse(t[1]);if(i.gameroom&&i.commands){cc.global.watchReplayData.matchid=n.data.id,cc.global.watchReplayData.onReplay=!0,cc.global.cur_game_code=n.parent.curGame;var a=n.decodeExt(i.gameroom),s=n.decodeExt(i.commands);n.GZUnzip(a,function(e){var t=e.toString();cc.global.watchReplayData.gameroom=t,n.GZUnzip(s,function(e){var t=e.toString();cc.global.watchReplayData.commands=t,cc.global.replayState&&(cc.global.replayState.enterReplay=!0),n.preload({},n)},!1)},!1)}else n.closeloadding(),n.alert("Error")}else{r=n.getLanguageText("ERROR_IN_SERVER_RESPONSE");n.closeloadding(),n.alert(r+": "+t[0])}}else{n.closeloadding();var r=n.getLanguageText("ERROR_IN_SERVER_RESPONSE");n.alert(r+": 01")}},function(){n.closeloadding();var e=n.getLanguageText("CONNECTING_FAILED_0");n.alert(e)})}}),cc._RF.pop()},{HHCommon:"HHCommon"}],GameRecordItem:[function(e,t,i){"use strict";cc._RF.push(t,"41b13vUqPlOBKn5+HbCmX3j","GameRecordItem");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{type:cc.Sprite,default:null},nickname:{type:cc.Label,default:null},remark:{type:cc.Label,default:null},tip:{type:cc.Label,default:null},value:{type:cc.Label,default:null}},init:function(e,t,i){this.loadAvatar(i.avatarurl),this.nickname.string=i.nickname,this.remark.string=i.remark,this.value.string=this.numformat(parseInt(i.value)),e.tipDesc[t]&&e.tipDesc[t][i.remark]&&(this.tip.node.active=!0,this.tip.string=e.tipDesc[t][i.remark])}}),cc._RF.pop()},{HHCommon:"HHCommon"}],GameRecordRow:[function(e,t,i){"use strict";cc._RF.push(t,"1de32EKcmBDPZ+GdzfMrNFb","GameRecordRow");var a=e("HHCommon");cc.Class({extends:a,properties:{game:{default:null,type:cc.Label},remark:{default:null,type:cc.Label},value:{default:null,type:cc.Label}},init:function(e,t){this.remark.string=t.remark;var i=t.remark.charAt(t.remark.length-1),a=this.numformat(parseInt(t.value)),s="";switch(i){case"r":s="";break;case"Turn":case"s":s="s";break;case"d":s="s"}this.value.string=a+s}}),cc._RF.pop()},{HHCommon:"HHCommon"}],GameSelect:[function(e,t,i){"use strict";cc._RF.push(t,"eacacyAs9lLW7ySu9C9llWW","GameSelect");var a=e("HHCommon");cc.Class({extends:a,properties:{},start:function(){},rungame:function(e){this.rungame=e,this.loadding(),this.scene("hall",this)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],GameTimer:[function(e,t,i){"use strict";cc._RF.push(t,"7928fWubdtBVYZD/M1lp4JP","GameTimer");e("HHCommon");cc.Class({extends:cc.globalCommon,properties:{is_cardgame:{default:!0}},onLoad:function(){this.isRunTimer=!1},runtimerBmpFnt:function(e,t,i){var a=this;return this.remaining=i,this.isRunTimer=!0,t.active=!0,t.getComponent("BitmapFont").init(i),this.timersrc=function(){a.remaining=a.remaining-1,a.remaining<0?(e.unschedule(this),a.isRunTimer=!1):t.getComponent("BitmapFont").init(a.remaining)},e.schedule(this.timersrc,1/cc.global.watchReplayData.replaySpeedX,i,0),this.timersrc},runtimer:function(e,t,i,a,s,r){var n=this;if(this.remaining=r,this.isRunTimer=!0,t&&null!=t.getComponent("BitmapFont"))t.active=!0,t.getComponent("BitmapFont").init(r);else{t&&null!=t.getComponent("NewTimer")&&t.getComponent("NewTimer").runtimer(r);var o=6<arguments.length&&void 0!==arguments[6]&&arguments[6];a.string=o?"00:"+(9<r?r:"0"+r):r,t&&(t.active=!0),this.is_cardgame&&(null!=a.node.parent.getComponent(cc.Animation)&&a.node.parent.getComponent(cc.Animation).stop(),null!=a.getComponent(cc.LabelOutline)&&(a.getComponent(cc.LabelOutline).color="#2C509C"),n.remaining<6&&(null!=a.getComponent(cc.LabelOutline)&&(a.getComponent(cc.LabelOutline).color="#B91616"),null!=a.node.parent.getComponent(cc.Animation)&&a.node.parent.getComponent(cc.Animation).play()))}return this.timersrc=function(){6==n.remaining&&(null!=a.getComponent(cc.LabelOutline)&&(a.getComponent(cc.LabelOutline).color="#B91616"),null!=a.node.parent.getComponent(cc.Animation)&&a.node.parent.getComponent(cc.Animation).play()),n.remaining=n.remaining-1,n.remaining<0?(e.unschedule(this),n.isRunTimer=!1):t&&null!=t.getComponent("BitmapFont")?t.getComponent("BitmapFont").init(n.remaining):a.string=o?"00:"+(9<n.remaining?n.remaining:"0"+n.remaining):n.remaining},e.schedule(this.timersrc,1/cc.global.watchReplayData.replaySpeedX,r,0),this.timersrc},stoptimer:function(e,t,i){t&&(t.active=!1),this.remaining=0,this.isRunTimer=!1,i&&e.unscheduleAllCallbacks()},pauseTimer:function(e,t,i){this.isRunTimer=!1,i&&e.unscheduleAllCallbacks()},resumeTimer:function(e,t,i){var a=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(!(this.remaining<=0))return this.isRunTimer=!0,this.runtimer(e,t,null,i,i,this.remaining,a)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],HHCard:[function(e,t,i){"use strict";cc._RF.push(t,"726a1LfQbFELqz2XkfR6oXX","HHCard");var a=e("HHCommon");cc.Class({extends:a,properties:{version:{default:0,type:cc.Integer},card:cc.Integer,initcard:{default:null,type:cc.Node},normal:{default:null,type:cc.Node},lefttop:{default:null,type:cc.Node},leftcolor:{default:null,type:cc.Node},rightbottom:{default:null,type:cc.Node},rightcolor:{default:null,type:cc.Node},kingbg:{default:null,type:cc.Node},king:{default:null,type:cc.Node},king1:{default:null,type:cc.Node},atlas:{default:null,type:cc.SpriteAtlas},select:{default:null,type:cc.Node},touched:{default:!1,notify:function(){this.select.getComponent(cc.Sprite).enabled=this.touched,this.select.getComponent(cc.Animation)&&(this.select.getComponent(cc.Animation).enabled=this.touched)}},lockicon:{default:null,type:cc.Node}},proxy:function(e){this.game=e},onLoad:function(){this.init(),this.lastclicktime=0,this.changeTheme(cc.global.game_theme_idx),this.node.on("theme-changed",this.theme_changed,this),"five"!=cc.current_scene&&(1==cc.global.theme.background||2==cc.global.theme.background?this.initcard.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("poker_back"+cc.global.theme.background):this.initcard.getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas2.getSpriteFrame("poker_back3"))},theme_changed:function(e){1==cc.global.theme.background||2==cc.global.theme.background?this.initcard.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("poker_back"+cc.global.theme.background):this.initcard.getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas2.getSpriteFrame("poker_back3"),0<this.card&&this.order()},init:function(){this.initcard&&(this.initcard.active=!0),this.normal&&(this.normal.active=!1),this.selected=!1,this.kingbg&&(this.kingbg.active=!1),this.index=-1,this.normal.y=0,this.kingbg&&(this.kingbg.y=0)},throwCard:function(){this.parent.noCards(this)},setCard:function(e){this.card=e,this.normal.y=0,this.normal.active=!1,this.kingbg&&(this.kingbg.y=0),this.kingbg&&(this.kingbg.active=!1)},setParent:function(e,t,i,a){this.isme=t,this.parent=e,this.isneed=i,this.allow=a,this.selected=!1},selectCard:function(){if((!cc.global.seriable||!this.isme)&&cc.global.myTurn&&this.allow){var e=(new Date).getTime();if(this.isneed&&e-this.lastclicktime<400)return this.throwCard(),void(this.lastclicktime=e);this.lastclicktime=e,this.isme&&!cc.global.seriable&&(this.parent.myselectedcard&&this.parent.myselectedcard!=this&&(this.parent.myselectedcard.unselected(),this.parent.myselectedcard=null),this.selected?this.parent.myselectedcard=null:this.parent.myselectedcard=this),this.selected?(this.doselect(),this.parent.selectedCards.pop(),this.index=-1):(this.parent.selectedCards.push(this),this.doselect(),this.index=this.parent.selectedCards.length-1,this.parent.checkCards())}},unselected:function(){return this.selected=!1,52<=this.card?this.kingbg&&(this.kingbg.stopAllActions(),this.kingbg.runAction(cc.moveTo(.05,this.kingbg.x,0))):this.normal&&(this.normal.stopAllActions(),this.normal.runAction(cc.moveTo(.05,this.normal.x,0))),this.select&&(this.select.stopAllActions(),this.select.runAction(cc.moveTo(.05,this.select.x,0))),this.selected?1:0},doselect:function(){this.selected?this.unselected():(52<=this.card&&this.kingbg?(this.kingbg.y=0,this.kingbg.stopAllActions(),this.kingbg.runAction(cc.moveTo(.05,this.kingbg.x,25))):this.normal&&(this.normal.y=0,this.normal.stopAllActions(),this.normal.runAction(cc.moveTo(.05,this.normal.x,25))),this.select&&(this.select.y=0,this.select.stopAllActions(),this.select.runAction(cc.moveTo(.05,this.select.x,25))),this.selected=!0)},doTipSelect:function(){52<=this.card&&this.kingbg?(this.kingbg.y=0,this.kingbg.stopAllActions(),this.kingbg.runAction(cc.moveTo(.05,this.kingbg.x,25))):this.normal&&(this.normal.y=0,this.normal.stopAllActions(),this.normal.runAction(cc.moveTo(.05,this.normal.x,25))),this.select&&(this.select.y=0,this.select.stopAllActions(),this.select.runAction(cc.moveTo(.05,this.select.x,25))),this.selected=!0},changeTheme:function(e){"five"==cc.current_scene&&(2==this.version?this.initcard.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("back"+(e+1).toString()):this.initcard.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("poker_back"+e))},order:function(){if("five"!=cc.current_scene)if(1==cc.global.theme.background||2==cc.global.theme.background?this.initcard.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("poker_back"+cc.global.theme.background):this.initcard.getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas2.getSpriteFrame("poker_back3"),1==cc.global.theme.card_size)for(var e=0;e<this.node.children.length;e++)this.node.children[e].scaleX=this.node.children[e].scaleY=1;else if(2==cc.global.theme.card_size)for(e=0;e<this.node.children.length;e++)this.node.children[e].scaleX=this.node.children[e].scaleY=1.2;if(4==this.version)if(this.card<=53&&0<=this.card){var t=this.card,i=this.card%4;12<(a=parseInt(this.card/4)+1)&&(a=0),t=4*i+a,this.kingbg.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(t),this.kingbg.active=!0,this.normal.active=!1,this.initcard.active=!1}else this.kingbg.active=!1,this.initcard.active=!0;else if(3==this.version)if(this.card<=53&&0<=this.card){var a;t=0;t=13*(i=this.card%4)+(a=parseInt(this.card/4))+1,this.normal.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(t),this.normal.active=!0,this.initcard.active=!1}else this.normal.active=!1,this.initcard.active=!0;else if(2==this.version){i="b-bigtag_";if((n=this).card<52){i+=(n.card%4).toString(),13==(t=parseInt(n.card/4)+2)&&(t=0),14==t&&(t=1);var s="b-"+(this.card%2==0?"red":"black")+"_"+t;this.rightcolor.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(i),this.lefttop.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(s),this.initcard.active=!1,this.normal.active=!0,this.kingbg.active=!1,this.normal.y=0,t<=12&&10<=t?this.normal.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("five_bg_"+t):0==t&&this.card%4==3?this.normal.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("five_bg_spadeA"):this.normal.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("five_bg_front")}else 52==n.card?(this.initcard.active=!1,this.normal.active=!1,this.kingbg.active=!0,this.kingbg.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("five_bg_joker1"),this.kingbg.y=0):53==n.card&&(this.initcard.active=!1,this.normal.active=!1,this.kingbg.active=!0,this.kingbg.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame("five_bg_joker2"),this.kingbg.y=0)}else if(1==this.version){if("five"!=cc.current_scene)switch(cc.global.theme.card_theme){case 1:this.atlas=cc.global.pokerAtlas1;break;case 2:this.atlas=cc.global.pokerAtlas2;break;default:this.atlas=cc.global.pokerAtlas1}i="b-bigtag_";if((n=this).card<52){i+=(n.card%4).toString(),13==(t=parseInt(n.card/4)+2)&&(t=0),14==t&&(t=1);s="b-"+(this.card%2==0?"red":"black")+"_"+t;this.leftcolor.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(i),this.rightcolor.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(i),this.lefttop.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(s),this.rightbottom.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(s),this.initcard.active=!1,this.normal.active=!0,this.kingbg.active=!1,this.normal.y=0}else 52==n.card?(this.king.getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas1.getSpriteFrame("b-bigtag_4"),this.king1.getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas1.getSpriteFrame("b-smalltag_4"),this.initcard.active=!1,this.normal.active=!1,this.kingbg.active=!0,this.kingbg.y=0):53==n.card&&(this.king.getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas1.getSpriteFrame("b-bigtag_5"),this.king1.getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas1.getSpriteFrame("b-smalltag_5"),this.initcard.active=!1,this.normal.active=!1,this.kingbg.active=!0,this.kingbg.y=0)}else{var r,n;i="img_card_color_";if((n=this).card<52){i+=(n.card%4).toString(),14==(t=(n.card-n.card%4)/4+3)?t=1:15==t&&(t=2);var o="img_card_"+t;this.leftcolor.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(i),this.rightcolor.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(i),this.lefttop.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(o),this.rightbottom.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(o);var l=this.card%2==0?cc.hexToColor("#c44a2d"):cc.hexToColor("#252525");this.lefttop.color=l,this.rightbottom.color=l,this.initcard.active=!1,this.normal.active=!0,this.kingbg.active=!1,this.normal.y=0}else 52==n.card?(r="card-joker2",this.king.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(r),this.initcard.active=!1,this.normal.active=!1,this.kingbg.active=!0,this.kingbg.y=0):53==n.card&&(r="card-joker1",this.king.getComponent(cc.Sprite).spriteFrame=this.atlas.getSpriteFrame(r),this.initcard.active=!1,this.normal.active=!1,this.kingbg.active=!0,this.kingbg.y=0)}},initLockIcon:function(){this.lockicon.active=!1},reset:function(){this.normal.y=0,this.kingbg.y=0,this.normal.active=!1,this.kingbg.active=!1},onClickCardLock:function(){}}),cc._RF.pop()},{HHCommon:"HHCommon"}],HHCommon:[function(e,t,i){"use strict";cc._RF.push(t,"e9273gTqBJBbaSl3tCrgKmw","HHCommon");var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=("function"==typeof Symbol&&a(Symbol.iterator),e("Base64")),r=e("zlib"),n=e("Base64ExtPlugin");cc.Class({extends:cc.Component,properties:{},ready:function(){return!!cc.global},connect:function(e){return null!=cc.global.socket&&(cc.global.socket.disconnect(),cc.global.socket=null),this.onError=e,cc.global.socket=window.io.connect(cc.global.http.wsURL+"/bm/game",this),cc.global.socket},initEventCallback:function(){var s=this;cc.global.socket.on("news",function(e){var t=cc.sys.localStorage.getItem("last_news_time");if((null==t||""==t||isNaN(t))&&(t=0),!(isNaN(e.create_time)||e.create_time<=0||e.create_time<t)){if(t=e.create_time,e.new=!0,cc.global.newslist.unshift(e),cc.global.newslist.length>cc.global.news_limit&&(cc.global.newslist=cc.global.newslist.slice(0,cc.global.news_limit)),cc.sys.localStorage.setItem("samhung_news",JSON.stringify(cc.global.newslist)),cc.sys.localStorage.setItem("last_news_time",t),cc.global.openwin){var i=cc.global.openwin.getComponent("NewsDialog");i&&(i.initBadgeLabel(),i.updateTab())}s.updateNotifyBadge&&s.updateNotifyBadge()}}),cc.global.socket.on("mcom",function(e){if(s.msndone&&s.msndonelist){for(var t=0;t<cc.global.missions.length;t++)if(cc.global.missions[t].id==e.extdata.id){cc.global.newMissions++,cc.global.missions[t].done=!0,cc.global.missions[t].current=e.extdata.current,cc.global.missions[t].new=!0,e.extdata.description=cc.global.missions[t].description,e.extdata.value=cc.global.missions[t].value;var i=cc.instantiate(s.msndone);i.getComponent("MissionDone").init(e.extdata),i.parent=s.msndonelist;break}s.updateNotifyBadge&&s.updateNotifyBadge()}}),cc.global.socket.on("tcom",function(e){if(s.msndone&&s.msndonelist){for(var t=0;t<cc.global.missions.length;t++)if(0<=cc.global.missions[t].description.indexOf("Record")){cc.global.missions[t].done=!0,cc.global.missions[t].new=!0;break}var i=cc.instantiate(s.msndone);i.getComponent("MissionDone").init(e.extdata,1),i.parent=s.msndonelist,s.updateNotifyBadge&&s.updateNotifyBadge()}}),cc.global.socket.on("updatedgd",function(e){cc.global&&cc.global.user&&(cc.global.user.goldcoins=e.goldcoins,cc.global.user.diamonds=e.diamonds,cc.global.user.viplevel=e.viplevel,cc.global.user.vipscore=e.vipscore,cc.global.user.loan_amount=e.loan_amount,cc.global.user.loan_date=e.loan_date),s&&s.updateBalance&&s.updateBalance(),cc.global.updategdstack&&cc.global.updategdstack.updateBalance&&cc.global.updategdstack.updateBalance()}),cc.global.socket.on("feedback",function(e){if(e.extdata&&e.extdata.message){var t=e.extdata.message,i=s.getDateFromTimestamp(t.createtime,!0),a=(i=i.replace("\n"," "))+"\n\n"+t.content;s.alert(a),cc.sys.localStorage.setItem("lastfeedback",t.createtime)}})},disconnect:function(){null!=cc.global.socket&&(cc.global.socket.disconnect(),cc.global.socket=null)},getCommon:function(e){return cc.find("Canvas/Script/"+e).getComponent(e)},loadding:function(){this.closeloadding(),this.loaddingDialog=cc.instantiate(cc.global.loadding),this.loaddingDialog.parent=cc.find("Canvas");var e=this;cc.global.loaddingtimer=setTimeout(function(){console.trace("cc.global.loaddingtimer"),cc.global.loaddingtimer&&(e.alertForCallBack("Retry ",function(){e.logout()}),cc.global.loaddingtimer=!1)},2e4)},closeloadding:function(){for(cc.global.loaddingtimer&&(clearTimeout(cc.global.loaddingtimer),cc.global.loaddingtimer=!1),this.closeConfirm();cc.find("Canvas/loadding");)cc.find("Canvas/loadding").destroy(),cc.find("Canvas").removeChild(cc.find("Canvas/loadding"))},checkConfirm:function(e,t,i,a,s){var r=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"Ok",n=6<arguments.length&&void 0!==arguments[6]?arguments[6]:"Cancel";if(this.closeConfirm(),cc.global.confirmdlg){cc.global.openconfirm=cc.instantiate(cc.global.confirmdlg),cc.global.openconfirm.parent=cc.find("Canvas");var o=cc.global.openconfirm.getComponent("ConfirmDialog");null!=o&&o.init(this,e,t,i,a,s,r,n)}},closeConfirm:function(){cc.global.openconfirm&&(cc.global.openconfirm.destroy(),cc.global.openconfirm=null)},timerEffect:function(e,t,i,a){var s=cc.scaleTo(.2,1.35*t),r=cc.delayTime(i),n=cc.scaleTo(.2,.8*t),o=cc.scaleTo(.2,t),l=cc.sequence(s,r,n,o);e.runAction(l)},onClickExit:function(){cc.global.audio.playVoiceSpeech("support/13_close_game"),this.checkConfirm("Are you sure to exit?",function(){cc.game.end()},null,null,{theme:3})},showToast:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];cc.global.opentoast&&(cc.global.opentoast.destroy(),cc.global.opentoast=null),cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.getComponent("ToastCtrl").init("",e,t),cc.global.opentoast.parent=cc.find("Canvas")},alert:function(e,t){this.closealert(),this.alertForCallBack(e,null,t)},alertForCallBack:function(e,t,i){if(cc.global.dialog){cc.global.alertdialog=cc.instantiate(cc.global.dialog),cc.global.alertdialog.parent=cc.find("Canvas");var a=cc.global.alertdialog.getComponent("HHDialog");a.setTheme(),null!=a&&(a.message.string=e),i&&(i.title&&(a.title.string=i.title),i.horzAlign&&(a.message.horizontalAlign=i.horzAlign),i.vertAlign&&(a.message.verticalAlign=i.vertAlign),i.fontSize&&(a.message.fontSize=i.fontSize),i.lineHeight&&(a.message.lineHeight=i.lineHeight),i.containerWidth&&(a.base.width=i.containerWidth),i.containerHeight&&(a.base.height=i.containerHeight)),null!=t&&null!=a&&(a.onClose=t),cc.global.audio.playDialogAud()}this.closeloadding()},closeOpenWin:function(){null!=cc.global.openwin&&(cc.global.openwin.destroy(),cc.global.openwin=null)},pvalistener:function(e,t){cc.global.listener=t,cc.global.context=e},cleanpvalistener:function(){null!=cc.global&&(cc.global.listener=null,cc.global.context=null)},updatepva:function(){null!=cc.global&&null!=cc.global.listener&&null!=cc.global.context&&cc.global.listener(cc.global.context)},closealert:function(){cc.global.alertdialog&&null!=cc.global.alertdialog&&(cc.global.alertdialog.destroy(),cc.global.alertdialog=null)},scene:function(t,i){if("bowling"!=t&&"fishing"!=t&&"occello"!=t&&"pool"!=t&&"racing"!=t||(cc.global.webviewurl=t,t="webview"),t){if(cc.switchscene=!0,"tetris"==t)if("NormalJoin"==cc.global.user.roomInType){var e=cc.sys.localStorage.getItem("tet_scene_v2");t=null!=e?e:"tetris1"}else t="tetris1";else"onet"==t?"NormalJoin"==cc.global.user.roomInType||""!=cc.global.user.roomid||cc.global.isOffline||(t="onet1"):"ofc"==t||("popstar"==t&&1==cc.global.curPlaywayScore?t="popstar1":"archery"==t&&1==cc.global.curPlaywayScore&&(t="archery_train"));cc.director.preloadScene(t,function(e){e?cc.switchscene=!1:(i&&i.closeloadding(),cc.director.loadScene(t,function(){cc.current_scene=t,cc.switchscene=!1,cc.sys.isNative&&cc.Device.setKeepScreenOn(!0)}))})}else cc.global&&i.closeloadding()},preload:function(e,t){if(cc.global.extparams=e,""!=cc.global.cur_game_code&&0<cc.global.cur_game_code.length){var i=cc.global.cur_game_code;2==(cc.global.cur_game_code=i).split("_").length&&(cc.global.cur_game_code=i.split("_")[0],cc.global.cur_game_condition=i[1]),cc.global.extparams.cond=cc.global.cur_game_condition,t.scene(i,t)}},root:function(){return cc.find("Canvas")},decode:function(e){return s.decode(e)},decodeExt:function(e){return s.decodeExt(e)},decodeString:function(e){return n.Base64.decode(e)},encodeString:function(e){return n.Base64.encode(e)},parse:function(e){return JSON.parse(e)},currentGameData:function(){return cc.global.newgameTabIdx[cc.global.cur_game_code+"_"+cc.global.cur_game_condition]},reset:function(e,t){if(cc.global.globalCommon=this,cc.global.authorization=e.token,cc.global.version=e.version,cc.global.user=e.player,cc.global.isOffline){var i=this.getLanguageText("NO_CONNECTION_0");cc.global.user.id=i,cc.global.user.nickname=i}cc.global.user.roomInType="",cc.global.user.roomNo="",cc.global.user.doCatch=!1,cc.global.user.myPlayTurn=!1,cc.global.user.tipsReady=!1,cc.global.user.hardLiner=!1,cc.global.newslist=[],cc.global.newMissions=e.missions,cc.global.gametype=e.gametype,cc.global.logintime=e.logintime,cc.global.logintime=this.reviseTimezone(cc.global.logintime),0<cc.global.user.free_bonus_time&&(cc.global.user.free_bonus_time=this.reviseTimezone(1e3*cc.global.user.free_bonus_time)),cc.global.lastactivetime=cc.global.logintime,cc.global.gotLastHands=!1,cc.global.data=e,cc.global.playway=null,cc.global.user.bgindex=-1,cc.global.normal_users=0,cc.global.invite_users=0,cc.global.champion_users=0,cc.global.totalUsers=0,cc.global.totalUsersinRoom=0,cc.global.backToHall=!1,cc.global.selplayway="",cc.global.watchReplayData={matchid:-1,onReplay:!1,gameroom:null,commands:null,replaySpeedX:1},cc.global.cur_game_code=""!=e.player.curgame?e.player.curgame:t,cc.global.championMode=0,cc.global.curPlaywayScore=0,cc.global.playwayRoomCount=[],cc.global.lobbyrooms=[],cc.global.gamestatus="playing"!=e.player.gamestatus?"ready":"playing",cc.global.serverTimerInverval&&clearInterval(cc.global.serverTimerInverval),cc.global.serverTimerInverval=setInterval(function(){cc.global.logintime+=1e3,cc.global.globalCommon&&(cc.global.serverDateTime=cc.global.globalCommon.getDateFromTimestamp(cc.global.logintime))},1e3)},initVersionData:function(){for(var e in cc.global.newgameTabIdx)null!=cc.global.newgameGroups[cc.global.newgameTabIdx[e].type]&&cc.global.newgameGroups[cc.global.newgameTabIdx[e].type].games.push(cc.global.newgameTabIdx[e]);for(var e in cc.global.cur_game_condition="0",cc.global.newgameTabs=[],cc.global.newgameTabIdx)cc.global.newgameTabs[cc.global.newgameTabIdx[e].idx]=e},initGames:function(e){cc.global.allgames={};for(var t=e.split("|"),i=0;i<t.length;i++){var a=t[i].split(",");if(0!=a.length&&""!=a[0]&&(2<a.length?cc.global.allgames[a[0]]={code:a[0],players:a[1],seets:a[2],rooms:[]}:cc.global.allgames[a[0]]={code:a[0],players:0,seets:0,rooms:[]},3<a.length)){for(var s=3;s<a.length;s++){var r=a[s].split(":");if(2==r.length){var n=r[0],o=r[1].split(".");3==o.length&&cc.global.allgames[a[0]].rooms.push({score:n,minscore:o[0],players:o[1],ready:o[2]})}}cc.global.allgames[a[0]].rooms.sort(function(e,t){return e.score-t.score})}}for(var i in cc.global.newgameTabIdx){var l=cc.global.newgameTabIdx[i].idx;cc.global.allgames[l]?cc.global.newgameTabIdx[i].istest=!1:cc.global.newgameTabIdx[i].istest=!0}cc.global.tetris_jrData=null},logout:function(){this.closeOpenWin(),cc.global.user=null,cc.global.games=null,cc.global.playway=null,this.disconnect()},socket:function(){var e=cc.global.socket;return null==e&&(e=this.connect(),cc.global.socket=e),e},map:function(e,t){null!=cc.global&&(cc.global.routes[e]=t||function(){})},cleanmap:function(){if(null!=cc.global&&null!=cc.global.routes)for(var e in cc.global.routes)delete cc.global.routes[e]},route:function(e){return cc.global.routes[e]||function(){}},layout:function(e,t){if(null!=e){for(var i=new Array,a=e.children,s=0;s<a.length;s++)i.push(a[s]);for(s=0;s<i.length;s++)e.removeChild(i[s]);for(i.sort(t),s=0;s<i.length;s++)(i[s].parent=e).getComponent(cc.Layout).updateLayout();i.splice(0,i.length)}},numformat:function(e){if(!e)return"0";var t,i=e.toString();if(3<i.length){var a=i.split(".");t=1<a.length?a[0].substr(a[0].length-1,1)+"."+a[1]:a[0].substr(a[0].length-1,1);for(var s=1;s<a[0].length;s++)t=s%3==0?a[0].substr(a[0].length-1-s,1)+","+t:a[0].substr(a[0].length-1-s,1)+t}else t=i;return t},numkrformat:function(e){parseInt(e);return this.numformat(e)},goldformat:function(e){var t,i=parseInt(e);if(1e9<=i)t=(i/1e9).toString().split(".")[0]+"B";else if(1e6<=i){t=(i/1e6).toString().split(".")[0]+"M"}else if(1e3<=i){t=(i/1e3).toString().split(".")[0]+"K"}else t=this.numformat(i);return t},remaintime:function(e){var t=parseInt(Math.ceil(e/1e3)),i=parseInt(Math.floor(t/3600)),a=parseInt(Math.floor(t/60))%60;return(t%=60)<10&&(t="0"+t),a<10&&(a="0"+a),i<10&&(i="0"+i),i+":"+a+":"+t},reviseTimezone:function(e){return e+6e4*((new Date).getTimezoneOffset()+540)},isLastDate:function(){var e=new Date(cc.global.logintime);return 11==e.getMonth()&&31==e.getDate()},getDateFromTimestamp:function(e){var t=new Date(e);return 1<arguments.length&&void 0!==arguments[1]&&arguments[1]?t.getFullYear()+"."+(t.getMonth()+1)+"."+t.getDate()+".\n"+this.azs(t.getHours())+":"+this.azs(t.getMinutes())+":"+this.azs(t.getSeconds()):this.azs(t.getHours())+":"+this.azs(t.getMinutes())},azs:function(e){return e<10&&(e="0"+e),e},rsn:function(e){for(;0<=e.indexOf(" ");)e=e.replace(" ","");return parseInt(e)},sanitizeDate:function(e){for(;0<=e.indexOf(".");)e=e.replace(".","/");return"/"==e.charAt(e.length-1)&&(e=e.slice(0,e.length-1)),e},genRemainTimeString:function(e){var t=parseInt(Math.floor(e/36e5)),i=parseInt(Math.floor(e%36e5/6e4)),a="";return 0!=t&&(a+=t+"h"),0!=i&&(a+=" "+i+"m"),a+" "+parseInt(e%6e4/1e3)+"s"},disDialogEffect:function(e){var t=cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1));e.runAction(t)},playSpriteAtlasAnimation:function(t,i){t.node.active=!0,t.curSpriteFrame=0,t.curLap=0,t.schedule(function e(){if(t.curSpriteFrame<10&&(t.curSpriteFrame="0"+t.curSpriteFrame),t.spriteFrame=i.getSpriteFrame(t.node.name+"00"+t.curSpriteFrame),t.curSpriteFrame++,t.curSpriteFrame++,t.curSpriteFrame>=i.getSpriteFrames().length){if(0<t.curLap)return t.unschedule(e),void(t.node.active=!1);t.curSpriteFrame=0,t.curLap++}},.066)},GZUnzip:function(e,i){for(var t=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],a=new Uint8Array(e.length),s=0;s<e.length;s++)a[s]=t?e[s]:e.charCodeAt(s);r.gunzip(a,function(e,t){if(e)throw e;i(t)})},showEmoticon:function(e){if(this.emoticon){-1==e&&(e=this.emoticon.children.length-1);var t=this;this.hideEmoticon(e),this.emoticon.color=cc.hexToColor("#FFFFFF"),this.emoticon.active=!0,this.emoticon.children[parseInt(e)].active=!0,this.emoticon.children[parseInt(e)].lap=0;var i=this.emoticon.children[parseInt(e)].getComponent(sp.Skeleton);if(i)i.enabled=!0,i.clearTracks(),i.setAnimation(0,"animation",!1),i.setCompleteListener(function(){t&&t.emoticon&&(0<t.emoticon.children[parseInt(e)].lap?setTimeout(function(){t&&t.emoticon&&(t.emoticon.active=!1,t.emoticon.children[parseInt(e)].active=!1)},1e3):(t.emoticon.children[parseInt(e)].lap++,t.emoticon.children[parseInt(e)].getComponent(sp.Skeleton).setAnimation(0,"animation",!1)))});else{var a=t.emoticon.children[parseInt(e)].getComponent(cc.Sprite);null==a&&((a=t.emoticon.children[parseInt(e)].children[0].getComponent(cc.Sprite)).node.active=!0),a.enabled=!0,a.node.width=80,a.node.height=80,t.emoticon.children[parseInt(e)].runAction(cc.sequence(cc.scaleTo(.3,1.3),cc.scaleTo(.3,1),cc.scaleTo(.3,1.3),cc.scaleTo(.3,1),cc.scaleTo(.3,1.3),cc.scaleTo(.3,1),cc.scaleTo(.3,1.3),cc.scaleTo(.3,1))),t.Emoticontimer=setTimeout(function(){t&&t.emoticon&&(t.emoticon.active=!1,t.emoticon.children[parseInt(e)].active=!1,a.node.active=!1)},3e3)}}},hideEmoticon:function(e){if(this.emoticon)for(var t=0;t<this.emoticon.children.length;t++)if(t!=parseInt(e)){this.emoticon.children[t].active=!1;var i=this.emoticon.children[parseInt(t)].getComponent(sp.Skeleton);i&&(i.setCompleteListener(null),i.clearTracks()),clearTimeout(this.Emoticontimer)}},loadImageFromUrl:function(e,i){cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&i?i("success",t):i&&i("error")})},loadAvatar:function(e,a,s){if(null==s&&(s=this.avatar),null!=s&&null!=s.getComponent(cc.Sprite)){var t=function(e,t){if("success"==e)null!=s&&null!=s.getComponent(cc.Sprite)&&(s.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t));else if("error"==e){var i=1==a?"images/other/play-img-player-default-female":"images/other/play-img-player-default";cc.loader.loadRes(i,cc.SpriteFrame,function(e,t){e||s&&null!=s&&null!=s.getComponent(cc.Sprite)&&(s.getComponent(cc.Sprite).spriteFrame=t)})}};if(""!=e&&null!=e)if(e&&"http"!=e.substr(0,4)&&null!=cc.global.avatarAtlas.getSpriteFrame(e))s.getComponent(cc.Sprite).spriteFrame=cc.global.avatarAtlas.getSpriteFrame(e);else{var i=this;if(e=cc.global.http.avatarURL+e,cc.sys.isNative){e=e.replace(".png",".jpg");var r=jsb.fileUtils.getWritablePath()+encodeURIComponent(e)+"_jpg";jsb.fileUtils.isFileExist(r)?i.loadImageFromUrl(r,t):cc.global.http.downloadImage(e,function(e){jsb.fileUtils.writeDataToFile(new Uint8Array(e),r),jsb.fileUtils.isFileExist(r)?i.loadImageFromUrl(r,t):t("error")},function(){t("error")})}else i.loadImageFromUrl(e,t)}else{var n=1==a?"images/other/play-img-player-default-female":"images/other/play-img-player-default";cc.loader.loadRes(n,cc.SpriteFrame,function(e,t){e||s&&null!=s&&null!=s.getComponent(cc.Sprite)&&(s.getComponent(cc.Sprite).spriteFrame=t)})}}},changeGameTheme:function(){return cc.global.game_theme_idx=3-cc.global.game_theme_idx,cc.sys.localStorage.setItem("game_theme_idx",cc.global.game_theme_idx),cc.global.game_theme_idx},initLobbyData:function(e){for(var t in cc.global.allgames)for(var i in cc.global.allgames[t].players=0,cc.global.allgames[t].rooms)cc.global.allgames[t].rooms[i].players=0,cc.global.allgames[t].rooms[i].ready=0;var a=e.split("|");for(t=0;t<a.length;t++){var s=a[t].split(",");if(0!=s.length&&""!=s[0])if(2!=s.length||"t"!=s[0])if(2!=s.length||"r"!=s[0]){var r=s[0];if(cc.global.allgames[r]&&(cc.global.allgames[r].players=parseInt(s[1]),2<s.length))for(i=2;i<s.length;i++){var n=s[i].split("_"),o=n[0];for(var l in cc.global.allgames[r].rooms)cc.global.allgames[r].rooms[l].score==o&&(cc.global.allgames[r].rooms[l].players=parseInt(n[1]),cc.global.allgames[r].rooms[l].ready=parseInt(n[2]))}}else cc.global.totalUsersinRoom=s[1];else cc.global.totalUsers=s[1]}},confirmToOnline:function(){var e=this;this.checkConfirm("?",function(){e.scene("loading")})},getLanguageText:function(e,t){var i=cc.global.languageData[cc.global.curLanguage][e],a="XXX";return cc.global.languageData.EN[e]&&(a=cc.global.languageData.EN[e]),i||a}}),cc._RF.pop()},{Base64:"Base64",Base64ExtPlugin:"Base64ExtPlugin",zlib:5}],HHDialog:[function(e,t,i){"use strict";cc._RF.push(t,"5a86b+6krtDYqASMwoCOo3I","HHDialog");var a=e("HHCommon");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},title:{default:null,type:cc.Label},message:{default:null,type:cc.Label},background:{default:[],type:cc.Node}},onClose:function(){this.node.parent.removeChild(this.node),this.node.destroy()},onCloseOnlyLogin:function(){"login"==cc.current_scene&&this.onClose()},setTheme:function(){var e=1==cc.find("Canvas").getComponent("GameCanvas").orientation,t=cc.director.getScene().name;e?(this.node.width=cc.global.ratioWidth/cc.global.narrowContentRatio,this.node.height=cc.global.ratioHeight/cc.global.narrowContentRatio):(this.node.height=cc.global.ratioHeight/cc.global.narrowContentRatio,this.node.width=cc.global.ratioWidth/cc.global.narrowContentRatio),"login"==t?this.background[0]&&(this.background[0].active=!0):"hall"==t&&this.background[1]&&(this.background[1].active=!0)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],HHTimer:[function(e,t,i){"use strict";cc._RF.push(t,"86636uMmFJOq5RCkYR81sbr","HHTimer");var a=e("HHCommon");cc.Class({extends:a,properties:{text:{default:null,type:cc.Label}},onLoad:function(){},init:function(t,e,i){var a=this;this.remaining=e,this.text.string=t;var s=".";this.schedule(function(){var e=t+s;a.text.string=e,s="..."==s?".":s+"."},1,1e3)},stop:function(e){this.remaining=0,e.destroy()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],HTTP:[function(e,t,i){"use strict";cc._RF.push(t,"667be4sMahPNKAp5INntQxy","HTTP");var n=cc.Class({extends:cc.Component,properties:{},statics:{baseURL:"http://localhost:8081",wsURL:"ws://localhost:8080",serverURL:"http://localhost:6004",apiURL:"http://localhost/shgames/api/InvokeAPI",authorization:null,getVersion:function(t,i){var a=cc.loader.getXMLHttpRequest();a.onreadystatechange=function(){if(4===a.readyState)if(200<=a.status&&a.status<300){var e=a.responseText;t&&t(e)}else i&&i("Error")};return a.open("GET","http://10.99.1.98:8080/roomgame/download/v5/version.manifest",!0),cc.sys.isNative&&a.setRequestHeader("Accept-Encoding","gzip,deflate"),a.ontimeout=function(e){i("No Internet.")},a.onerror=function(e){i("No Internet.")},a.timeout=5e4,a.send(),a},httpGet:function(e,t,i,a){var s=cc.loader.getXMLHttpRequest();return s.onreadystatechange=function(){if(4===s.readyState)if(200<=s.status&&s.status<300){var e=s.responseText;t&&t(e,a)}else i&&i(a)},null!=cc.global&&null!=cc.global.authorization&&cc.global.authorization,e.indexOf("?"),s.open("GET",this.baseURL+e,!0),cc.sys.isNative&&s.setRequestHeader("Accept-Encoding","gzip,deflate"),null!=cc.global&&null!=cc.global.authorization&&postRequest.setRequestHeader("authorization",cc.global.authorization),null!=cc.global&&null!=cc.global.user&&postRequest.setRequestHeader("userid",cc.global.user.id),s.ontimeout=function(e){i(a)},s.onerror=function(e){i(a)},s.timeout=9e4,s.send(),s},downloadImage:function(e,t,i){var a=cc.loader.getXMLHttpRequest();a.onreadystatechange=function(){if(4===a.readyState)if(200<=a.status&&a.status<300){var e=a.response;t&&t(e)}else i&&i()},null!=cc.global&&null!=cc.global.authorization&&cc.global.authorization,e.indexOf("?"),a.open("GET",e,!0),cc.sys.isNative&&a.setRequestHeader("Accept-Encoding","gzip,deflate"),a.responseType="arraybuffer",a.ontimeout=function(e){i()},a.onerror=function(e){i()},a.timeout=9e4,a.send()},encodeFormData:function(e){var t=[],i=/%20/g;for(var a in e){var s=e[a].toString(),r=encodeURIComponent(a).replace(i,"+")+"="+encodeURIComponent(s).replace(i,"+");t.push(r)}return t.join("&")},httpPost:function(e,t,i,a,s){5<arguments.length&&void 0!==arguments[5]&&arguments[5];if("/auth/login"!=e&&cc.global.isOffline)return cc.global.globalCommon?(cc.global.globalCommon.closeloadding(),void cc.global.globalCommon.confirmToOnline()):void(a&&a());var r=cc.loader.getXMLHttpRequest();r.onreadystatechange=function(){if(4===r.readyState&&200<=r.status&&r.status<300){cc.global.lastactivetime=cc.global.logintime;var e=r.responseText;r=null,s&&s.closeConfirm(),i&&i(e)}},r.timeout=2e5,r.open("POST",this.baseURL+e,!0),null!=cc.global&&null!=cc.global.authorization&&r.setRequestHeader("authorization",cc.global.authorization),null!=cc.global&&null!=cc.global.user&&r.setRequestHeader("userid",cc.global.user.id),cc.sys.isNative&&r.setRequestHeader("Accept-Encoding","gzip,deflate","text/html;charset=UTF-8"),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(n.encodeFormData(t));return setTimeout(function(){if(r)if(r.abort(),null!=s){var e="",t="",i="";"login"==cc.current_scene||"hall"==cc.current_scene?(e="Retry.",t="logout",i="waiting"):(e="No Singnal.",t="Logout",i="Search signal"),s.checkConfirm(e,function(){"login"==cc.current_scene?a&&a():s.logout()},function(){"login"==cc.current_scene?a&&a():s.logout()},null,null,t,i)}else a&&a()},2e4),r}},onLoad:function(){}});cc._RF.pop()},{}],HallDialog:[function(e,t,i){"use strict";cc._RF.push(t,"4b6c3OQnbxCHYwjk6zOM5Fs","HallDialog");var a=e("HHCommon");cc.Class({extends:a,properties:{},onLoad:function(){this.node.width=cc.global.ratioWidth/cc.global.narrowContentRatio,this.node.height=cc.global.ratioHeight/cc.global.narrowContentRatio,cc.global.audio.playDialogAud()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],HelpDialog:[function(e,t,i){"use strict";cc._RF.push(t,"5781f/WTWRLDaMu4Nded6pw","HelpDialog");var a=e("HallDialog");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},tabs:{default:null,type:cc.Node},contentView:{default:null,type:cc.Node},msnBg:{default:null,type:cc.Node},greenBackground:cc.SpriteFrame,blueBackground:cc.SpriteFrame},init:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.parent=e,1==cc.global.championMode&&(t=6),this.initState(t),this.initTheme()},initTheme:function(){4===cc.global.theme_idx?this.msnBg&&this.msnBg.getComponent(cc.Sprite)&&(this.msnBg.getComponent(cc.Sprite).spriteFrame=this.blueBackground):this.msnBg&&this.msnBg.getComponent(cc.Sprite)&&(this.msnBg.getComponent(cc.Sprite).spriteFrame=this.greenBackground)},initState:function(e){this.curTab=e,this.updateTab()},updateTab:function(){for(var e=0;e<this.tabs.children.length;e++)e==this.curTab?this.tabs.children[e].getComponent("NotifyTabButton").init(!0,0):this.tabs.children[e].getComponent("NotifyTabButton").init(!1,0);this.loadContent()},loadContent:function(){for(var e=0;e<this.contentView.children.length;e++)this.contentView.children[e].active=!1;this.contentView.children[this.curTab].active=!0},onClickTab:function(e,t){this.curTab!=t&&(this.curTab=t,this.updateTab())},onClickClose:function(){this.parent.closeDialog(this)}}),cc._RF.pop()},{HallDialog:"HallDialog"}],IntCounter:[function(e,t,i){"use strict";cc._RF.push(t,"5011cAgOc1J5ol2zcjd6Tpy","IntCounter"),Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}}();i.IntCounter=function(){function a(e,t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,a),t<e?(this._min=t,this._max=e,i=-i,this._fvalue=this._max):(this._min=e,this._max=t),this._speed=i,this._range=t-e+1,this.mapping(this._fvalue)}return s(a,[{key:"setRange",value:function(e,t){t<e?(this._min=t,this._max=e):(this._min=e,this._max=t),this.mapping(this._fvalue)}},{key:"getValue",value:function(){return this._value}},{key:"setValue",value:function(e){this._fvalue=e,this.mapping(e)}},{key:"start",value:function(e){this._fvalue=e%this._range,this.mapping(this._fvalue)}},{key:"mapping",value:function(e){if(1!=this._range){var t=Math.round(e)%this._range;t<0&&(t+=this._range),this._value=this._min+t}else this._value=this._min}},{key:"update",value:function(e){this._fvalue+=this._speed*e,this._fvalue%=this._range,this.mapping(this._fvalue)}},{key:"getSpeed",value:function(){return this._speed}},{key:"setSpeed",value:function(e){this._speed=e}}]),a}();cc._RF.pop()},{}],KoniBegin:[function(e,t,i){"use strict";cc._RF.push(t,"302a5pVwzpEro67Xoydjb+o","KoniBegin");var a=e("HHCommon"),s=e("KoniEngine"),o={};cc.Class({extends:a,properties:{koni_player:{default:null,type:cc.Prefab},koni_player_board:{default:null,type:cc.Prefab},selfplayer:{default:null,type:cc.Node},opponentplayer:{default:null,type:cc.Node},statusboard:{default:null,type:cc.Node},boardclaim:{default:null,type:cc.Sprite},claimatlas:{default:null,type:cc.SpriteAtlas},towerboard:{default:null,type:cc.Node},hintboard:{default:null,type:cc.Node},roomdata:{default:null,type:cc.Node},turntimer:{default:null,type:cc.Node},statistics:{default:null,type:cc.Node},totalmatches:{default:null,type:cc.Node},stargained:{default:null,type:cc.Node},diamondgained:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},observer:{default:null,type:cc.Prefab},observerbench:{default:null,type:cc.Node},emodlg:{default:null,type:cc.Prefab},chat:{default:null,type:cc.Prefab},chatsearch:{default:null,type:cc.Prefab},userinfodlg:{default:null,type:cc.Prefab},btn_enter:{default:null,type:cc.Node},btn_giveup:{default:null,type:cc.Node},btn_chat:{default:null,type:cc.Node},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},illegalconfirm:{default:null,type:cc.Prefab},btn_find_empty:{default:null,type:cc.Node},pcs_cell_pref:{default:null,type:cc.Prefab},pcs_hint_cell:{default:null,type:cc.Prefab},roomrankdialog:{default:null,type:cc.Prefab},finishAct:{default:null,type:cc.Node},mainBoard:{default:null,type:cc.Node},btnSfx:{default:null,type:cc.Node},lblTurnCount:{default:null,type:cc.Label}},onLoad:function(){this.initEventCallback(),cc.game.setFrameRate(60),cc.global.amObserve="no",this.play_status=0,this.playerlist=new Array,this.playerboardlist=new Array,this.observerlist=new Array,this.posBaseIdx=0,this.inited=!1,this.playerBoardSlotPos=[cc.v2(0,-240),cc.v2(0,240)],this.notReplay=!0,this.startGameTimer=null,this.endGameTimer=null,this.pangolds=0,this.isGamePlaying=!1,this.pickedPiece=null,this.turnSeat=0,this.isNewRoom=!0,this.turnCount=0,(o=new s).init(),this.makeKoniPiece(),null!=cc.global&&(this.initgame(),""!=cc.global.user.roomid&&(this.recovery(),this.isNewRoom=!1)),cc.global.watchReplayData.onReplay&&this.prepareReplay(),this.setEtcKeyBoardEvent();var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==e&&(e=!0),e?(this.btnSfx.children[0].active=!0,this.btnSfx.children[1].active=!1):(this.btnSfx.children[0].active=!1,this.btnSfx.children[1].active=!0),cc.global.audio.playBGM("bgm_koni")},initgame:function(){var t=this;this.finishAct&&(this.finishAct.active=!1);var e=this.socket();this.map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("banker",this.banker_event),this.map("playkoni",this.playkoni_event),this.map("rer",this.recovery_event),this.map("selemoticon",this.emoticon_event),this.map("sendchat",this.sendchat_event),this.map("callplayer",this.callplayer_event),this.map("sl",this.sendlines_event),this.map("allcards",this.allcards_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)});var i={};switch(cc.global.user.roomInType){case"NormalCreate":null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i);break;case"NormalJoin":i.extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i);break;case"NormalObserve":i.extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i)}this.inited=!0,this.loadding()},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},prepareReplay:function(){this.notReplay=!1,cc.global.amObserve="yes",this.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),this.replay_bar.active=!0,this.replayStep="ready_room",this.replaySeq=0,this.replayPrevCmd="",this.goReplay()},stopAllClock:function(){this.turntimer.getComponent("TurnTimer").pauseAllTimer()},resumeAllClock:function(){this.turntimer.getComponent("TurnTimer").resumeAllTimer()},pauseReplayTimer:function(){this.stopAllClock(),clearTimeout(this.replayTimer)},resumeReplayTimer:function(){var e=this;this.resumeAllClock(),this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay/cc.global.watchReplayData.replaySpeedX)},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):this.togglePlayToPause()},togglePlayToPause:function(){this.replayTimer&&clearTimeout(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replay_bar.children[0].opacity=100,this.pauseReplayTimer()},replayPrevMove:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.replayEventProcess(!0))},replayNextMove:function(){this.togglePlayToPause(),this.replayEventProcess(!0)},onClickReplaySpeedUp:function(){var e=this.getLanguageText("REPLAY_TIME");cc.global.watchReplayData.replaySpeedX<5&&(cc.global.watchReplayData.replaySpeedX++,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){var e=this.getLanguageText("REPLAY_TIME");1<cc.global.watchReplayData.replaySpeedX&&(cc.global.watchReplayData.replaySpeedX--,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},cleanAllPlayers:function(){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].destroy(),this.playerboardlist[e].destroy();this.playerlist.splice(0,this.playerlist.length),this.playerboardlist.splice(0,this.playerboardlist.length),this.playerlist=new Array,this.playerboardlist=new Array,this.selfplayer&&(this.selfplayer.destroyAllChildren(),this.selfplayer.removeAllChildren()),this.opponentplayer&&(this.opponentplayer.destroyAllChildren(),this.opponentplayer.removeAllChildren()),this.towerboard&&(this.towerboard.destroyAllChildren(),this.towerboard.removeAllChildren(),this.piece_array=null),this.hintboard&&(this.hintboard.destroyAllChildren(),this.hintboard.removeAllChildren(),this.piece_hint_array=null)},replayEventProcess:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.play_history&&this.play_history[this.replaySeq]){this.replayTimeDelay=0;var t=!1;switch(this.replayStep){case"ready_room":this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"playkoni":t=!0,this.playkoni_event(i,this);break;case"allcards":t=!0,this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.emoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"players":this.players_event(i,this)}this.replayPrevCmd=i.command}this.play_history[this.replaySeq+1]&&""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay+=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,e&&!t&&this.replayEventProcess(!0)}},goReplay:function(){var e=this;this.replayEventProcess(),this.play_history[this.replaySeq]?this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay):(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.replayPrevCmd="",this.pauseReplayTimer())},setEtcKeyBoardEvent:function(){var i=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e,t){switch(e){case cc.KEY.space:i.processReadyState();break;case cc.KEY.escape:case cc.KEY.back:if(!i.isemoticon&&!i.ischat)return void i.onclickBack();i.isemoticon&&(null!=i.emoticonpage&&i.emoticonpage.destroy(),i.isemoticon=!1),i.ischat&&(null!=i.chatpage&&i.chatpage.destroy(),i.ischat=!1)}}},i.node)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;e<0||(this.socket().exec("selemoticon",{extparams:{emoticon:e}}),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1))},onCtrlKeyDown:function(e){e.keycode==cc.KEY.space&&2==this.playerlist.length&&(this.endGameTimer||this.sendState())},processReadyState:function(){2==this.playerlist.length&&(this.endGameTimer||this.sendState())},joinroom_event:function(e,t){cc.global.user.selplayway=e.name,t.roomid=e.id,t.panScore=cc.global.curPlaywayScore=e.score;var i=t.getLanguageText("ROOM_0");switch(t.roomdata.children[0].getComponent(cc.Label).string=e.id+i,t.roomdata.children[1].getComponent(cc.Label).string="("+t.numformat(e.score)+"pt)",cc.global.gamestatus){case"ready":cc.global.gamestatus="waiting",2==e.playerlist.length&&(cc.global.gamestatus="playing"),t.players_event(e,t);break;case"waiting":t.players_event(e,t);break;case"playing":cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)}e.hisdata?t.showMatchCareer(e.hisdata):t.hideMatchCareer(),"yes"==cc.global.amObserve?(t.btn_giveup.active=!1,t.btn_chat.active=!1):(t.btn_giveup.active=!0,t.btn_chat.active=!0),t.closeloadding()},players_event:function(e,t){2==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)if(e.observerlist[a].id==cc.global.user.id){i=!1;break}if(i&&t.notReplay)return cc.global.outReasonMsg=e.msg,void t.exitPlay();t.observer_event(e,t),t.isBoardPlayersChanged(e.playerlist)&&(t.startGameTimer&&(clearTimeout(t.startGameTimer),t.startGameTimer=null),t.endGameTimer&&(clearTimeout(t.endGameTimer),t.endGameTimer=null),t.players_engine(e,t))},players_engine:function(e){this.removeBoardPlayers(e.playerlist),this.hideAllPieces();for(var t=this.posBaseIdx,i=0;i<e.playerlist.length;i++){if(e.playerlist[i].seatid=i,"no"==cc.global.amObserve&&e.playerlist[i].id!=cc.global.user.id&&(t=1-this.posBaseIdx),this.playerexist(e.playerlist[i])){var a=this.getPlayer(e.playerlist[i].id),s=this.getPlayerBoard(e.playerlist[i].id);a.init(this,e.playerlist[i],t%2,i),s.init(this,e.playerlist[i],t%2,i),s.node.setPosition(this.playerBoardSlotPos[t%2]),a.seatid=s.seatid=t%2,a.layoutForSeat(),s.layoutForSeat()}else{var r=cc.instantiate(this.koni_player);"yes"!=cc.global.amObserve?e.playerlist[i].id==cc.global.user.id?r.parent=this.selfplayer:r.parent=this.opponentplayer:r.parent=t%2==0?this.selfplayer:this.opponentplayer,r.getComponent("KoniPlayer").init(this,e.playerlist[i],t%2,i),this.playerlist.push(r);var n=cc.instantiate(this.koni_player_board);n.parent=this.statusboard,n.setPosition(this.playerBoardSlotPos[t%2]),n.getComponent("KoniPlayerBoard").init(this,e.playerlist[i],t%2,i),this.playerboardlist.push(n)}t++}1==e.playerlist.length?(this.setWaitingState(),this.cleanAfterAllCards(),this.hideMatchCareer()):2==e.playerlist.length&&this.setReadyState(),"yes"==cc.global.amObserve&&e.playerlist.length<2?1==cc.global.championMode?this.btn_enter.active=!1:0==cc.global.championMode&&this.notReplay&&(this.btn_enter.active=!0):this.btn_enter.active=!1,this.showWaitingTimer()},setWaitingState:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("KoniPlayerBoard");t&&t.setState("Pending")}},setReadyState:function(){var e=this.getLanguageText("READY_0")+"?";if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("KoniPlayerBoard");i&&i.setState(e)}},observer_event:function(e,t){t.observerbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i],t),a.getComponent("Observer").nickname.node.active=!1,a.parent=t.observerbench,t.observerlist[i]=a}},removeBoardPlayers:function(e){for(var t=0;t<this.playerlist.length;t++){for(var i=this.playerlist[t].getComponent("KoniPlayer"),a=!1,s=0;s<e.length;s++)if(i.userdata.id==e[s].id){a=!0;break}1!=a&&(this.playerlist[t].destroy(),this.playerlist.splice(t,1),this.playerboardlist[t].destroy(),this.playerboardlist.splice(t,1))}},isBoardPlayersChanged:function(e){if(0==this.playerlist.length&&0!=e.length)return!0;if(this.playerlist.length!=e.length)return!0;for(var t=0;t<e.length;t++)if(!this.getPlayer(e[t].id))return!0;return!1},playerexist:function(e){for(var t=0;t<this.playerlist.length;t++)if(null!=this.playerlist[t]&&this.playerlist[t].getComponent("KoniPlayer").userdata.id==e.id)return!0;return!1},makeKoniPiece:function(){if(this.pcs_cell_pref){o.init(!0),this.towerboard.destroyAllChildren(),this.towerboard.removeAllChildren(),this.hintboard.destroyAllChildren(),this.hintboard.removeAllChildren(),this.piece_array=[],this.piece_hint_array=[];for(var e=0,t=0;t<o.boardHeight;t++)for(var i=0;i<o.boardWidth;i++){if(0<o.status[t][i]){var a=cc.instantiate(this.pcs_cell_pref);a.parent=this.towerboard,a.active=!1,this.piece_array.push(a)}if(0<=o.status[t][i]){var s=cc.instantiate(this.pcs_hint_cell);s.parent=this.hintboard,s.getComponent("KoniPieceHint").init(this,t,i),this.piece_hint_array[e]=s}e++}}},initGameboard:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.pcs_cell_pref){o.init(e);for(var t=0,i=0;i<o.boardHeight;i++)for(var a=0;a<o.boardWidth;a++)if(0<o.status[i][a]&&this.piece_array&&this.piece_array.length>=t+1){var s=this.piece_array[t];s.getComponent("KoniPiece").init(this,o.status[i][a],i,a),s.active=!0,s.getComponent(cc.Animation).play(),t++}}this.closeloadding()},piecePicked:function(e,t,i){this.unpickAllPieces(),this.pickedPiece=e,o.readyForFind(t,i),o.findGoAble(t,i,0,0),this.hideGoAble(),this.showGoAble()},hideGoAble:function(){for(var e=0;e<this.hintboard.children.length;e++)this.hintboard.children[e].getComponent("KoniPieceHint").hide()},showGoAble:function(e,t){for(var i=1;i<o.goable.length;i++){var a=o.goable[i].point,s=13*a.row+a.col;this.piece_hint_array[s].getComponent("KoniPieceHint").show()}},unpickAllPieces:function(){for(var e=0;e<this.towerboard.children.length;e++){var t=this.towerboard.children[e].getComponent("KoniPiece");t&&t.unpick()}},onClickPieceSlot:function(e,t){-1!=o.canMove(e,t)&&(this.hideGoAble(),this.sendMovePiece(e,t))},movePiece:function(e,t,i){var a=this,s=o.getGoAblePos(this.pickedPiece.row,this.pickedPiece.col,e,t);1<s.length&&(o.movePoint(this.pickedPiece.row,this.pickedPiece.col,e,t),this.showJumpOff(this.pickedPiece.row,this.pickedPiece.col),this.pickedPiece.moveTo(s.reverse(),e,t),this.pickedPiece=null),this.changeTurnTimer=setTimeout(function(){a.changeTurn(i,!0)},220*(s.length-1))},changeTurn:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];0==e?(this.turnSeat=1,t&&this.giveTurn2(this.koni_timer)):1==e&&(this.turnSeat=0,t&&this.giveTurn1(this.koni_timer))},showJumpOff:function(e,t){var i=13*e+t;this.piece_hint_array&&this.piece_hint_array[i]&&this.piece_hint_array[i].getComponent("KoniPieceHint").show()},sendMovePiece:function(e,t){if(this.pickedPiece&&"no"==cc.global.amObserve&&0==this.turnSeat&&1==this.pickedPiece.pieceId){var i=this.convertPoint(this.pickedPiece.row,this.pickedPiece.col),a=this.convertPoint(e,t);this.socket().exec("playkoni",{extparams:{srow:i.row,scol:i.col,erow:a.row,ecol:a.col,roomid:this.roomid,localturn:this.turnCount}})}},convertPoint:function(e,t){return 1==this.getPlayer(cc.global.user.id).userdata.seatid&&(t=(e=16-e)%2==0?12-t:13-t),{row:e,col:t}},getPieceByRowCol:function(e,t){for(var i=0;i<this.towerboard.children.length;i++){var a=this.towerboard.children[i].getComponent("KoniPiece");if(a&&a.row==e&&a.col==t)return a}},showMatchCareer:function(e){},hideMatchCareer:function(){},sendState:function(){this.getPlayerBoard(cc.global.user.id).isReady()||this.socket().exec("ready",{extparams:{roomid:this.roomid}})},userready_event:function(e,t){cc.global.audio.playEffectAud("ready");var i=t.getPlayerBoard(e.userid);if(i){var a=t.getLanguageText("PREPARED_0");i.setState(a),i.startTimer(30)}},banker_event:function(e,t){t.closeConfirm(),t.hideAllStatus(),t.initGameboard(!0),t.isGamePlaying=!0,t.isNewRoom=!1,t.koni_timer=30,e.msg&&!isNaN(e.msg)&&(t.koni_timer=parseInt(e.msg));for(var i=t.getPlayer(e.userid),a=0;a<t.playerlist.length;a++)t.playerlist[a].getComponent("KoniPlayer").hideBanker();i&&(i.showBanker(),0==i.seatid?(t.turnSeat=0,t.giveTurn1(t.koni_timer)):(t.turnSeat=1,t.giveTurn2(t.koni_timer)))},playkoni_event:function(e,t){if(!t.notReplay||parseInt(t.roomid)==parseInt(e.extdata.roomid)){if(t.lblTurnCount&&e.extdata&&e.extdata.turncount){var i=parseInt(e.extdata.turncount);if(t.notReplay&&t.turnCount+1!=i)return t.loadding(),void t.recovery();t.lblTurnCount.string="\n"+Math.round(i/2)+"Turn",t.turnCount=parseInt(i)}t.hideGoAble(),t.closeConfirm(),t.unpickAllPieces(),t.stopTurnTimerAll();var a=t.getPlayer(e.userid);a&&(e.extdata.passcount&&a.updatePassCount(e.extdata.passcount),"p"!=e.extdata.type?a.seatid==a.userdata.seatid?(t.pickedPiece=t.getPieceByRowCol(parseInt(e.extdata.data.srow),parseInt(e.extdata.data.scol)),t.movePiece(parseInt(e.extdata.data.erow),parseInt(e.extdata.data.ecol),a.seatid)):a.seatid!=a.userdata.seatid&&(e.extdata.data.srow%2==0?t.pickedPiece=t.getPieceByRowCol(16-parseInt(e.extdata.data.srow),12-parseInt(e.extdata.data.scol)):t.pickedPiece=t.getPieceByRowCol(16-parseInt(e.extdata.data.srow),13-parseInt(e.extdata.data.scol)),e.extdata.data.erow%2==0?t.movePiece(16-parseInt(e.extdata.data.erow),12-parseInt(e.extdata.data.ecol),a.seatid):t.movePiece(16-parseInt(e.extdata.data.erow),13-parseInt(e.extdata.data.ecol),a.seatid)):t.changeTurn(a.seatid,!0)),t.showBoardClaim(e.extdata.type);var s="";switch(e.extdata.type){case"n":break;case"p":s="pass"}""!=s&&a.speech(s)}},stopTurnTimerAll:function(){this.turntimer.getComponent("TurnTimer").stopAllTimer()},showBoardClaim:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";switch(e){case"n":break;case"p":"pass";break;case"w":"win";break;case"l":"defeat";break;case"d":"draw"}if("CH"==cc.global.curLanguage?"_ch":"RU"==cc.global.curLanguage?"_ru":"_en",this.boardclaim.node.children[0].active=!1,"tech"==t&&(this.boardclaim.node.children[0].active=!0,this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string={l:"Lose",w:"Victory"}[e]),"w"==e)this.runFinishAction("dzz_cj_win");else if("l"==e)this.runFinishAction("dzz_cj_lose");else if("p"==e){this.boardclaim.node.children[0].active=!0;var i=this.getLanguageText("PASS_0");this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string=i,this.boardclaim.getComponent(cc.Animation).play()}},runFinishAction:function(e){if("yes"!=cc.global.amObserve&&this.finishAct&&this.finishAct.getComponent(sp.Skeleton)){var t=cc.callFunc(this.enableFinishAni,this,e),i=cc.callFunc(this.disableFinishAni,this);this.node.runAction(cc.sequence(t,cc.delayTime(3),i))}},enableFinishAni:function(e,t){if(this.finishAct){var i=this.finishAct.getComponent(sp.Skeleton);i&&(this.finishAct.active=!0,i.animation=t)}},disableFinishAni:function(e){this.finishAct&&(this.finishAct.active=!1)},hideAllPieces:function(){if(this.piece_array&&0<this.piece_array.length)for(var e=0;e<this.piece_array.length;e++)this.piece_array[e].active=!1},recovery_event:function(e,t){t.isGamePlaying=!0,t.getPlayer(e.banker).showBanker(),t.hideAllStatus(),t.setPanInfo(e.players,e.paninfos),t.initGameboard(!1),e.koni_timer&&!isNaN(e.koni_timer)&&(t.koni_timer=parseInt(e.koni_timer)),e.userid&&e.timer&&t.setTurn(e.userid,e.timer),t.lblTurnCount&&e.count&&(t.lblTurnCount.string="\n"+Math.round(parseInt(e.count)/2)+"Turn",t.turnCount=parseInt(e.count));for(var i=0;i<e.players.length;i++){var a=t.getPlayer(e.players[i].playuser);a&&e.players[i].pass&&a.updatePassCount(e.players[i].pass)}},setPanInfo:function(e,t){var i=this.getPlayer(e[0].playuser);o.setPanInfo(t),(0==i.seatid&&1==i.userdata.seatid||1==i.seatid&&0==i.userdata.seatid)&&o.flipPan()},setTurn:function(e,t){var i=this.getPlayer(e);i&&(this.turnSeat=i.seatid),this.stopTurnTimerAll(),0==this.turnSeat?this.giveTurn1(t):1==this.turnSeat&&this.giveTurn2(t)},giveTurn1:function(e){this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer1(e),this.togglePcsTurn(0))},giveTurn2:function(e){this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer2(e),this.togglePcsTurn(1))},togglePcsTurn:function(e){for(var t=0;t<this.towerboard.children.length;t++){var i=this.towerboard.children[t].getComponent("KoniPiece");i&&i.toggleTurn(e)}},hideAllStatus:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("KoniPlayerBoard");t&&t.hideStatus()}},sendlines_event:function(e,t){var i=parseInt(e.extmsg);if(0<i){2<=i&&(i/=2,cc.global.audio.playEffectAud("charge"));var a=t.panScore*i,s=0;if("normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway)for(r=0;r<t.playerlist.length;r++)if(n=t.playerlist[r].getComponent("KoniPlayer")){if(0==n.userdata.goldcoins)return;0==s?s=n.userdata.goldcoins:s>n.userdata.goldcoins&&(s=n.userdata.goldcoins)}s<a&&(a=s),t.updateBetUpBalance(a),t.multiBetUp(a),t.pangolds=t.pangolds+2*a}},multiBetUp:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("KoniPlayer");i&&i.betup.getComponent("TetrisBetUp").init(e,i.seatid)}},workOutMatchCareer:function(e){for(var t=0;t<e.players.length;t++){var i=this.getPlayer(e.players[t].userid),a=this.getPlayerBoard(e.players[t].userid);i&&a&&("normal"==cc.global.user.selplayway?0<e.players[t].score&&(this.matchCareerData.tgolds[i.userdata.id]+=e.players[t].score-this.pangolds/2):"diamond"==cc.global.user.selplayway&&0<e.players[t].score&&(this.matchCareerData.tdiamonds[i.userdata.id]+=e.players[t].score-this.pangolds/2),2==e.players[t].win&&(this.matchCareerData.wins[i.userdata.id]++,i.userdata.id))}this.showMatchCareer(this.matchCareerData)},allcards_event:function(e,t){clearTimeout(t.changeTurnTimer),t.otherEventCache=[],t.isGamePlaying=!1,t.pickedPiece=null,t.stopTurnTimerAll(),t.hideGoAble(),t.matchCareerData&&t.workOutMatchCareer(e);for(var i=t.playerlist.length==e.players.length,a=0;a<e.players.length;a++){var s=t.getPlayer(e.players[a].userid);if(e.players[a].getout&&(i=!1),s&&("normal"==cc.global.user.selplayway&&(s.userdata.goldcoins=parseInt(e.players[a].gold)),s.summary(e.players[a])),t.getPlayerBoard(e.players[a].userid)&&("suicide"!=e.title||e.players[a].win||(s=t.getPlayer(e.players[a].userid))&&s.showEmoticon(-1)),e.players[a].userid==cc.global.user.id)switch(t.notReplay&&(cc.global.user.goldcoins=e.players[a].gold),e.players[a].win){case 0:t.showBoardClaim("l",e.title);break;case 1:t.showBoardClaim("d",e.title);break;case 2:t.showBoardClaim("w",e.title)}}o.init(),i&&(t.endGameTimer=setTimeout(function(){t.endGameTimer=null,t.boardclaim.getComponent(cc.Animation).stop(),t.boardclaim.node.setScale(0,0),t.hideAllPieces(),t.cleanAfterAllCards(),t.setReadyState()},5e3))},cleanAfterAllCards:function(){this.pangolds=0,cc.global.amObserve&&"no"==cc.global.amObserve&&this.showWaitingTimer();for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].getComponent("KoniPlayer").hideBanker(),this.playerlist[e].getComponent("KoniPlayer").updatePassCount(0);this.lblTurnCount&&(this.lblTurnCount.string="\n",this.turnCount=0)},updateBetUpBalance:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("KoniPlayer");i&&(i.userdata.goldcoins-=e)}this.updatePlayerBalance()},updatePlayerBalance:function(){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("KoniPlayer");t&&t.updateBalance()}},showWaitingTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("KoniPlayerBoard");t&&t.startTimer(30)}},showReadyTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("KoniPlayerBoard");t&&t.startTimer(3)}},hideTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("KoniPlayerBoard");t&&t.stopTimer()}},getPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("KoniPlayer");if(i.userdata.id==e)return i}},getOtherPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("KoniPlayer");if(i.userdata.id!=e)return i}},getPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("KoniPlayerBoard");if(i.userdata.id==e)return i}},getOtherPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("KoniPlayerBoard");if(i.userdata.id!=e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},onClickGiveUp:function(){if(this.isGamePlaying){var e=this;cc.global.audio.playVoiceSpeech("support/12_give_up");var t=this.getLanguageText("ARE_YOU_GIVE_UP");this.checkConfirm(t,function(){e&&e.socket().exec("suicide",{})},null)}},onClickSfx:function(){if(this.btnSfx){var e=this.btnSfx,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},showChatDialog:function(){this.onclickChat(0)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.notReplay){if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}if(!(e<0)){this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root();var a=this.chatpage.getComponent("Chat");a.init(this,e),a.base.x=a.base.y=0,this.ischat=!0}}},onClickEmoticon:function(){if(this.notReplay){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),this.isemoticon=!1;this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root();var e=this.emoticonpage.getComponent("Emoticon");e.init(this,!1),e.base.x=e.base.y=0,this.isemoticon=!0}},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase,a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg);var s=t.getObserver(e.userid);s&&s.showCallPlayer(i,e.msg)},callplayer_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg);var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg,!1)},emoticon_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg);var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},onClickFindEmptyRoom:function(){},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},onClickChangePiece:function(){1==this.tgpcsbtn.children[0].active&&(this.tgpcsbtn.children[0].active=!1,this.tgpcsbtn.children[1].active=!0,this.togglePieceMode(!0)),1==this.tgpcsbtn.children[1].active&&(this.tgpcsbtn.children[0].active=!0,this.tgpcsbtn.children[1].active=!1,this.togglePieceMode(!1))},onclickBack:function(){var e=this;this.notReplay?this.isGamePlaying&&"no"==cc.global.amObserve?(cc.global.audio.playVoiceSpeech("support/14_roomout"),this.checkConfirm("Are you sure to leave room? You will lose.",function(){e.socket().exec("leave",{})},null)):this.socket().exec("leave",{}):this.exitPlay()},exitPlay:function(){var e=this;cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),null==this.exitTimer&&(this.exitTimer=setInterval(function(){e.finishAct&&!e.finishAct.active&&(e.returnToHall(),clearInterval(e.exitTimer),e.exitTimer=null)},500))},returnToHall:function(){this.loadding(),clearInterval(this.otherEventInvoker),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.startGameTimer&&clearTimeout(this.startGameTimer),this.endGameTimer&&clearTimeout(this.endGameTimer),this.hideTimer(),this.cleanAllPlayers(),this.scene("hall",this)}}),cc._RF.pop()},{HHCommon:"HHCommon",KoniEngine:"KoniEngine"}],KoniEngine:[function(e,t,i){"use strict";cc._RF.push(t,"a5ca1fDyvhKcI2KXzumfLN8","KoniEngine"),t.exports=function(){this.status=[],this.goable=[],this.route=[],this.boardWidth=13,this.boardHeight=17,this.init=function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0]&&this.initStatus(),this.clearGoAble()},this.initStatus=function(){this.status=[[-1,-1,-1,-1,-1,-1,2,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,2,2,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,2,2,2,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,2,2,2,2,-1,-1,-1,-1],[0,0,0,0,2,2,2,2,2,0,0,0,0],[-1,0,0,0,0,0,0,0,0,0,0,0,0],[-1,0,0,0,0,0,0,0,0,0,0,0,-1],[-1,-1,0,0,0,0,0,0,0,0,0,0,-1],[-1,-1,0,0,0,0,0,0,0,0,0,-1,-1],[-1,-1,0,0,0,0,0,0,0,0,0,0,-1],[-1,0,0,0,0,0,0,0,0,0,0,0,-1],[-1,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,1,1,1,1,0,0,0,0],[-1,-1,-1,-1,-1,1,1,1,1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,1,1,1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1]]},this.clearGoAble=function(){this.goable=[],this.route=[]},this.readyForFind=function(e,t){this.clearGoAble();var i={parent:-1,point:{col:t,row:e,value:this.status[e][t]}};this.goable.push(i)},this.findGoAble=function(e,t,i,a){var s=-1;0!==i&&(s=this.goable[this.goable[i].parent].point.value),e%2==0?(this.checkPoint(i,e,t-1,e,t-2,s,a+1),this.checkPoint(i,e,t+1,e,t+2,s,a+1),this.checkPoint(i,e-1,t,e-2,t-1,s,a+1),this.checkPoint(i,e-1,t+1,e-2,t+1,s,a+1),this.checkPoint(i,e+1,t,e+2,t-1,s,a+1),this.checkPoint(i,e+1,t+1,e+2,t+1,s,a+1)):(this.checkPoint(i,e,t-1,e,t-2,s,a+1),this.checkPoint(i,e,t+1,e,t+2,s,a+1),this.checkPoint(i,e-1,t,e-2,t+1,s,a+1),this.checkPoint(i,e-1,t-1,e-2,t-1,s,a+1),this.checkPoint(i,e+1,t,e+2,t+1,s,a+1),this.checkPoint(i,e+1,t-1,e+2,t-1,s,a+1))},this.checkPoint=function(e,t,i,a,s,r,n){var o=this.status,l=this.goable[e].point.value;if(0<=t&&t<17&&0<=i&&i<13){var c=o[t][i];if((c!==r&&0===c||0<c)&&0<=c&&(0===c&&1<=l&&(d={parent:e,point:{col:i,row:t,value:c,length:n}},this.goable.push(d)),0<c&&0<=a&&a<17&&0<=s&&s<13)){var h=o[a][s];if(0===h){for(var d={parent:e,point:{col:s,row:a,value:h,length:n}},u=!1,p=0;p<this.goable.length;p++)this.goable[p].point.col==s&&this.goable[p].point.row==a&&(this.goable[p].point.length>n&&(this.goable[p]=d),u=!0);!1===u&&(this.goable.push(d),this.findGoAble(a,s,this.goable.length-1,n))}}}},this.movePoint=function(e,t,i,a){this.status[i][a]=this.status[e][t],this.status[e][t]=0},this.getGoAblePos=function(e,t,i,a){this.route=[],this.readyForFind(e,t),this.findGoAble(e,t,0,0);var s=this.canMove(i,a);return-1!=s&&this.getRoute(s),this.route},this.setPanInfo=function(e){for(var t=0;t<e.length;t++)this.status[t]=e[t]},this.flipPan=function(){for(var e=[],t=0;t<this.boardHeight;t++)for(e[t]=[],i=0;i<this.boardWidth;i++)e[t][i]=0;for(t=0;t<this.boardHeight;t++)for(var i=0;i<this.boardWidth;i++)e[t][i]=t%2==0?this.status[16-t][12-i]:this.status[16-t][13-i],1==e[t][i]?e[t][i]=2:2==e[t][i]&&(e[t][i]=1);this.status=e},this.getRoute=function(e){if(-1!=e){var t=this.getAvailablePoint(e);this.route.push(t),this.getRoute(t.parent)}},this.getAvailablePoint=function(e){return this.goable[e]},this.canMove=function(e,t){for(var i=-1,a=0;a<this.goable.length;a++)if(this.goable[a].point.row==e&&this.goable[a].point.col==t){i=a;break}return i}},cc._RF.pop()},{}],KoniPieceHint:[function(e,t,i){"use strict";cc._RF.push(t,"1c81bfA7f5CDpTolFErtFwt","KoniPieceHint"),cc.Class({extends:cc.Component,properties:{hint:{default:null,type:cc.Node}},init:function(e,t,i){this.parent=e,this.row=t,this.col=i,this.cell_width=e.mainBoard.width/12,this.cell_height=e.mainBoard.height/16,this.x_offset=this.cell_width/2,this.y_offset=0,this.node.width=this.cell_width,this.node.height=this.cell_height,t%2==0?this.node.setPosition(this.cell_width*i,-this.cell_height*t):this.node.setPosition(this.cell_width*i-this.x_offset,-this.cell_height*t),this.hint.active=!1},show:function(){this.hint.active=!0},hide:function(){this.hint.active=!1},onClick:function(){this.parent.onClickPieceSlot(this.row,this.col)}}),cc._RF.pop()},{}],KoniPiece:[function(e,t,i){"use strict";cc._RF.push(t,"362ffISlUpBtJk/Q8Xxm2LP","KoniPiece");var a=e("HHCommon");cc.Class({extends:a,properties:{me:{default:null,type:sp.Skeleton},op:{default:null,type:sp.Skeleton},effect:{default:null,type:cc.Node}},init:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=arguments[2],a=arguments[3];this.isJump=!1,this.parent=e,this.pieceId=t,this.row=i,this.col=a,this.node.zIndex=13*i+a,this.saveZIndex=this.node.zIndex,this.cell_width=e.mainBoard.width/12,this.cell_height=e.mainBoard.height/16,this.node.width=this.cell_width,this.node.height=this.cell_height,this.x_offset=this.cell_width/2,this.y_offset=12,1==this.pieceId?(this.me.enabled=!0,this.op.enabled=!1,this.me.node.active=!0,this.op.node.active=!1):2==this.pieceId&&(this.me.enabled=!1,this.op.enabled=!0,this.me.node.active=!1,this.op.node.active=!0),i%2==0?this.node.setPosition(this.cell_width*this.col,-this.cell_height*this.row+this.y_offset):this.node.setPosition(this.cell_width*this.col-this.x_offset,-this.cell_height*this.row+this.y_offset)},moveTo:function(e,t,i){this.node.stopAllActions(),this.row%2==0?this.node.setPosition(this.cell_width*this.col,-this.cell_height*this.row+this.y_offset):this.node.setPosition(this.cell_width*this.col-this.x_offset,-this.cell_height*this.row+this.y_offset),this.row=t,this.col=i,this.node.zIndex=13*this.row+this.col,this.saveZIndex=this.node.zIndex,this.node.zIndex=1e3,this.jump(),this.moveAnimationImpl(e,1),6<=e.length&&(this.effect.active=!0)},moveImmediate:function(){this.row%2==0?this.node.setPosition(this.cell_width*this.col,-this.cell_height*this.row+this.y_offset):this.node.setPosition(this.cell_width*this.col-this.x_offset,-this.cell_height*this.row+this.y_offset)},moveAnimationImpl:function(i,a){if(a>=i.length){this.dropped();var t=this;this.effect.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(e){t.effect&&(t.effect.active=!1)},this)))}else{i[a].point.row%2==0?this.node.runAction(cc.moveTo(.22,this.cell_width*i[a].point.col,-this.cell_height*i[a].point.row+this.y_offset)):this.node.runAction(cc.moveTo(.22,this.cell_width*i[a].point.col-this.x_offset,-this.cell_height*i[a].point.row+this.y_offset));var e=cc.callFunc(function(e,t){cc.global.audio.playEffectAud("chess/pcs_drop"),t.script.moveAnimationImpl(i,a)},this,{script:this});this.node.runAction(cc.sequence(cc.delayTime(.22),e)),a++}},onClickPiece:function(){"no"==cc.global.amObserve&&0==this.parent.turnSeat&&1==this.pieceId&&this.parent.isGamePlaying&&(this.parent.piecePicked(this,this.row,this.col),this.pick())},jump:function(){this.isJump=!0,1==this.pieceId?(this.me.clearTracks(),this.me.timeScale=3,this.me.setAnimation(0,"jump",!0)):2==this.pieceId&&(this.op.clearTracks(),this.op.timeScale=3,this.op.setAnimation(0,"jump",!0)),this.node.zIndex=1e3},pick:function(){this.clearDropFade(),1==this.pieceId?(this.me.clearTracks(),this.me.timeScale=2,this.me.setAnimation(0,"select",!0)):2==this.pieceId&&(this.op.clearTracks(),this.op.timeScale=2,this.op.setAnimation(0,"select",!0)),this.node.zIndex=1e3},clearDropFade:function(){1==this.pieceId?(this.me.node.getComponent(cc.Animation).stop(),this.me.node.color=cc.hexToColor("#FFFFFF")):2==this.pieceId&&(this.op.node.getComponent(cc.Animation).stop(),this.op.node.color=cc.hexToColor("#FFFFFF"))},unpick:function(){this.isJump||(1==this.pieceId?(this.me.clearTracks(),this.me.setAnimation(0,"idle",!1)):2==this.pieceId&&(this.op.clearTracks(),this.op.setAnimation(0,"idle",!1)),this.node.zIndex=this.saveZIndex)},toggleTurn:function(e){return this.clearDropFade(),2==this.pieceId&&1==e?(this.me.node.color=cc.hexToColor("#FFFFFF"),void(this.op.node.color=cc.hexToColor("#FFFFFF"))):1==this.pieceId&&0==e?(this.me.node.color=cc.hexToColor("#FFFFFF"),void(this.op.node.color=cc.hexToColor("#FFFFFF"))):(this.me.node.color=cc.hexToColor("#C0C0C0"),void(this.op.node.color=cc.hexToColor("#C0C0C0")))},dropped:function(){this.isJump=!1,this.unpick(),1==this.pieceId?this.me.node.getComponent(cc.Animation).play("pcs_drop_fade"):2==this.pieceId&&this.op.node.getComponent(cc.Animation).play("pcs_drop_fade")}}),cc._RF.pop()},{HHCommon:"HHCommon"}],KoniPlayerBoard:[function(e,t,i){"use strict";cc._RF.push(t,"3e11atQ5WhKbK+2B0rsbDWz","KoniPlayerBoard");var a=e("HHCommon");cc.Class({extends:a,properties:{countdown:{default:null,type:cc.Label},status:{default:null,type:cc.Label},tip:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.layoutForSeat()},startTimer:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode||!(3<e)){var t=this;t.stopTimer(),t.countdown.node.active=!0,t.countdown.string=e,t.timer||(t.timer=setInterval(function(){0<e?t.countdown&&(e--,t.countdown.string=e):t.stopTimer()},1e3))}},stopTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null),this.countdown&&(this.countdown.node.active=!1)},setState:function(e){var t=this.getLanguageText("READY_0")+"?",i=this.getLanguageText("PREPARED_0");1!=cc.global.championMode&&2!=cc.global.championMode?(this.status.node.active=!0,t==(this.status.string=e)&&this.userdata.id==cc.global.user.id&&"no"==cc.global.amObserve?this.tip.active=!0:this.tip.active=!1):this.status.string=i},hideTip:function(){this.tip.active=!1},hideStatus:function(){this.stopTimer(),this.hideTip(),this.status.node.active=!1},layoutForSeat:function(){0==this.seatid||this.seatid},isReady:function(){return this.getLanguageText("PREPARED_0")==this.status.string},onClickReady:function(){this.parent&&this.parent.processReadyState()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],KoniPlayer:[function(e,t,i){"use strict";cc._RF.push(t,"6a0beCZtEtD5Z6xO7S4+vF3","KoniPlayer");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},nickname:{default:null,type:cc.Label},goldcoin_base:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},betup:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},winorlose:{default:null,type:cc.Node},banker:{default:null,type:cc.Node},passCount:{default:null,type:cc.Label}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.nickname.string=t.nickname,1==cc.global.championMode||cc.global.championMode,this.goldcoins.string=this.numformat(t.goldcoins),this.goldcoins.node.parent.active=!0,this.loadAvatar(t.avatarurl,t.gender),this.layoutForSeat()},speech:function(e){var t=this.userdata.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)},onClickDisInfo:function(){},updateCareer:function(e){},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},spendDiamondForLuck:function(e){this.updateBalance()},showCallPlayer:function(e,t){var i=this;this.hideCallPlayer(),cc.global.audio.playVoiceChatWithType(this.userdata.playcharacter,t),this.callplayer.active=!0,this.callplayer.children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onClickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userdata.id},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){cc.global.user.id==this.userdata.id?this.parent.onClickEmoticon&&this.parent.onClickEmoticon():this.onClickCallPlayer()},layoutForSeat:function(){},summary:function(e){var a=this;if(this.updateCareer(e),this.winorlose.getComponent(cc.Animation).play(),2==e.win){cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("win"),this.winorlose.children[1].getComponent(cc.Label).string="+"+this.numformat(e.exp),this.winorlose.children[2].getComponent(cc.Label).string="+"+this.numformat(e.score),e.orig_gold=e.gold-e.score,"diamond"==cc.global.user.selplayway&&(e.orig_gold=e.diamond-e.score);var t=cc.callFunc(function(e,t){t.orig_gold+Math.round(t.score/5)>("diamond"==cc.global.user.selplayway?t.diamond:t.gold)?"diamond"==cc.global.user.selplayway?t.orig_gold=t.diamond:t.orig_gold=t.gold:t.orig_gold=t.orig_gold+Math.round(t.score/5);var i=e.getComponent("KoniPlayer").goldcoins.node;i.getComponent(cc.Label).string=a.numformat(t.orig_gold),i.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1)))},this,e),i=cc.sequence(cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t);this.node.runAction(i)}else cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("lose"),this.winorlose.children[1].getComponent(cc.Label).string="-"+this.numformat(Math.abs(e.exp)),this.winorlose.children[2].getComponent(cc.Label).string="-"+this.numformat(-1*e.score),this.goldcoins.string=this.numformat(e.gold)},showBanker:function(){this.banker.active=!0,2<=this.banker.children.length&&(this.banker.children[0].active=0==this.seatid,this.banker.children[1].active=0!=this.seatid)},hideBanker:function(){this.banker.active=!1},updatePassCount:function(e){if(this.passCount){var t=3-parseInt(e);if(0<=t){var i=this.getLanguageText("PASS_COUNT");this.passCount.string=i+": "+t}else{i=this.getLanguageText("NO_PASS_COUNT");this.passCount.string=i}}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],LabelArray:[function(e,t,i){"use strict";cc._RF.push(t,"2d691EMHaBNHaBhhuQSKc7h","LabelArray"),cc.Class({extends:cc.Component,properties:{labels:{default:[],type:cc.Label}},onLoad:function(){}}),cc._RF.pop()},{}],LanguageDialog:[function(e,t,i){"use strict";cc._RF.push(t,"f2a0eW35xBC/YZ0mk8vw14N","LanguageDialog");var a=e("HallDialog");cc.Class({extends:a,properties:{content:{default:null,type:cc.Node}},init:function(e){this.parent=e,this.btns=[],this.lanList=cc.global.languageList,this.lanIdx=this.lanList.findIndex(function(e){return e==cc.global.curLanguage}),this.oriIdx=this.lanIdx;for(var t=0;t<4;t++)this.btns.push(this.content.children[t]),this.btns[t].children[0].children[1].active=this.lanIdx==t,this.btns[t].children[0].children[0].active=this.lanIdx!=t},onClickClose:function(){this.node.destroy(),this.oriIdx!=this.lanIdx&&cc.director.preloadScene("login",function(e){cc.director.loadScene("login",function(){})})},onClickLanBtn:function(){var e=1<arguments.length?parseInt(arguments[1]):0;if(e!=this.lanIdx){this.lanIdx=e,cc.global.curLanguage=this.lanList[e];for(var t=0;t<4;t++)this.btns[t].children[0].children[1].active=this.lanIdx==t,this.btns[t].children[0].children[0].active=this.lanIdx!=t;cc.sys.localStorage.setItem("curLan",cc.global.curLanguage)}}}),cc._RF.pop()},{HallDialog:"HallDialog"}],LiveDialog:[function(e,t,i){"use strict";cc._RF.push(t,"d1e7fwzGstAO41oeEodyUq+","LiveDialog");var a=e("HallDialog");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},title:{default:null,type:cc.Label},title_icon:cc.Sprite,title_label:cc.Label,nocontent:cc.Node,nocontentbg:cc.Node,contentView:{default:null,type:cc.Node},itemPrefab:{default:null,type:cc.Prefab},scrollview:{default:null,type:cc.ScrollView},keyword:cc.EditBox,total_count:cc.Label},init:function(e){this.parent=e,this.code=cc.global.cur_game_code+"_"+cc.global.cur_game_condition,this.game=cc.global.newgameTabIdx[this.code],cc.global.gameIcons[this.game.idx]&&(this.title_icon.spriteFrame=cc.global.gameIcons[this.game.idx],this.title_label.string=this.game.name),this.onClickRefresh()},update:function(e){var t=cc.global.allgames[cc.global.hallTabIdx];if(null!=t){var i=this.getLanguageText("PLAYING_0"),a=this.getLanguageText("PLAYERS_0"),s=this.getLanguageText("WAIT_0");this.total_count.string=i+":"+t.players+a;var r=0;for(var n in t.rooms)r+=parseInt(t.rooms[n].ready);this.total_count.string=i+" : "+(t.players-r)+a+" \n"+s+" : "+r+a}},onClickRefresh:function(){this.loadding();var t=this;cc.global.http.httpPost("/hall/room_list",{gameidx:cc.global.hallTabIdx,keyword:this.keyword.string},function(e){t.closeloadding(),t.renderPageContent(t.parse(e))},function(e){t.closeloadding()})},onClickClose:function(){this.parent.closeDialog(this)},onClickTrain:function(){this.parent.onClickTrain()},renderPageContent:function(e){var t=this;if(t&&t.scrollview&&t.scrollview.scrollToTop(.1),t&&t.contentView&&(t.contentView.destroyAllChildren(),t.contentView.removeAllChildren()),!e.list||0==e.list.length)return this.nocontent.active=!0,void(this.nocontentbg.active=!0);this.nocontent.active=!1,this.nocontentbg.active=!1;for(var i=0;i<e.list.length;i++){var a=cc.instantiate(t.itemPrefab);a.parent=t.contentView,a.getComponent("GameLiveRow").init(t,e.list[i])}},onClearKeyword:function(e,t){this.keyword.string=""},onChangeKeyword:function(e,t){0<this.keyword.string.length?this.keyword.node.children[0].active=!0:this.keyword.node.children[0].active=!1}}),cc._RF.pop()},{HallDialog:"HallDialog"}],LoadingLogic:[function(i,e,t){"use strict";cc._RF.push(e,"3be2b2ZQzZIGIAui0xOmSD7","LoadingLogic");var a=i("HHCommon");cc.Class({extends:a,properties:{tipLabel:cc.Label,progress:cc.ProgressBar,_stateStr:"",_isLoading:!1,btnRetry:cc.Node,manifestUrl:{default:null,url:cc.RawAsset},train_btn:cc.Node},onLoad:function(){cc.global||(cc.global={}),cc.global.autoOffline=!1,cc.global.isTestGame=JSON.parse(cc.sys.localStorage.getItem("This_is_test")),cc.global.isTestGame||(cc.global.isTestGame=!1,cc.sys.localStorage.setItem("This_is_test",JSON.stringify(cc.global.isTestGame))),cc.global.theme=JSON.parse(cc.sys.localStorage.getItem("card_game_theme")),null==cc.global.theme&&(cc.global.theme={card_theme:2,card_size:1,card_sort:1,background:3}),cc.global.autologin=0,cc.global.orientation=1;var e=cc.director.getWinSize();cc.global.ratioWidth=e.width,cc.global.ratioHeight=e.height,cc.sys.isMobile?cc.global.narrowContentRatio=e.width/720:e.height>e.width?cc.global.narrowContentRatio=1280/720/(e.height/e.width):(cc.global.narrowContentRatio=1280/720/(e.width/e.height),cc.global.ratioWidth=e.height,cc.global.ratioHeight=e.width),this.initMgr(),this.tipLabel.string=this._stateStr;var t=cc.sys.localStorage.getItem("theme_idx");null==t||4==t||isNaN(t)?t=3:3==t&&(t=4);var i=(new Date).getHours();19<=i||i<=6?(cc.global.isDark=!0,t=4):cc.global.isDark=!1,t=4,cc.global.isDark=!0,cc.sys.localStorage.setItem("theme_idx",t),cc.global.theme_idx=t,cc.global.game_theme_idx=cc.sys.localStorage.getItem("game_theme_idx"),(null==cc.global.game_theme_idx||isNaN(cc.global.game_theme_idx))&&(cc.global.game_theme_idx=1,cc.sys.localStorage.setItem("game_theme_idx",cc.global.game_theme_idx))},startGame:function(){this.initGameConfig(),this.checkVersion()},initGameConfig:function(){cc.global.version=6.4,cc.global.chat||cc.loader.loadRes("config/chat",cc.TextAsset,function(e,t){cc.global.chat=null!=e?[]:t}),cc.global.user={},cc.global.missions||cc.loader.loadRes("config/mission",cc.TextAsset,function(e,t){cc.global.missions=null!=e?[]:t}),cc.global.newgameGroups={1:{name:"BoardGame",games:[]},2:{name:"Card Game",games:[]},3:{name:"Sport Game",games:[]},4:{name:"Puzzle",games:[]}},cc.global.newgameTabIdx||cc.loader.loadRes("config/games",cc.TextAsset,function(e,t){cc.global.newgameTabIdx=null!=e?{}:t}),cc.global.news_limit=100},networkFail:function(e){this.btnRetry.active=!0,this.progress.node.active=!1,this.tipLabel.string=e||"Network Error",this.train_btn.active=!0},checkVersion:function(){if(this.train_btn.active=!1,this.btnRetry.active=!1,this.progress.node.active=!0,this.progress.progress=.1,cc.sys.isNative){var e=r.getLanguageText("CONNECTING_SERVER_0");this.tipLabel.string=e;var r=this,n=!1,t=cc.global.http.getVersion(function(e){if(n=!0,null==e){var t=r.getLanguageText("ERROR_IN_SERVER_RESPONSE");r.networkFail(t+": 01")}else{var i=(jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"hhgame-asset";r._am||(r._am=new jsb.AssetsManager(r.manifestUrl,i),cc.sys.ENABLE_GC_FOR_NATIVE_OBJECTS||r._am.retain(),cc.sys.os===cc.sys.OS_ANDROID&&r._am.setMaxConcurrentTask(2));var a=JSON.parse(e);r._needUpdate=!1;t=r.getLanguageText("CHECKING_VERSION_0");if(r.tipLabel.string=t,r._am.getLocalManifest().isLoaded()){var s=r._am.getLocalManifest().getVersion();if(r.versionCompareHandle(a.version,s)<=0)return void r.startPreloading();r._needUpdate=!0,r.hotUpdate()}}},function(e){n=!0,r.networkFail(e)});setTimeout(function(){n||t&&t.abort()},3e3)}else this.startPreloading()},checkCb:function(e){switch(e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:return cc.eventManager.removeListener(this._checkListener),this._checkListener=null,this.tipLabel.string=".",void this.startPreloading();case jsb.EventAssetsManager.NEW_VERSION_FOUND:this._needUpdate=!0;break;default:return}cc.eventManager.removeListener(this._checkListener),this._checkListener=null,this.hotUpdate()},hotUpdate:function(){if(this._am&&this._needUpdate)this.tipLabel.string="Updating.",this.progress.progress=1,this.progress.node.active=!0,this._updateListener=new jsb.EventListenerAssetsManager(this._am,this.updateCb.bind(this)),cc.eventManager.addListener(this._updateListener,1),this._failCount=0,this._am.update();else{var e=this.getLanguageText("ERROR_IN_SERVER_RESPONSE");this.networkFail(e+": 03")}},updateCb:function(e){var t=!1,i=!1;switch(e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:i=!0;break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:var a=this.getLanguageText("PREPARING_UPDATING_0");this.tipLabel.string=a,this.progress.progress=.1;break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:if(e.getTotalBytes()){var s=e.getTotalBytes()/1024/1024+"";1<s.split(".").length&&(s=s.split(".")[0]+"."+s.split(".")[0].substr(0,2));var r=e.getDownloadedBytes()/1024/1024+"";1<r.split(".").length&&(r=r.split(".")[0]+"."+r.split(".")[0].substr(0,2));var n=e.getPercent();(isNaN(n)||n<=.1)&&(n=.1),n=parseFloat(n);a=this.getLanguageText("UPDATING_DATA_0");this.tipLabel.string=a+" "+parseInt(100*n)+"%",this.progress.progress=n}else{var a=this.getLanguageText("PREPARING_UPDATING_0");this.tipLabel.string=a,this.progress.progress=1}break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:i=!0;break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:return void this.startPreloading();case jsb.EventAssetsManager.UPDATE_FINISHED:this.progress.progress=1;a=this.getLanguageText("COMPLETE_0");this.tipLabel.string=a,t=!0;break;case jsb.EventAssetsManager.UPDATE_FAILED:this._failCount++,this._failCount<5?this._am.downloadFailedAssets():i=!(this._failCount=0);break;case jsb.EventAssetsManager.ERROR_UPDATING:case jsb.EventAssetsManager.ERROR_DECOMPRESS:}if(i)return cc.eventManager.removeListener(this._updateListener),this._updateListener=null,void this.networkFail("Error");if(t){cc.eventManager.removeListener(this._updateListener),this._updateListener=null;var o=jsb.fileUtils.getSearchPaths(),l=this._am.getLocalManifest().getSearchPaths();Array.prototype.unshift(o,l),cc.sys.localStorage.setItem("HotUpdateSearchPaths",JSON.stringify(o)),jsb.fileUtils.setSearchPaths(o);a=this.getLanguageText("RESTART_PROGRAM_0");this.tipLabel.string=a,cc.game.restart()}},onDestroy:function(){this._updateListener&&(cc.eventManager.removeListener(this._updateListener),this._updateListener=null),this._am&&!cc.sys.ENABLE_GC_FOR_NATIVE_OBJECTS&&this._am.release()},initMgr:function(){var e=i("Audio");cc.global.audio=new e,cc.global.audio.init();var t=i("ServerConfig");cc.global.http=i("HTTP"),console.log(t.baseURL),cc.global.http.baseURL=t.baseURL,cc.global.http.wsURL=t.wsURL,cc.global.http.avatarURL=t.avatarURL,cc.sys.isMobile&&(cc.global.http.baseURL=t.baseURL3g,cc.global.http.wsURL=t.wsURL3g,cc.global.http.avatarURL=t.avatarURL3g),cc.global.http.f7URL=t.f7URL,cc.global.http.voiceURL=t.voiceURL,cc.global.http.serverURL=t.serverURL,cc.global.http.apiURL=t.apiURL,cc.global.openwin=null,cc.global.openinvite=null,cc.global.opentoast=null},startPreloading:function(){var e=this.getLanguageText("LOADING_DATA");this._stateStr=e,this._isLoading=!0;var s=this;this.progress.node.active=!0,this.progress.progress=.1,cc.sys.isMobile?cc.loader.loadResDir("images",function(e,t,i){var a;s._isLoading&&(a=0<t&&0<e?e/t:.1,(isNaN(a)||a<=.1)&&(a=.1),a=parseFloat(a),s.progress.progress=a)},function(e,t,i){s.onLoadComplete()}):s.onLoadComplete()},versionCompareHandle:function(e,t){for(var i=e.split("."),a=t.split("."),s=0;s<i.length;++s){var r=parseInt(i[s]),n=parseInt(a[s]||0);if(r!==n)return r-n}return a.length>i.length?-1:0},onLoadComplete:function(){this._isLoading=!1;var e=this.getLanguageText("LOAD_COMPLETE_0");this._stateStr=e,cc.director.loadScene("login"),cc.current_scene="login",cc.loader.onComplete=null},update:function(e){if(0!=this._stateStr.length)if(this.tipLabel.string=this._stateStr+" ",this._isLoading)this.tipLabel.string+=Math.floor(100*this.progress.progress)+"%",this.progress.node.active=!0;else for(var t=Math.floor(Date.now()/1e3)%4,i=0;i<t;++i)this.tipLabel.string+="."},onClickRetry:function(){this.checkVersion()},onClickExit:function(){cc.game.end()},onClickSound:function(){},onClickOffline:function(){cc.global.isOffline=!0,cc.global.autoOffline=!0;cc.director.loadScene("login"),cc.current_scene="login",cc.loader.onComplete=null}}),cc._RF.pop()},{Audio:"Audio",HHCommon:"HHCommon",HTTP:"HTTP",ServerConfig:"ServerConfig"}],LocalizationManager:[function(e,t,i){"use strict";cc._RF.push(t,"1ada2gk7fJDs6t2e4W/kfxQ","LocalizationManager"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.init()},init:function(){if(cc.global||(cc.global={}),cc.global.languageList=["EN","CH","RU"],!cc.global.languageData){var e=cc.sys.localStorage.getItem("curLan");e||(cc.sys.localStorage.setItem("curLan","EN"),e="EN"),cc.global.curLanguage=e,cc.global.languageData={EN:{},CH:{},RU:{}}}var r=this;cc.loader.loadRes("language",cc.RawAsset,function(e,t){try{for(var i=0;i<t.length;i++){var a=t[i];if(a){var s=a.KEY;s&&(cc.global.languageData.EN[s]=a.EN,cc.global.languageData.CH[s]=a.CH,cc.global.languageData.RU[s]=a.RU)}}r.node.getComponent("LoadingLogic").startGame()}catch(e){console.log(e),cc.global.languageData={},r.node.getComponent("LoadingLogic").startGame()}}.bind(this))}}),cc._RF.pop()},{}],LocalizeImg:[function(e,t,i){"use strict";cc._RF.push(t,"57e7eeznJdGOqEh2LTwo7Di","LocalizeImg"),cc.Class({extends:cc.Component,properties:{imgSet:{default:[],type:[cc.SpriteFrame]}},onLoad:function(){if(cc.global.curLanguage)try{var e=0;"EN"==cc.global.curLanguage?e=0:"CH"==cc.global.curLanguage?e=1:"RU"==cc.global.curLanguage&&(e=2),this.node.getComponent(cc.Sprite)&&this.imgSet[e]&&(this.node.getComponent(cc.Sprite).spriteFrame=this.imgSet[e])}catch(e){console.log(e)}}}),cc._RF.pop()},{}],Localize:[function(e,t,i){"use strict";cc._RF.push(t,"60421+rCj1DsortAF25cdHc","Localize"),cc.Class({extends:cc.Component,properties:{Key:""},onLoad:function(){if(cc.global.languageData&&cc.global.languageData[cc.global.curLanguage])try{var e=cc.global.languageData[cc.global.curLanguage][this.Key];e&&this.setText(e)}catch(e){console.log(e)}},setFontRes:function(e){},setText:function(e){this.node.getComponent(cc.Label)&&(this.node.getComponent(cc.Label).string=e)}}),cc._RF.pop()},{}],MinerBegin:[function(e,t,i){"use strict";cc._RF.push(t,"400e6UXNGxNbI9xNbYhHwRv","MinerBegin");var a=e("HHCommon");cc.Class({extends:a,properties:{room_value_label:{default:null,type:cc.Node},btnSfx:{default:null,type:cc.Node},background:{default:null,type:cc.Node},underground:{default:null,type:cc.Node},miner:{default:null,type:cc.Node},hookrope:{default:null,type:cc.Node},mineobject:{default:null,type:cc.Prefab},mouseobject:{default:null,type:cc.Prefab},gemmouseobject:{default:null,type:cc.Prefab},label_goal:{default:null,type:cc.Label},label_level:{default:null,type:cc.Label},label_time:{default:null,type:cc.Label},label_total:{default:null,type:cc.Label},lable_tmpscore:{default:null,type:cc.Label},mine:{default:[]},otherMine:{default:[]},treasure:{default:[]},tiles:{default:null,type:cc.SpriteAtlas},levelgoal:0,goal:0,level:0,total:0,roundRemaintime:0,gaming:{default:null,type:cc.Label},joining:{default:null,type:cc.Label},room_status:{default:null,type:cc.Label},btn_ready:{default:null,type:cc.Node},timeout_status:{default:null,type:cc.Node},game_status:{default:null,type:cc.Node},players_status:{default:null,type:cc.Node},game_result:{default:null,type:cc.Node},game_result_content:{default:null,type:cc.Node},label_rank:{default:null,type:cc.Label},label_score:{default:null,type:cc.Label},label_gold:{default:null,type:cc.Label},timer:{default:null,type:cc.Label},avatar_area_id_label:{default:null,type:cc.Label},avatar_area_gold_label:{default:null,type:cc.Label},avatar_area_avatarSprite:{default:null,type:cc.Sprite},deposited_value_label:{default:null,type:cc.Label},betUp_animation:{default:null,type:cc.Node},score_label:{default:null,type:cc.Label},playing_status:{default:null,type:cc.Node},playing_label:{default:null,type:cc.Label},joining_label:{default:null,type:cc.Label},gold_star:{default:null,type:cc.Node}},onLoad:function(){cc.global.user.roomInType="NormalJoin",!cc.global.isOffline&&this.initEventCallback(),cc.game.setFrameRate(60),cc.global.amObserve="no",cc.director.getCollisionManager().enabled=!0,cc.director.getCollisionManager().enabledDebugDraw=!1,this.play_status=0,this.playerlist=new Array,this.inited=!1,this.time=60,this.notReplay=!0,this.isGamePlaying=!1,this.otherTmpScore=0,this.goldMinerStarted=!1,this.roomValue=0,this.userReady=!1,this.myscore=0,this.restart=!0,this.sceneInfoFromJson=null,cc.global.extparams.roomid?this.roomId=cc.global.extparams.roomid:this.roomId=cc.global.user.roomid,this.playerArr=new Array,null!=cc.global&&this.initgame(),cc.global.audio.playBGM("bgm_tetris",.3);var i=this;cc.global.isOffline&&cc.loader.loadRes("new_game/miner/sceneInfo",cc.TextAsset,function(e,t){e||(i.sceneInfoFromJson=t,i.beginOffline())})},setScene:function(e){for(var t=cc.find("Canvas").width,i=cc.find("Canvas").height,a=(i-this.underground.height)/2,s=0;s<e.length;s++){var r,n,o;"mouse"==e[s].type?this.mine[s]=cc.instantiate(this.mouseobject):"gemmouse"==e[s].type?this.mine[s]=cc.instantiate(this.gemmouseobject):this.mine[s]=cc.instantiate(this.mineobject),this.mine[s].setPosition(new cc.Vec2(e[s].x*t/100-t/2,e[s].y*i/100-i/2-a)),this.mine[s].parent=this.background,"mouse"==e[s].type?(n=e[s].price,o=3):"gemmouse"==e[s].type?(n=e[s].price,o=2.5):"stone"==e[s].type?(r="game_mineral_stone_big_00",n=e[s].price,o=.8):"gold"==e[s].type?1==e[s].scale?(r="game_mineral_gold_big_00",n=e[s].price,o=.8):.8==e[s].scale?(r="game_mineral_gold_big_00",n=e[s].price,o=1.5):.5==e[s].scale?(r="game_mineral_gold_middle_00",n=e[s].price,o=2.5):.25==e[s].scale&&(r="game_mineral_gold_small_00",n=e[s].price,o=4):"diamond"==e[s].type?(r="game_mineral_diamond_green_00",n=e[s].price,o=4):"treasure"==e[s].type?(r="game_mineral_chests_00",n=e[s].price,o=2.5):"explosive"==e[s].type&&(r="game_mineral_bomb_00",n=e[s].price,o=3),this.mine[s].setScale(1.6,1.6),cc.global.isOffline&&(n=this.getPrice(e[s].type,e[s].scale)),"mouse"!=e[s].type&&"gemmouse"!=e[s].type?(this.mine[s].getComponent(cc.Sprite).spriteFrame=this.tiles.getSpriteFrame(r),this.mine[s].getComponent(cc.BoxCollider).size=cc.size(this.mine[s].width,this.mine[s].height),this.mine[s].getComponent("mineobject").init(s,e[s].type,n,o,e[s].x,this)):this.mine[s].getComponent("SusliksMove").init(s,e[s].type,n,o,e[s].x,this),1==parseInt(e[s].used)&&(this.mine[s].active=!1)}},getPrice:function(e,t){var i;switch(e){case"gold":i=1<=t?500:.8<=t?250:.5<=t?100:50;break;case"diamond":i=600;break;case"treasure":i=800;break;case"gemmouse":i=602;break;case"stone":i=20;break;case"mouse":i=2;break;case"explosive":i=0}return i},fun_timemanage:function(){this.roundRemaintime--,this.label_time.string=this.roundRemaintime,0==this.roundRemaintime&&(this.unschedule(this.fun_timemanage),this.fun_endgame())},miner_wait:function(){this.minerspine.play("miner_wait")},miner_pull:function(){this.minerspine.play("miner_lift")},miner_lift_gold:function(){this.minerspine.play("miner_lift_heavy")},miner_dig:function(){this.minerspine.play("miner_throw")},fun_touchunderground:function(){0==this.hookrope.getComponent("hookrope").hasdig&&(this.isGamePlaying&&cc.global.audio.playEffectAud("chess/pcs_drop"),this.miner_dig(),this.hookrope.getComponent("hookrope").dig())},fun_destroymine:function(e){this.mine[e].destroy(),"mouse"!=this.sceneInforFromData[e].type&&"gemmouse"!=this.sceneInforFromData[e].type?(this.lable_tmpscore.string=this.mine[e].getComponent("mineobject").worth,this.goal=this.mine[e].getComponent("mineobject").worth):(this.lable_tmpscore.string=this.mine[e].getComponent("SusliksMove").worth,this.goal=this.mine[e].getComponent("SusliksMove").worth),this.lable_tmpscore.node.setPosition(this.mine[e].getPosition());var t=cc.fadeIn(.2),i=cc.fadeOut(.3),a=cc.moveTo(.5,cc.p(-270,100)),s=cc.scaleTo(.5,1.4),r=cc.scaleTo(.5,1),n=cc.moveTo(.2,this.label_total.node.getPosition()),o=cc.spawn(t,a),l=cc.spawn(i,n),c=cc.sequence(o,s,r,l,cc.callFunc(this.fun_effectgoal.bind(this)));this.lable_tmpscore.node.runAction(c)},fun_effectgoal:function(){var e=Math.min(this.goal,50);this.tmpgoal=this.total+this.goal-e,this.label_total.string=this.tmpgoal,this.deltagoal=0,this.schedule(this.fun_timegoal,.01)},fun_timegoal:function(){if(this.deltagoal==Math.min(this.goal,50))return this.total+=this.goal,this.label_total.string=this.total,void this.unschedule(this.fun_timegoal);this.deltagoal++;var e=this.tmpgoal+this.deltagoal;this.label_total.string=e},initgame:function(){var t=this,e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));if(null==e&&(e=!0),e?(this.btnSfx.children[0].active=!0,this.btnSfx.children[1].active=!1):(this.btnSfx.children[0].active=!1,this.btnSfx.children[1].active=!0),cc.global.isOffline){var i=this.getLanguageText("NO_CONNECTION_0");this.avatar_area_id_label.string=i}else{var a=this.socket();this.map("tick",this.tick_event),this.map("begin",this.begin_event),this.map("finish",this.finish_event),this.map("rtleave",this.rtleave_event),a.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)});var s={};s.extparams={roomid:cc.global.extparams.roomid},a.exec("rtjoin",s),this.playerBalance=cc.global.user.goldcoins,this.avatar_area_id_label.string=cc.global.user.nickname,this.avatar_area_gold_label.string=this.numformat(this.playerBalance),this.loadAvatar(cc.global.user.avatarurl,cc.global.user.gender,this.avatar_area_avatarSprite)}this.inited=!0},cleanAllPlayers:function(){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].destroy();this.playerlist.splice(0,this.playerlist.length),this.playerlist=new Array},update:function(e){var t=this;this.goldMinerStarted&&0<=this.time&&(this.time-=e,this.timer.string=parseInt(this.time)),cc.global.isOffline&&this.time<=0&&this.restart&&(setTimeout(function(){t.beginOffline()},2e3),this.restart=!1)},tick_event:function(e,t){if((cc.global.isOffline||parseInt(t.roomId)==parseInt(e.room_id))&&(t.room_value_label.getComponent(cc.Label).string=0==t.roomValue?t.numformat(parseInt(cc.global.curPlaywayScore))+"pt":t.numformat(t.roomValue)+"pt",0!=e.extdata.status&&0!=e.extdata.mstatus||(t.game_result.active=!1,t.score_label.string=0,t.game_status.active=!0,t.joining.string="Login: "+e.extdata.total,t.gaming.string="Playing: "+e.extdata.player_count,t.room_status.string=e.extdata.time+"s After Game Start",t.btn_ready.active=!0,t.timeout_status.active=!1,t.playing_status.active=!1,e.extdata.time<=3&&!t.userReady&&(t.btn_ready.active=!1,t.timeout_status.active=!0)),e.extdata.status&&!e.extdata.mstatus&&(t.btn_ready.active=!1,t.btn_ready.children[2].active=!1),e.extdata.status)){for(var i=0;i<e.extdata.player_count;i++)t.playerArr[i]=e.extdata.scores[i];if(e.extdata.mstatus)if(cc.global.isOffline?t.score_label.string=t.numformat(this.myscore):t.score_label.string=t.numformat(e.extdata.mscore),t.playing_status.active=!0,t.myRankStatus=!1,t.joining_label.string="Login: "+e.extdata.total,t.playing_label.string="Playing: "+e.extdata.player_count,e.extdata.player_count<5||e.extdata.mrank<5){t.players_status.active=!0;for(var a=0;a<4;a++)t.players_status.children[a].active=!1;s=e.extdata.player_count<5?e.extdata.player_count:4;for(i=0;i<s;i++)t.players_status.children[i].active=!0,t.playerArr[i]&&t.playerArr[i][3]&&(t.players_status.children[i].children[0].getComponent(cc.Label).string=t.playerArr[i][3]+"."),t.playerArr[i]&&t.playerArr[i][0]&&t.playerList[t.playerArr[i][0]]&&(t.players_status.children[i].children[1].getComponent(cc.Label).string=t.playerList[t.playerArr[i][0]]),t.playerArr[i]&&(t.players_status.children[i].children[2].getComponent(cc.Label).string=t.numformat(t.playerArr[i][1])),t.playerArr[i][0]==cc.global.user.id?(t.players_status.children[i].children[0].color=cc.hexToColor("#F5FF02"),t.players_status.children[i].children[1].color=cc.hexToColor("#F5FF02"),t.players_status.children[i].children[2].color=cc.hexToColor("#F5FF02"),t.myRankStatus=!0):(t.players_status.children[i].children[0].color=cc.hexToColor("#FFFFFF"),t.players_status.children[i].children[1].color=cc.hexToColor("#FFFFFF"),t.players_status.children[i].children[2].color=cc.hexToColor("#FFFFFF"));t.myRankStatus||(t.players_status.children[3].active=!0,t.players_status.children[3].children[0].getComponent(cc.Label).string=e.extdata.mrank+".",t.players_status.children[3].children[1].getComponent(cc.Label).string=t.playerList[cc.global.user.id],t.players_status.children[3].children[2].getComponent(cc.Label).string=t.numformat(e.extdata.mscore),t.players_status.children[3].children[0].color=cc.hexToColor("#F5FF02"),t.players_status.children[3].children[1].color=cc.hexToColor("#F5FF02"),t.players_status.children[3].children[2].color=cc.hexToColor("#F5FF02"),t.myRankStatus=!0)}else{t.players_status.active=!0;for(a=0;a<4;a++)t.players_status.children[a].active=!1;for(i=0;i<3;i++)t.players_status.children[i].active=!0,t.playerArr[i]&&t.playerArr[i][3]&&(t.players_status.children[i].children[0].getComponent(cc.Label).string=t.playerArr[i][3]+"."),t.playerArr[i]&&t.playerArr[i][0]&&t.playerList[t.playerArr[i][0]]&&(t.players_status.children[i].children[1].getComponent(cc.Label).string=t.playerList[t.playerArr[i][0]]),t.playerArr[i]&&(t.players_status.children[i].children[2].getComponent(cc.Label).string=t.numformat(t.playerArr[i][1]));t.players_status.children[3].active=!0,t.players_status.children[3].children[0].getComponent(cc.Label).string=e.extdata.mrank+".",t.players_status.children[3].children[1].getComponent(cc.Label).string=t.playerList[cc.global.user.id],t.players_status.children[3].children[2].getComponent(cc.Label).string=t.numformat(e.extdata.mscore),t.players_status.children[3].children[0].color=cc.hexToColor("#F5FF02"),t.players_status.children[3].children[1].color=cc.hexToColor("#F5FF02"),t.players_status.children[3].children[2].color=cc.hexToColor("#F5FF02"),t.myRankStatus=!0}else{t.players_status.active=!0;for(a=0;a<4;a++)t.players_status.children[a].active=!1;var s;s=e.extdata.player_count<5?e.extdata.player_count:4;for(i=0;i<s;i++)t.players_status.children[i].active=!0,t.playerArr[i]&&t.playerArr[i][3]&&(t.players_status.children[i].children[0].getComponent(cc.Label).string=t.playerArr[i][3]+"."),t.playerArr[i]&&t.playerArr[i][0]&&t.playerList[t.playerArr[i][0]]&&(t.players_status.children[i].children[1].getComponent(cc.Label).string=t.playerList[t.playerArr[i][0]]),t.playerArr[i]&&(t.players_status.children[i].children[2].getComponent(cc.Label).string=t.numformat(t.playerArr[i][1])),t.players_status.children[i].children[0].color=cc.hexToColor("#FFFFFF"),t.players_status.children[i].children[1].color=cc.hexToColor("#FFFFFF"),t.players_status.children[i].children[2].color=cc.hexToColor("#FFFFFF")}}},begin_event:function(t,i){if((cc.global.isOffline||parseInt(i.roomId)==parseInt(t.room_id))&&(i.userReady=!1,i.roomValue=parseInt(t.extdata.roomscore),i.playerList=t.extdata.players,t.extdata.mstatus)){if("60"==t.extdata.play_time){cc.global.isOffline||(i.betUp_animation.active=!0),i.betUp_animation.children[1].getComponent(cc.Label).string=i.numformat(i.roomValue),i.avatar_area_gold_label.string=i.numformat(parseInt(cc.global.user.goldcoins)-i.roomValue),i.betUp_animation.getComponent(cc.Animation).play("miner_betup");var a=i;i.betUp_animation.getComponent(cc.Animation).on("finished",function(e){a.betUp_animation.active=!1,a.deposited_value_label.string=a.numformat(a.roomValue*parseInt(t.extdata.player_count))},a),cc.global.audio.playVoiceSpeech("support/10_start_game")}else i.avatar_area_gold_label.string=i.numformat(parseInt(cc.global.user.goldcoins)-i.roomValue),i.deposited_value_label.string=i.numformat(parseInt(i.roomValue)*parseInt(t.extdata.player_count));i.game_status.active=!1,i.time=t.extdata.play_time,i.btn_ready.children[2].active=!1,i.isGamePlaying=!0,i.underground.on(cc.Node.EventType.TOUCH_START,function(e){i.fun_touchunderground()},i),i.hookrope.getComponent("hookrope").setParent(i),i.hookrope.getComponent("hookrope").collideCount=0,i.minerspine=i.miner.getComponent(cc.Animation),i.miner_wait(),i.remaintime=60,i.levelgoal=600,i.total=0,i.level=1,i.label_level.string=i.level+"Round",i.label_goal.string=i.levelgoal,i.label_total.string=i.total,i.schedule(i.fun_timemanage,1),i.sceneInforFromData=t.extdata.scene,i.setScene(i.sceneInforFromData),i.goldMinerStarted=!0}},finish_event:function(e,t){for(var i=0;i<t.mine.length;i++)t.mine[i].destroy();if(t.timer.string="60",t.isGamePlaying=!1,t.goldMinerStarted=!1,t.deposited_value_label.string=0,e.extdata.mstatus){e.extdata.mrank<4&&0<e.extdata.mrank?cc.global.audio.playSummaryAud("win"):cc.global.audio.playSummaryAud("lose"),t.game_result.active=!0,0<e.extdata.mrank&&(t.label_rank.string=e.extdata.mrank+"th."),t.label_score.string="point: "+t.numformat(e.extdata.mscore)+"pt";var a=0;for(i=0;i<e.extdata.result.length;i++)e.extdata.result[i].user_id==cc.global.user.id&&(a=parseInt(e.extdata.result[i].gchange));t.label_gold.string=a+"",t.avatar_area_gold_label.string=t.numformat(parseInt(cc.global.user.goldcoins))}for(i=0;i<t.players_status.children.length;i++)t.players_status.children[i].children[2].getComponent(cc.Label).string=0,t.players_status.children[i].active=!1;t.playing_status.active=!1},onClickReadyBtn:function(){this.btn_ready.children[2].active=!0,this.userReady=!0,this.socket().exec("rtready",{extparams:{roomid:cc.global.user.roomid}})},onClickSfx:function(){if(this.btnSfx){var e=this.btnSfx,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},onclickBack:function(){if(cc.global.isOffline)this.returnToHall();else if(this.ready())if(this.isGamePlaying){var e=this;this.notReplay&&this.isGamePlaying&&"no"==cc.global.amObserve?(cc.global.audio.playVoiceSpeech("support/14_roomout"),this.checkConfirm("Are you sure to leave room? You will lose.",function(){e.socket().exec("rtleave",{})},null)):this.socket().exec("rtleave",{})}else this.socket().exec("rtleave",{})},rtleave_event:function(e,t){t.exitPlay()},exitPlay:function(){cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.returnToHall()},returnToHall:function(){this.loadding(),cc.global.curPlaywayScore=0,cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.tetris_jrData=null,cc.global.backToHall=!0,this.cleanAllPlayers(),this.scene("hall",this)},beginOffline:function(){if(null!=this.sceneInfoFromJson){this.myscore=0,this.score_label.string=this.numformat(this.myscore),this.gold_star.active=!1,this.timer.string="60";for(var e=0;e<this.mine.length;e++)this.mine[e].destroy();var t=this.sceneInfoFromJson,i="scene"+Math.floor(5*Math.random());this.restart=!0;var a={command:"begin",event:"command",roomid:0,extdata:{players:[cc.global.user.id],total:1,mscore:0,roomscore:0,mstatus:1,player_count:1,play_time:60,scene:t[i]}};this.begin_event(a,this)}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],MinerBetUp:[function(e,t,i){"use strict";cc._RF.push(t,"c187cq8/E5GSaH9ali8dVBA","MinerBetUp");var a=e("HHCommon");cc.Class({extends:a,properties:{goldcoin_base:{default:null,type:cc.Node},diamond_base:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},diamonds:{default:null,type:cc.Label}},init:function(e,t){this.node.active=!0;2<arguments.length&&void 0!==arguments[2]&&arguments[2];"normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway?(this.goldcoin_base.active=!0,this.diamond_base.active=!1,this.goldcoins.string=this.numformat(e)):"diamond"==cc.global.user.selplayway&&(this.goldcoin_base.active=!1,this.diamond_base.active=!0,this.goldcoins.string="");var i="betup_left";1==t&&(i="betup_right"),this.node.getComponent(cc.Animation).play(i);var a=this;setTimeout(function(){a&&a.node&&(a.node.active=!1)},750)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],MissionDialog:[function(e,t,i){"use strict";cc._RF.push(t,"30a3dHwtMxLYYjbTbeaEwK0","MissionDialog");var a=e("HallDialog");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},scrollView:{default:null,type:cc.ScrollView},contentView:{default:null,type:cc.Node},msnPrefab:{default:null,type:cc.Prefab},star:{default:null,type:cc.Node},goldslot:{default:null,type:cc.Node},award:{default:null,type:cc.Node},owngold:{default:null,type:cc.Label},awardgold:{default:null,type:cc.Label},msn_count:{default:null,type:cc.Label},awardShadow:{default:null,type:cc.Node},fireworks:{default:null,type:cc.ParticleSystem},btn_daily:{default:null,type:cc.Node},btn_total:{default:null,type:cc.Node}},init:function(e,t,i){this.curScene=e,this.data=i,this.parent=t,this.preCeremonyGold=cc.global.user.goldcoins,this.owngold.string=this.numformat(this.preCeremonyGold),this.curTab=1,this.initBadgeLabel(),this.updateTabBadge(),this.loadMissions()},initBadgeLabel:function(){this.badgeLabels=[0,0];for(var e=cc.global.newMissions=0;e<this.data.length;e++)1==this.data[e].done&&(this.badgeLabels[this.data[e].daily]++,cc.global.newMissions++)},loadMissions:function(){this.scrollView.scrollToTop(.3);for(var e=0;e<this.contentView.children.length;e++)this.contentView.children[e].active=!1;this.data.sort(function(e,t){var i=e.curvalue/e.value;return t.curvalue/t.value-i});var t=0,i=0,a=0;for(e=0;e<this.data.length;e++)if(this.data[e].daily==this.curTab){var s=this.data[e];if(1!=s.accept){var r=null;this.contentView.children[a]?r=this.contentView.children[a]:(r=cc.instantiate(this.msnPrefab)).parent=this.contentView,r.active=!0,r.getComponent("MissionItem").init(this,s,i),s.complete&&t++,i++,a++}}this.msn_count.string=t+"/"+i},onClickClose:function(){this.parent.closeDialog(this)},onClickDailyTab:function(){1!=this.curTab&&(this.curTab=1,this.updateTabBadge(),this.loadMissions())},updateTabBadge:function(){1==this.curTab?(this.btn_daily.getComponent("NotifyTabButton").init(!0,this.badgeLabels[1]),this.btn_total.getComponent("NotifyTabButton").init(!1,this.badgeLabels[0])):0==this.curTab&&(this.btn_total.getComponent("NotifyTabButton").init(!0,this.badgeLabels[0]),this.btn_daily.getComponent("NotifyTabButton").init(!1,this.badgeLabels[1]))},onClickTotalTab:function(){0!=this.curTab&&(this.curTab=0,this.updateTabBadge(),this.loadMissions())},awardCeremony:function(e){var t=cc.callFunc(function(e,t){t.script.parent.updateNotifyBadge&&t.script.parent.updateNotifyBadge()},this,{script:this});this.node.runAction(cc.sequence(cc.delayTime(1),t)),this.awardgold.string=e,this.awardShadow.runAction(cc.sequence(cc.fadeIn(.2),cc.delayTime(1.35),cc.fadeOut(.2))),this.award.runAction(cc.sequence(cc.fadeIn(0),cc.scaleTo(0,0,0),cc.scaleTo(.2,1.1,1.1),cc.scaleTo(.1,.6,.6),cc.scaleTo(.15,1,1),cc.delayTime(1),cc.fadeOut(.2))),this.fireworks.resetSystem(),this.goldslot.runAction(cc.sequence(cc.delayTime(.4),cc.fadeIn(.05),cc.delayTime(1),cc.fadeOut(.05)));var i=cc.callFunc(function(e,t){var i=cc.instantiate(t.script.star),a=cc.callFunc(function(e){e.destroy()},i),s=cc.callFunc(function(e,t){t.script.preCeremonyGold=t.script.preCeremonyGold+Math.round(t.prize/5),t.owngold.string=t.script.numformat(t.script.preCeremonyGold),t.owngold.node.runAction(cc.sequence(cc.scaleTo(.05,1.1,1.1),cc.scaleTo(.05,1,1)))},e,t),r=(parseInt(1e3*Math.random()),parseInt(1e3*Math.random())%10);i.position=new cc.Vec2(360,-603-r),i.scale=new cc.Vec2(1.1,1.1),i.parent=e,i.runAction(cc.sequence(cc.moveTo(.4,300,-970).easing(cc.easeOut(.4)),s)),i.runAction(cc.sequence(cc.scaleTo(.4,1,1).easing(cc.easeOut(.4)),cc.delayTime(.2),a))},this,{script:this,owngold:this.owngold,prize:e}),a=cc.sequence(cc.delayTime(.1),i,cc.delayTime(.1),i,cc.delayTime(.1),i,cc.delayTime(.1),i,cc.delayTime(.1),i);this.node.runAction(a),this.initBadgeLabel(),this.updateTabBadge()}}),cc._RF.pop()},{HallDialog:"HallDialog"}],MissionDone:[function(e,t,i){"use strict";cc._RF.push(t,"491c1Sy/tRJHq3C9JwFK6s6","MissionDone");var a=e("HHCommon");cc.Class({extends:a,properties:{bg:{default:null,type:cc.Node},msntype:{default:null,type:cc.Label},objective:{default:null,type:cc.Label},achive:{default:null,type:cc.Label}},init:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.data=e,0==t&&(this.msntype.string=this.getLanguageText("MISSION_DONE_0"),cc.global.audio.playVoiceSpeech("support/15_mission_finished"),this.objective.string=e.description.replace("X",e.value),this.achive.string="("+this.numformat(e.current)+"/"+this.numformat(e.value)+")"),1==t&&(this.msntype.string=this.getLanguageText("NEW_RECORD"),cc.global.audio.playVoiceSpeech("support/16_top_record"),this.objective.string=e.title,this.achive.string="("+e.value+")"),this.node.runAction(cc.fadeIn(.3)),this.fadeOut()},fadeOut:function(){var e=cc.callFunc(function(e){e.destroy()},this),t=cc.sequence(cc.delayTime(4.5),cc.fadeOut(.2),cc.delayTime(.2),e);this.node.runAction(t)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],MissionItem:[function(e,t,i){"use strict";cc._RF.push(t,"a1114Imm7pKXZrvKxdS3Seb","MissionItem");var a=e("HHCommon");cc.Class({extends:a,properties:{game:{default:null,type:cc.Label},description:{default:null,type:cc.Label},current:{default:null,type:cc.Label},total:{default:null,type:cc.Label},reward:{default:null,type:cc.Label},btn_reward:{default:null,type:cc.Button},rewarded:{default:null,type:cc.Node},progress:{default:null,type:cc.ProgressBar},greenBackground:cc.SpriteFrame,blueBackground:cc.SpriteFrame},onLoad:function(){},init:function(e,t,i){this.data=t,this.parent=e,this.initTheme(),""==t.game?this.game.string="All Game":this.game.string=t.game,this.description.string=t.description.replace("X",this.numformat(this.data.value)),this.current.string=this.numformat(this.data.curvalue),this.total.string=this.numformat(this.data.value),this.reward.string=this.numformat(this.data.reward),this.btn_reward.interactable=this.data.curvalue>=this.data.value,this.btn_reward.node.getComponent(cc.Sprite).enabled=this.btn_reward.interactable,t.accept&&(this.btn_reward.node.active=!1,this.rewarded.active=!0),this.progress.progress=this.data.curvalue/this.data.value,this.node.opacity=0,this.node.runAction(cc.sequence(cc.delayTime(.1*i),cc.fadeIn(.5).easing(cc.easeIn(3))))},initTheme:function(){4===cc.global.theme_idx?this.node&&this.node.getComponent(cc.Sprite)&&(this.node.getComponent(cc.Sprite).spriteFrame=this.blueBackground):this.node&&this.node.getComponent(cc.Sprite)&&(this.node.getComponent(cc.Sprite).spriteFrame=this.greenBackground)},claimMission:function(){var o=this;o.loadding(),cc.global.http.httpPost("/hall/missionreward",{missionid:o.data.mission},function(e){if(o.closeloadding(),null!=e&&""!=e){var t=e.split("$$$");if(2<t.length&&"00"==t[0]){var i=parseInt(t[1]),a=parseInt(t[2]);if(0<i){var s=!1;if(0<a?(o.upgradeMission(i,a),o.data.curvalue>=o.data.value&&(s=!0)):(o.disableMission(),o.fadeOut()),!(o.data.done=s))for(var r=0;r<cc.global.missions.length;r++)cc.global.missions[r].id==o.data.mission&&(cc.global.missions[r].done=!1);if(o.parent&&o.parent.data&&0<o.parent.data.length)for(r=0;r<o.parent.data.length;r++)o.parent.data[r].mission==o.data.mission&&(o.parent.data[r].accept=!0);o.parent.awardCeremony(o.data.reward)}else o.alert("Error.")}else{n=o.getLanguageText("ERROR_IN_SERVER_RESPONSE");o.alert(n+": "+t[0])}}else{var n=o.getLanguageText("ERROR_IN_SERVER_RESPONSE");o.alert(n+": 01")}},function(){o.closeloadding();var e=o.getLanguageText("CONNECTING_FAILED_0");o.alert(e)})},disableMission:function(){this.btn_reward.interactable=!1},upgradeMission:function(e,t){this.data.value=t,this.total.string=this.numformat(this.data.value),this.description.string=this.data.description.replace("X",this.numformat(this.data.value)),this.btn_reward.interactable=this.data.curvalue>=this.data.value,this.btn_reward.node.getComponent(cc.Sprite).enabled=this.btn_reward.interactable,this.progress.progress=this.data.curvalue/this.data.value},fadeOut:function(){var e=cc.callFunc(function(e){e.destroy()},this),t=cc.sequence(cc.delayTime(1.5),cc.fadeOut(.2),cc.delayTime(.2),e);this.node.runAction(t)},start:function(){}}),cc._RF.pop()},{HHCommon:"HHCommon"}],Net:[function(e,t,i){"use strict";cc._RF.push(t,"2f232b3dRxHzowZBkd8ECoo","Net");var a=e("../../Constants").textureScale;cc.Class({extends:cc.Component,properties:{netAtlas:{default:null,type:cc.SpriteAtlas}},onLoad:function(){this._index=1,this.netSprite=this.getComponent(cc.Sprite),this.index=[1,2,2,3,3,4,5,6,7,8,8,1],this.midIdx=6,this.mapping=[26,50,75,100,130,159,189,221,253,287,322,330],this.midMap=this.mapping[this.midIdx]},setVariables:function(e,t){this._basketry=e,this._slotz=t},resetSkin:function(){this._index=1,this.netSprite.spriteFrame=this.netAtlas.getSpriteFrame("basketry_1")},setZOrder:function(e){this.node.setLocalZOrder(e)},updateFalling:function(e,t){return this.formatBallTrace(e,t),this.mapNextFrame(e)},setOffset:function(e,t){this.offsetx=e,this.offsety=t},formatBallTrace:function(e,t){var i=e.getY()-this._basketry.getY();if(30<e.getSpeedy()){var a=e.getSpeedy()+-1.5*t;a<=30&&(a=30),e.setSpeedy(a)}var s=70-i;if(0<s){var r=32*s/70,n=e.getX()-this._basketry.getX();r<n?(e.setSpeedx(.3*e.getSpeedx()),e.setX(this._basketry.getX()+r)):n<-r&&(e.setSpeedx(.3*e.getSpeedx()),e.setX(-r+this._basketry.getX()))}},getDepth:function(){return this._basketry.getZ()+this.deepthOffset},setDepOffset:function(e){this.deepthOffset=e},drawing:function(e){this.f9_x=e.mapX(this._basketry.getX(),this._slotz),this.f10_y=e.mapY(this._basketry.getY(),this._slotz),this.node.x=this.f9_x*a,this.node.y=this.f10_y*a},mapNextFrame:function(e){var t,i,a=e.getY()-this._basketry.getY();if(a<this.mapping[0])return!1;if(a>this.mapping[this.mapping.length-1])return this._index=1,this.netSprite.spriteFrame=this.netAtlas.getSpriteFrame("basketry_"+this._index),!0;a>=this.midMap?(t=this.midIdx,i=this.index.length):(t=0,i=this.midIdx);for(var s=0,r=i-1;!(r<t);){if(a>=this.mapping[r]){s=this.index[r];break}r--}return this._index=s,this.netSprite.spriteFrame=this.netAtlas.getSpriteFrame("basketry_"+this._index),!1}}),cc._RF.pop()},{"../../Constants":"Constants"}],NewTimer:[function(e,t,i){"use strict";cc._RF.push(t,"89ff3ZGbe9OrYXLKxrNadN9","NewTimer");var a=e("HHCommon");cc.Class({extends:a,properties:{text:cc.Label,right_clock:cc.Node,left_clock:cc.Node},onLoad:function(){this.isRunTimer=!1},runtimer:function(e){this.remaining=e,this.isRunTimer=!0,this.right_clock.stopAllActions(),this.left_clock.stopAllActions(),this.right_clock.rotation=this.left_clock.rotation=0,this.right_clock.runAction(cc.rotateTo(e/2,180)),this.left_clock.runAction(cc.sequence(cc.delayTime(e/2),cc.rotateTo(e/2,180)))}}),cc._RF.pop()},{HHCommon:"HHCommon"}],NewsDialog:[function(e,t,i){"use strict";cc._RF.push(t,"3fb5et0NahHS4tS8458sJ3p","NewsDialog");var a=e("HallDialog");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},tabs:{default:null,type:cc.Node},scrollView:{default:null,type:cc.ScrollView},contentView:{default:null,type:cc.Node},itemPrefab:{default:null,type:cc.Prefab},rankItemPrefab:{default:null,type:cc.Prefab},btnClearAll:{default:null,type:cc.Node},noContent:{default:null,type:cc.Node}},init:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.parent=e,this.initBadgeLabel(),this.initState(t)},initBadgeLabel:function(){for(this.badgeLabels=[],e=0;e<this.tabs.children.length;e++)this.badgeLabels[e]=0;for(var e=0;e<cc.global.newslist.length;e++)1==cc.global.newslist[e].new&&this.badgeLabels[cc.global.newslist[e].type]++},initState:function(e){this.curTab=e,this.tabVisited=[];for(var t=0;t<this.tabs.children.length;t++)this.tabVisited[t]=!1;this.updateTab()},updateTab:function(){this.tabVisited[this.curTab]=!0,this.updateTabBadge(),this.loadContent()},updateTabBadge:function(){for(var e=0;e<this.tabs.children.length;e++)e==this.curTab?this.tabs.children[e].getComponent("NotifyTabButton").init(!0,this.badgeLabels[e]):this.tabs.children[e].getComponent("NotifyTabButton").init(!1,this.badgeLabels[e])},onClickTab:function(e,t){this.curTab!=t&&(this.curTab=t,this.updateTab())},loadContent:function(){this.scrollView.scrollToTop(.1),this.contentView.destroyAllChildren(),this.contentView.removeAllChildren();var e=this,t=0;this.loadding();for(var i=0,a=0;i<cc.global.newslist.length;i++)if(cc.global.newslist[i].type==e.curTab){var s=null;1==cc.global.newslist[i].type?(s=cc.instantiate(e.rankItemPrefab)).getComponent("NewsRankItem").init(e,cc.global.newslist[i],a):(s=cc.instantiate(e.itemPrefab)).getComponent("NewsItem").init(e,cc.global.newslist[i],a),s&&(s.parent=e.contentView,t+=s.height,cc.global.newslist[i].new=!1,a++)}this.contentView.height=t,this.updateNotify(),e.btnClearAll&&(e.btnClearAll.active=0<e.contentView.children.length),e.noContent&&(e.noContent.active=!(0<e.contentView.children.length)),this.closeloadding()},onClickClose:function(){for(var e=0;e<cc.global.newslist.length;e++)1==this.tabVisited[cc.global.newslist[e].type]&&(cc.global.newslist[e].new=!1);this.parent.closeDialog(this)},updateNotify:function(){this.initBadgeLabel(),this.updateTabBadge()},forceUpdateLayout:function(){this.contentView.getComponent(cc.Layout).updateLayout()},onClickClearAllNews:function(){for(var e=0;e<this.contentView.children.length;e++)1==this.curTab?this.contentView.children[e].getComponent("NewsRankItem").dismiss():this.contentView.children[e].getComponent("NewsItem").dismiss()},onDestroy:function(){cc.sys.localStorage.setItem("samhung_news",JSON.stringify(cc.global.newslist))}}),cc._RF.pop()},{HallDialog:"HallDialog"}],NewsItem:[function(e,t,i){"use strict";cc._RF.push(t,"030f5zRRa9DSo8q9adod8mk","NewsItem"),cc.Class({extends:cc.Component,properties:{title:{default:null,type:cc.Label},newtag:{default:null,type:cc.Node},date:{default:null,type:cc.Label},content:{default:null,type:cc.Label},trash:{default:null,type:cc.Node},calendar:{default:null,type:cc.Node},view:{default:null,type:cc.Node},greenBackground:cc.SpriteFrame,blueBackground:cc.SpriteFrame},init:function(e,t,i){this.parent=e,this.initTheme(),this.node.opacity=0,this.node.runAction(cc.sequence(cc.delayTime(.1*i),cc.fadeIn(.5).easing(cc.easeIn(3)))),this.data=t,this.title.string=t.title;var a=cc.global.globalCommon.getDateFromTimestamp(1e3*t.create_time,!0);this.date.string=a.replace("\n"," ");var s=".";null!=t.content&&""!=t.content&&(s=t.content),this.content.string=s,t.new&&cc.global.unread_news--,this.newtag.active=t.new},initTheme:function(){4===cc.global.theme_idx?(this.trash&&1<this.trash.children.length&&(this.trash.children[0].active=!1,this.trash.children[1].active=!0),this.calendar&&1<this.calendar.children.length&&(this.calendar.children[0].active=!1,this.calendar.children[1].active=!0),this.view&&this.view.getComponent(cc.Sprite)&&(this.view.getComponent(cc.Sprite).spriteFrame=this.blueBackground),this.content&&(this.content.node.color=cc.hexToColor("#c7f2ff"))):(this.trash&&1<this.trash.children.length&&(this.trash.children[0].active=!0,this.trash.children[1].active=!1),this.calendar&&1<this.calendar.children.length&&(this.calendar.children[0].active=!0,this.calendar.children[1].active=!1),this.view&&this.view.getComponent(cc.Sprite)&&(this.view.getComponent(cc.Sprite).spriteFrame=this.greenBackground),this.content&&(this.content.node.color=cc.hexToColor("#D2FFD2")))},resizeContent:function(){this.parent.forceUpdateLayout()},update:function(){this.resizeContent()},dismiss:function(){for(var e=0;e<cc.global.newslist.length;e++)if(cc.global.newslist[e].id==this.data.id){cc.global.newslist.splice(e,1);break}this.fadeOut(),this.parent.updateNotify()},fadeOut:function(){var e=cc.callFunc(function(e){e.destroy()},this),t=cc.sequence(cc.scaleTo(.1,1,0),cc.delayTime(.2),e);this.node.runAction(t)}}),cc._RF.pop()},{}],NewsRankItem:[function(e,t,i){"use strict";cc._RF.push(t,"6c1fdBOteFEFoLS0Q7qgJsZ","NewsRankItem"),cc.Class({extends:cc.Component,properties:{title:{default:null,type:cc.Label},newtag:{default:null,type:cc.Node},date:{default:null,type:cc.Label},content:{default:null,type:cc.Node},trash:{default:null,type:cc.Node},calendar:{default:null,type:cc.Node},view:{default:null,type:cc.Node},underline:{default:null,type:cc.Node},rankrewarditem:{default:null,type:cc.Prefab},greenBackground:cc.SpriteFrame,blueBackground:cc.SpriteFrame},init:function(e,t,i){this.parent=e,this.initTheme(),this.node.opacity=0,this.node.runAction(cc.sequence(cc.delayTime(.1*i),cc.fadeIn(.5).easing(cc.easeIn(3)))),this.data=t,this.title.string=t.title;var a=cc.global.globalCommon.getDateFromTimestamp(1e3*t.create_time,!0);if(this.date.string=a.replace("\n"," "),null!=t.content&&""!=t.content){var s=t.content.split("$");if(null!=s&&0<s.length)for(var r=0;r<s.length;r++)if(null!=s[r]&&""!=s[r]){var n=cc.instantiate(this.rankrewarditem);n.getComponent("RankRewardItem").init(this,s[r]),n.parent=this.content}}t.new&&cc.global.unread_news--,this.newtag.active=t.new},initTheme:function(){4===cc.global.theme_idx?(this.trash&&1<this.trash.children.length&&(this.trash.children[0].active=!1,this.trash.children[1].active=!0),this.calendar&&1<this.calendar.children.length&&(this.calendar.children[0].active=!1,this.calendar.children[1].active=!0),this.underline&&1<this.underline.children.length&&(this.underline.children[0].active=!1,this.underline.children[1].active=!0),this.view&&this.view.getComponent(cc.Sprite)&&(this.view.getComponent(cc.Sprite).spriteFrame=this.blueBackground)):(this.trash&&1<this.trash.children.length&&(this.trash.children[0].active=!0,this.trash.children[1].active=!1),this.calendar&&1<this.calendar.children.length&&(this.calendar.children[0].active=!0,this.calendar.children[1].active=!1),this.underline&&1<this.underline.children.length&&(this.underline.children[0].active=!0,this.underline.children[1].active=!1),this.view&&this.view.getComponent(cc.Sprite)&&(this.view.getComponent(cc.Sprite).spriteFrame=this.greenBackground))},resizeContent:function(){this.parent.forceUpdateLayout()},update:function(){this.resizeContent()},dismiss:function(){for(var e=0;e<cc.global.newslist.length;e++)if(cc.global.newslist[e].id==this.data.id){cc.global.newslist.splice(e,1);break}this.fadeOut(),this.parent.updateNotify()},fadeOut:function(){var e=cc.callFunc(function(e){e.destroy()},this),t=cc.sequence(cc.scaleTo(.1,1,0),cc.delayTime(.2),e);this.node.runAction(t)}}),cc._RF.pop()},{}],NotifyButton:[function(e,t,i){"use strict";cc._RF.push(t,"ffdd3FlZttM2J7B7o/l3swY","NotifyButton"),cc.Class({extends:cc.Button,properties:{notify_badge:{default:null,type:cc.Node},notify_label:{default:null,type:cc.Label}},start:function(){this.notify_badge&&(this.orig_badge_pos=this.notify_badge.position)},showBadge:function(e,t){this.notify_badge&&this.notify_label&&(this.notify_label.string=e,t?(this.notify_badge.opacity=0,this.notify_badge.runAction(cc.fadeIn(.2))):this.notify_badge.opacity=222)},hideBadge:function(e){this.notify_badge&&(e?this.notify_badge.runAction(cc.fadeOut(.2)):this.notify_badge.opacity=0)},moveBadgePosition:function(e){this.notify_badge&&this.orig_badge_pos&&(this.notify_badge.position=this.orig_badge_pos.add(e))},revertBadgePosition:function(e){this.notify_badge&&this.orig_badge_pos&&(this.notify_badge.position=this.orig_badge_pos)}}),cc._RF.pop()},{}],NotifyTabButton:[function(e,t,i){"use strict";cc._RF.push(t,"9d0ecdMOvJKdLIW+H+2YVaK","NotifyTabButton");var a=e("NotifyButton");cc.Class({extends:a,properties:{sprite:{default:null,type:cc.Node},buttonLabel:{default:null,type:cc.Label}},init:function(e,t){!(2<arguments.length&&void 0!==arguments[2])||arguments[2];var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:cc.hexToColor("#B4B4B4"),a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:cc.Color.WHITE,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:cc.Vec2.ZERO;this.changeBadge(t,!1),this.changeState(e,i,a,s)},changeBadge:function(e,t){null!=e&&""!=e&&0!=e?this.notify_badge&&this.notify_label&&this.showBadge(e,t):this.hideBadge(t)},changeState:function(e,t,i,a){if(1==e){if(this.sprite.children[0].active=!0,1<this.sprite.children.length&&(this.sprite.children[1].active=!1),this.buttonLabel)this.buttonLabel.node.color=i,(s=this.buttonLabel.node.getComponent(cc.LabelOutline))&&(s.color=i),this.buttonLabel.node.scaleX=this.buttonLabel.node.scaleY=1.1;this.moveBadgePosition(a)}else{var s;if(this.sprite.children[0].active=!1,1<this.sprite.children.length&&(this.sprite.children[1].active=!0),this.buttonLabel)this.buttonLabel.node.color=t,(s=this.buttonLabel.node.getComponent(cc.LabelOutline))&&(s.color=t),this.buttonLabel.node.scaleX=this.buttonLabel.node.scaleY=1;this.revertBadgePosition(a)}}}),cc._RF.pop()},{NotifyButton:"NotifyButton"}],OFCBegin:[function(e,t,i){"use strict";cc._RF.push(t,"1d035XakYVNmacMreIdwE9o","OFCBegin");var a=e("Deck"),s=e("HHCommon");cc.Class({extends:s,properties:{poker:{default:null,type:cc.Node},summary:{default:null,type:cc.Prefab},touch:{default:null,type:cc.Node},back_players:{default:null,type:cc.Node},front_players:{default:null,type:cc.Node},btn_enter:{default:null,type:cc.Node},playersboard:{default:null,type:cc.Node},leavereq:{default:null,type:cc.Node},chat:{default:null,type:cc.Prefab},emodlg:{default:null,type:cc.Prefab},unselect:{default:null,type:cc.Node},roominfo:{default:null,type:cc.Node},roomscore:{default:null,type:cc.Label},observer:{default:null,type:cc.Prefab},obsbench:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},obsemojibtn:{default:null,type:cc.Node},btn_cardsort:{default:null,type:cc.Node},btn_robot:{default:null,type:cc.Node},raiseup:{default:null,type:cc.Node},gameboardmark:{default:null,type:cc.Node},btn_record_play:{default:null,type:cc.Node},lbl_record_status:{default:null,type:cc.Label},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},btn_find_empty:{default:null,type:cc.Node},room_cond_mode:{default:null,type:cc.Node},underCardPanel:{default:null,type:cc.Node},remaincardspanel:{default:null,type:cc.Node},remaincardcount:{default:null,type:cc.Label},remaincardback:cc.Node,bet:{default:null,type:cc.Node},dealingCardAnim:{default:null,type:cc.Prefab},callPlayer:{default:null,type:cc.Node},selfobj:{default:null,type:cc.Node},readyBtn:{default:null,type:cc.Node},raiseAnim:{default:null,type:cc.Node},isPlayer:{default:!1},background:{default:null,type:cc.Node},buttons:{default:null,type:cc.Node},bar_bottom:{default:null,type:cc.Node},settinglayer:{default:null,type:cc.Node},settingback:{default:null,type:cc.Node},switchtogame:{default:null,type:cc.Node},soundbtn:{default:null,type:cc.Node}},onLoad:function(){var e=this;e.switchtogame.active=!0,e.switchtogame.getComponent(cc.Animation).play("door_open"),cc.global.audio.playEffectAud("door"),cc.global.amObserve="no",setTimeout(function(){e.onStartGame()},700),this.curTheme=parseInt(cc.global.game_theme_idx),this.changeTheme(this.curTheme),this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged(),this.underCardPanel.width=this.underCardPanel.width/cc.global.narrowContentRatio,this.lasttime=cc.global.logintime},onStartGame:function(){this.show_setting=!1,this.initEventCallback(),cc.game.setFrameRate(30),this.curBgIdx=1,this.boardRatio=1,this.goRecovery=!1,this.initUI(),this.myselectedcard=null,this.underselectedcard=[],this.selectedCards=[],cc.global.seriable=!1,this.playerSlotPos3=[cc.v2(300,190),cc.v2(-150,190)],this.playerSlotPos4=[cc.v2(375,190),cc.v2(25,190),cc.v2(-325,190)],this.altPlayerPos=[cc.v2(-505,-260),cc.v2(195,150),cc.v2(195,150),cc.v2(195,150),cc.v2(195,150),cc.v2(195,150),cc.v2(195,150),cc.v2(195,150)],this.playerBoardSlotPos=[cc.v2(-620,-200),cc.v2(-105,95),cc.v2(195,150),cc.v2(195,150),cc.v2(195,150),cc.v2(195,150),cc.v2(195,150),cc.v2(195,150)],this.altBoardPos=[cc.v2(-105,-150),cc.v2(-105,95),cc.v2(195,150),cc.v2(195,150),cc.v2(195,150),cc.v2(195,150),cc.v2(195,150),cc.v2(195,150)],this.playerSlots=[cc.v2(-300,-201),cc.v2(-300,220)],this.playerBordSlots=[cc.v2(-227,-220),cc.v2(-227,201)],this.player=new Array,this.observerlist=new Array,this.playerboard=new Array,this.pokercards=new Array,this.underpokercards=new Array,this.lastcards=new Array,this.cardsArr=new Array,this.summarypage=null,this.inited=!1,this.lasttip=null,this.score="1",this.play_status=0,this.KPMode=0,this.upCardsCount=0,this.rerenderPlayers=[],this.isOnSummary=!1,this.notReplay=!0,this.gameCleaned=!1,null!=cc.global&&(""!=cc.global.user.roomid?this.recovery():this.initgame()),cc.global.watchReplayData.onReplay&&this.prepareReplay(),this.deck=new a,this.obserberIndex=0},prepareReplay:function(){this.notReplay=!1,cc.global.amObserve="yes",this.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),this.replay_bar.active=!0,this.replayStep="ready_room",this.replaySeq=0,this.goReplay(),this.createReplayTimer(),this.buttons.children[2].active=this.buttons.children[3].active=!1},createReplayTimer:function(){var e=this;this.replayTimer=setInterval(function(){e.play_history&&(e.replayTimeDelay-=30*cc.global.watchReplayData.replaySpeedX,e.replayTimeDelay<=0&&e.play_history[e.replaySeq]&&e.goReplay())},30)},pauseReplayTimer:function(){clearInterval(this.replayTimer)},resumeReplayTimer:function(){this.createReplayTimer()},goReplay:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=!1;switch(this.replayStep){case"ready_room":this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"play":t=!0,this.replay_play_event(i,this);break;case"catch":this.catch_event(i,this);break;case"catchresult":this.catchresult_event(i,this);break;case"lasthands":this.lasthands_event(i,this);break;case"bet":t=!0,this.takecards_event(i,this);break;case"turn":t=!0,this.turn_event(i,this);break;case"allcards":this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.selemoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"players":this.players_event(i,this);break;case"exit":this.leave_event(i,this);break;case"throw":t=!0,this.throw_event(i,this);break;case"throwd":t=!0,this.throwd_event(i,this);break;case"result":t=!0,this.resultcards_event(i,this)}}""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,this.play_history[this.replaySeq]||(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.pauseReplayTimer()),e&&!t&&this.replayEventProcess(!0)},exitPlay:function(){cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),clearTimeout(this.deal1_timer),clearTimeout(this.deal2_timer),clearTimeout(this.deal3_timer),clearTimeout(this.bankerSelfTimer),clearTimeout(this.bankerOtherTimer),this.rerenderPlayers=[],this.isOnSummary=!1,this.returnToHall()},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.gameTimerSpeedChange(!0),this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):(this.replayTimer&&clearInterval(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.gameTimerSpeedChange(!1),this.replay_bar.children[0].opacity=100,this.pauseReplayTimer())},togglePlayToPause:function(){this.replayTimer&&clearInterval(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.gameTimerSpeedChange(!1),this.replay_bar.children[0].opacity=100,this.pauseReplayTimer()},onClickReplayStop:function(){},onClickReplaySpeedUp:function(){if(cc.global.watchReplayData.replaySpeedX<5){cc.global.watchReplayData.replaySpeedX++;var e=this.getLanguageText("REPLAY_TIME");this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.gameTimerSpeedChange(!0),this.pauseReplayTimer(),this.resumeReplayTimer()}this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){if(1<cc.global.watchReplayData.replaySpeedX){cc.global.watchReplayData.replaySpeedX--;var e=this.getLanguageText("REPLAY_TIME");this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.gameTimerSpeedChange(!0),this.pauseReplayTimer(),this.resumeReplayTimer()}this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplayNextTurn:function(){this.togglePlayToPause(),this.goReplay(!0)},onClickReplayPrevTurn:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.goReplay(!0))},gameTimerSpeedChange:function(e){if(this&&this.playerboard)for(var t=0;t<this.playerboard.length;t++){var i=this.playerboard[t].getComponent("OFCPlayerBoardRender");i&&i.rtgametimer&&(i.rtgametimer.isRunTimer?i.pauseTimer():i.resumeTimer())}},initUI:function(){JSON.parse(cc.sys.localStorage.getItem("sfx_on1"))?(this.soundbtn.children[1].active=!0,this.soundbtn.children[0].active=!1):(this.soundbtn.children[0].active=!0,this.soundbtn.children[1].active=!1),cc.global.audio.playBGM("bgm_card")},onClickReady:function(){if(this.ready()){var e=this.socket(),t={};t.extparams={roomid:cc.global.extparams.roomid},e.exec("ready",t)}},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{}),this.initgame()},initgame:function(){var t=this;if(this.ready()){var e=this.socket();this.game=this.getCommon("OFCDataBind"),(cc.global.dizhubegin=this).map("jr",this.joinroom_event),this.map("players",this.players_event),this.map("catch",this.catch_event),this.map("lasthands",this.lasthands_event),this.map("catchresult",this.catchresult_event),this.map("bet",this.takecards_event),this.map("turn",this.turn_event),this.map("play",this.play_event),this.map("allcards",this.allcards_event),this.map("rend",this.rend_event),this.map("cardtips",this.cardtips_event),this.map("roomready",this.roomready_event),this.map("playeready",this.playeready_event),this.map("rer",this.recovery_event),this.map("banker",this.banker_event),this.map("exit",this.leave_event),this.map("seltips",this.seltips_event),this.map("selemoticon",this.selemoticon_event),this.map("callplayer",this.callplayer_event),this.map("sendchat",this.sendchat_event),this.map("startrecordresult",this.startrecord_event),this.map("throw",this.throw_event),this.map("throwd",this.throwd_event),this.map("result",this.resultcards_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)});var i={};(t=this).notReplay&&("NormalCreate"==cc.global.user.roomInType?(i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i)):"NormalJoin"==cc.global.user.roomInType?(i.extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i)):"NormalObserve"==cc.global.user.roomInType&&(i.extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i))),t.inited=!0}},joinroom_event:function(e,t){cc.global.extparams.roomid=e.id,cc.global.user.roomNo=e.id,cc.global.user.selplayway=e.name,cc.global.gameCond=e.cond,4==e.cond?(t.is_ptn_room=!0,cc.global.is_ptn_room=!0):(t.room_cond_mode.active=!1,t.is_ptn_room=!1,cc.global.is_ptn_room=!1),t.is_ptn_room||t.notReplay&&cc.global.amObserve,"champion"==cc.global.user.selplayway||(cc.global.championMode=0),cc.global.curPlaywayScore=e.score,t.score=e.score;var i=t.getLanguageText("ROOM_0");t.roomscore.string=parseInt(t.score)*(null==e.ratio||null==e.ratio?t.boardRatio:e.ratio),t.roominfo.children[3].getComponent(cc.Label).string=e.id+i,cc.global.amObserve,t.touch.active=!1,"diamond"==cc.global.user.selplayway&&(t.roominfo.children[1].children[1].children[0].active=!1,t.roominfo.children[3].children[1].children[1].active=!0),"ready"==cc.global.gamestatus?(cc.global.gamestatus="waiting",t.is_ptn_room?8==e.playerlist.length&&(cc.global.gamestatus="playing"):e.playerlist.length==cc.global.fullCount&&"playing"==e.status&&(cc.global.gamestatus="playing"),t.goRecovery=!0,t.players_event(e,t,!0)):"waiting"==cc.global.gamestatus?(t.goRecovery=!0,t.players_event(e,t,!0)):"playing"==cc.global.gamestatus&&(cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t,!0):t.observer_event(e,t)),t.goRecovery=!1},observer_event:function(e,t){t.obsbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i]),a.parent=t.obsbench,(t.observerlist[i]=a).getComponent("Observer").nickname.node.active=!1}},returnToHall:function(){this.loadding(),clearTimeout(this.restartTimer),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.scene("hall",this)},userready_event:function(e,t){},roomready_event:function(e,t){1==e.cardroom&&null!=t.invite&&t.invite.destroy()},playeready_event:function(e,t){e.userid==cc.global.user.id&&(t.gamebtn.active=!1,t.game.playtimer())},players_event:function(e,t){if(2<arguments.length&&void 0!==arguments[2]&&arguments[2],e.msg&&(cc.global.outReasonMsg=e.msg),cc.global.fullCount=t.is_ptn_room?8:cc.global.gameCond+2,0==e.playerlist.length||e.playerlist.length>cc.global.fullCount)t.returnToHall();else{e.playerlist.length<2?(t.play_status=0,cc.global.gamestatus="waiting"):e.playerlist.length==cc.global.fullCount&&t.notReplay&&"no"==cc.global.amObserve&&"playing"!=cc.global.gamestatus&&!t.is_ptn_room&&t.is_ptn_room&&8==e.playerlist.length&&(t.play_status=1,cc.global.gamestatus="playing");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)e.observerlist[a].id==cc.global.user.id&&(i=!1);if(i&&t.notReplay)t.exitPlay();else{if(t.observer_event(e,t),"playing"==cc.global.gamestatus&&0==t.goRecovery)return;if("yes"==cc.global.amObserve?(t.btn_cardsort.active=!1,0==t.play_status?"waiting"==cc.global.gamestatus&&0==t.isOnSummary?1==cc.global.championMode||2==cc.global.championMode?t.btn_enter.active=!1:0==cc.global.championMode&&t.notReplay&&(t.btn_enter.active=!0):t.btn_enter.active=!1:1==t.play_status&&(t.btn_enter.active=!1)):(t.btn_cardsort.active=!1,t.btn_enter.active=!1),t.isBoardPlayersChanged(e.playerlist)){if(t.rerenderPlayers=e.playerlist,t.rerenderPlayers.length<cc.global.fullCount&&t.showRaiseUp(0),t.isOnSummary)return;t.cleanGamePlayers(),t.game.restart(),t.rerenderPlayers.length<cc.global.fullCount&&t.showRaiseUp(0),t.rerenderPlayers.length<2&&t.showRaiseUp(0),t.addBoardPlayers()}}}},clearContextPlayers:function(){for(var e=0;e<this.player.length;e++)this.player[e].destroy();this.player.splice(0,this.player.length),this.player=new Array},isBoardPlayersChanged:function(e){if(0==this.rerenderPlayers.length&&0!=e.length)return!0;if(this.rerenderPlayers.length!=e.length)return!0;for(var t=0;t<e.length;t++){for(var i=!1,a=0;a<this.rerenderPlayers.length;a++)if(e[t].id==this.rerenderPlayers[a].id){i=!0;break}if(!i)return!0}return!1},addBoardPlayers:function(){if("no"==cc.global.amObserve){for(var e=-1,t=0;t<this.rerenderPlayers.length;t++)this.rerenderPlayers[t].seatid=t,this.rerenderPlayers[t].id==cc.global.user.id&&(this.game.addSelfPlayer(this,this.rerenderPlayers[t]),this.game.giveContext(this),e=this.rerenderPlayers[t].seatid);for(t=0;t<this.rerenderPlayers.length;t++)if(this.rerenderPlayers[t].seatid!=e&&0==this.playerexist(this.rerenderPlayers[t],this)){var i=this.rerenderPlayers[t].seatid-e;i<0&&(i+=cc.global.fullCount),this.newplayer(this.player.length,this,this.rerenderPlayers[t],i,!1)}}else for(t=0;t<this.rerenderPlayers.length;t++)this.rerenderPlayers[t].seatid=t,0==this.playerexist(this.rerenderPlayers[t],this)&&this.newplayer(this.player.length,this,this.rerenderPlayers[t],this.rerenderPlayers[t].seatid,!0)},removeBoardPlayers:function(){for(var e=0;e<this.player.length;e++){for(var t=this.player[e].getComponent("OFCPlayerRender"),i=!1,a=0;a<this.rerenderPlayers.length;a++)if(t.userdata.id==this.rerenderPlayers[a].id){i=!0;break}1!=i&&this.showRaiseUp(0),this.player[e].destroy(),this.player.splice(e,1),this.playerboard[e].destroy(),this.playerboard.splice(e,1)}},playerexist:function(e,t){for(var i=0;i<t.player.length;i++)if(null!=t.player[i]&&t.player[i].getComponent("OFCPlayerRender").userid==e.id)return!0;return!1},banker_event:function(e,t){if(cc.global.banker=e.userid,e.userid==cc.global.user.id&&t.notReplay)t.bankerSelfTimer=setTimeout(function(){t&&t.game&&(t.game.showBanker(),t.is_ptn_room&&(t.game.updateBalanceData(e.msg,e.extmsg),t.showRaiseUp(e.extmsg)))},600);else{var i=600;t.notReplay||(i=0),t.bankerOtherTimer=setTimeout(function(){t&&(t.getPlayerBoard(e.userid).showBanker(),t.is_ptn_room&&(t.getPlayer(e.userid).updateBalanceData(e.msg,e.extmsg),t.showRaiseUp(e.extmsg)))},i)}},catch_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay)t.game.catchtimer(e.timer,e.ratio),cc.global.user.doCatch=!0;else for(var i=0;i<t.playerboard.length;i++){var a=t.playerboard[i].getComponent("OFCPlayerBoardRender");a.userid&&a.userid==e.userid?a.catchtimer(e.timer):a.stopTimer()}},raiseUp:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];e<=this.boardRatio&&!t||(this.boardRatio=e,this.roomscore.string=parseInt(this.score)*parseInt(e),this.roomscore.node.runAction(cc.sequence(cc.scaleTo(.15,1.2,1.2),cc.scaleTo(.15,1,1))),!this.is_ptn_room&&1<e&&this.raiseUp_event())},recovery_event:function(e,t){if(t.cleanGame(),t.raiseUp(e.ratio),"no"==cc.global.amObserve){var i=t.decode(e.player.cards);if(e.player&&e.player.cards){for(var a=0;a<i.length;a++){var s=t.playcards(t.game,t,50*a-300,i[a]);t.registerProxy(s)}for(n=0;n<t.pokercards.length;n++){var r=t.pokercards[n];r.getComponent("HHCard").setParent(t,!0,!0,!0),r.getComponent("HHCard").order()}t.layoutPokerCard()}}e.player&&e.player.bank&&t.game.showBanker(!1);for(var n=0;n<e.others.length;n++)e.others[n].bank&&(t.getPlayerBoard(e.others[n].playuser).showBanker(!1),cc.global.banker=e.others[n].userid),t.is_ptn_room&&(t.getPlayer(e.others[n].playuser).updateBalanceData(e.others[n].rgd,e.others[n].bet),t.getPlayerBoard(e.others[n].playuser).resetcards(e.others[n].cnum));if(null!=e.decknum&&0<=e.decknum&&(t.lastcardlist=parseInt(e.decknum),t.showRemainCardCount(t)),0<=e.bt&&(t.remaincardspanel.children[0].getComponent("HHCard").setCard(e.bt),t.remaincardspanel.children[0].getComponent("HHCard").setParent(t,!1,!0,!0),t.remaincardspanel.children[0].getComponent("HHCard").order()),0<=e.dummy&&t.is_ptn_room&&t.showRaiseUp(e.dummy),t.cleanUnderCard(t),e.remains){var o=t.decode(e.remains);t.resetUnderCard(t,o)}else t.is_ptn_room&&t.resetUnderCard(t,[]);if("playing"==e.status){if(cc.global.gamestatus="playing",t.btn_enter.active=!1,e.player&&t.game.showMineData(t,e.player.first,e.player.score),null!=e.others&&0<e.others.length)for(n=0;n<e.others.length;n++)t.getPlayerBoard(e.others[n].playuser).showMineData(t,e.others[n].first,e.others[n].score);e.expid&&(e.expid==cc.global.user.id?(cc.global.myTurn=!0,t.game.playtimer(t.game,e.timer,1==e.bt,1<e.bt?e.bt-1:0)):(cc.global.myTurn=!1,(l=t.getPlayerBoard(e.expid))&&l.playtimer(t.game,e.timer)),0<=e.bt&&(cc.global.seriable=!0))}if("calling"==e.status&&(cc.global.gamestatus="playing",t.btn_enter.active=!1,e.expid))if(e.expid==cc.global.user.id&&t.notReplay)t.game.catchtimer(e.timer,e.ratio),cc.global.user.doCatch=!0;else{var l=t.getPlayerBoard(e.expid);l.catchtimer(e.timer)}if(null!=e.others&&0<e.others.length)for(n=0;n<e.others.length;n++)t.getPlayerBoard(e.others[n].playuser).resetcards(e.others[n].cnum)},getRatioStep:function(e){return 2==e?1:4==e?2:8==e?3:void 0},raiseUp_event:function(){var e=this;this.raiseAnim.active=!0;var t=this.raiseAnim.children[0].getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"play",!1),cc.global.audio.playEffectAud("call"),setTimeout(function(){e.raiseAnim.active=!1},2e3)},catchresult_event:function(e,t){if(t.raiseUp(e.ratio),e.userid==cc.global.user.id&&t.notReplay){if(t.game.catchresult(e),cc.global.user.doCatch=!1,0<e.myratio)switch(parseInt(e.myratio)){case 1:t.showAnimation(t.game.operesult.children[1],11,e.userid);break;case 2:t.showAnimation(t.game.operesult.children[2],12,e.userid);break;case 3:t.showAnimation(t.game.operesult.children[3],13,e.userid);break;case 4:t.showAnimation(t.game.operesult.children[4],14,e.userid)}else t.game.speech("pass"),t.fold_event(e,t);t.game.updateBalanceData(e.gd,e.bet)}else{if((a=t.getPlayerBoard(e.userid))&&a.catchresult(e),0<e.myratio)switch(parseInt(e.myratio)){case 1:t.getPlayer(e.userid).speech("call");break;case 2:t.getPlayer(e.userid).speech("call2");break;case 3:t.getPlayer(e.userid).speech("call4");break;case 4:t.getPlayer(e.userid).speech("call8")}else t.getPlayer(e.userid).speech("pass"),t.getPlayerBoard(e.userid).fold_event(e,t);t.getPlayer(e.userid).updateBalanceData(e.gd,e.bet)}if(0<parseInt(e.myratio)&&t.showRaiseUp(e.tgd),1<parseInt(e.myratio)){t&&t.game&&t.game.hideBanker();for(var i=0;i<t.playerboard.length;i++){var a=t.playerboard[i].getComponent("OFCPlayerBoardRender");a.hideBanker()}e.userid==cc.global.user.id&&t.notReplay?t.game.showBanker():t.getPlayerBoard(e.userid).showBanker(),cc.global.banker=e.userid}},fold_event:function(e,t){var i=cc.instantiate(t.poker);i.setPosition(t.poker.position),i.parent=t.root();for(var a=0;a<t.pokercards.length;a++)t.game.pokerpool.put(t.pokercards[a]);t.pokercards.slice(0,t.pokercards.length);var s=cc.callFunc(function(e,t){e.destroy()},i,{}),r=cc.sequence(cc.spawn(cc.moveTo(.2,0,0),cc.scaleTo(.2,.6,.6),cc.rotateTo(.2,60)),s);i.runAction(r)},hideAllCallStat:function(e){if(!(e<this.game.callRank)){var t=this.game.playermysql.getComponent("OFCPlayerRender");t.hideCallStat();for(var i=0;i<this.player.length;i++)(t=this.player[i].getComponent("OFCPlayerRender")).hideCallStat()}},lasthands_event:function(e,t){1==e.cardroom&&null!=t.invite&&t.invite.destroy();var i=[];if(null!=e.lasthands&&(i=t.decode(e.lasthands),t.resetUnderCard(t,i)),t.is_ptn_room&&(t.cleanUnderCard(t),t.resetUnderCard(t,i)),t.underCards=i,t.is_ptn_room||(t.lastcardlist=parseInt(e.dnum),t.showRemainCardCount(t)),e.userid==cc.global.user.id&&t.notReplay){for(t.is_ptn_room||t.game.lasthands(),a=0;a<t.playerboard.length;a++)(s=t.playerboard[a].getComponent("OFCPlayerBoardRender")).hideresult();cc.global.myTurn=!0,t.is_ptn_room||t.game.playtimer(t.game,20,!0),t.game.hideresult()}else{t.game.hideresult();for(var a=0;a<t.playerboard.length;a++){var s=t.playerboard[a].getComponent("OFCPlayerBoardRender");s.hideresult()}t.notReplay||(t.cleanUnderCard(t),t.underCards&&t.resetUnderCard(t,t.underCards));var r=t.getPlayerBoard(e.userid);r&&(t.is_ptn_room||(r.lasthands(t,t.game,e),r.playtimer(t.game,e.timer)))}t.toggleCardsState()},cleanAllLastCards:function(){if(this.playerboard){for(var e=0;e<this.playerboard.length;e++)this.playerboard[e].getComponent("OFCPlayerBoardRender").cleanLastCards(this.game);this.game.cleanCards(this.game)}},kp_event:function(e,t){t.notReplay&&t.game.hideResultPlayBtn();var i=t.decode(e.msg);t.game.unselected(t,t.game);for(var a=0;a<i.length;a++)t.game.cardtips(t,i[a],i);t.game.playtimer(t.game,5,e.first,e.extmsg)},turn_event:function(e,t){if(t.game.unselected(t,t.game),t.notReplay&&t.game.hideResultPlayBtn(),e.userid==cc.global.user.id&&t.notReplay)t.game.playtimer(t.game,parseInt(e.msg),1==parseInt(e.extmsg));else{var i=t.getPlayerBoard(e.userid);i&&i.playtimer(t.game,parseInt(e.msg))}},leave_event:function(e,t){e.userid==cc.global.user.id&&t.notReplay?t.disLeaveReq("true"==e.msg):t.getPlayer(e.userid).disLeaveReq("true"==e.msg)},selemoticon_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showEmoticon(e.msg);else{var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg)}var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},callplayer_event:function(e,t){if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showCallPlayer(e.msg);else{var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg)}var a=t.getObserver(e.userid);a&&(a.showCallPlayer(e.msg,!0),t.is_ptn_room||(5<=a.index?(a.callplayer.children[0].x=-350,a.callplayer.children[1].x=-350,a.callplayer.children[0].scaleX=-1):a.callplayer.children[0].scaleX=1))},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase;if(e.userid==cc.global.user.id&&t.notReplay)"no"==cc.global.amObserve&&t.game.showCallPlayer(i,e.msg);else{var a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg)}var s=t.getObserver(e.userid);s&&(s.showCallPlayer(i,e.msg),t.is_ptn_room||(5<=s.index?(s.callplayer.children[0].x=-350,s.callplayer.children[1].x=-350,s.callplayer.children[0].scaleX=-1):s.callplayer.children[0].scaleX=1))},showAnimation:function(e,t,i){var a=-1;switch(t){case 11:a=0;break;case 12:a=4;break;case 13:a=5;break;case 14:a=6}0<=a&&this.disEffect(e,a,i)},disEffect:function(e,t,i){e.children[0]&&(e.children[0].active=!0);var a="",s=null;switch(cc.global.user.id==i?this.game&&this.game.playermysql&&(s=this.game.playermysql.getComponent("OFCPlayerRender")):s=this.getPlayer(i),t){case 0:s&&s.speech("call");break;case 4:a="tongqian",cc.global.audio.playEffectAud("call"),s&&s.speech("call2");break;case 5:a="tongqian",cc.global.audio.playEffectAud("call"),s&&s.speech("call4");break;case 6:a="tongqian",cc.global.audio.playEffectAud("call"),s&&s.speech("call8")}if(""!=a&&e&&e.children[0]){var r=e.children[0].getComponent(sp.Skeleton);r.clearTracks(),r.setAnimation(0,a,!1)}setTimeout(function(){e&&e.children[0]&&(e.children[0].active=!1)},2e3)},cardtips_event:function(e,t){if(t.game.unselected(t,t.game),e.extdata.cards){var i=t.decode(e.extdata.cards);t.lasttip=i.join(","),cc.global.tipsReady=!0,t.upCardsCount=i.length;for(var a=0;a<i.length;a++)t.game.cardtips(t,i[a],i)}else t.upCardsCount=0,t.game.cardtipsfornot(t,t.game),setTimeout(function(){t.noCards()},500)},seltips_event:function(e,t){var i=t.decode(e.cards);if(t.lasttip=i.join(","),0<i.length)for(var a=0;a<i.length;a++)t.game.cardtips(t,i[a],i);else t.checkSelEndCard();for(var s=0;s<t.cardsArr.length;s++){var r=t.cardsArr[s].getComponent("HHCard");r.touched=!1,r.selected}},replay_play_event:function(e,t){if(e.curgame==cc.global.cur_game_code){cc.global.gamestatus="playing";var i=[],a=(this.getPlayer(e.playuser),this.getPlayerBoard(e.playuser));e.cards&&(i=t.decode(e.cards),a.resetcards(i.length),a.setCards(i)),t.is_ptn_room&&(t.cleanUnderCard(t),t.resetUnderCard(t,[]))}},play_event:function(e,t){if(t.lastcardlist=54,e.curgame==cc.global.cur_game_code){t.isOnSummary=!1,t.summarypage&&t.summarypage.getComponent("OFCSummaryDetail")&&(t.summarypage.destroy(),t.summarypage=null,t.restart(),cc.global.gamestatus="playing",t.btn_enter.active=!1);var i=[];e.cards&&(i=t.decode(e.cards));for(var a=0;a<t.playerboard.length;a++)t.playerboard[a].getComponent("OFCPlayerBoardRender").showCardsPanel();if(t.is_ptn_room){var s=cc.callFunc(function(e,t){if(t.game&&"no"==cc.global.amObserve){for(var i=0;i<t.self.pokercards.length;i++)t.self.pokercards[i].getComponent("HHCard").order();t.self.layoutPokerCard()}},this,{game:t.game,self:t});t.remaincardspanel.active=!1,t.dealing1(t.game,1,t,0,i),cc.global.audio.playEffectAud("shuffle"),t.deal1_timer=setTimeout(function(){t.dealing1(t.game,1,t,1,i,s,!0),t.reordering(t),t.cleanUnderCard(t);var e=[];t.is_ptn_room||null!=t.underCards&&(e=t.underCards),t.resetUnderCard(t,e)},250),t.is_ptn_room&&("no"==cc.global.amObserve&&t.notReplay&&(t.bet.active=!0),t.bet.children[1].getComponent(cc.Label).string=0),t.resetUnderCard(t,[])}else{var r=t.game.pokerpool.get();r.setPosition(t.remaincardspanel.parent.position),r.parent=t.root();var n=null,o=null,l=t.game.pokerpool.get();l.setPosition(t.remaincardspanel.parent.position),l.parent=t.root(),l.setScale(.6,.6);var c=cc.callFunc(function(e,t){if(t.game){if(t.game.pokerpool.put(t.down),t.game.pokerpool.put(t.upon),"no"==cc.global.amObserve){for(var i=0;i<t.self.pokercards.length;i++)t.self.pokercards[i].getComponent("HHCard").order();t.self.layoutPokerCard()}n&&n.destroy(),o&&o.destroy()}},this,{game:t.game,self:t,down:l,upon:r});t.dealing(t.game,0,1,t,0,l,r,i),1==cc.global.gameCond?((n=t.game.pokerpool.get()).setPosition(t.remaincardspanel.parent.position),n.parent=t.root(),t.dealing(t.game,1,1,t,0,null,n,i)):2==cc.global.gameCond&&((n=t.game.pokerpool.get()).setPosition(t.remaincardspanel.parent.position),n.parent=t.root(),t.dealing(t.game,1,1,t,0,null,n,i),(o=t.game.pokerpool.get()).setPosition(t.remaincardspanel.parent.position),o.parent=t.root(),t.dealing(t.game,2,1,t,0,null,o,i)),t.showRemainCardCount(t),cc.global.audio.playEffectAud("shuffle"),t.deal2_timer=setTimeout(function(){t.dealing(t.game,0,1,t,1,l,r,i),1==cc.global.gameCond?t.dealing(t.game,1,1,t,1,null,n,i):2==cc.global.gameCond&&(t.dealing(t.game,1,1,t,1,null,n,i),t.dealing(t.game,2,1,t,1,null,o,i)),t.showRemainCardCount(t),t.deal3_timer=setTimeout(function(){t.dealing(t.game,0,1,t,2,l,r,i,c,!0),1==cc.global.gameCond?t.dealing(t.game,1,1,t,2,null,n,i,c,!0):2==cc.global.gameCond&&(t.dealing(t.game,1,1,t,2,null,n,i,c,!0),t.dealing(t.game,2,1,t,2,null,o,i,c,!0)),t.showRemainCardCount(t),t.reordering(t),t.showRemainCardCount(t)},250)},250)}}},showUnderCards:function(e){var t=[];null!=e.underCards&&(t=e.underCards);for(var i=0;i<t.length;i++){var a=e.game.minpokerpool.get();a.getComponent("HHCard").setCard(t[i]),a.card=t[i],a.parent=e.underCardPanel,e.underpokercards.push(a),a.getComponent("HHCard").setParent(e,!1,!1,!0),a.getComponent("HHCard").order()}10<=e.underCardPanel.children.length?e.underCardPanel.getComponent(cc.Layout).resizeMode=cc.Layout.ResizeMode.CHILDREN:(e.underCardPanel.getComponent(cc.Layout).resizeMode=cc.Layout.ResizeMode.CONTAINER,e.underCardPanel.getComponent(cc.Layout).spacingX=2)},allcards_event:function(e,t){t.gameCleaned=!1,t.hasRight=!1,t.game.hasRP=!1,e.finished=!0,cc.global.gamestatus="waiting";var i=null;null!=e.cnt&&0<cc.global.championMode&&(t.currenRound=parseInt(e.cnt)+1);for(var a=0;a<e.players.length;a++){for(var s=e.players[a],r=0;r<t.rerenderPlayers.length;r++)t.rerenderPlayers[r].id==s.userid&&(t.rerenderPlayers[r].goldcoins=s.gold,t.rerenderPlayers[r].rank=s.rank,t.rerenderPlayers[r].exp=s.normalscore);if(s.userid==cc.global.user.id&&t.notReplay)cc.global.user.normalrank=s.normalrank,cc.global.user.goldcoins=s.gold,t.game.updateCareerAfterMatch(s),"",2==s.win?"Victory":0==s.win&&"Lost";else{if((i=s).cards){var n=t.decode(s.cards),o=t.getPlayerBoard(s.userid);o.cleanCards();for(var l=0;l<n.length;l++)o.lasttakecards(t.game,t,n.length,n,e)}t.getPlayer(s.userid).updateCareerAfterMatch(s);2==s.win?"Victory":0==s.win&&"Lost"}}if(t.showRaiseUp(e.dummy),t.isOnSummary=!0,cc.global.summaryDetailData=e,null!=i){if(t.updatepva(),t.closeOpenWin(),!t.summary)return;if(t.summarypage=cc.instantiate(t.summary),null==t.summarypage||null==t.summarypage)return;t.summarypage.parent=t.root(),t.summarypage.getComponent("OFCSummaryDetail").create(t,e,"yes"==cc.global.amObserve)}t.is_ptn_room&&setTimeout(function(){"playing"!=cc.global.gamestatus&&"yes"==cc.global.amObserve&&t.notReplay&&t.rerenderPlayers.length<8&&(t.btn_enter.active=!0)},4500)},rend_event:function(e,t){t.isOnSummary=!1,"no"==cc.global.amObserve&&t.socket().exec("rnr",{extparams:{roomid:cc.global.extparams.roomid}}),t.hasRight=!1},showRaiseUp:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;e<0||null==e||null==e?this.raiseup.active=!1:this.is_ptn_room||0!=e?(this.raiseup.runAction(cc.sequence(cc.scaleTo(.2,1.3,1.3),cc.scaleTo(.1,.9,.9),cc.scaleTo(.2,1,1))),this.raiseup.active=!0,"normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway?(this.raiseup.children[0].active=!0,this.raiseup.children[1].active=!1):"diamond"==cc.global.user.selplayway&&(this.raiseup.children[0].active=!1,this.raiseup.children[1].active=!0),this.raiseup.children[2].getComponent(cc.Label).string=this.numformat(e)):this.raiseup.active=!1},getPlayerBoard:function(e){if(this&&this.playerboard)for(var t=0;t<this.playerboard.length;t++){var i=this.playerboard[t].getComponent("OFCPlayerBoardRender");if(i.userid&&i.userid==e)return i}},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},startrecord_event:function(e,t){},getPlayer:function(e){if(this&&this.player)for(var t=0;t<this.player.length;t++){var i=this.player[t].getComponent("OFCPlayerRender");if(i.userid&&i.userid==e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},dealing1:function(e,t,i,a,s,r){if(i&&i.playerboard){for(o=0;o<i.playerboard.length;o++){var n=i.playerboard[o].getComponent("OFCPlayerBoardRender").seatid;i.otherplayer1(o,n,t,i,r)}if("no"==cc.global.amObserve)for(var o=0;o<t;o++){var l=i.current1(e,i,300*a+50*o-300,s[1*a+o],r);null!=l&&i.registerProxy(l)}}},dealing:function(e,t,i,a,s,r,n,o,l){if(a.otherplayer(n,t,i,e,a,l),"yes"==cc.global.amObserve)null!=r&&a.otherplayer(r,cc.global.fullCount-1,i,e,a,l,!0);else for(var c=0;c<i;c++)if(null!=r)null!=(h=a.current(e,a,300*s+50*c-300,o[1*s+c],l))&&a.registerProxy(h);else{var h=e.pokerpool.get();null!=h&&a.registerProxy(h)}},otherplayer1:function(i,e,a,s,t){5<arguments.length&&void 0!==arguments[5]&&arguments[5];var r=cc.instantiate(s.dealingCardAnim);r.setPosition(0,0),r.parent=s.root(),r.children[e].getComponent(cc.Animation).play(),setTimeout(function(){if(s&&s.playerboard){for(var e=s.playerboard[i].getComponent("OFCPlayerBoardRender"),t=0;t<a;t++)e.countcards(1);r.destroy()}},200)},moveCardPosition:function(e,t){if(0==e)return cc.v2(0,-120);var i=cc.v2(0,0);switch(cc.global.gameCond){case 0:i=cc.pSub(this.playerSlotPos4[1],cc.v2(240,50));break;case 1:i=cc.pSub(this.playerSlotPos3[e-1],cc.v2(260,50));break;case 2:i=cc.pSub(this.playerSlotPos4[e-1],cc.v2(260,50))}return i},otherplayer:function(e,t,i,a,s,r){var n=6<arguments.length&&void 0!==arguments[6]&&arguments[6];if(e.parent=s.root(),s.player){1==s.curTheme||s.curTheme;var o,l=s.playerboard[t].getComponent("OFCPlayerBoardRender").seatid;o=cc.sequence(cc.spawn(cc.moveTo(.2,s.moveCardPosition(l,t)),cc.scaleTo(.2,.5,.5)),n&&null!=r?r:cc.callFunc(function(e,t){t.poker.setPosition(s.remaincardspanel.parent.position),t.poker.setScale(.6,.6)},s,{poker:e,self:s})),e.runAction(o);for(var c=s.playerboard[t].getComponent("OFCPlayerBoardRender"),h=0;h<i;h++)s.notReplay?c.countcards(1):c.countcardsForReplay(1,[])}},registerProxy:function(e){e&&e.getComponent("HHCard").proxy(this.game)},playcards:function(e,t,i,a){return t.current(e,t,i,a,null)},current:function(e,t,i,a,s){var r=5<arguments.length&&void 0!==arguments[5]&&arguments[5];if(null==e||null==e)return null;if(null==e.pokerpool||null==e.pokerpool)return null;var n=e.pokerpool.get();if("no"==cc.global.amObserve){var o=n.getComponent("HHCard");if(o.setCard(a),r&&o.order(),o.setParent(t,!0,!0,!0),n.setScale(1,1),n.rotation=0,n.card=a,n.setPosition(t.remaincardspanel.parent.x,t.remaincardspanel.parent.y),n.parent=t.root(),n.setScale(.6,.6),t.pokercards.push(n),"luckyre"!=cc.global.gamestatus)if(null!=s){var l=cc.sequence(cc.spawn(cc.moveTo(.2,t.poker.x,t.poker.y),cc.scaleTo(.2,1,1)),cc.callFunc(function(e,t){t.poker.setPosition(0,0),t.poker.parent=t.self.poker},t,{self:t,poker:n}),s);n.runAction(l)}else{var c=cc.sequence(cc.spawn(cc.moveTo(.2,t.poker.x,t.poker.y),cc.scaleTo(.2,1,1)),cc.callFunc(function(e,t){t.poker.setPosition(0,0),t.poker.parent=t.self.poker},t,{self:t,poker:n}));n.runAction(c)}else n.x=0,n.y=0}return n},current1:function(e,t,i,a,s){var r=5<arguments.length&&void 0!==arguments[5]&&arguments[5];if(null==e||null==e)return null;if(null==e.pokerpool||null==e.pokerpool)return null;var n=e.pokerpool.get();if("no"==cc.global.amObserve){var o=n.getComponent("HHCard");if(o.setCard(a),r&&o.order(),o.setParent(t,!0,!0,!0),n.setScale(1,1),n.rotation=0,n.card=a,n.setPosition(0,0),n.parent=t.root(),n.setScale(.6,.6),t.pokercards.push(n),"luckyre"!=cc.global.gamestatus)if(null!=s){var l=cc.sequence(cc.spawn(cc.moveTo(.2,t.poker.x,t.poker.y),cc.scaleTo(.2,1,1)),cc.callFunc(function(e,t){t.poker.setPosition(0,0),t.poker.parent=t.self.poker},t,{self:t,poker:n}),s);n.runAction(l)}else{var c=cc.sequence(cc.spawn(cc.moveTo(.2,t.poker.x,t.poker.y),cc.scaleTo(.2,1,1)),cc.callFunc(function(e,t){t.poker.setPosition(0,0),t.poker.parent=t.self.poker},t,{self:t,poker:n}));n.runAction(c)}else n.x=0,n.y=0}return n},reordering:function(e){if(null!=e.pokercards&&null!=e.pokercards&&"no"==cc.global.amObserve){for(var t=0;t<e.pokercards.length;t++)e.pokercards[t].parent=e.poker;e.addTouchEvent()}},newplayer:function(e,t,i,a){var s=this.playerSlots[a],r=this.playerBordSlots[a],n=t.game,o=!1;t.is_ptn_room?o=0!=a&&6!=a&&7!=a:(o=0!=a,this.isPlayer=0==a),n&&0<n.playerboardpool.size()&&(t.playerboard[e]=n.playerboardpool.get(),t.playerboard[e].parent=t.playersboard,t.playerboard[e].zIndex=3,t.playerboard[e].setPosition(r),t.playerboard[e].getComponent("OFCPlayerBoardRender").initplayer(t,i,a,o)),n&&0<n.playerspool.size()&&(t.player[e]=n.playerspool.get(),t.player[e].parent=0<a?t.back_players:t.front_players,t.player[e].setPosition(s),t.player[e].getComponent("OFCPlayerRender").initplayer(t,i,a,o))},givup:function(){this.ready()&&this.socket().exec("giveup",{})},cardtips:function(){if(this.ready())var e=this.socket(),t={};null!=this.lasttip?t.extparams={cardtips:this.lasttip}:t.extparams={cardtips:""},e.exec("cardtips",t),this.lasttip=null},docatch:function(e,t){this.ready()&&this.socket().exec("docatch",{extparams:{callx:t}})},noCards:function(e){this.game.unselected(this,this.game);var t=e.card;this.socket().exec("throw",{extparams:{card:t+""}}),this.lasttip=null},cleanGame:function(){for(var e=0;e<this.pokercards.length;e++){var t=this.pokercards[e];this.game.pokerpool.put(t)}for(this.cleanUnderCard(this),this.pokercards.splice(0,this.pokercards.length),i=0;i<this.lastcards.length;i++)this.game.minpokerpool.put(this.lastcards[i]);this.lastcards.splice(0,this.lastcards.length);for(var i=0;i<this.player.length;i++){var a=this.playerboard[i].getComponent("OFCPlayerBoardRender");if(a){a.result&&(a.result.active=!1),a.cannot&&(a.cannot.active=!1),a.donot&&(a.donot.active=!1),a.lastcards&&(a.lastcards.active=!1),a.dizhu&&(a.dizhu.active=!1),a.hideCallStat(),a.resetcards(0),a.showMineData(this,-1,-1);var s=this.player[i].getComponent("OFCPlayerRender");s.hideLeaveReq(),this.is_ptn_room||s.removeTeamMark()}}this.raiseUp(1,!0),this.lasttime=cc.global.logintime,"no"==cc.global.amObserve&&(this.game.clean(this),this.game.showMineData(this,-1,-1),this.raiseUp(1,!0)),this.dealed=!1,this.leavereq.active=!1},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},removeGetoutPlayers:function(){var e=this;if(cc.global.summaryDetailData&&(e.deadPlayers=cc.global.summaryDetailData.players,e.deadPlayers&&e.deadPlayers))for(var t=0;t<e.deadPlayers.length;t++)for(var i=0;i<e.player.length;i++)e.player[i].getComponent("OFCPlayerRender").userdata.id==e.deadPlayers[t].userid&&e.deadPlayers[t].getout&&(e.player[i].destroy(),e.player.splice(i,1),e.playerboard[i].destroy(),e.playerboard.splice(i,1))},cleanGamePlayers:function(){for(var e=0;e<this.player.length;e++)this.player[e].destroy(),this.playerboard[e].destroy();this.player.splice(0,this.player.length),this.playerboard.splice(0,this.player.length),this.player=new Array,this.playerboard=new Array},restart:function(e){this.gameCleaned||(this.gameCleaned=!0,this.cleanGame(),this.goRecovery=!1,cc.global.gamestatus="waiting",this.cleanGamePlayers(),this.game.restart(),this.addBoardPlayers(),"yes"==cc.global.amObserve&&this.rerenderPlayers.length<(4!=cc.global.gameCond?cc.global.fullCount:3)&&(2==cc.global.championMode?this.btn_enter.active=!1:0==cc.global.championMode&&this.notReplay&&(this.btn_enter.active=!0)),this.play_status=0,this.game.callRank=0,this.isOnSummary=!1)},onDestroy:function(){this.inited=!1,this.cleanmap(),cc.global.onBatteryChanged=null},addTouchEvent:function(){this.cardsArr=this.poker.getChildren()},onTouchStart:function(e){},onTouchMove:function(e){},onTouchEnd:function(e){},checkSelStartCard:function(e){var t=this.cardsArr.length;this.beginCardId=-1,this.moveCardId=-1;for(var i=t-1;0<=i;i--){var a=this.cardsArr[i];if(a.getBoundingBox().contains(e))return a.getComponent("HHCard").touched=!0,void(this.beginCardId=i)}},checkSelMoveCard:function(e){for(var t=this.cardsArr.length,i=t-1;0<=i;i--){var a=this.cardsArr[i];if(a.getBoundingBox().contains(e)){a.getComponent("HHCard").touched=!0,this.moveCardId=i,this.beginCardId=-1==this.beginCardId?i:this.beginCardId;break}}if(-1!=this.beginCardId)for(var s=Math.min(this.beginCardId,this.moveCardId),r=Math.max(this.beginCardId,this.moveCardId),n=0;n<t;n++)this.cardsArr[n].getComponent("HHCard").touched=s<=n&&n<=r},sendTouchCards:function(){for(var e=new Array,t=this.cardsArr.length,i=0;i<t;i++){var a=this.cardsArr[i].getComponent("HHCard");a.touched&&(e.push(a.card),a.doselect())}e=new Array;for(var s=0;s<this.cardsArr.length;s++){var r=this.cardsArr[s].getComponent("HHCard");r.touched&&(e.push(r.card),r.doselect())}this.beginCardId=-1,this.moveCardId=-1},checkSelEndCard:function(){for(var e=this.cardsArr.length,t=[],i=1,a=0;a<e;a++){var s=this.cardsArr[a].getComponent("HHCard");s.touched&&0==s.selected?(i=1,t.push(s.card)):s.touched&&1==s.selected&&(i=0,s.doselect()),s.touched=!1}if(0!=t.length){var r=this.deck.makeEngineCardArray(t),n=this.engine.getPossibleCards(r);t=[];for(var o=0;o<n.size();o++)t.push(this.deck.getNumber(n.get(o)));this.upCardsCount=t.length,this.showSelCardsTip(t)}else 1==i&&(this.upCardsCount=0,this.game.unselected(this,this.game))},showSelCardsTip:function(e){for(var t=0;t<this.cardsArr.length;t++)for(var i=this.cardsArr[t].getComponent("HHCard"),a=0;a<e.length;a++)i.card==e[a]&&i.doTipSelect()},displayCardList:function(e){for(var t="cardlist : (",i=0;i<e.size();i++)t=t+e.get(i).getString()+",";t+=")"},disCardtips:function(e,t){},onclickBack:function(){this.ready()&&(this.notReplay&&(0<this.player.length||"no"==cc.global.amObserve)?this.socket().exec("leave",{}):this.exitPlay())},changeCharacter:function(){},onclickUnSel:function(){cc.global.tipsReady&&(cc.global.tipsReady=!1),this.upCardsCount=0,this.game.unselected(this,this.game)},showChatDialog:function(){this.onclickChat(1)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}e<0||(this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root(),this.chatpage.getComponent("Chat").init(this,e),this.ischat=!0)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;if(!(e<0)&&this.ready()){var t=this.socket(),i={};i.extparams={emoticon:e},t.exec("selemoticon",i),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1)}},onClickEmoticon:function(){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),this.isemoticon=!1;this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root(),this.emoticonpage.getComponent("Emoticon").init(this),this.isemoticon=!0},onclickUserlist:function(){this.socket().exec("totaluserlist",{})},disLeaveReq:function(e){this.leavereq.active=e},changeCardSortOrder:function(){var e=JSON.parse(cc.sys.localStorage.getItem("carsort_order"));null==e&&(e=!1);for(var t=0;t<this.poker.children.length;t++)this.poker.children[t].zIndex=100-this.poker.children[t].zIndex;this.layoutPokerCard()},layoutPokerCard:function(){for(var e=0;e<this.poker.children.length;e++)this.poker.children[e].y=0;this.layout(this.poker,function(e,t){return e.zIndex-t.zIndex})},onClickRecordPlay:function(){this.socket().exec("startrecord",{})},onClickFindEmptyRoom:function(){var i=this;i.socket().exec("fnr",{}),cc.global.socket.on("fnr",function(e){var t=JSON.parse(e);i.alert(t.extmsg)})},removeCard:function(e){for(var t=e.index,i=[],a=0;a<this.selectedCards.length;a++)a!=t&&i.push(this.selectedCards[a]);this.selectedCards=i},doPlayCards:function(){if(this.ready()){var e=this.socket();this.game.selectedcards.splice(0,this.game.selectedcards.length);for(var t=0;t<this.selectedCards.length;t++){var i=this.selectedCards[t];this.game.selectedcards.push(i.card)}if(this.game.selectedcards.length){var a={};a.extparams={cards:this.game.selectedcards.join()},e.exec("bet",a),cc.global.user.hardLiner=!1}}this.lasttip=null},checkCards:function(){for(var e=0,t=!1,i=!0,a=-1,s=0;s<this.selectedCards.length;s++){var r=0;this.selectedCards[s].isneed&&(t=!0),this.selectedCards[s].card<52?14==(r=(this.selectedCards[s].card-this.selectedCards[s].card%4)/4+3)?r=1:15==r&&(r=2):r=52==this.selectedCards[s].card?5:6,a<0&&(a=r),i=a==r?i&&!0:i&&!1,e+=a=r}if(14==e)t&&this.doPlayCards();else if(i){if(4==this.selectedCards.length)this.doPlayCards();else if(4<this.selectedCards.length){for(this.myselectedcard=null,s=0;s<this.selectedCards.length;s++)this.selectedCards[s].unselected();this.selectedCards.splice(0,this.selectedCards.length)}}else if(14<e){for(this.myselectedcard=null,s=0;s<this.selectedCards.length;s++)this.selectedCards[s].unselected();this.selectedCards.splice(0,this.selectedCards.length)}else if(3<=this.selectedCards.length){for(this.myselectedcard=null,s=0;s<this.selectedCards.length;s++)this.selectedCards[s].unselected();this.selectedCards.splice(0,this.selectedCards.length)}},throw_event:function(s,r){cc.global.myTurn=!1;var n=r.decode(s.extdata.free);if(cc.global.audio.playEffectAud("out_card"),cc.global.user.id==s.userid&&"no"==cc.global.amObserve&&r.notReplay){for(var e=null,t=new Array,i=0;i<r.pokercards.length;i++)r.pokercards[i].getComponent("HHCard").card==n[n.length-1]&&(e=r.pokercards[i]),t.push(r.pokercards[i]);if(r.pokercards=t,null!=e){var a=e.position;e.parent=r.root(),e.setPosition(r.poker.x+a.x,r.poker.y+a.y),h=cc.sequence(cc.spawn(cc.moveTo(.2,r.underCardPanel.x,r.underCardPanel.y),cc.scaleTo(.2,.5,.5)).easing(cc.easeSineInOut(3)),cc.callFunc(function(e,t){t.self.game.pokerpool.put(e)},e,{self:r})),e.runAction(h),setTimeout(function(){if(r.cleanUnderCard(r),r.resetUnderCard(r,n),s.extdata.cards){var e=r.decode(s.extdata.cards);0<r.lastcardlist?setTimeout(function(){r.cleanMyPokerCard(r),r.resetMyPokerCard(r,e)},200):(r.cleanMyPokerCard(r),r.resetMyPokerCard(r,e))}},300)}r.selectedCards.slice(0,r.selectedCards.length),r.game.stopTimer()}else{var o=r.getPlayerBoard(s.userid);if((e=o.getLastCard()).getComponent("HHCard").setCard(n[n.length-1]),e.getComponent("HHCard").order(),null!=e){var l=o.node.x+o.pokertag.x+o.cardspanel.x+e.x,c=o.node.y+o.pokertag.y+o.cardspanel.y+e.y;e.parent=r.root(),e.setPosition(l,c),r.notReplay?o.countcards(-1):o.countcardsForReplay(-1,[n[n.length-1]]);var h=cc.sequence(cc.spawn(cc.moveTo(.2,r.underCardPanel.x,r.underCardPanel.y),cc.scaleTo(.2,1,1)).easing(cc.easeSineInOut(3)),cc.callFunc(function(e,t){e.setScale(1,1),e.destroy()},e,{self:r}));e.runAction(h),setTimeout(function(){if(0<r.lastcardlist){var e=r.game.pokerpool.get();e.setPosition(r.remaincardspanel.parent.position),e.parent=r.root(),e.setScale(1,1);for(var t=cc.callFunc(function(e,t){if(t.game&&t.game.pokerpool.put(t.upon),t.board.resetcards(t.cnum),t.carddata.extdata.cards&&!r.notReplay){var i=r.decode(t.carddata.extdata.cards);t.board.setCards(i)}},r,{game:r.game,self:r,upon:e,board:o,cnum:s.extdata.cnum,carddata:s}),i=0;i<r.playerboard.length;i++)r.playerboard[i].getComponent("OFCPlayerBoardRender").userid==s.userid&&r.otherplayer(e,i,1,r.game,r,t,!0)}else if(o.resetcards(s.extdata.cnum),s.extdata.cards&&!r.notReplay){var a=r.decode(s.extdata.cards);r.getPlayerBoard(s.userid).setCards(a)}r.cleanUnderCard(r),r.resetUnderCard(r,n)},200)}r.getPlayerBoard(s.userid).getComponent("OFCPlayerBoardRender").stopTimer()}null!=s.extdata.nextid&&(cc.global.user.id==s.extdata.nextid&&r.notReplay?(cc.global.myTurn=!0,r.game.playtimer(r.game,s.extdata.timer,!0)):r.getPlayerBoard(s.extdata.nextid).getComponent("OFCPlayerBoardRender").playtimer(r.game,s.extdata.timer),r.showRemainCardCount(r),r.reduceRemainCard(r),r.resetMinesCards(r),r.toggleCardsState())},resetMinesCards:function(e){"no"==cc.global.amObserve&&e.notReplay&&e.game.resetMinesCard();for(var t=0;t<e.playerboard.length;t++)e.playerboard[t].getComponent("OFCPlayerBoardRender").resetMinesCard()},cleanUnderCard:function(e){if(this&&this.selectedCards){this.selectedCards.splice(0,this.selectedCards.length);for(var t=0;t<=e.underpokercards.length;t++){var i=e.underpokercards[t];e.game.minpokerpool.put(i)}e.underpokercards.splice(0,e.underpokercards.length),e.underCardPanel.getComponent(cc.Layout).resizeMode=cc.Layout.ResizeMode.CONTAINER,e.underCardPanel.getComponent(cc.Layout).spacingX=2}},resetUnderCard:function(e,t){if(e&&e.underCardPanel){if(e.is_ptn_room)return e.underCardPanel.active=!0,(s=e.game.minpokerpool.get()).parent=e.underCardPanel,s.getComponent("HHCard").init(),0!=t.length&&(s.getComponent("HHCard").setCard(t[0]),s.getComponent("HHCard").order()),e.underpokercards.push(s),s.rotation=0,void s.setScale(1,1);for(var i=0;i<t.length;i++){var a=t[i],s=e.game.minpokerpool.get();s.parent=e.underCardPanel,e.underpokercards.push(s),s.rotation=0,s.setScale(1,1),s.getComponent("HHCard").setParent(e,!1,!1,!0),s.getComponent("HHCard").setCard(a),s.getComponent("HHCard").order()}10<=e.underCardPanel.children.length?e.underCardPanel.getComponent(cc.Layout).resizeMode=cc.Layout.ResizeMode.CHILDREN:(e.underCardPanel.getComponent(cc.Layout).resizeMode=cc.Layout.ResizeMode.CONTAINER,e.underCardPanel.getComponent(cc.Layout).spacingX=2)}},cleanMyPokerCard:function(e){if(e.pokercards){for(var t=0;t<=e.pokercards.length;t++){var i=e.pokercards[t];e.game.pokerpool.put(i)}e.pokercards.splice(0,e.pokercards.length)}},resetMyPokerCard:function(e,t){for(var i=0;i<t.length;i++){var a=t[i],s=e.game.pokerpool.get();s.y=0,s.setScale(1,1),s.getComponent("HHCard").setParent(e,!0,!0,!0),s.getComponent("HHCard").setCard(a),s.getComponent("HHCard").order(),s.parent=e.poker,e.pokercards.push(s)}e.toggleCardsState()},convertMinesData:function(e){for(var t=[],i=0;i<e.length;i++){var a=e[i],s={index:parseInt(a.slice(0,1)),mine:parseInt(a.slice(1,a.length))};t.push(s)}return t},moveEatCard:function(e,t,i,a,s,r){var n=6<arguments.length&&void 0!==arguments[6]&&arguments[6];if(i<t.length){var o=t[i];o.card.setPosition(o.startX,o.startY),o.card.parent=e.root(),o.card.setScale(o.startScale,o.startScale);var l=cc.sequence(cc.spawn(cc.moveTo(.2,o.endX+60*i,o.endY),cc.scaleTo(.2,o.endScale,o.endScale)).easing(cc.easeSineInOut(3)),cc.callFunc(function(e,t){e.setScale(1,1),e.setPosition(0,0),e.getComponent("HHCard").init(),n||0!=t.type?2==t.type?t.self.game.minpokerpool.put(e):t.self.game.pokerpool.put(e):e.destroy(),t.isme_?t.self.game.addMineCard(t.self,t.mines_[t.index_].mine):t.self.getPlayerBoard(t.userid).addMineCard(t.self,t.mines_[t.index_].mine)},o.card,{self:e,type:o.type,index_:i,mines_:a,isme_:n,userid:s.userid}));if(o.card.runAction(l),cc.global.audio.playEffectAud("get_card"),0==o.type&&!n)if(e.notReplay)e.getPlayerBoard(s.userid).countcards(-1);else{for(var c=[],h=0;h<a.length;h++)c.push(a[h].mine);e.getPlayerBoard(s.userid).countcardsForReplay(-1,c)}i++,setTimeout(function(){e.moveEatCard(e,t,i,a,s,r,n)},400)}else{if(s.cards&&e.notReplay)d=e.decode(s.cards),0<e.lastcardlist&&r?(e.current(e.game,e,-300,d[d.length-1],cc.callFunc(function(e,t){},e,{}),!0),setTimeout(function(){e.cleanMyPokerCard(e),e.resetMyPokerCard(e,d)},200)):(e.cleanMyPokerCard(e),e.resetMyPokerCard(e,d));else if(0<e.lastcardlist&&r)e.getPlayerBoard(s.userid)&&e.getPlayerBoard(s.userid).resetcards(s.cnum),s.cards&&!e.notReplay&&(d=e.decode(s.cards),e.getPlayerBoard(s.userid).setCards(d));else if(e.getPlayerBoard(s.userid)&&(e.getPlayerBoard(s.userid).resetcards(s.cnum),s.cards&&!e.notReplay)){var d=e.decode(s.cards);e.getPlayerBoard(s.userid).setCards(d)}if(e.cleanUnderCard(e),s.free){var u=e.decode(s.free);e.resetUnderCard(e,u)}}},calcDcardIndex:function(e,t,i,a){return(i==t?1:i==e?0:2)%a},takecards_event:function(e,t){if("number"==typeof e.ratio&&t.raiseUp(e.ratio),e.dcard&&(e.dcard=t.decode(e.dcard)),t.lasttip=null,t.dealed=!0,cc.global.myTurn=!1,cc.global.seriable=!1,e.mines&&0<e.mines.length&&(t.lasttime=cc.global.logintime+600*e.mines.length),!t.is_ptn_room){if(cc.global.user.id==e.userid&&"no"==cc.global.amObserve&&t.notReplay){if(u=t.convertMinesData(e.mines)){for(var i=[],a=!1,s=0;s<u.length;s++){if(v={card:null,startX:0,startY:0,startScale:0,endX:0,endY:0,endScale:0,type:-1},0==u[s].index){for(var r=null,n=new Array,o=0;o<t.pokercards.length;o++)t.pokercards[o].getComponent("HHCard").card==u[s].mine?r=t.pokercards[o]:n.push(t.pokercards[o]);t.pokercards=n,null!=r&&(x=(v.card=r).position,v.startX=t.poker.x+x.x,v.startY=t.poker.y+x.y,v.startScale=1,r.parent=t.root(),r.setPosition(v.startX,v.startY),r.setScale(v.startScale,v.startScale),v.endX=t.game.minescard.x,v.endY=t.game.minescard.y,v.endScale=.5,a=!(v.type=0))}else if(1==u[s].index)t.remaincardspanel.children[0].getComponent("HHCard").card==u[s].mine&&((C=t.game.pokerpool.get()).getComponent("HHCard").setCard(u[s].mine),C.getComponent("HHCard").order(),v.card=C,v.startX=t.remaincardspanel.parent.x,v.startY=t.remaincardspanel.parent.y,v.startScale=.6,C.setPosition(v.startX,v.startY),C.parent=t.root(),C.setScale(v.startScale,v.startScale),v.endX=t.game.minescard.x,v.endY=t.game.minescard.y,v.endScale=.5,v.type=1);else if(2==u[s].index){var l=[];for(o=0;o<t.underpokercards.length;o++)t.underpokercards[o].getComponent("HHCard").card==u[s].mine?(C=t.underpokercards[o],v.card=C,v.startX=t.underCardPanel.x+C.x,v.startY=t.underCardPanel.y+C.y,v.startScale=1,v.endX=t.game.minescard.x,v.endY=t.game.minescard.y,v.endScale=1,v.type=2):l.push(t.underpokercards[o]);t.underpokercards=l}else if(3<=u[s].index)for(S=0;S<t.playerboard.length;S++){var c=t.playerboard[S].getComponent("OFCPlayerBoardRender").seatid,h=t.calcDcardIndex(3,1,c,e.dcard.length);(T=t.playerboard[S].getComponent("OFCPlayerBoardRender").checkRobeCard(u[s].mine,null!=e.dcard?e.dcard[h]:-1))&&((C=t.game.pokerpool.get()).getComponent("HHCard").setCard(u[s].mine),C.getComponent("HHCard").order(),v.card=C,v.startX=t.playerboard[S].x+t.playerboard[S].getComponent("OFCPlayerBoardRender").pokertag.x+t.playerboard[S].getComponent("OFCPlayerBoardRender").minescard.x,v.startY=t.playerboard[S].y+t.playerboard[S].getComponent("OFCPlayerBoardRender").pokertag.y+t.playerboard[S].getComponent("OFCPlayerBoardRender").minescard.y,v.startScale=.8,C.setPosition(v.startX,v.startY),C.parent=t.root(),C.setScale(v.startScale,v.startScale),v.endX=t.game.minescard.x,v.endY=t.game.minescard.y,v.endScale=.5,v.type=3)}null!=v.card&&i.push(v)}null!=i&&t.moveEatCard(t,i,0,u,e,a,!0)}if(e.score)for(e.score[e.userid]&&t.game.setMineScore(e.score[e.userid]),S=0;S<t.playerboard.length;S++)e.score[t.playerboard[S].getComponent("OFCPlayerBoardRender").userid]&&t.playerboard[S].getComponent("OFCPlayerBoardRender").setMineScore(e.score[t.playerboard[S].getComponent("OFCPlayerBoardRender").userid])}else{var d=t.getPlayerBoard(e.userid),u=t.convertMinesData(e.mines),p=d.seatid,g=(p+1)%cc.global.fullCount,m=(p-1+cc.global.fullCount)%cc.global.fullCount;if(u){i=[];var y=t.getPlayerBoard(e.userid),f=y.node.x+y.pokertag.x+y.minescard.x,b=y.node.y+y.pokertag.y+y.minescard.y;for(a=!1,s=0;s<u.length;s++){var v={card:null,startX:0,startY:0,startScale:0,endX:0,endY:0,endScale:0,type:-1},_={card:null,startX:0,startY:0,startScale:0,endX:0,endY:0,endScale:0,type:-1};r=null;if(1==u[s].index)0<t.lastcardlist&&t.remaincardspanel.children[0].getComponent("HHCard").card==u[s].mine&&((C=t.game.pokerpool.get()).getComponent("HHCard").setCard(u[s].mine),C.getComponent("HHCard").order(),v.card=C,v.startX=t.remaincardspanel.parent.x,v.startY=t.remaincardspanel.parent.y,v.startScale=.6,C.setPosition(v.startX,v.startY),C.parent=t.root(),C.setScale(v.startScale,v.startScale),v.endX=f,v.endY=b,v.endScale=.5,v.type=1);else if(2==u[s].index){for(l=[],o=0;o<t.underpokercards.length;o++)if(t.underpokercards[o].getComponent("HHCard").card==u[s].mine){var C=t.underpokercards[o];v.card=C,v.startX=t.underCardPanel.x+C.x,v.startY=t.underCardPanel.y+C.y,v.startScale=1,v.endX=f,v.endY=b,v.endScale=1,v.type=2}else l.push(t.underpokercards[o]);t.underpokercards=l}else if(3<=u[s].index){for(S=0;S<t.playerboard.length;S++){if(T=!1,t.playerboard[S].getComponent("OFCPlayerBoardRender").userid!=e.userid){var k=t.playerboard[S].getComponent("OFCPlayerBoardRender").seatid,w=t.calcDcardIndex(m,g,k,e.dcard.length);T=t.playerboard[S].getComponent("OFCPlayerBoardRender").checkRobeCard(u[s].mine,null!=e.dcard?e.dcard[w]:-1)}T&&((C=t.game.pokerpool.get()).getComponent("HHCard").setCard(u[s].mine),C.getComponent("HHCard").order(),v.card=C,v.startX=t.playerboard[S].x+t.playerboard[S].getComponent("OFCPlayerBoardRender").pokertag.x+t.playerboard[S].getComponent("OFCPlayerBoardRender").minescard.x,v.startY=t.playerboard[S].y+t.playerboard[S].getComponent("OFCPlayerBoardRender").pokertag.y+t.playerboard[S].getComponent("OFCPlayerBoardRender").minescard.y,v.startScale=.8,C.setPosition(v.startX,v.startY),C.parent=t.root(),C.setScale(v.startScale,v.startScale),v.endX=f,v.endY=b,v.endScale=.5,v.type=3)}if(t.notReplay&&"no"==cc.global.amObserve){var T=!1,P=t.calcDcardIndex(m,g,0,e.dcard.length);(T=t.game.checkRobeCard(u[s].mine,null!=e.dcard?e.dcard[P]:-1))&&((C=t.game.pokerpool.get()).getComponent("HHCard").setCard(u[s].mine),C.getComponent("HHCard").order(),_.card=C,_.startX=t.game.minescard.x,_.startY=t.game.minescard.y,_.startScale=.6,C.setPosition(_.startX,_.startY),C.parent=t.root(),C.setScale(_.startScale,_.startScale),_.endX=f,_.endY=b,_.endScale=.5,_.type=3)}}else if(0==u[s].index&&null!=(r=t.getPlayerBoard(e.userid).getLastCard())){var x=(v.card=r).position;v.startX=d.node.x+d.pokertag.x+d.cardspanel.x+x.x,v.startY=d.node.y+d.pokertag.y+d.cardspanel.y+x.y,v.startScale=.8,r.parent=t.root(),r.rotation=0,r.getComponent("HHCard").setCard(u[s].mine),r.getComponent("HHCard").order(),r.setPosition(v.startX,v.startY),r.setScale(v.startScale,v.startScale),v.endX=f,v.endY=b,v.endScale=.6,a=!(v.type=0)}null!=v.card&&i.push(v),null!=_.card&&i.push(_)}null!=i&&t.moveEatCard(t,i,0,u,e,a)}if(e.score){"no"==cc.global.amObserve&&t.notReplay&&e.score[cc.global.user.id]&&t.game.setMineScore(e.score[cc.global.user.id]);for(var S=0;S<t.playerboard.length;S++)e.score[t.playerboard[S].getComponent("OFCPlayerBoardRender").userid]&&t.playerboard[S].getComponent("OFCPlayerBoardRender").setMineScore(e.score[t.playerboard[S].getComponent("OFCPlayerBoardRender").userid])}}null==e.open&&null==e.open||(t.remaincardspanel.children[0].getComponent("HHCard").setCard(e.open),t.remaincardspanel.children[0].getComponent("HHCard").setParent(t,!1,!0,!0),t.remaincardspanel.children[0].getComponent("HHCard").order()),cc.global.user.id==e.userid&&t.notReplay?(t.selectedCards.slice(0,t.selectedCards.length),t.game.stopTimer()):t.getPlayerBoard(e.userid).getComponent("OFCPlayerBoardRender").stopTimer(),e.nextid==e.userid&&(cc.global.seriable=!0),cc.global.user.id==e.nextid&&t.notReplay?(cc.global.myTurn=!0,t.game.playtimer(t.game,e.timer,!0)):null!=e.nextid&&t.getPlayerBoard(e.nextid).getComponent("OFCPlayerBoardRender").playtimer(t.game,e.timer),t.reduceRemainCard(t),t.resetMinesCards(t),t.toggleCardsState()}},takeCard_MyMove:function(e,t,i,a,s){var r=e.game.pokerpool.get();r.getComponent("HHCard").setCard(t[i].mine),r.getComponent("HHCard").order(),a.card=r,a.startX=e.playerboard[s].x+e.playerboard[s].getComponent("OFCPlayerBoardRender").pokertag.x+e.playerboard[s].getComponent("OFCPlayerBoardRender").minescard.x,a.startY=e.playerboard[s].y+e.playerboard[s].getComponent("OFCPlayerBoardRender").pokertag.y+e.playerboard[s].getComponent("OFCPlayerBoardRender").minescard.y,a.startScale=.8,r.setPosition(a.startX,a.startY),r.parent=e.root(),r.setScale(a.startScale,a.startScale),a.endX=e.game.minescard.x,a.endY=e.game.minescard.y,a.endScale=.5,a.type=3},takeCard_OtherMove:function(e,t,i,a,s){var r=e.game.pokerpool.get(),n=e.getPlayerBoard(s.userid),o=n.node.x+n.pokertag.x+n.minescard.x,l=n.node.y+n.pokertag.y+n.minescard.y;r.getComponent("HHCard").setCard(t[i].mine),r.getComponent("HHCard").order(),a.card=r,a.startX=e.game.minescard.x,a.startY=e.game.minescard.y,a.startScale=.6,r.setPosition(a.startX,a.startY),r.parent=e.root(),r.setScale(a.startScale,a.startScale),a.endX=o,a.endY=l,a.endScale=.5,a.type=3},takeCard_MyMove1:function(e,t,i,a,s,r){var n=e.getPlayerBoard(r.userid),o=n.node.x+n.pokertag.x+n.minescard.x,l=n.node.y+n.pokertag.y+n.minescard.y,c=e.game.pokerpool.get();c.getComponent("HHCard").setCard(t[i].mine),c.getComponent("HHCard").order(),a.card=c,a.startX=e.playerboard[s].x+e.playerboard[s].getComponent("OFCPlayerBoardRender").pokertag.x+e.playerboard[s].getComponent("OFCPlayerBoardRender").minescard.x,a.startY=e.playerboard[s].y+e.playerboard[s].getComponent("OFCPlayerBoardRender").pokertag.y+e.playerboard[s].getComponent("OFCPlayerBoardRender").minescard.y,a.startScale=.8,c.setPosition(a.startX,a.startY),c.parent=e.root(),c.setScale(a.startScale,a.startScale),a.endX=o,a.endY=l,a.endScale=.5,a.type=3},throwd_event:function(e,t){var i=0;t.lasttime>cc.global.logintime&&(i=t.lasttime-cc.global.logintime),(!i||i<0)&&(i=0),3e3<i&&(i=3e3);var a=t.decode(e.extdata.free);cc.global.audio.playEffectAud("out_card"),cc.global.myTurn=!1,cc.global.seriable=!1,cc.global.user.id==e.userid&&t.notReplay?(t.selectedCards.slice(0,t.selectedCards.length),t.game.stopTimer()):t.getPlayerBoard(e.userid).getComponent("OFCPlayerBoardRender").stopTimer(),cc.global.user.id==e.extdata.nextid&&t.notReplay?(cc.global.myTurn=!0,t.game.playtimer(t.game,e.extdata.timer,!0)):t.getPlayerBoard(e.extdata.nextid).getComponent("OFCPlayerBoardRender").playtimer(t.game,e.extdata.timer),t.moveRemainOpenCard(t,t.underCardPanel.position,a[a.length-1]),setTimeout(function(){t.cleanUnderCard(t),t.resetUnderCard(t,a)},i+200),t.showRemainCardCount(t),t.reduceRemainCard(t),t.resetMinesCards(t),t.toggleCardsState()},moveRemainOpenCard:function(e,t,i){if(0<e.lastcardlist){var a=e.game.pokerpool.get(),s=cc.callFunc(function(e,t){t.game&&(t.upon.getComponent("HHCard").init(),t.game.pokerpool.put(t.upon))},e,{game:e.game,self:e,upon:a});a.getComponent("HHCard").setCard(i),a.getComponent("HHCard").order(),a.setPosition(e.remaincardspanel.parent.x,e.remaincardspanel.parent.y),a.setScale(.6,.6),a.parent=e.root();var r=cc.sequence(cc.spawn(cc.moveTo(.2,t.x,t.y),cc.scaleTo(.2,.5,.5)).easing(cc.easeSineInOut(3)),s);a.runAction(r)}},showRemainCardCount:function(e){e.remaincardspanel.children[0].getComponent("HHCard").init(),e.remaincardcount.string=e.lastcardlist,0<e.lastcardlist?(e.remaincardcount.node.active=!0,e.remaincardspanel.active=!0):(e.remaincardcount.node.active=!1,e.remaincardspanel.active=!1),e.lastcardlist&&0<e.lastcardlist?e.remaincardback.active=!0:e.remaincardback.active=!1},reduceRemainCard:function(e){e.lastcardlist--,e.remaincardcount.string=e.lastcardlist+"",e.lastcardlist<=0&&(e.remaincardspanel.active=!1,e.remaincardcount.node.active=!1,e.remaincardback.active=!1)},resultcards_event:function(e,t){t.game.stopTimer();for(var i=0;i<t.playerboard.length;i++)t.playerboard[i].getComponent("OFCPlayerBoardRender").stopTimer();for(var a=0;a<e.extdata.list.length;a++){var s=e.extdata.list[a];if(s.cards)if(s.userid==cc.global.user.id&&t.notReplay){if(s.answer){for(var r=t.decode(s.answer),n=0;n<t.pokercards.length;n++)0<=r.indexOf(t.pokercards[n].getComponent("HHCard").card)&&(t.pokercards[n].getComponent("HHCard").touched=!0);0<=r.indexOf(t.underpokercards[0].getComponent("HHCard").card)&&(t.underpokercards[0].getComponent("HHCard").touched=!0)}t.game.showCardSum(s.fsum,!!s.answer)}else{var o=t.getPlayerBoard(s.userid);if(o){if(o.setCards(t.decode(s.cards)),s.answer){var l=t.decode(s.answer);for(n=0;n<o.cardspanel.children.length;n++)0<=l.indexOf(o.cardspanel.children[n].getComponent("HHCard").card)&&(o.cardspanel.children[n].getComponent("HHCard").touched=!0);0<=l.indexOf(t.underpokercards[0].getComponent("HHCard").card)&&(t.underpokercards[0].getComponent("HHCard").touched=!0)}o.showCardSum(s.fsum,!!s.answer)}}}},toggleCardsState:function(){if("no"==cc.global.amObserve&&this.notReplay){for(var e=0;e<this.poker.children.length;e++){var t=this.poker.children[e].getComponent("HHCard");t.unselected(),cc.global.is_ptn_room||(t.touched=!cc.global.myTurn||cc.global.myTurn&&cc.global.seriable)}this.game&&this.game.toggleMineCardsState()}if(!cc.global.is_ptn_room)for(var i=0;i<this.playerboard.length;i++)if(this.playerboard[i]){var a=this.playerboard[i].getComponent("OFCPlayerBoardRender");a&&a.toggleCardsState()}},onToggleSetting:function(){var i=this;this.closeOpenWin(),cc.loader.loadRes("prefab/main/ThemeSelectDialog",cc.Prefab,function(e,t){e||(cc.global.openwin=cc.instantiate(t),cc.global.openwin.getComponent("ThemeSelectDialog").init(i),cc.global.openwin.parent=i.root())})},onToggleSound:function(){var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));e=!e,cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(e)),e?(this.soundbtn.children[0].active=!1,this.soundbtn.children[1].active=!0,cc.global.audio.playBGM("bgm_card"),cc.audioEngine.resumeAll()):(this.soundbtn.children[0].active=!0,this.soundbtn.children[1].active=!1,cc.audioEngine.pauseAll())},onChangeTheme:function(){var e=this;null!=e.hideSetting&&clearTimeout(e.hideSetting),e.hideSetting=setTimeout(function(){e.onToggleSetting()},3e3),e.curTheme=e.changeGameTheme(),e.changeTheme(e.curTheme,!0)},changeTheme:function(e,t){},onThemeChanged:function(e){cc.sys.localStorage.setItem("card_game_theme",JSON.stringify(cc.global.theme)),this.background.children[0].active=1==cc.global.theme.background,this.background.children[1].active=2==cc.global.theme.background,this.background.children[2].active=3==cc.global.theme.background,this.remaincardback&&2<this.remaincardback.children.length&&(this.remaincardback.children[0].active=1==cc.global.theme.background,this.remaincardback.children[1].active=2==cc.global.theme.background,this.remaincardback.children[2].active=3==cc.global.theme.background),this.remaincardspanel.children[0].emit("theme-changed");for(var t=0;t<this.underCardPanel.children.length;t++)this.underCardPanel.children[t]&&this.underCardPanel.children[t].emit("theme-changed");if(this.poker){for(t=0;t<this.poker.children.length;t++)this.poker.children[t]&&this.poker.children[t].emit("theme-changed");if(cc.global.theme.card_size,this.game&&this.game.node.emit("theme-changed"),this.player)for(t=0;t<this.player.length;t++)this.player[t].emit("theme-changed");if(this.playerboard)for(t=0;t<this.playerboard.length;t++)this.playerboard[t].emit("theme-changed")}}}),cc._RF.pop()},{Deck:"Deck",HHCommon:"HHCommon"}],OFCButton:[function(e,t,i){"use strict";cc._RF.push(t,"b7e83maFzdA348zIQzYMzZY","OFCButton");var a=e("HHCommon");cc.Class({extends:a,properties:{helpdlg:{default:null,type:cc.Prefab},setting:{default:null,type:cc.Prefab}},onLoad:function(){},start:function(){},onClickHelp:function(){cc.global.openwin=cc.instantiate(this.helpdlg),cc.global.openwin.getComponent("HelpDialog").init(this,3),cc.global.openwin.parent=this.root()},onSettingClick:function(){cc.global.openwin=cc.instantiate(this.setting),cc.global.openwin.parent=this.root(),cc.global.openwin.getComponent("SettingDialog").init()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],OFCDataBind:[function(s,e,t){"use strict";cc._RF.push(e,"84252zBV2JBa5QXtxrCO6LG","OFCDataBind");var i=s("HHCommon");cc.Class({extends:i,properties:{player:{default:null,type:cc.Prefab},playerboard:{default:null,type:cc.Prefab},poker:{default:null,type:cc.Prefab},poker_min:{default:null,type:cc.Prefab},myself:{default:null,type:cc.Prefab},catchbtn:{default:null,type:cc.Node},timer:{default:null,type:cc.Node},timer_num:{default:null,type:cc.Label},lastcards:{default:null,type:cc.Node},playbtn:{default:null,type:cc.Node},notallow:{default:null,type:cc.Node},operesult:{default:null,type:cc.Node},donottake:{default:null,type:cc.Node},cardtipmsg:{default:null,type:cc.Node},timerplaynum:{default:null,type:cc.Label},callx2btn:{default:null,type:cc.Node},callx4btn:{default:null,type:cc.Node},redpig:{default:null,type:cc.Node},board_rank:{default:null,type:cc.Node},catchclock:{default:null,type:cc.Node},playclock:{default:null,type:cc.Node},getcard:{default:null,type:cc.Node},minescard:{default:null,type:cc.Node},catch_Timer:{default:null,type:cc.Node},catchTimerNum:{default:null,type:cc.Label},betGold:{default:null,type:cc.Label},scorenum:{default:null,type:cc.Label}},onLoad:function(){this.hasRP=!1,this.isRedTeam=!1,this.callRank=0,this.timer&&(this.timer.active=!1),this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.redpig.active=!1),this.playbtn&&(this.playbtn.active=!1),this.notallow&&(this.notallow.active=!1),this.operesult&&(this.operesult.active=!1),this.cardtipmsg&&(this.cardtipmsg.active=!1),(this.dizhu_databind_context=this).playerspool=new cc.NodePool,this.playerboardpool=new cc.NodePool,this.myselfpool=new cc.NodePool,this.pokerpool=new cc.NodePool,this.minpokerpool=new cc.NodePool,this.minescards=new Array,this.myselfpool,this.selectedcards=new Array,this.cardslist=new Array;for(var e=0;e<8;e++)this.playerspool.put(cc.instantiate(this.player)),this.playerboardpool.put(cc.instantiate(this.playerboard));for(e=0;e<25;e++)this.pokerpool.put(cc.instantiate(this.poker));for(e=0;e<60;e++)this.minpokerpool.put(cc.instantiate(this.poker_min));this.myselfpool.put(cc.instantiate(this.myself)),this.ready()&&(this.pva_format(cc.global.user.goldcoins,cc.global.user.cards,0,cc.global.user.championexp,this),this.pvalistener(this,function(e){e.pva_format(cc.global.user.goldcoins,cc.global.user.cards,0,cc.global.user.championexp,e)})),this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged()},addSelfPlayer:function(e,t){0<this.myselfpool.size()&&null!=cc.global&&(this.playermysql=this.myselfpool.get(),this.playermysql.parent=e.selfobj,this.playermysql.setPosition(-366,180),this.playermysql.active=!0,this.playermysql.getComponent("OFCPlayerRender").initplayer(e,t,0,!1,!1))},giveContext:function(e){this.playermysql.getComponent("OFCPlayerRender").giveContext(e)},changeStageInfo:function(e){this.playermysql.getComponent("OFCPlayerRender").changeStageInfo(e)},showRoomNumber:function(e){this.playermysql.getComponent("OFCPlayerRender").showRoomNumber(e)},updateCareerAfterMatch:function(e){this.betGold.string=0,this.playermysql.getComponent("OFCPlayerRender").updateCareerAfterMatch(e)},updateBalanceData:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.betGold.string=this.numformat(parseInt(t)),this.playermysql.getComponent("OFCPlayerRender").updateBalanceData(e,t)},setRedTeam:function(e,t){this.playermysql.getComponent("OFCPlayerRender").setRedTeam(e,t)},setBoardRank:function(){for(var e=0;e<this.board_rank.children.length;e++)this.board_rank.children[e].active=!1;0<this.callRank&&(this.board_rank.children[this.callRank-1].active=!0)},hideBoardRank:function(){for(var e=0;e<this.board_rank.children.length;e++)this.board_rank.children[e].active=!1},pva_format:function(e,t,i,a,s){},showBanker:function(){!(0<arguments.length&&void 0!==arguments[0])||arguments[0]},catchresult:function(e){this.timer&&(this.timer.active=!1),this.catchbtn&&(this.catchbtn.active=!1),this.playbtn&&(this.playbtn.active=!1),this.timesrc&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc),this.showCatchResult(e)},showCallStat:function(e){this.playermysql.getComponent("OFCPlayerRender").showCallStat(e)},hideresult:function(){this.operesult&&(this.operesult.active=!1)},lasthands:function(){this.catchbtn&&(this.catchbtn.active=!0),this.operesult&&(this.operesult.active=!1)},hideBanker:function(){this.playermysql&&this.playermysql.getComponent("OFCPlayerRender").hideBanker()},hideResultPlayBtn:function(){this.result&&(this.result.active=!1),this.playbtn&&(this.playbtn.active=!1)},lasttakecards:function(e,t,i,a){for(this.hideResultPlayBtn(),this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.redpig.active=!1),this.jsq&&(this.jsq.active=!1),this.lastcards&&(this.lastcards.active=!0),this.timesrc&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc),s=0;s<this.cardslist.length;s++)this.pokerpool.put(this.cardslist[s]);if(this.cardslist.splice(0,this.cardslist.length),null!=a)for(var s=0;s<a.length;s++)this.playcards(t,s,a[s],a);else this.showPassLastTakes();this.repositionLastCards()},showKickPopBalloon:function(e){this.playermysql.getComponent("OFCPlayerRender").showKickPopBalloon(e)},cardtips:function(e,t,i){for(var a,s=0;s<e.pokercards.length;s++){var r=e.pokercards[s];if(r.getComponent("HHCard").card==t){a=r;break}}null!=a&&a.getComponent("HHCard").doselect()},cardtipsfornot:function(e,t){t.cardtipmsg.active=!0,setTimeout(function(){t.cardtipmsg.active=!1},1e3),t.unselected(e,t)},unselected:function(e){for(var t=0;t<e.pokercards.length;t++){var i=e.pokercards[t];if(i){var a=i.getComponent("HHCard");a&&a.unselected()}}},playcards:function(e,t,i,a){this.hideCardSum();for(var s,r=0;r<e.pokercards.length;r++){var n=e.pokercards[r];if(n.card==i){s=n;break}}null!=s&&(s.getComponent("HHCard").unselected(),s.touched=!1,s.x=24*t,s.y=0,s.parent=this.lastcards,this.countcard(i,a),s.zIndex=t,s.setScale(.55,.55),this.cardslist.push(s))},countcard:function(e,t){for(var i=parseInt(e/4),a=0,s=0;s<t.length;s++)i==parseInt(t[s]/4)&&(a+=1);return a},stopTimer:function(){this.rtgametimer&&this.timesrc&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc)},playtimer:function(e,t,i){3<arguments.length&&void 0!==arguments[3]&&arguments[3],this.timesrc&&this.rtgametimer.stoptimer(this,this.timer,this.timesrc),this.timer&&(this.timer.active=!0),this.lastcards&&(this.lastcards.active=!1),this.operesult&&(this.operesult.active=!1),this.catchbtn&&(this.catchbtn.active=!0);var a=s("GameTimer");this.rtgametimer=new a,this.timesrc=this.rtgametimer.runtimer(this,this.timer_num.node.parent,this.atlas,this.timer_num,this.timer_num,t),this.canTouch=!0,0!=cc.global.turnIndex&&this.timerEffect(this.timer,1,.1,1),cc.global.turnIndex=0},showCatchResult:function(e){var t=this;this.operesult.active=!0;for(var i=0;i<this.operesult.children.length;i++)this.operesult.children[i].active=!1;switch(parseInt(e.myratio)){case 1:this.operesult.children[1].active=!0;break;case 2:this.operesult.children[2].active=!0;break;case 3:this.operesult.children[3].active=!0;break;case 4:this.operesult.children[4].active=!0}setTimeout(function(){t.hideresult()},2e3)},showPassLastTakes:function(){},doSelectCard:function(e){null==this.selectedcards.find(function(e){e.card})&&this.selectedcards.push(e)},doUnSelectCard:function(e){var t=this.selectedcards.indexOf(e);0<=t&&this.selectedcards.splice(t,1)},clean:function(e){if(this.catchbtn&&(this.catchbtn.active=!1,this.callx2btn.active=!1,this.callx4btn.active=!1,this.redpig.active=!1),this.lastcards&&(this.lastcards.active=!1),this.operesult&&(this.operesult.active=!1),this.hideBoardRank(),"no"==cc.global.amObserve&&this.playermysql){var t=this.playermysql.getComponent("OFCPlayerRender");t&&(t.hideCallStat(),t.clean(e),t.parent.is_ptn_room||t.removeTeamMark())}},cleanCards:function(e){for(var t=0;t<this.cardslist.length;t++)this.pokerpool.put(this.cardslist[t]);this.cardslist.splice(0,this.cardslist.length),this.lastcards&&(this.lastcards.active=!1),this.operesult&&(this.operesult.active=!1)},restart:function(){this.hideCardSum(),this.hideBoardRank(),this.playerspool.clear(),this.playerboardpool.clear();for(var e=0;e<8;e++)this.playerspool.put(cc.instantiate(this.player)),this.playerboardpool.put(cc.instantiate(this.playerboard));for(this.pokerpool.clear(),this.minpokerpool.clear(),t=0;t<25;t++)this.pokerpool.put(cc.instantiate(this.poker));for(var t=0;t<60;t++)this.minpokerpool.put(cc.instantiate(this.poker_min));this.myselfpool.active=!0},disChPos:function(e){},disChSitPos:function(e){},disChEffectPos:function(){},disUserCharacter:function(){},showEmoticon:function(e){this.playermysql&&this.playermysql.getComponent("OFCPlayerRender")&&this.playermysql.getComponent("OFCPlayerRender").showEmoticon(e)},showCallPlayer:function(e,t){this.playermysql&&this.playermysql.getComponent("OFCPlayerRender")&&this.playermysql.getComponent("OFCPlayerRender").showCallPlayer(e,t)},onClickEmoticon:function(){this.playermysql&&this.playermysql.getComponent("OFCPlayerRender")&&this.playermysql.getComponent("OFCPlayerRender").onClickEmoticon()},speech:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";if(this.playermysql){var t=this.playermysql.getComponent("OFCPlayerRender");t&&t.speech(e)}},changeTheme:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;this.curTheme=e,this.playermysql.getComponent("OFCPlayerRender").changeTheme(e,!0)},initTheme1:function(){},initTheme2:function(){},repositionLastCards:function(){if(this.lastcards&&0!=this.lastcards.children.length)if(2==this.curTheme)this.lastcards.width=24*(this.lastcards.children.length-1)+109;else if(1==this.curTheme){var e=6<=this.lastcards.children.length?6:this.lastcards.children.length;this.lastcards.width=24*(e-1)+109}},addMinesCard:function(e,t){for(var i=0;i<t.length;i++)this.minescard.active=!0,this.minescards.push(t[i]),this.minescard.children[0].getComponent("HHCard").setCard(t[i]),this.minescard.children[0].getComponent("HHCard").setParent(e,!1,!1,!1),this.minescard.children[0].getComponent("HHCard").order()},addMineCard:function(e,t){this.minescard.active=!0,this.minescards.push(t),this.minescard.children[0].getComponent("HHCard").setCard(t),this.minescard.children[0].getComponent("HHCard").setParent(e,!1,!1,!1),this.minescard.children[0].getComponent("HHCard").order(),this.toggleMineCardsState()},removeMinesCard:function(e){e<54?(this.minescard.children[0].getComponent("HHCard").setCard(e),this.minescard.children[0].getComponent("HHCard").order(),this.minescard.active=!0):(this.minescard.children[0].getComponent("HHCard").init(),this.minescard.active=!1)},toggleMineCardsState:function(){this.minescard.children[0].getComponent("HHCard").touched=cc.global.myTurn},checkRobeCard:function(e,t){var i=!1;return e==this.minescard.children[0].getComponent("HHCard").card&&(i=!0),i&&this.removeMinesCard(t),i},setMineScore:function(e){this.minescard.children[1].getComponent(cc.Label).fontSize=40,this.minescard.children[1].getComponent(cc.Label).string=e+"pt"},showMineData:function(e,t,i){0<i?(this.minescard.active=!0,this.minescard.children[0].getComponent("HHCard").setCard(t),this.minescard.children[0].getComponent("HHCard").setParent(e,!1,!1,!1),this.minescard.children[0].getComponent("HHCard").order(),this.minescard.children[1].getComponent(cc.Label).string=i+"pt"):this.minescard.active=!1},showCardSum:function(e,t){this.scorenum.string=e,this.scorenum.node.active=!0,this.scorenum.node.color=t?cc.hexToColor("#FE5E36"):cc.hexToColor("#FFFFFF")},hideCardSum:function(){this.scorenum.node.active=!1},resetMinesCard:function(){this.minescard.children[0].getComponent("HHCard").selected=!1},onThemeChanged:function(e){this.playermysql&&this.playermysql.emit("theme-changed")}},"toggleMineCardsState",function(){cc.global.is_ptn_room||(this.minescard.children[0].getComponent("HHCard").touched=cc.global.myTurn)}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],OFCPlayerBoardRender:[function(s,e,t){"use strict";cc._RF.push(e,"58b198I+5VMGpPa8E29L66K","OFCPlayerBoardRender");var i=s("HHCommon");cc.Class({extends:i,properties:{dizhu:{default:null,type:cc.Node},callstat:{default:null,type:cc.Node},pokertag:{default:null,type:cc.Node},pokercards:{default:null,type:cc.Label},timer:{default:null,type:cc.Node},jsq:{default:null,type:cc.Node},amready:{default:null,type:cc.Node},catchplayresult:{default:null,type:cc.Node},timer_num:{default:null,type:cc.Label},result:{default:null,type:cc.Node},lastcards:{default:null,type:cc.Node},cannot:{default:null,type:cc.Node},donot:{default:null,type:cc.Node},resultx2:{default:null,type:cc.Node},resultx4:{default:null,type:cc.Node},resultx6:{default:null,type:cc.Node},cardbg:{default:null,type:cc.Prefab},cardspanel:{default:null,type:cc.Node},quality:!0,lt:{default:null,type:cc.Node},boardRemainCards:cc.Array,catchcall:0,minescard:{default:null,type:cc.Node},scorenum:{default:null,type:cc.Label},isTurn:{default:!1},timerFlag:{default:!1}},onLoad:function(){this.cardcount=0,this.cardslist=new Array,this.isRight=!1,this.remaincards=new Array,this.isFirstTheme=!0,this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged()},initplayer:function(e,t,i,a){this.parent=e,this.playerSlotPos3=e.playerSlotPos3,this.playerSlotPos4=e.playerSlotPos4,this.curTheme=e.curTheme,this.userdata=t,this.userid=t.id,this.isRight=a,this.minescards=[],this.getCards=[],this.seatid=i,cc.global.is_ptn_room,this.jsq&&(this.jsq.active=!1),this.catchplayresult.active=!0,this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.changeTheme(this.curTheme)},updateCareerAfterMatch:function(e){this.userdata.goldcoins=e.gold,this.goldcoins.string=this.numformat(e.gold+e.diamond),this.userdata.nickname.indexOf("Com")<0&&(this.userdata.record.matchcount=e.totalmatches,this.userdata.record.win=e.winmatches,this.userdata.record.loss=e.lossmatches,this.userdata.record.draw=e.drawmatches,this.userdata.record.normalrank=e.normalrank,this.userlevel.string=this.numformat(e.normalrank)+"th")},countcards:function(e){this.cardcount=this.cardcount+e,this.resetcards(this.cardcount)},setCards:function(e){for(var t=0;t<e.length&&!(t>=this.cardspanel.children.length);t++){var i=this.cardspanel.children[t].getComponent("HHCard");i.setCard(e[t]),i.order()}this.getCards=e},resetcards:function(e){this.cardspanel.removeAllChildren();this.parent.notReplay;if(0<(this.cardcount=e)){if(this.isRight)for(a=0;a<e;a++){var t=cc.instantiate(this.cardbg);t.parent=this.cardspanel,t.children[4].scaleX=-1,1!=this.seatid||this.parent.is_ptn_room||(t.children[4].rotation=0,t.children[4].scaleX*=-1),this.parent.is_ptn_room&&(1!=this.seatid&&2!=this.seatid||(t.children[4].rotation=-90,t.children[4].scaleX*=-1))}else for(a=0;a<e;a++){var i=cc.instantiate(this.cardbg);i.parent=this.cardspanel,0!=this.seatid||this.is_ptn_room||(i.children[4].rotation=0),this.parent.is_ptn_room&&(6!=this.seatid&&7!=this.seatid||(i.children[4].rotation=-90))}for(var a=0;a<this.cardspanel.children.length;a++)this.cardspanel.children[a].children[4].getComponent(cc.Label).string=""}0<this.cardspanel.children.length?this.showCardsPanel():this.cleanCards()},cleanCards:function(){this.cardspanel.active=!1},cleanLastCards:function(e){if(0<this.cardslist.length){for(var t=0;t<this.cardslist.length;t++)e.minpokerpool.put(this.cardslist[t]);this.cardslist.splice(0,this.cardslist.length)}this.lastcards&&(this.lastcards.active=!1),this.kick&&(this.kick.active=!1),this.pop&&(this.pop.active=!1),this.donot&&(this.donot.active=!1),this.cannot&&(this.cannot.active=!1)},showCardsPanel:function(){this.cardspanel.active=!0},catchtimer:function(e){this.jsq&&(this.jsq.active=!0),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1);var t=s("GameTimer");this.rtgametimer=new t,this.timesrc=this.rtgametimer.runtimer(this,this.jsq,this.atlas,this.timer_num,this.timer_num,e)},showBanker:function(){},showCallStat:function(e){switch(parseInt(e)){case 1:this.callstat.children[0].active=!0;break;case 2:this.callstat.children[1].active=!0;break;case 3:this.callstat.children[2].active=!0}},hideCallStat:function(){this.callstat.children[0].active=!1,this.callstat.children[1].active=!1,this.callstat.children[2].active=!1},pauseTimer:function(){this.rtgametimer&&this.rtgametimer.pauseTimer(this,this.jsq,this.timesrc)},resumeTimer:function(){this.rtgametimer&&(this.timesrc=this.rtgametimer.resumeTimer(this,this.jsq,this.timer_num))},stopTimer:function(){this.rtgametimer&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),this.isTurn=!1,0==cc.global.myTurn&&this.toggleBackCardState()},catchresult:function(e,t){var i=this;if(this.rtgametimer){if(this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),0<e.myratio)switch(this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),parseInt(e.myratio)){case 0:this.catchcall=0;break;case 1:this.result&&(this.result.active=!0),this.catchcall=1;break;case 2:this.resultx2&&(this.resultx2.active=!0,this.showEffectOfComponent(this.resultx2)),this.catchcall=2;break;case 3:this.resultx4&&(this.resultx4.active=!0,this.showEffectOfComponent(this.resultx4)),this.catchcall=3;break;case 4:this.resultx6&&(this.resultx6.active=!0,this.showEffectOfComponent(this.resultx6)),this.catchcall=4}else this.donot&&(this.donot.active=!1),this.catchcall=0;setTimeout(function(){i.hideresult()},2e3)}},hideresult:function(){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1)},lasthands:function(e,t,i){this.hideresult(),this.rtgametimer&&this.timesrc&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),this.userid==i.userid&&this.playtimer(t,i.timer)},hideBanker:function(){},setRedTeam:function(e){if(!e)return this.avatar_outline.color=new cc.Color(255,0,0),void(this.info_outline.color=new cc.Color(255,0,0));this.userid==e.userid?(this.avatar_outline.color=new cc.Color(255,0,0),this.info_outline.color=new cc.Color(255,0,0)):(this.avatar_outline.color=new cc.Color(255,255,255),this.info_outline.color=new cc.Color(255,255,255))},removeTeamMark:function(){this.avatar_outline.color=new cc.Color(255,255,255),this.info_outline.color=new cc.Color(255,255,255)},lasttakecards:function(e,t,i,a,s){var r=this.parent.notReplay;if(this.rtgametimer&&this.timesrc&&this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.jsq&&(this.jsq.active=!1),this.lastcards&&(this.lastcards.active=!0),0<this.cardslist.length){for(n=0;n<this.cardslist.length;n++)e.minpokerpool.put(this.cardslist[n]);this.cardslist.splice(0,this.cardslist.length)}if(r?this.resetcards(i):(this.boardRemainCards=[],s&&""!=s.playercards&&null!=s.playercards?(this.boardRemainCards=this.decode(s.playercards),this.resetcards(this.boardRemainCards.length,this.boardRemainCards),this.setCards(this.boardRemainCards)):this.resetcards(0)),null!=a)for(var n=0;n<a.length;n++)this.playcards(e,n,a[n],a);else this.tipdonot();this.repositionLastCards()},tipcannot:function(){this.cannot&&(this.cannot.active=!0),this.donot&&(this.donot.active=!1)},tipdonot:function(){this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!0)},playcards:function(e,t,i,a){var s=e.minpokerpool.get();s.parent=this.lastcards,this.cardslist.push(s);var r=s.getComponent("HHCard");r.setCard(i),r.order()},countcard:function(e,t){return parseInt(e/4)},playtimer:function(e,t){this.stopTimer(),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.lastcards&&(this.lastcards.active=!1);for(var i=0;i<this.cardslist.length;i++)e.minpokerpool.put(this.cardslist[i]);var a=s("GameTimer");this.rtgametimer=new a,this.timesrc=this.rtgametimer.runtimer(this,this.jsq,this.atlas,this.timer_num,this.timer_num,t),0==cc.global.myTurn&&this.toggleBackCardState(),cc.global.turnIndex!=this.seatid&&this.timerEffect(this.jsq,1,.1,1),cc.global.turnIndex=this.seatid,this.isTurn=!0},clean:function(e){for(var t=this.catchcall=0;t<this.cardslist.length;t++)e.minpokerpool.put(this.cardslist[t]);this.jsq&&(this.jsq.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.cardcount=0},giveContext:function(e){this.dizhucontxt=e},changeStageInfo:function(e){var t=this.getLanguageText("BOARD_SCORE"),i=": "+e;this.box_stageinfo.string=t+i},showRoomNumber:function(e){var t=this.getLanguageText("ROOM_0");this.box_roominfo.string=e+t},showEffectOfComponent:function(e){e.children[0].active=!0;var t=e.children[0].getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"tongqian",!1),cc.global.audio.playEffectAud("call"),setTimeout(function(){e&&e.children&&e.children[0]&&(e.children[0].active=!1)},1500)},display:function(e){for(var t=" [",i=0;i<e.length;i++)t=t+e[i]+" , ";t+="]"},changeTheme:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;this.curTheme=e;for(var t=0;t<this.cardspanel.children.length;t++){var i=this.cardspanel.children[t].getComponent("HHCard");i&&i.changeTheme(e)}},initTheme1:function(){},initTheme2:function(){},repositionLastCards:function(){if(this.lastcards){for(var e=[],t=0;t<this.lastcards.children.length;t++)this.lastcards.children[t].getComponent("HHCard")&&e.push(1);if(2==this.curTheme)this.lastcards.width=300,1!=this.seatid&&0!=this.seatid||(this.lastcards.width=26*this.lastcards.children.length+64);else if(1==this.curTheme){this.lastcards.width=210;var i=6<=this.lastcards.children.length?6:this.lastcards.children.length;1!=this.seatid&&0!=this.seatid||(this.lastcards.width=26*i+56,0==this.seatid&&(this.lastcards.y=6<i?100:70))}}},addMineCard:function(e,t){this.minescard.active=!0,this.minescards.push(t),this.minescard.children[0].getComponent("HHCard").init(),this.minescard.children[0].getComponent("HHCard").setCard(t),this.minescard.children[0].getComponent("HHCard").setParent(e,!1,!1,!0),this.minescard.children[0].getComponent("HHCard").order()},addMinesCard:function(e,t){for(var i=0;i<t.length;i++)this.minescard.active=!0,this.minescards.push(t[i]),this.minescard.children[0].getComponent("HHCard").setCard(t[i]),this.minescard.children[0].getComponent("HHCard").setParent(e,!1,!1,!0),this.minescard.children[0].getComponent("HHCard").order()},removeMinesCard:function(e){e<54?(this.minescard.children[0].getComponent("HHCard").setCard(e),this.minescard.children[0].getComponent("HHCard").order(),this.minescard.active=!0):(this.minescard.children[0].getComponent("HHCard").init(),this.minescard.active=!1)},resetMinesCard:function(){this.minescard.children[0].getComponent("HHCard").selected=!1},checkRobeCard:function(e,t){var i=!1;return!!this.minescard.active&&(e==this.minescard.children[0].getComponent("HHCard").card&&(i=!0,this.removeMinesCard(t)),i)},setMineScore:function(e){this.minescard.children[1].getComponent(cc.Label).string=e+"pt"},showMineData:function(e,t,i){0<i?(this.minescard.active=!0,this.minescard.children[0].getComponent("HHCard").setCard(t),this.minescard.children[0].getComponent("HHCard").setParent(e,!1,!1,!0),this.minescard.children[0].getComponent("HHCard").order(),this.minescard.children[1].getComponent(cc.Label).string=i+"pt"):this.minescard.active=!1},getLastCard:function(){return this.cardspanel.children[this.cardspanel.children.length-1]},countcardsForReplay:function(e,t){var i=[];this.cardcount+=e,this.resetcards(this.cardcount);for(var a=0;a<this.getCards.length;a++){for(var s=!1,r=0;r<t.length;r++)this.getCards[a]==t[r]&&(s=!0);s||i.push(this.getCards[a])}this.setCards(i)},fold_event:function(){var e=cc.instantiate(this.cardspanel);e.setPosition(this.node.x+this.pokertag.x+this.cardspanel.x,this.node.y+this.pokertag.y+this.cardspanel.y),e.parent=this.parent.root(),this.resetcards(0);var t=cc.callFunc(function(e,t){e.destroy()},e,{}),i=cc.sequence(cc.spawn(cc.moveTo(.2,0,0),cc.scaleTo(.2,.6,.6),cc.rotateTo(.2,60)),t);e.runAction(i)},showCardSum:function(e,t){this.scorenum.string=e,this.scorenum.node.active=!0,this.scorenum.node.color=t?cc.hexToColor("#FE5E36"):cc.hexToColor("#FFFFFF")},hideCardSum:function(){this.scorenum.node.active=!1},toggleCardsState:function(){for(var e=0;e<this.minescard.children.length;e++){var t=this.minescard.children[e].getComponent("HHCard");t&&(t.unselected(),cc.global.is_ptn_room||(t.touched=this.isTurn))}},toggleBackCardState:function(){for(var e=0;e<this.cardspanel.children.length;e++){var t=this.cardspanel.children[e].getComponent("HHCard");t&&(t.unselected(),cc.global.is_ptn_room)}},onThemeChanged:function(){for(var e=0;e<this.cardspanel.children.length;e++)this.cardspanel.children[e]&&this.cardspanel.children[e].emit("theme-changed")}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],OFCPlayerRender:[function(i,e,t){"use strict";cc._RF.push(e,"479c2upo9JPcpl3bcbWo22n","OFCPlayerRender");var a=i("HHCommon");cc.Class({extends:a,properties:{username:{default:null,type:cc.Label},goldcoins:{default:null,type:cc.Label},freeicon:{default:null,type:cc.Node},dizhu:{default:null,type:cc.Node},callstat:{default:null,type:cc.Node},avatar:{default:null,type:cc.Sprite},btncharacter:{default:null,type:cc.Node},avatar_outline:{default:null,type:cc.Node},info_outline:{default:null,type:cc.Node},userinfonode:{default:null,type:cc.Node},userinfo:{default:null,type:cc.Prefab},userinfopan:{default:null,type:cc.Node},userbaseinfo:{default:null,type:cc.Node},leave:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},bet:{default:null,type:cc.Node},betgold:{default:null,type:cc.Label},catchcall:0,amready:{default:null,type:cc.Node}},onLoad:function(){this.isRight=!1,this.isFirstTheme=!0,this.isOpenRed=!1,this.node.on("theme-changed",this.onThemeChanged,this),this.onThemeChanged()},initplayer:function(e,t,i,a){var s=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];this.playerSlotPos3=e.playerSlotPos3,this.playerSlotPos4=e.playerSlotPos4,this.parent=e,this.curTheme=e.curTheme,this.seatidx=i,this.userdata=t,cc.global.user.id,t.id,this.username.string=t.nickname,this.userid=t.id,this.playcharacter=t.playcharacter,this.avatarurl=t.avatarurl,this.seatid=i,this.loadAvatar(t.avatarurl,t.gender),1==(this.isRight=a)||(this.userid,cc.global.user.id),1==i||0==i&&cc.global.amObserve,6!=i&&7!=i||(this.userinfopan.x=this.userinfopan.x-10,this.userinfonode.x=this.userinfonode.x-10),3!=this.playcharacter&&4!=this.playcharacter||s&&(this.btncharacter.y+=20),this.jsq&&(this.jsq.active=!1),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(t.goldcoins))),this.goldcoins.node.parent.getComponent(cc.Label)&&(this.goldcoins.node.parent.getComponent(cc.Label).string=this.numformat(parseInt(t.goldcoins))),this.parent.is_ptn_room,this.goldcoins.node.parent.active=!0,this.changeTheme(this.curTheme)},updateBalance:function(){this.goldcoins.node.parent.getComponent(cc.Label)&&(this.goldcoins.node.parent.getComponent(cc.Label).string=this.numformat(parseInt(this.userdata.goldcoins))),this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},updateBalanceData:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(e))),this.betgold&&(this.betgold.string=this.numformat(parseInt(t))),this.goldcoins.node.parent.getComponent(cc.Label)&&(this.goldcoins.node.parent.getComponent(cc.Label).string=this.numformat(parseInt(e)))},updateCareerAfterMatch:function(e){this.userdata.goldcoins=e.gold,this.goldcoins.string=this.numformat(e.gold)},catchtimer:function(e){this.jsq&&(this.jsq.active=!0),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1);var t=i("GameTimer");this.rtgametimer=new t,this.timesrc=this.rtgametimer.runtimer(this,this.jsq,this.atlas,this.timer_num,this.timer_num,e)},showBanker:function(){},showCallStat:function(e){switch(parseInt(e)){case 1:this.callstat.children[0].active=!0;break;case 2:this.callstat.children[1].active=!0;break;case 3:this.callstat.children[2].active=!0}},hideCallStat:function(){this.callstat.children[0].active=!1,this.callstat.children[1].active=!1,this.callstat.children[2].active=!1},catchresult:function(e,t){if(this.rtgametimer)if(this.rtgametimer.stoptimer(this,this.jsq,this.timesrc),e.docatch){switch(this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),parseInt(e.myratio)){case 0:this.cannot&&(this.cannot.active=!0),this.catchcall=0;break;case 1:this.resultx2&&(this.resultx2.active=!0,this.showEffect(0)),this.catchcall=1;break;case 2:this.resultx4&&(this.resultx4.active=!0,this.showEffect(1)),this.catchcall=2;break;case 3:this.resultx6.active=!0,this.showEffect(2),this.catchcall=3}this.showCallStat(e.myratio)}else this.catchcall=0,this.result&&(this.result.active=!1),this.cannot&&!t&&(this.cannot.active=!0),this.donot&&(this.donot.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1)},showKickPopBalloon:function(e){},hideresult:function(){this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1)},hideBanker:function(){},setRedTeam:function(e){},setTeamPartner:function(e){},removeTeamMark:function(){},hideLeaveReq:function(){this.leave.active=!1},clean:function(e){this.parent.is_ptn_room||(this.info_outline.color=new cc.Color(255,255,255)),this.jsq&&(this.jsq.active=!1),this.result&&(this.result.active=!1),this.resultx2&&(this.resultx2.active=!1),this.resultx4&&(this.resultx4.active=!1),this.resultx6&&(this.resultx6.active=!1),this.cannot&&(this.cannot.active=!1),this.donot&&(this.donot.active=!1),this.takecards&&(this.takecards.active=!1),this.cardcount=0,this.catchcall=0},onClickMe:function(){"no"==cc.global.amObserve&&this.parent.game.onClickEmoticon()},onClickDisInfo:function(){this.onclickCallPlayer()},disLeaveReq:function(e){this.leave.active=e},showCallPlayer:function(e,t){cc.global.audio.playVoiceChatWithType(this.playcharacter,t);var i=this;this.hideCallPlayer(),this.callplayer.children[0].children[0].getComponent(cc.Label).string=e,i.callplayer.active=!0,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i.callplayer.active=!1},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer);this&&this.showCallPlayerObj&&(this.showCallPlayerObj.active=!1,this.showCallPlayerObj.destroy(),this.showCallPlayerObj=null),this.callplayer.active=!1},onclickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userid},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){this.dizhucontxt.onClickEmoticon()},onClickChat:function(){this.dizhucontxt.onclickChat()},onClickLobbyList:function(){this.dizhucontxt.onclickUserlist()},giveContext:function(e){this.dizhucontxt=e},speech:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=this.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)},changeTheme:function(e,t){this.curTheme=e},initTheme1:function(){},initTheme2:function(){},onThemeChanged:function(e){1==cc.global.theme.background||2==cc.global.theme.background?this.avatar_outline.getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("head_frame"+cc.global.theme.background):this.avatar_outline.getComponent(cc.Sprite).spriteFrame=cc.global.pokerAtlas2.getSpriteFrame("head_frame3")}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],OFCSummaryDetail:[function(e,t,i){"use strict";cc._RF.push(t,"68d05s0EdZDi7z9o/tRKXSs","OFCSummaryDetail");var a=e("HHCommon");cc.Class({extends:a,properties:{workitem:{default:null,type:cc.Node},myscore:{default:null,type:cc.Label},myexpscore:{default:null,type:cc.Label},mycareer:{default:null,type:cc.Label},myscoretype:{default:null,type:cc.Node},player_1_score:{default:null,type:cc.Label},player_1_expscore:{default:null,type:cc.Label},player_1_career:{default:null,type:cc.Label},player_1_scoretype:{default:null,type:cc.Node},player_2_score:{default:null,type:cc.Label},player_2_expscore:{default:null,type:cc.Label},player_2_career:{default:null,type:cc.Label},player_2_scoretype:{default:null,type:cc.Node},player_3_score:{default:null,type:cc.Label},player_3_expscore:{default:null,type:cc.Label},player_3_career:{default:null,type:cc.Label},player_3_scoretype:{default:null,type:cc.Node},player_4_score:{default:null,type:cc.Label},player_4_expscore:{default:null,type:cc.Label},player_4_career:{default:null,type:cc.Label},player_4_scoretype:{default:null,type:cc.Node},player_5_score:{default:null,type:cc.Label},player_5_expscore:{default:null,type:cc.Label},player_5_career:{default:null,type:cc.Label},player_5_scoretype:{default:null,type:cc.Node},player_6_score:{default:null,type:cc.Label},player_6_expscore:{default:null,type:cc.Label},player_6_career:{default:null,type:cc.Label},player_6_scoretype:{default:null,type:cc.Node},player_7_score:{default:null,type:cc.Label},player_7_expscore:{default:null,type:cc.Label},player_7_career:{default:null,type:cc.Label},player_7_scoretype:{default:null,type:cc.Node},mygetout:{default:null,type:cc.Node},player1getout:{default:null,type:cc.Node},player2getout:{default:null,type:cc.Node},player3getout:{default:null,type:cc.Node},player4getout:{default:null,type:cc.Node},player5getout:{default:null,type:cc.Node},player6getout:{default:null,type:cc.Node},player7getout:{default:null,type:cc.Node},base:{default:null,type:cc.Node},win:{default:null,type:cc.Node},draw:{default:null,type:cc.Node},lose:{default:null,type:cc.Node},effect:cc.Node},onLoad:function(){this.disDialogEffect(this.base);var t=this;this.workitem.on("getout",function(e){cc.global.backToHall=!0,cc.global.user.roomid="",t.parent.loadding(),t.parent.rerenderPlayers=[],t.parent.isOnSummary=!1,t.parent.scene("hall",t.parent),e.stopPropagation()}),1==cc.global.game_theme_idx?(this.node.children[2].children[0].active=!0,this.node.children[2].children[1].active=!1):(this.node.children[2].children[0].active=!1,this.node.children[2].children[1].active=!0),this.node.height*=cc.global.narrowContentRatio;var e=this;this.iswin=!1,this.effect.getComponent(sp.Skeleton).setCompleteListener(function(){e.iswin?e.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_winloop",!0):e.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_loseloop",!0)})},summaryPos:function(e,t,i){var a=cc.p(0,0);switch(t){case 0:1==i&&(a=cc.pSub(e.playerSlotPos4[i],cc.v2(0,60)));break;case 1:a=cc.pSub(e.playerSlotPos3[i-1],cc.v2(0,60));break;case 2:a=cc.pSub(e.playerSlotPos4[i-1],cc.v2(0,60))}return a},create:function(e,t,i){var a=this;this.parent=e,this.obsmode=i;var s=4500,r=5e3;this.parent.is_ptn_room&&(s=4e3,r=4500);for(var n=0;n<t.players.length;n++){var o=t.players[n];if(o.userid==cc.global.user.id&&"no"==cc.global.amObserve)this.disLevelInfo(o),this.process(o,null,this.myscore,this.myexpscore,null,null,this.mycareer,this.myscoretype),o.getout?setTimeout(function(){a&&a.node&&a.node.dispatchEvent(new cc.Event.EventCustom("getout",!0))},s):setTimeout(function(){a&&a.node&&(a.parent.restart(),a.parent&&a.parent.summarypage&&a.parent.summarypage.destroy(),a.parent.summarypage=null)},r);else if(this.parent.is_ptn_room)switch(e.getPlayer(o.userid).seatidx){case 0:this.process(o,null,this.myscore,this.myexpscore,null,this.mygetout,this.mycareer,this.myscoretype);break;case 1:this.process(o,null,this.player_1_score,this.player_1_expscore,null,this.player1getout,this.player_1_career,this.player_1_scoretype);break;case 2:this.process(o,null,this.player_2_score,this.player_2_expscore,null,this.player2getout,this.player_2_career,this.player_2_scoretype);break;case 3:this.process(o,null,this.player_3_score,this.player_3_expscore,null,this.player3getout,this.player_3_career,this.player_3_scoretype);break;case 4:this.process(o,null,this.player_4_score,this.player_4_expscore,null,this.player4getout,this.player_4_career,this.player_4_scoretype);break;case 5:this.process(o,null,this.player_5_score,this.player_5_expscore,null,this.player5getout,this.player_5_career,this.player_5_scoretype);break;case 6:this.process(o,null,this.player_6_score,this.player_6_expscore,null,this.player6getout,this.player_6_career,this.player_6_scoretype);break;case 7:this.process(o,null,this.player_7_score,this.player_7_expscore,null,this.player7getout,this.player_7_career,this.player_7_scoretype)}else switch(e.getPlayer(o.userid).seatidx){case 0:this.process(o,null,this.myscore,this.myexpscore,null,this.mygetout,this.mycareer,this.myscoretype);break;case 1:this.player_1_score.node.parent.setPosition(a.summaryPos(e,cc.global.gameCond,e.getPlayer(o.userid).seatidx)),this.process(o,null,this.player_1_score,this.player_1_expscore,null,this.player1getout,this.player_1_career,this.player_1_scoretype);break;case 2:this.player_2_score.node.parent.setPosition(a.summaryPos(e,cc.global.gameCond,e.getPlayer(o.userid).seatidx)),this.process(o,null,this.player_2_score,this.player_2_expscore,null,this.player2getout,this.player_2_career,this.player_2_scoretype);break;case 3:this.player_3_score.node.parent.setPosition(a.summaryPos(e,cc.global.gameCond,e.getPlayer(o.userid).seatidx)),this.process(o,null,this.player_3_score,this.player_3_expscore,null,this.player3getout,this.player_3_career,this.player_3_scoretype)}}"yes"==cc.global.amObserve&&setTimeout(function(){a&&a.node&&a.parent.summarypage&&(a.parent.restart(),a.parent.summarypage.destroy(),a.parent.summarypage=null)},r)},process:function(e,t,i,a,s,r,n,o){i.node.parent.active=!0,0<=e.score?i.string="+ "+this.numformat(e.score):i.string="- "+this.numformat(-1*e.score),0<=e.exp?a.string="+ "+this.numformat(e.exp):a.string="- "+this.numformat(Math.abs(e.exp)),null!=r&&(r.active=e.getout),"normal"==cc.global.user.selplayway?(o.children[0].active=!0,o.children[1].active=!1):"diamond"==cc.global.user.selplayway&&(o.children[0].active=!1,o.children[1].active=!0)},disLevelInfo:function(e){this.win.active=!1,this.draw.active=!1,this.lose.active=!1,this.effect.active=!1,this.iswin=2==e.win,2==e.win?(this.effect.active=!0,this.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_win",!1),cc.global.audio.playSummaryAud("win")):(1==e.win?this.draw.active=!0:(this.effect.active=!0,this.effect.getComponent(sp.Skeleton).setAnimation(0,"dzz_cj_lose",!1)),cc.global.audio.playSummaryAud("lose"))},onLeaveClick:function(){this.parent.onclickBack()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],Observer:[function(e,t,i){"use strict";cc._RF.push(t,"884541vseREErp92V+W/jU3","Observer");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},nickname:{default:null,type:cc.Label},callplayer:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},vipcrown:{default:null,type:cc.Node},crownlist:{default:null,type:cc.Node},vipbadge:{default:null,type:cc.Node},viplevel:{default:null,type:cc.Label},userinfodlg:{default:null,type:cc.Prefab},index:0},init:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;2<arguments.length&&void 0!==arguments[2]&&arguments[2],this.data=e,this.parent=t,e&&e.nickname&&(this.nickname.node.active=!0,this.nickname.string=e.nickname,this.loadAvatar(e.avatarurl,e.gender)),this.right=!1},onClick:function(){if(this.ready()){if(cc.global.user.id==this.data.id)return void(this.parent&&this.parent.onClickEmoticon());var e=this.socket(),t={};t.extparams={callplayer:this.data.id},e.exec("callplayer",t)}},onClickDisInfo:function(){},showCallPlayer:function(e,t){if(cc.global.audio.playVoiceChatWithType(this.data.playcharacter,t),this.callplayer){var i=this;this.hideCallPlayer(),this.callplayer.active=!0,this.right?(this.callplayer.scaleX=-1,this.callplayer.children[0].scaleX=-1,this.callplayer.children[0].anchorX=1):(this.callplayer.scaleX=1,this.callplayer.children[0].scaleX=1,this.callplayer.children[0].anchorX=0),this.callplayer.children[0].x=-23.2,this.callplayer.children[0].children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)}},hideCallPlayer:function(){this.callplayer&&(this.unschedule(this.hideCallPlayer),this.callplayer.active=!1)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],OnetBegin:[function(e,t,i){"use strict";cc._RF.push(t,"ce1030bQJZJWrE9prUsxZXX","OnetBegin");var a=e("HHCommon"),s=null;cc.Class({extends:a,properties:{selfuser:{default:null,type:cc.Node},opponentuser:{default:null,type:cc.Node},opponentboard:{default:null,type:cc.Node},selfboard:{default:null,type:cc.Node},onet_player:{default:null,type:cc.Prefab},onet_player_board:{default:null,type:cc.Prefab},overlay:{default:null,type:cc.Node},roomdata:{default:null,type:cc.Node},pandata:{default:null,type:cc.Node},statistics:{default:null,type:cc.Node},totalmatches:{default:null,type:cc.Node},stargained:{default:null,type:cc.Node},diamondgained:{default:null,type:cc.Node},senddata:{default:null,type:cc.Node},hintcount:{default:null,type:cc.Label},bombcount:{default:null,type:cc.Label},btnbomb:{default:null,type:cc.Node},btnhint:{default:null,type:cc.Node},btntiletheme:{default:null,type:cc.Node},btndualgiveup:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},observer:{default:null,type:cc.Prefab},observerbench:{default:null,type:cc.Node},emodlg:{default:null,type:cc.Prefab},chat:{default:null,type:cc.Prefab},chatsearch:{default:null,type:cc.Prefab},userinfodlg:{default:null,type:cc.Prefab},btn_enter:{default:null,type:cc.Node},btn_record_play:{default:null,type:cc.Node},lbl_record_status:{default:null,type:cc.Label},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},illegalconfirm:{default:null,type:cc.Prefab},btn_find_empty:{default:null,type:cc.Node},btn_replay_next_round:{default:null,type:cc.Node},btn_replay_prev_round:{default:null,type:cc.Node},roomrankdialog:{default:null,type:cc.Prefab},finishAct:{default:null,type:cc.Node},btnSfx:{default:null,type:cc.Node},multi:{default:null,type:cc.Node},orientation:{default:1,type:cc.Integer},userContainer:{default:null,type:cc.Node}},onLoad:function(){if(this.initEventCallback(),cc.game.setFrameRate(60),cc.global.amObserve="no",2==(s=this).orientation&&(this.userContainer.scaleX/=Math.max(.9,cc.global.narrowContentRatio),this.userContainer.scaleY/=Math.max(.9,cc.global.narrowContentRatio)),this.play_status=0,this.playerlist=new Array,this.playerboardlist=new Array,this.observerlist=new Array,this.posBaseIdx=0,this.inited=!1,this.notReplay=!0,this.startGameTimer=null,this.endGameTimer=null,this.krCacheArr=[],this.curRound=0,this.pangolds=0,this.hintCnt=0,this.bombCnt=0,this.isGamePlaying=!1,this.isNewRoom=!0,this.myHitBlockCount=0,this.otherEventCache=[],this.otherEventInvoker=null,this.newRoundTimer=null,this.reshuffleTimer=null,cc.global.isOffline){this.gameTower=[],this.cntremain=[72,72];for(var e=0;e<2;e++)this.gameTower[e]=[];for(e=0;e<2;e++)for(var t=0;t<3;t++)this.gameTower[e][t]=[];var i={command:"jr",cond:20,event:"command",game:"onet",id:"Onet",name:"normal",observerlist:[],playerlist:[{avatarurl:cc.global.user.avatarurl,exp:0,explevel:0,gender:0,goldcoins:cc.global.user.goldcoins,id:cc.global.user.id,nickname:cc.global.user.nickname,playcharacter:1,rank:0,seatid:0,texp:0,viplevel:0,vipscore:0},{avatarurl:"",exp:0,explevel:0,gender:0,goldcoins:1e4,id:0,nickname:this.getLanguageText("AI_PLAYER_0"),playcharacter:1,rank:0,seatid:1,texp:0,viplevel:0,vipscore:0}],players:2,playway:"onet",score:1};this.joinroom_event(i,this)}null!=cc.global&&(this.initgame(),""!=cc.global.user.roomid&&(this.recovery(),this.isNewRoom=!1)),this.setEtcKeyBoardEvent(),this.scheduler=cc.director.getScheduler(),cc.global.watchReplayData.onReplay&&this.prepareReplay(),cc.global.audio.playBGM("bgm_onet")},initgame:function(){var t=this,e=this.socket();this.finishAct&&(this.finishAct.active=!1),this.map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("play",this.play_event),this.map("ctema",this.theme_event),this.map("rer",this.recovery_event),this.map("selemoticon",this.emoticon_event),this.map("sendchat",this.sendchat_event),this.map("callplayer",this.callplayer_event),this.map("oer",this.oercache_event),this.map("rnum",this.remainpairs_event),this.map("sl",this.sendlines_event),this.map("hintre",this.hintresult_event),this.map("disturb",this.bombresult_event),this.map("reshuffle",this.rscache_event),this.map("allcards",this.allcards_event),this.map("startrecordresult",this.startrecord_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)});var i={};switch(cc.global.user.roomInType){case"NormalCreate":null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i);break;case"NormalJoin":i.extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i);break;case"NormalObserve":i.extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i)}var a=this.btnSfx,s=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==s&&(s=!0),a&&(s?(a.children[0].active=!0,a.children[1].active=!1):(a.children[0].active=!1,a.children[1].active=!0)),this.inited=!0,cc.global.isOffline||this.loadding()},recovery:function(){this.goRecovery=!0,this.isGamePlaying=!1,this.socket().exec("rer",{})},prepareReplay:function(){this.notReplay=!1,this.btnbomb.parent.active=!1,cc.global.amObserve="yes",this.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),this.replay_bar.active=!0,this.replayStep="ready_room",this.replaySeq=0,this.replayPrevCmd="",this.goReplay()},stopAllClock:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("OnetPlayerBoard");t&&t.stopClock()}},resumeAllClock:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("OnetPlayerBoard");t&&t.resumeClock()}},pauseReplayTimer:function(){this.stopAllClock(),clearTimeout(this.replayTimer)},resumeReplayTimer:function(){this.resumeAllClock(),this.goReplay()},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):(this.replayTimer&&clearTimeout(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.btn_replay_next_round.active=this.btn_replay_prev_round.active=!1,this.replay_bar.children[0].opacity=100,this.pauseReplayTimer())},cleanAllPlayers:function(){if(this.playerlist&&!(this.playerlist.length<=0)){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].destroy(),this.playerboardlist[e].destroy();this.playerlist.splice(0,this.playerlist.length),this.playerboardlist.splice(0,this.playerboardlist.length),this.playerlist=new Array,this.playerboardlist=new Array,this.selfuser&&(this.selfuser.destroyAllChildren(),this.selfuser.removeAllChildren()),this.opponentuser&&(this.opponentuser.destroyAllChildren(),this.opponentuser.removeAllChildren()),this.opponentboard&&(this.opponentboard.destroyAllChildren(),this.opponentboard.removeAllChildren()),this.selfboard&&(this.selfboard.destroyAllChildren(),this.selfboard.removeAllChildren())}},replayEventProcess:function(){if(this.play_history){switch(this.replayTimeDelay=0,this.replayStep){case"ready_room":this.cleanAllPlayers(),this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var e=JSON.parse(this.play_history[this.replaySeq]);switch(e.command){case"play":"play"!=this.replayPrevCmd&&this.play_event(e,this);break;case"ctema":this.theme_event(e,this);break;case"oer":this.tilematch_event(e,this),this.replayTimeDelay+=400;break;case"rnum":this.remainpairs_event(e,this);break;case"reshuffle":this.reshuffle_event(e,this),this.replayTimeDelay+=400;break;case"sl":this.sendlines_event(e,this);break;case"hintre":this.hintresult_event(e,this);break;case"disturb":this.bombresult_event(e,this);break;case"allcards":this.allcards_event(e,this);break;case"callplayer":this.callplayer_event(e,this);break;case"selemoticon":this.emoticon_event(e,this);break;case"sendchat":this.sendchat_event(e,this);break;case"jr":this.joinroom_event(e,this);break;case"players":this.players_event(e,this)}this.replayPrevCmd=e.command}this.play_history[this.replaySeq+1]&&""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay+=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2}},goReplay:function(){var e=this;this.replayEventProcess(),this.play_history[this.replaySeq]?this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay):(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.btn_replay_next_round.active=this.btn_replay_prev_round.active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.replayPrevCmd="",this.pauseReplayTimer())},setEtcKeyBoardEvent:function(){var i=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e,t){switch(e){case cc.KEY.space:i.processReadyState();break;case cc.KEY.escape:case cc.KEY.back:if(!i.isemoticon&&!i.ischat)return void i.onclickBack();i.isemoticon&&(null!=i.emoticonpage&&i.emoticonpage.destroy(),i.isemoticon=!1),i.ischat&&(null!=i.chatpage&&i.chatpage.destroy(),i.ischat=!1)}}},i.node)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;0<=e&&(this.socket().exec("selemoticon",{extparams:{emoticon:e}}),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1))},onCtrlKeyDown:function(e){112==e.keyCode?this.getHR(!0):17==e.keyCode?this.getHR(!1):32==e.keyCode?this.processReadyState():115==e.keyCode&&this.changePosition()},getHR:function(e){},joinroom_event:function(e,t){if(cc.global.user.selplayway=e.name,t.roomid=e.id,t.panScore=cc.global.curPlaywayScore=e.score,cc.global.isOffline&&1==cc.global.isOffline)t.roomdata.getComponent(cc.Label).string=t.getLanguageText("TRAINING_ROOM_0");else{var i=t.getLanguageText("ROOM_0"),a=t.getLanguageText("SCORE_0");t.roomdata.getComponent(cc.Label).string=e.id+i+" ("+t.numformat(e.score)+a+")"}switch(cc.global.gamestatus){case"ready":cc.global.gamestatus="waiting",2==e.playerlist.length&&(cc.global.gamestatus="playing"),t.players_event(e,t);break;case"waiting":t.players_event(e,t);break;case"playing":cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)}e.hisdata?t.showMatchCareer(e.hisdata):t.hideMatchCareer(),"yes"==cc.global.amObserve?t.btnbomb.active=t.btntiletheme.active=t.btndualgiveup.active=t.btnhint.active=!1:(t.btnbomb.active=t.btntiletheme.active=t.btndualgiveup.active=t.btnhint.active=!0,cc.global.isOffline&&(t.btndualgiveup.active=!1)),t.drawroot(),t.closeloadding()},players_event:function(e,t){e.msg&&(cc.global.outReasonMsg=e.msg),2==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)if(e.observerlist[a].id==cc.global.user.id){i=!1;break}i&&t.notReplay?t.exitPlay():(t.observer_event(e,t),t.isBoardPlayersChanged(e.playerlist)&&(t.startGameTimer&&(clearTimeout(t.startGameTimer),t.startGameTimer=null),t.endGameTimer&&(clearTimeout(t.endGameTimer),t.endGameTimer=null),t.players_engine(e,t)))},players_engine:function(e){this.removeBoardPlayers(e.playerlist);for(var t=this.posBaseIdx,i=0;i<e.playerlist.length;i++){if(e.playerlist[i].seatid=i,"no"==cc.global.amObserve&&e.playerlist[i].id!=cc.global.user.id&&(t=1-this.posBaseIdx),this.playerexist(e.playerlist[i])){var a=this.getPlayer(e.playerlist[i].id),s=this.getPlayerBoard(e.playerlist[i].id);a.seatid=s.seatid=t%2,a.layoutForSeat(),s.layoutForSeat()}else{var r=cc.instantiate(this.onet_player),n=cc.instantiate(this.onet_player_board);"yes"!=cc.global.amObserve?e.playerlist[i].id==cc.global.user.id?(r.parent=this.selfuser,n.parent=this.selfboard):(r.parent=this.opponentuser,n.parent=this.opponentboard):this.selfuser.children.length<1?(r.parent=this.selfuser,n.parent=this.selfboard):(r.parent=this.opponentuser,n.parent=this.opponentboard),r.getComponent("OnetPlayer").init(this,e.playerlist[i],t%2,i),this.playerlist.push(r),n.getComponent("OnetPlayerBoard").init(this,e.playerlist[i],t%2,i),this.playerboardlist.push(n)}t++}1==e.playerlist.length?(this.setWaitingState(),this.cleanAfterAllCards()):2==e.playerlist.length&&this.setReadyState(),this.btn_enter&&("yes"==cc.global.amObserve&&e.playerlist.length<2?1==cc.global.championMode?this.btn_enter&&(this.btn_enter.active=!1):0==cc.global.championMode&&this.notReplay&&this.btn_enter&&(this.btn_enter.active=!0):this.btn_enter&&(this.btn_enter.active=!1)),this.showWaitingTimer()},observer_event:function(e,t){t.observerbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i],t),a.getComponent("Observer").nickname.node.active=!1,a.parent=t.observerbench,t.observerlist[i]=a}},processCacheEvent:function(){null!=s&&null!=s&&s.otherCacheEvent()},otherCacheEvent:function(){if(null!=s&&null!=s&&null!=s.otherEventCache&&null!=s.otherEventCache&&s.isGamePlaying&&0!=s.otherEventCache.length){var e=s.otherEventCache[0];if(e){switch(e.cmd){case"oer":s.tilematch_event(e.data,s);break;case"reshuffle":s.reshuffle_event(e.data,s)}s.otherEventCache.shift()}!cc.global.isOffline&&"no"==cc.global.amObserve&&10<=s.myHitBlockCount&&s.recovery()}},oercache_event:function(e,t){t.isGamePlaying&&(e.userid!=cc.global.user.id?t.otherEventCache.push({cmd:"oer",data:e}):t.myHitBlockCount=t.myHitBlockCount<=0?0:t.myHitBlockCount-1)},rscache_event:function(e,t){e.userid!=cc.global.user.id?t.otherEventCache.push({cmd:"reshuffle",data:e}):t.reshuffle_event(e,t)},tilematch_event:function(e,t){var i,a,s;"no"==cc.global.amObserve?e.userid!=cc.global.user.id?((a=t.getPlayerBoard(e.userid))&&a.showTileMatched(e.msg),(i=t.getPlayerBoard(cc.global.user.id))&&i.tileBlockAttack()):((i=t.getPlayerBoard(cc.global.user.id))&&i.showTileMatched(e.msg),(s=t.getOtherPlayerBoard(cc.global.user.id))&&s.tileBlockAttack()):((a=t.getPlayerBoard(e.userid))&&a.showTileMatched(e.msg),(s=t.getOtherPlayerBoard(e.userid))&&s.tileBlockAttack())},remainpairs_event:function(e,t){var i=t.getPlayerBoard(e.userid);i&&i.updateRemains(e.msg)},removeBoardPlayers:function(e){for(var t=0;t<this.playerlist.length;t++){for(var i=this.playerlist[t].getComponent("OnetPlayer"),a=!1,s=0;s<e.length;s++)if(i.userdata.id==e[s].id){a=!0;break}1!=a&&(this.playerlist[t].destroy(),this.playerlist.splice(t,1),this.playerboardlist[t].destroy(),this.playerboardlist.splice(t,1))}},isBoardPlayersChanged:function(e){if(0==this.playerlist.length&&0!=e.length)return!0;if(this.playerlist.length!=e.length)return!0;for(var t=0;t<e.length;t++)if(!this.getPlayer(e[t].id))return!0;return!1},playerexist:function(e){for(var t=0;t<this.playerlist.length;t++)if(null!=this.playerlist[t]&&this.playerlist[t].getComponent("OnetPlayer").userdata.id==e.id)return!0;return!1},onChangePosition:function(){"no"!=cc.global.amObserve&&(this.pauseReplayTimer(),this.play_history=[],this.changePosition(),this.prepareReplay())},changePosition:function(){if(0!=this.playerlist.length){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("OnetPlayer"),i=this.playerboardlist[e].getComponent("OnetPlayerBoard");t&&i&&(t.seatid=i.seatid=(t.seatid+1)%2,t.layoutForSeat(),i.layoutForSeat())}this.posBaseIdx=1-this.posBaseIdx}},showMatchCareer:function(e){},hideMatchCareer:function(){},setWaitingState:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("OnetPlayerBoard");t&&t.setState("Pending")}},setReadyState:function(){var e=this.getLanguageText("READY_0")+"?";if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("OnetPlayerBoard");i&&i.setState(e)}},sendState:function(){if(cc.global.isOffline){var e=this.getPlayerBoard(cc.global.user.id);if(e){var t=this.getLanguageText("PREPARED_0");e.setState(t)}this.makeData()}else this.playerlist.length<2||this.getPlayerBoard(cc.global.user.id).isReady()||this.socket().exec("ready",{extparams:{roomid:this.roomid}})},drawroot:function(){"normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway?(this.pandata.children[0].children[0].active=!0,this.pandata.children[0].children[1].active=!1):"diamond"==cc.global.user.selplayway&&(this.pandata.children[0].children[0].active=!1,this.pandata.children[0].children[1].active=!0)},userready_event:function(e,t){var i=t.getPlayerBoard(e.userid);if(i&&!i.isReady()){cc.global.audio.playEffectAud("ready");var a=t.getLanguageText("PREPARED_0");i.setState(a),i.startTimer(30)}},onClickSfx:function(){var e=this.btnSfx;if(e){var t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},updateHintCount:function(e){this.hintCnt=e},updateBombCount:function(e){this.bombCnt=e,this.bombcount.string=this.bombCnt},play_event:function(a,o){o.closeloadding();for(var e=0;e<o.playerboardlist.length;e++){if(i=o.playerboardlist[e].getComponent("OnetPlayerBoard")){i.hideRoundResult();var t=o.getLanguageText("PREPARED_0");i.setState(t)}}if(o.senddata.getComponent(cc.Label).string="0",o.showReadyTimer(),o.startGameTimer=setTimeout(function(){for(var e=0;e<a.players.length;e++){a.players[e].playuser==cc.global.user.id&&(o.updateHintCount(a.players[e].hint),o.updateBombCount(a.players[e].bomb));var t=o.getPlayerBoard(a.players[e].playuser);t&&(t.setTowerPieces(a.players[e].alltowers,a.players[e].remains,a.players[e].move),a.players[e].expiry&&!isNaN(a.players[e].expiry)?t.setClock(parseInt(a.players[e].expiry/1e3)-3):t.setClock(30),t.updateBombCount(a.players[e].bomb),cc.global.isOffline&&1==cc.global.isOffline&&t.updateRemains())}if(o.hideAllStatus(),o.isGamePlaying=!0,o.isNewRoom=!1,1==cc.global.curPlaywayScore){var i=3;a.bottime&&!isNaN(a.bottime)&&(i=parseFloat(a.bottime)),o.trainModeInterval&&clearInterval(o.trainModeInterval),o.trainModeInterval=setInterval(function(){if(o.isGamePlaying){var e=o.getOtherPlayerBoard(cc.global.user.id),t=o.getOtherPlayer(cc.global.user.id);if(e&&t){if(0<e.possibleMatches.length){var i=e.possibleMatches[0][0],a=e.possibleMatches[0][e.possibleMatches[0].length-1],s=10*i[0]+i[1],r=10*a[0]+a[1];if(cc.global.isOffline){var n={tc:s+"/"+r,botid:t.userdata.id};o.process_play(n)}else o.socket().exec("oe",{extparams:{tc:s+"/"+r,botid:t.userdata.id}})}}else clearInterval(o.trainModeInterval)}else clearInterval(o.trainModeInterval)},1e3*i)}},3e3),0==o.curRound&&o.sendlines_event({msg:0,extmsg:1},o),"no"==cc.global.amObserve){var i,s=JSON.parse(cc.sys.localStorage.getItem("rg_onet_tile_theme"));null==s&&(s=0),(i=o.getPlayerBoard(cc.global.user.id))&&i.setTileTheme(parseInt(s))}o.otherEventInvoker&&clearInterval(o.otherEventInvoker),o.otherEventInvoker=setInterval(o.processCacheEvent,410)},theme_event:function(e,t){var i=t.getPlayerBoard(e.userid);i&&i.setTileTheme(e.msg)},recovery_event:function(e,t){for(var i=0;i<e.players.length;i++){var a=t.getPlayerBoard(e.players[i].playuser);a&&(a.setTileTheme(e.players[i].tema),a.setTowerPieces(e.players[i].alltowers,e.players[i].remains,e.players[i].move),a.setClock(parseInt(e.players[i].expiry/1e3)),a.showRoundScore(),a.updateBombCount(e.players[i].bomb),e.players[i].playuser==cc.global.user.id&&(t.updateHintCount(e.players[i].hint),t.updateBombCount(e.players[i].bomb)))}t.sendlines_event({extmsg:2*e.ratio,msg:e.sendlines},t),t.hideAllStatus(),t.isGamePlaying=!0,t.closeloadding(),t.otherEventInvoker&&clearInterval(t.otherEventInvoker),t.otherEventCache=[],t.myHitBlockCount=0,t.otherEventInvoker=setInterval(t.processCacheEvent,410)},hideAllStatus:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("OnetPlayerBoard");t&&t.hideStatus()}},sendlines_event:function(e,t){var i=(""+e.msg).split(","),a=parseInt(i[0]);if(1<i.length){var s={userid:e.userid,msg:""+i[1]};t.oercache_event(s,t)}if(2<i.length){var r={userid:e.userid,msg:parseInt(i[2])};t.remainpairs_event(r,t)}t.senddata.getComponent(cc.Label).string=t.numformat(a);var n=parseInt(e.extmsg);if(0<n){2<=n&&(n/=2,40<=a&&(cc.global.audio.playEffectAud("charge"),t.showMultiAni()));var o=t.panScore*n,l=0;if("normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway)for(var c=0;c<t.playerlist.length;c++){var h=t.playerlist[c].getComponent("OnetPlayer");if(h){if(0==h.userdata.goldcoins)return;0==l?l=h.userdata.goldcoins:l>h.userdata.goldcoins&&(l=h.userdata.goldcoins)}}l<o&&(o=l),t.updateBetUpBalance(o),t.multiBetUp(o),t.pangolds=t.pangolds+2*o,t.pandata.children[1].getComponent(cc.Label).string=t.pangolds}},showMultiAni:function(){if(this.multi){var e=this;this.multi.active=!0;var t=this.multi.getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"play",!1),setTimeout(function(){e.multi.active=!1},2e3)}},multiBetUp:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("OnetPlayer");i&&i.betup.getComponent("TetrisBetUp").init(e,i.seatid,this.orientation)}},workOutMatchCareer:function(e){for(var t=0;t<e.players.length;t++){var i=this.getPlayer(e.players[t].userid),a=this.getPlayerBoard(e.players[t].userid);i&&a&&("normal"==cc.global.user.selplayway?0<e.players[t].score&&(this.matchCareerData.tgolds[i.userdata.id]+=e.players[t].score-this.pangolds/2):"diamond"==cc.global.user.selplayway&&0<e.players[t].score&&(this.matchCareerData.tdiamonds[i.userdata.id]+=e.players[t].score-this.pangolds/2),e.players[t].pig&&(this.matchCareerData.wins[i.userdata.id]++,i.userdata.id))}this.showMatchCareer(this.matchCareerData)},allcards_event:function(e,t){if(t.reshuffleTimer&&clearTimeout(t.reshuffleTimer),t.newRoundTimer&&clearTimeout(t.newRoundTimer),t.otherEventInvoker&&(clearInterval(t.otherEventInvoker),t.otherEventInvoker=null),t.otherEventCache=[],t.myHitBlockCount=0,t.isGamePlaying=!1,cc.global.isOffline){e.pig?this.runFinishAction("dzz_cj_win"):this.runFinishAction("dzz_cj_lose");for(var i=0;i<e.players.length;i++){var a=t.getPlayer(e.players[i].userid);(r=t.getPlayerBoard(e.players[i].userid))&&r.showRoundResult(e.players[i].pig)}setTimeout(function(){t.cleanAfterAllCards(),t.setReadyState()},2500)}else{var s=t.playerlist.length==e.players.length;t.matchCareerData&&t.workOutMatchCareer(e);for(i=0;i<e.players.length;i++){var r;a=t.getPlayer(e.players[i].userid);if(e.players[i].getout&&(s=!1),a&&("normal"==cc.global.user.selplayway&&(a.userdata.goldcoins=parseInt(e.players[i].gold)),a.summary(e.players[i])),(r=t.getPlayerBoard(e.players[i].userid))&&(r.showRoundResult(e.players[i].pig),"suicide"!=e.title||e.players[i].pig||(a=t.getPlayer(e.players[i].userid))&&a.showEmoticon(-1)),e.players[i].userid==cc.global.user.id)t.notRepla&&(cc.global.user.goldcoins=e.players[i].gold),e.players[i].pig?t.runFinishAction("dzz_cj_win"):t.runFinishAction("dzz_cj_lose")}t.bombCnt=0,s&&(t.endGameTimer=setTimeout(function(){t.cleanAfterAllCards(),t.setReadyState()},2500))}},cleanAfterAllCards:function(){this.senddata&&(this.senddata.getComponent(cc.Label).string="0"),this.pangolds=0,this.pandata.children[1].getComponent(cc.Label).string=this.pangolds;for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("OnetPlayerBoard");t&&(t.hideRoundResult(),t.hideRoundScore(),t.showPlayCharacter())}cc.global.amObserve&&"no"==cc.global.amObserve&&this.showWaitingTimer()},updateBetUpBalance:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("OnetPlayer");i&&(i.userdata.goldcoins-=e)}this.updatePlayerBalance()},updatePlayerBalance:function(){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("OnetPlayer");t&&t.updateBalance()}},showWaitingTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("OnetPlayerBoard");t&&t.startTimer(30)}},showReadyTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("OnetPlayerBoard");t&&t.startTimer(3)}},hideTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("OnetPlayerBoard");t&&t.stopTimer()}},hideCharacter:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("OnetPlayerBoard");t&&t.hidePlayCharacter()}},getPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("OnetPlayer");if(i.userdata.id==e)return i}},getOtherPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("OnetPlayer");if(i.userdata.id!=e)return i}},getPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("OnetPlayerBoard");if(i.userdata.id==e)return i}},getOtherPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("OnetPlayerBoard");if(i.userdata.id!=e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},showChatDialog:function(){this.onclickChat(0)},onclickChat:function(){if(cc.global.isOffline&&1==cc.global.isOffline)return null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.parent=this.node),void cc.global.opentoast.getComponent("ToastCtrl").init("","");if("no"==cc.global.amObserve){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}if(!(e<0)){this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root();var a=this.chatpage.getComponent("Chat");a.init(this,e),a.base.x=a.base.y=0,this.ischat=!0}}},onClickEmoticon:function(){if(cc.global.isOffline&&1==cc.global.isOffline)return null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.parent=this.node),void cc.global.opentoast.getComponent("ToastCtrl").init("","");if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),void(this.isemoticon=!1);this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root();var e=this.emoticonpage.getComponent("Emoticon");e.init(this,!1),e.base.x=e.base.y=0,this.isemoticon=!0},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase,a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg)},callplayer_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg);var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg,!0)},emoticon_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg);var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},startrecord_event:function(e,t){},hintresult_event:function(e,t){if(e.userid==cc.global.user.id){var i=t.panScore*Math.pow(2,t.hintCnt);t.spendGoldForLuck(Math.floor(i)),t.updateHintCount(t.hintCnt+1)}var a=t.decodeString(e.msg).split("-"),s=a[0],r=a[a.length-1];s=s.slice(1,s.length-1).split(","),r=r.slice(1,r.length-1).split(",");var n=10*parseInt(s[1])+parseInt(s[0]),o=10*parseInt(r[1])+parseInt(r[0]),l=t.getPlayerBoard(e.userid);l&&l.showHintCell(n,o)},bombresult_event:function(e,t){e.userid==cc.global.user.id&&(t.bombCnt--,t.updateBombCount(t.bombCnt),t.spendGoldForLuck(Math.floor(t.panScore)));var i=t.getOtherPlayerBoard(e.userid);i&&i.showBombAttack(),(i=t.getPlayerBoard(e.userid))&&i.bombUsed()},spendGoldForLuck:function(e){cc.global.user.goldcoins-=e;var t=this.getPlayer(cc.global.user.id);t&&t.spendGoldForLuck(e)},shuffle_arr:function(e){for(var t,i,a=e.length;a;t=Math.floor(Math.random()*a),i=e[--a],e[a]=e[t],e[t]=i);return e},reshuffleTower:function(e,t){for(var i=[],a=0;a<e.length;a++){var s=e[a];"0"!=s&&i.push(s)}if(i.sort(),4<i.length){var r=[];for(a=2;a<i.length;a++)r.push(i[a]);r=this.shuffle_arr(r);for(a=0;a<r.length;a++)i[a+2]=r[a]}var n="",o=0;for(a=0;a<e.length;a++){var l=e[a];n+="0"!=l?i[o++]:l}this.reshuffle_event({userid:t,msg:n,extmsg:0},this)},reshuffle_event:function(e,t){if(t.isGamePlaying&&t&&t.getPlayerBoard){var i=t.getPlayerBoard(e.userid);i&&(i.shuffleTower(e.msg,e.extmsg),i.hideNoMatch())}},onClickHint:function(){if(this.isGamePlaying){if(cc.global.isOffline&&1==cc.global.isOffline)return null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.parent=this.node),void cc.global.opentoast.getComponent("ToastCtrl").init("",".");var e=this.panScore*Math.pow(2,this.hintCnt);if(cc.global.user.goldcoins<e)return null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.parent=this.node),void cc.global.opentoast.getComponent("ToastCtrl").init("",".");var t=this;t.checkConfirm(""+e,function(){t.getPlayerBoard(cc.global.user.id)&&t.socket().exec("hint",{})},function(){},10)}},onClickBomb:function(){if(this.isGamePlaying){if(cc.global.isOffline&&1==cc.global.isOffline)return null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.parent=this.node),void cc.global.opentoast.getComponent("ToastCtrl").init("","");if(this.bombCnt<=0)return null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.parent=this.node),void cc.global.opentoast.getComponent("ToastCtrl").init("","Bomb");if(cc.global.user.goldcoins<this.panScore)return null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.parent=this.node),void cc.global.opentoast.getComponent("ToastCtrl").init("","");var i=this;i.checkConfirm(""+i.panScore,function(){var e=i.getPlayerBoard(cc.global.user.id),t=i.getOtherPlayerBoard(cc.global.user.id);e&&t.bombCleared&&(e.bombCleared=!1,i.socket().exec("disturb",{}))},function(){},10)}},onClickSwitchTheme:function(){if("no"==cc.global.amObserve){var e=this.getPlayerBoard(cc.global.user.id);e&&(e.changeTileTheme(),cc.sys.localStorage.setItem("rg_onet_tile_theme",JSON.stringify(e.tileTheme)))}},onClickGiveUp:function(){if(this.isGamePlaying){var e=this;cc.global.audio.playVoiceSpeech("support/12_give_up"),this.checkConfirm("",function(){e&&e.socket().exec("suicide",{})},null)}},onClickFindEmptyRoom:function(){var t=this;t.socket().exec("fnr",{}),cc.global.socket.on("fnr",function(e){t.alert(e.extmsg)})},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},onclickBack:function(){if(cc.global.isOffline)this.exitPlay();else if(this.ready()){var e=this;this.notReplay?this.isGamePlaying&&"no"==cc.global.amObserve&&1<cc.global.curPlaywayScore?(cc.global.audio.playVoiceSpeech("support/14_roomout"),this.checkConfirm("Are you sure to leave room? You will lose.",function(){e.socket().exec("leave",{})},null)):this.socket().exec("leave",{}):this.exitPlay()}},exitPlay:function(){var e=this;cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),null==this.exitTimer&&(this.exitTimer=setInterval(function(){e.finishAct&&!e.finishAct.active&&(clearInterval(e.exitTimer),e.exitTimer=null,e.returnToHall())},500))},processReadyState:function(){2==this.playerlist.length&&this.sendState()},runFinishAction:function(e){if("yes"!=cc.global.amObserve&&this.finishAct&&this.finishAct.getComponent(sp.Skeleton)){var t=cc.callFunc(this.enableFinishAni,this,e),i=cc.callFunc(this.disableFinishAni,this);this.node.runAction(cc.sequence(t,cc.delayTime(3),i))}},enableFinishAni:function(e,t){if(this.finishAct){var i=this.finishAct.getComponent(sp.Skeleton);i&&(this.finishAct.active=!0,i.animation=t)}},disableFinishAni:function(e){this.finishAct&&(this.finishAct.active=!1)},returnToHall:function(){this.loadding(),s=null,this.otherEventInvoker&&(clearInterval(this.otherEventInvoker),this.otherEventInvoker=null),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.startGameTimer&&clearTimeout(this.startGameTimer),this.endGameTimer&&clearTimeout(this.endGameTimer),this.hideTimer(),this.cleanAllPlayers(),this.scene("hall",this)},getTower:function(){for(var e=[],t=1;t<=20;t++)e[t-1]=t;var i=[],a=[];for(t=0;t<100;t++)a[t]=-1;for(t=1;t<=20;t++){var s=4;t!=e[0]&&t!=e[1]&&t!=e[2]&&t!=e[3]||(s=2);for(var r=0;r<s;r++){for(;;){var n=i.length,o=Math.floor(72*Math.random());if(-1==a[o]){a[o]=n;break}}i.push("0abcdefghijklmnopqrst".charAt(t))}}for(var l="",c=0;c<i.length;c++)l+=i[a[c]];return l},makeTowerMarix:function(e){this.towers=e,this.chararray=[];for(var t=0;t<10;t++)this.chararray[t]=[];this.onetmap=[];for(t=0;t<this.towers.length;t++){var i=this.towers[t],a=t%8+1,s=Math.floor(t/8)+1;this.chararray[a][s]=i}for(t=0;t<10;t++)this.chararray[t][0]="0",this.chararray[t][10]="0";for(var r=0;r<11;r++)this.chararray[0][r]="0",this.chararray[9][r]="0";return this.chararray},makeData:function(){for(var e=0;e<2;e++)for(var t=0;t<3;t++)this.gameTower[e][t]=this.getTower();var i=cc.sys.localStorage.getItem("onet_bottime");null==i&&(i=3),i=parseFloat(i),cc.sys.localStorage.setItem("onet_bottime",i);var a=cc.sys.localStorage.getItem("onet_expiry");null==a&&(a=63e3),cc.sys.localStorage.setItem("onet_expiry",a);var s={players:[{playuser:cc.global.user.id,alltowers:[this.gameTower[0][0],this.gameTower[0][1],this.gameTower[0][2]],remains:0,move:[0,parseInt(10*Math.random())%4+1,parseInt(10*Math.random())%4+5],bomb:0,expiry:a},{playuser:0,alltowers:[this.gameTower[1][0],this.gameTower[1][1],this.gameTower[1][2]],remains:0,move:[0,parseInt(10*Math.random())%4+1,parseInt(10*Math.random())%4+5],bomb:0,expiry:33e3}],bottime:i};this.play_event(s,this)},process_play:function(e){0==e.botid&&null!=e.botid?e.userid=e.botid:e.userid=cc.global.user.id,e.msg=e.tc,this.oercache_event(e,this)},finishGame:function(e){if(e){var t=cc.sys.localStorage.getItem("onet_bottime");null==t&&(t=3),t=parseFloat(t),(t-=.2)<=.8&&(t=.8),cc.sys.localStorage.setItem("onet_bottime",t);var i=cc.sys.localStorage.getItem("onet_expiry");null==i&&(i=63e3),(i-=1e3)<=33e3&&(i=33e3),cc.sys.localStorage.setItem("onet_expiry",i)}var a={pig:e,players:[{userid:cc.global.user.id,pig:e},{userid:0,pig:!e}]};this.allcards_event(a,this)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],OnetPlayerBoard:[function(e,t,i){"use strict";cc._RF.push(t,"a9889buC55EGoFQACNflsDC","OnetPlayerBoard");var a=e("HHCommon");cc.Class({extends:a,properties:{cross:{default:null,type:cc.Node},tower:{default:null,type:cc.Node},nomatch:{default:null,type:cc.Node},countdown:{default:null,type:cc.Label},status:{default:null,type:cc.Label},round:{default:null,type:cc.Node},character:{default:null,type:cc.Node},remainfunc:{default:null,type:cc.Node},remainpair:{default:null,type:cc.Label},tip:{default:null,type:cc.Node},tileAtlas:{default:null,type:cc.SpriteAtlas},tileCrossPref:{default:null,type:cc.Prefab},tilePref:{default:null,type:cc.Prefab},clockbar:{default:null,type:cc.Node},clockTimeLCD:{default:null,type:cc.Node},clockTimeProgress:{default:null,type:cc.Node},bombEffect:{default:null,type:sp.Skeleton},rph:{default:null,type:cc.Node},bombcnt:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.roundResult=!1,this.roundScore=0,this.layoutForSeat(),this.showPlayCharacter(),this.fromCell=null,this.toCell=null,this.linkRoute=[],this.roundTowers=[],this.tileTheme=0,this.state="WAIT",this.clockTime=0,this.totalClockTime=30,this.moveDir=0,this.moveList=[],this.hintCleared=!0,this.bombCleared=!0,this.remainPairCnt=0,this.possibleMatches=[],this.boardClockTimer=null,this.bbCnt=0,this.cellWidth=50,this.cellHeight=50,this.initTowerPieces(),null!=this.parent.trainRound?this.showRoundPH():this.initRoundPH()},initTowerPieces:function(){for(var e=0;e<11;e++)for(var t=0;t<10;t++){var i=cc.instantiate(this.tilePref);i.parent=this.tower,i.rowNum=e,i.colNum=t,i.zIndex=10*e+t,0!=e&&10!=e&&0!=t&&9!=t||(i.getComponent("OnetTile").isAlive=!1);var a=cc.instantiate(this.tileCrossPref);a.parent=this.cross,a.rowNum=e,a.colNum=t,i.crossCell=a}this.towerMat=[]},initRoundPH:function(){},showRoundPH:function(){for(var e=0;e<3;e++)this.rph.children[e].active=!0},setTileTheme:function(e){this.tileTheme=e,this.updateTileTheme()},toNextRound:function(){this.roundTowers.shift(),this.moveList.shift(),0!=this.roundTowers.length&&0!=this.moveList.length?(this.moveDir=this.moveList[0],this.drawTower(),this.updateRemains(this.possibleMatches.length),this.showRoundScore()):cc.global.isOffline&&1==cc.global.isOffline&&this.parent.finishGame(0<parseInt(this.userdata.id))},drawTower:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1;t<=9;t++)for(var i=1;i<=8;i++){var a=this.tower.children[10*t+i];a.setPosition(this.cellWidth/2+this.cellWidth*i,-this.cellWidth/2-this.cellHeight*t),a.zIndex=10*t+i;var s="0abcdefghijklmnopqrst".indexOf(this.roundTowers[0][8*(t-1)+(i-1)]);a.getComponent("OnetTile").init(this,s,this.tileAtlas.getSpriteFrame(this.tileTheme+"-"+s)),a.parent=this.tower}this.getPossibleMatchesAll(),this.updateRemains(e)},shuffleTower:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.roundTowers[0]=e,this.drawTower(t)},setTowerPieces:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];this.roundTowers=e,i!=[]&&(this.moveList=i,this.moveDir=this.moveList[0]),this.drawTower(t)},addClockTime:function(){this.clockTime+=4,null==this.boardClockTimer&&this.setClock(this.clockTime),this.refreshLCDTimeProgress()},setClock:function(e){if(!(e<=0)){var t=this;t.clockTime=e,t.refreshLCDTimeProgress(),t.boardClockTimer&&(clearInterval(t.boardClockTimer),t.boardClockTimer=null),t.boardClockTimer=setInterval(function(){t.clockbar?(t.clockTime--,t.refreshLCDTimeProgress(),0==t.clockTime&&(clearInterval(t.boardClockTimer),t.boardClockTimer=null,cc.global.isOffline&&t.parent.isGamePlaying&&t.parent.finishGame(!1))):(clearInterval(t.boardClockTimer),t.boardClockTimer=null)},1e3)}},stopClock:function(){this.boardClockTimer&&(clearInterval(this.boardClockTimer),this.boardClockTimer=null)},resumeClock:function(){this.setClock(this.clockTime)},refreshLCDTimeProgress:function(){var e=parseInt(this.clockTime/60),t=this.clockTime%60;this.clockTimeLCD.children[0].getComponent(cc.Label).string=e,this.clockTimeLCD.children[2].getComponent(cc.Label).string=t,this.clockTime<=10?(this.clockTimeProgress.children[0].children[0].color=cc.hexToColor("#FF0000"),cc.global.audio.playEffectAud("onet/hurryup")):this.clockTimeProgress.children[0].children[0].color=cc.hexToColor("#FFFF00");var i=this.clockTime/this.totalClockTime;i=1<i?1:i,this.clockTimeProgress.children[0].runAction(cc.scaleTo(.2,i,1)),0<i&&this.clockTimeProgress.children[0].children[0].runAction(cc.scaleTo(.2,1/i,1))},changeTileTheme:function(){this.tileTheme=(this.tileTheme+1)%3,this.updateTileTheme()},updateTileTheme:function(){for(var e=1;e<=9;e++)for(var t=1;t<=8;t++){var i=this.tower.children[10*e+t].getComponent("OnetTile");i.changeTheme(this.tileAtlas.getSpriteFrame(this.tileTheme+"-"+i.idx))}},updateRemains:function(e){this.remainfunc.children[1].active=!1,cc.global.isOffline&&1==cc.global.isOffline?this.remainpair.string="Left Pair : "+this.possibleMatches.length:null==this.parent.trainRound?e<0?(this.remainPairCnt=0,this.remainpair.string="    "):(this.remainPairCnt=e,this.remainpair.string="Left Pair : "+this.remainPairCnt):this.remainpair.string="Left Pair : "+this.possibleMatches.length},startTimer:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode||!(3<e)){var t=this;t.stopTimer(),t.countdown.node.active=!0,t.countdown.string=e,t.timer||(t.timer=setInterval(function(){0<e?t.countdown&&(e--,t.countdown.string=e):t.stopTimer()},1e3))}},stopTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=void 0,this.tip&&1==this.tip.active&&1==cc.global.curPlaywayScore&&this.parent.onclickBack()),this.countdown&&(this.countdown.node.active=!1)},setState:function(e){var t=this.getLanguageText("READY_0")+"?",i=this.getLanguageText("PREPARED_0");1!=cc.global.championMode&&2!=cc.global.championMode?(this.status.node.active=!0,t==(this.status.string=e)&&this.userdata.id==cc.global.user.id&&"no"==cc.global.amObserve?this.tip.active=!0:this.tip.active=!1):this.status.string=i},hideTip:function(){this.tip.active=!1},hideStatus:function(){this.countdown.node.active=!1,this.status.node.active=!1,this.tip.active=!1,this.hidePlayCharacter(),this.stopTimer()},clearAllTiles:function(){for(var e=0;e<=10;e++)for(var t=0;t<=9;t++)this.tower.children[10*e+t].getComponent("OnetTile").hideAll(),this.cross.children[10*e+t].getComponent("OnetTileCross").hideCross()},showRoundResult:function(e){this.boardClockTimer&&(clearInterval(this.boardClockTimer),this.boardClockTimer=null),this.clockTime=0,this.hideNoMatch(),this.refreshLCDTimeProgress(),this.clearAllTiles(),this.updateRemains(-1),this.roundResult=e,this.showPlayCharacter(),this.showRoundScore(e),e?this.characterAction("Victory"):this.characterAction("Lost")},hideRoundResult:function(){this.roundResult=!1},showRoundScore:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.hideRoundScore(),0==this.moveDir?this.roundScore=0:this.moveDir<=4?this.roundScore=1:this.moveDir<=8&&(this.roundScore=2),e&&this.roundScore++;for(var t=0;t<this.roundScore;t++)this.round.children[t].active=!0},hideRoundScore:function(){for(var e=this.roundScore=0;e<3;e++)this.round.children[e].active=!1},layoutForSeat:function(){0==this.seatid||this.seatid},showPlayCharacter:function(){this.character.active=!0,this.character.getComponent("Character").disUserCharacter(this.userdata.playcharacter%2,!1,this.userdata.avatarurl)},hidePlayCharacter:function(){this.character.active=!1},characterAction:function(e){this.character.getComponent("Character").disChPos(e)},initTouchedTiles:function(){this.fromCell=this.toCell=null},tileTouched:function(e){if("yes"==cc.global.amObserve||this.userdata.id!=cc.global.user.id)return!1;if(cc.global.audio.playEffectAud("onet/tiletouch"),this.fromCell){if(this.fromCell.rowNum==e.rowNum&&this.fromCell.colNum==e.colNum)return!0;if((this.toCell=e).getComponent("OnetTile").select(),this.fromCell.getComponent("OnetTile").idx!=this.toCell.getComponent("OnetTile").idx)return this.fromCell.getComponent("OnetTile").deselect(),this.fromCell=e,this.toCell=void 0,!0;if(0==this.getLinkRoute(this.fromCell,this.toCell))return this.fromCell.getComponent("OnetTile").deselect(),this.fromCell=e,this.toCell=void 0,!0;var t=10*this.fromCell.rowNum+this.fromCell.colNum,i=10*this.toCell.rowNum+this.toCell.colNum;null==this.parent.trainRound?this.parent.isGamePlaying&&(this.parent.myHitBlockCount++,this.socket().exec("oe",{extparams:{tc:t+"/"+i}}),this.processMatching(!0,!1)):this.processMatching(!0,!1)}else this.cleanAllSelection(),this.fromCell=e,this.toCell=void 0,e.getComponent("OnetTile").select();return!0},processMatching:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.isAdjacent(this.fromCell,this.toCell)?(this.linkRoute=[[this.fromCell.rowNum,this.fromCell.colNum],[this.toCell.rowNum,this.toCell.colNum]],this.goMatch(this.fromCell,this.toCell,e),this.initTouchedTiles()):this.canReach(this.fromCell,t)&&this.canReach(this.toCell,t)?(this.fromCell.getComponent("OnetTile").deselect(),this.toCell.getComponent("OnetTile").deselect(),this.linkRoute=this.getLinkRoute(this.fromCell,this.toCell),0==this.linkRoute.length?(this.fromCell=this.toCell,this.toCell=void 0,this.fromCell.getComponent("OnetTile").select()):(this.goMatch(this.fromCell,this.toCell,e),this.initTouchedTiles())):(this.fromCell.getComponent("OnetTile").deselect(),this.fromCell=this.toCell,this.toCell=void 0),cc.global.isOffline&&1==cc.global.isOffline&&this.updateRemains()},getLinkRoute:function(e,t){var i=[],a=1;if(e.rowNum<=t.rowNum&&e.colNum<=t.colNum)a=1;else if(e.rowNum>=t.rowNum&&e.colNum>=t.colNum)a=1,e=(s=this.swapFromTo(e,t))[0],t=s[1];else if(a=2,e.colNum>t.colNum){var s=this.swapFromTo(e,t);e=s[0],t=s[1]}return 1==a?i=this.searchRoute1(e,t):2==a&&(i=this.searchRoute2(e,t)),i},swapFromTo:function(e,t){var i;return i=e,[e=t,t=i]},getLineDirection:function(e,t){return e[0]<t[0]?4:e[0]>t[0]?3:e[1]<t[1]?2:e[1]>t[1]?1:void 0},goMatch:function(e,t){if(2<arguments.length&&void 0!==arguments[2]&&arguments[2],this.linkRoute.length){var i=this,a=10*this.linkRoute[0][0]+this.linkRoute[0][1],s=10*this.linkRoute[this.linkRoute.length-1][0]+this.linkRoute[this.linkRoute.length-1][1];this.cross.children[a].getComponent("OnetTileCross").showDot(),this.cross.children[s].getComponent("OnetTileCross").showDot();for(var r=0;r<this.linkRoute.length-1;r++){var n=10*this.linkRoute[r][0]+this.linkRoute[r][1],o=(this.tower.children[n].getComponent("OnetTile"),this.getLineDirection(this.linkRoute[r],this.linkRoute[r+1])),l=this.cross.children[n].getComponent("OnetTileCross");switch(o){case 1:l.showCross(!0,!1,!1,!1);break;case 2:l.showCross(!1,!0,!1,!1);break;case 3:l.showCross(!1,!1,!0,!1);break;case 4:l.showCross(!1,!1,!1,!0)}}this.cleanAllSelection(),this.addClockTime(),e.getComponent("OnetTile").matched(),t.getComponent("OnetTile").matched(),this.node.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(e){i.moveTiles&&i.linkRoute&&2<=i.linkRoute.length&&i.moveTiles(i.linkRoute[0],i.linkRoute[i.linkRoute.length-1])},this,null))),cc.global.audio.playEffectAud("onet/match")}},hideCross:function(){for(var e=0;e<this.linkRoute.length;e++){var t=10*this.linkRoute[e][0]+this.linkRoute[e][1];this.cross.children[t].getComponent("OnetTileCross").hideCross()}},searchRoute1:function(e,t){var i=[],a=[e.rowNum,e.colNum],s=[t.rowNum,t.colNum];if(a[0]==s[0])for(u=0;u<11;u++){if(r=[],u<a[0]){for(n=a[0];u<=n;n--)r.push([n,a[1]]);for(l=a[1]+1;l<=s[1]-1;l++)r.push([u,l]);for(n=u;n<=a[0];n++)r.push([n,s[1]])}else if(a[0]<u){for(n=a[0];n<=u;n++)r.push([n,a[1]]);for(l=a[1]+1;l<=s[1]-1;l++)r.push([u,l]);for(n=u;a[0]<=n;n--)r.push([n,s[1]])}else if(u==a[0])for(l=a[1];l<=s[1];l++)r.push([u,l]);i.push(r)}else if(a[1]==s[1])for(u=0;u<=9;u++){if(r=[],u<a[1]){for(n=a[1];u<=n;n--)r.push([a[0],n]);for(h=a[0]+1;h<=s[0]-1;h++)r.push([h,u]);for(n=u;n<=a[1];n++)r.push([s[0],n])}else if(a[1]<u){for(n=a[1];n<=u;n++)r.push([a[0],n]);for(h=a[0]+1;h<=s[0]-1;h++)r.push([h,u]);for(n=u;a[1]<=n;n--)r.push([s[0],n])}else if(u==a[1])for(h=a[0];h<=s[0];h++)r.push([h,u]);i.push(r)}else{for(l=a[1];l<=s[1];l++){for(var r=[],n=a[1];n<=l;n++)r.push([a[0],n]);for(h=a[0]+1;h<=s[0];h++)r.push([h,l]);for(n=l+1;n<=s[1];n++)r.push([s[0],n]);i.push(r)}for(h=a[0];h<=s[0];h++){for(r=[],n=a[0];n<=h;n++)r.push([n,a[1]]);for(l=a[1]+1;l<=s[1];l++)r.push([h,l]);for(n=h+1;n<=s[0];n++)r.push([n,s[1]]);i.push(r)}for(u=s[1]+1;u<=9;u++){for(var o=[],l=a[1];l<=u;l++)o.push([a[0],l]);for(h=a[0]+1;h<=s[0];h++)o.push([h,u]);for(n=u-1;s[1]<=n;n--)o.push([s[0],n]);i.push(o)}for(u=s[0]+1;u<=10;u++){for(var c=[],h=a[0];h<=u;h++)c.push([h,a[1]]);for(l=a[1]+1;l<=s[1];l++)c.push([u,l]);for(n=u-1;s[0]<=n;n--)c.push([n,s[1]]);c.push(s),i.push(c)}for(u=0;u<=a[1]-1;u++){var d=[];for(n=a[1];u+1<=n;n--)d.push([a[0],n]);for(h=a[0];h<=s[0];h++)d.push([h,u]);for(l=u+1;l<=s[1];l++)d.push([s[0],l]);i.push(d)}for(var u=0;u<=a[0]-1;u++){var p=[];for(n=a[0];u<=n;n--)p.push([n,a[1]]);for(l=a[1]+1;l<=s[1]-1;l++)p.push([u,l]);for(h=u;h<=s[0];h++)p.push([h,s[1]]);i.push(p)}}return this.getMinRoute(i,e,t)},searchRoute2:function(e,t){for(var i=[],a=[e.rowNum,e.colNum],s=[t.rowNum,t.colNum],r=a[1];r<=s[1];r++){for(var n=[],o=a[1];o<=r;o++)n.push([a[0],o]);for(h=a[0]-1;s[0]<=h;h--)n.push([h,r]);for(o=r+1;o<=s[1];o++)n.push([s[0],o]);i.push(n)}for(h=a[0];s[0]<=h;h--){for(n=[],o=a[0];h<=o;o--)n.push([o,a[1]]);for(r=a[1]+1;r<=s[1];r++)n.push([h,r]);for(o=h-1;s[0]<=o;o--)n.push([o,s[1]]);i.push(n)}for(u=s[1]+1;u<=9;u++){var l=[];for(r=a[1];r<=u;r++)l.push([a[0],r]);for(h=a[0]-1;s[0]<=h;h--)l.push([h,u]);for(o=u-1;s[1]<=o;o--)l.push([s[0],o]);l.push(s),i.push(l)}for(u=s[0]-1;0<=u;u--){for(var c=[],h=a[0];u<=h;h--)c.push([h,a[1]]);for(r=a[1]+1;r<=s[1];r++)c.push([u,r]);for(o=u+1;o<=s[0];o++)c.push([o,s[1]]);i.push(c)}for(u=a[1]-1;0<=u;u--){var d=[];for(o=a[1];u+1<=o;o--)d.push([a[0],o]);for(h=a[0];s[0]<=h;h--)d.push([h,u]);for(r=u+1;r<=s[1];r++)d.push([s[0],r]);i.push(d)}for(var u=a[0]+1;u<=10;u++){var p=[];for(o=a[0];o<=u-1;o++)p.push([o,a[1]]);for(r=a[1];r<=s[1];r++)p.push([u,r]);for(h=u-1;s[0]<=h;h--)p.push([h,s[1]]);i.push(p)}return this.getMinRoute(i,e,t)},getMinRoute:function(e,t,i){for(var a=[],s=0;s<e.length;s++){for(var r=e[s],n=!1,o=0;o<r.length;o++){var l=r[o][0],c=r[o][1],h=10*l+c;if(l==t.rowNum&&c==t.colNum);else if(l==i.rowNum&&c==i.colNum);else if(this.tower.children[h]&&this.tower.children[h].isAlive){n=!0;break}}n||(a.length>r.length||0==a.length)&&(a=r)}return a},canReach:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!e.isAlive)return!1;if(!t&&e.getComponent("OnetTile").blocked.active&&!e.crossCell.children[0].active)return!1;var i=e.rowNum,a=e.colNum,s=this.tower.children[10*(i-1)+a],r=this.tower.children[10*i+a-1],n=this.tower.children[10*i+a+1],o=this.tower.children[10*(i+1)+a];return!(s.isAlive&&r.isAlive&&n.isAlive&&o.isAlive)},isAdjacent:function(e,t){var i=e.rowNum,a=e.colNum,s=i-t.rowNum,r=a-t.colNum;return 0==s&&(1==r||-1==r)||0==r&&(1==s||-1==s)},getPossibleMatchesAll:function(){if(0<this.getAliveTileCount()){for(var e=[],t=1;t<=9;t++)for(a=1;a<=8;a++)this.canReach(this.tower.children[10*t+a],!0)&&e.push(this.tower.children[10*t+a]);var i=[];for(t=0;t<e.length-1;t++)for(var a=t+1;a<e.length;a++)e[t].getComponent("OnetTile").idx==e[a].getComponent("OnetTile").idx&&(this.isAdjacent(e[t],e[a])||i.push([e[t],e[a]]));var s=[];for(t=0;t<i.length;t++){var r=i[t][0],n=i[t][1],o=this.getLinkRoute(r,n);0<o.length&&s.push(o)}var l=this.findAdjacentSameCells();s=s.concat(l);var c=[],h=[];for(t=0;t<s.length;t++){var d=s[t][0],u=s[t][s[t].length-1];this.hasPointInArr(h,d)||this.hasPointInArr(h,u)||(c.push(s[t]),h.push(d),h.push(u))}if(0==c.length){if(this.showNoMatch(),cc.global.isOffline&&1==cc.global.isOffline){var p=this;setTimeout(function(){p.parent.reshuffleTower(p.getTowerStr(),p.userdata.id)},1e3)}this.possibleMatches=[]}else this.possibleMatches=c}else this.possibleMatches=[],this.toNextRound()},getTowerStr:function(){for(var e="",t=1;t<=9;t++)for(var i=1;i<=8;i++){var a=this.tower.children[10*t+i];if(a.isAlive)e+="0abcdefghijklmnopqrst"[a.getComponent("OnetTile").idx];else e+="0"}return e},showNoMatch:function(){this.nomatch.active||(this.nomatch.active=!0,this.nomatch.runAction(cc.sequence(cc.fadeOut(0),cc.fadeIn(.1))),this.nomatch.children[1].runAction(cc.sequence(cc.scaleTo(0,0),cc.scaleTo(.2,.35))))},hideNoMatch:function(){this.nomatch.active=!1,this.nomatch.runAction(cc.fadeOut(.1)),this.nomatch.children[1].runAction(cc.scaleTo(0,0))},getAliveTileCount:function(){for(var e=0,t=1;t<=9;t++)for(var i=1;i<=8;i++)this.tower.children[10*t+i].isAlive&&e++;return e},hasPointInArr:function(e,t){for(var i=0;i<e.length;i++)if(e[i][0]==t[0]&&e[i][1]==t[1])return!0;return!1},findAdjacentSameCells:function(){for(var e=[],t=1;t<=9;t++)for(var i=1;i<=8;i++){var a=10*t+i,s=10*t+i+1,r=10*(t+1)+i;this.isSameTile(this.tower.children[a],this.tower.children[s])&&e.push([[t,i],[t,i+1]]),this.isSameTile(this.tower.children[a],this.tower.children[r])&&e.push([[t,i],[t+1,i]])}return e},isSameTile:function(e,t){return!(!e.isAlive||!t.isAlive)&&e.getComponent("OnetTile").idx==t.getComponent("OnetTile").idx},showTileMatched:function(e){var t=e.split("/");this.fromCell=this.tower.children[t[0]],this.toCell=this.tower.children[t[1]],this.processMatching(!1,!0)},getCM:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(0<this.possibleMatches.length){var t=this.possibleMatches[0][0],i=this.possibleMatches[0][this.possibleMatches[0].length-1];e?(this.linkRoute=this.possibleMatches[0],this.goMatch(this.tower.children[10*t[0]+t[1]],this.tower.children[10*i[0]+i[1]],!0)):this.showHintCell(10*t[0]+t[1],10*i[0]+i[1])}},showHintCell:function(e,t){this.fromCell=this.toCell=void 0,this.cleanAllSelection(),this.tower.children[e].getComponent("OnetTile").select(),this.tower.children[t].getComponent("OnetTile").select(),this.hintCleared=!1,cc.global.audio.playEffectAud("onet/hint")},cleanAllSelection:function(){for(var e=0;e<11;e++)for(var t=0;t<10;t++)this.tower.children[10*e+t].getComponent("OnetTile").deselect();this.hintCleared=!0},tileBlockAttack:function(){for(var e=[],t=0;t<11;t++)for(var i=0;i<10;i++)this.canBlock(this.tower.children[10*t+i])&&e.push(this.tower.children[10*t+i]);var a,s,r=e.length;0<r&&(2==r?(a=0,s=1):s=((a=parseInt(100*Math.random())%r)+parseInt(100*Math.random())%(r-1)+1)%r,e[a]&&e[a].getComponent("OnetTile").block(),e[s]&&e[s].getComponent("OnetTile").block())},canBlock:function(e){return!!e&&e.isAlive&&!e.getComponent("OnetTile").blocked.active},moveTiles:function(e,t){if(null!=this.parent.trainRound||this.parent.isGamePlaying){switch(this.moveDir){case 1:this.moveLeft(e,t);break;case 2:this.moveRight(e,t);break;case 3:this.moveUp(e,t);break;case 4:this.moveDown(e,t);break;case 5:this.moveRowLeftRight(e,t);break;case 6:this.moveRowRightLeft(e,t);break;case 7:this.moveColUpDown(e,t);break;case 8:this.moveColDownUp(e,t)}this.calcTowerZIndexAndSort(),this.getPossibleMatchesAll(),null!=this.parent.trainRound&&this.updateRemains()}},calcTowerZIndexAndSort:function(){for(var e=0;e<11;e++)for(var t=0;t<10;t++){var i=this.tower.children[10*e+t].rowNum,a=this.tower.children[10*e+t].colNum;this.tower.children[10*e+t].zIndex=10*i+a,this.tower.children[10*e+t].crossCell=this.cross.children[10*i+a]}this.tower.sortAllChildren()},calcTilePosition:function(e){e.setPosition(this.cellWidth/2+this.cellWidth*e.colNum,-1*this.cellHeight/2-this.cellHeight*e.rowNum)},cellMoveAction:function(e,t,i,a){return!!e.isAlive&&(this.calcTilePosition(e),e.runAction(t),e.rowNum+=i,e.colNum+=a,!0)},getTowerColEdge:function(e,t){for(var i=0,a=1;a<=8;a++)this.tower.children[10*e+a].isAlive&&i++;return 1==t?i:2==t?8-i:void 0},getTowerRowEdge:function(e,t){for(var i=0,a=1;a<=9;a++)this.tower.children[10*a+e].isAlive&&i++;return 1==t?i:2==t?9-i:void 0},moveLeft:function(e,t){if(11!=t[0]||11!=t[1]){if(e[0]==t[0]){for(var i=0,a=this.getTowerColEdge(e[0],1),s=e[1]+1;s<t[1];s++)this.cellMoveAction(this.tower.children[10*e[0]+s],cc.moveBy(.2,-50,0),0,-1)&&i++;for(s=t[1]+1;s<=8;s++)this.cellMoveAction(this.tower.children[10*e[0]+s],cc.moveBy(.2,-100,0),0,-2)&&i++;0<i&&(this.tower.children[10*e[0]+e[1]].colNum=a+1,this.tower.children[10*t[0]+t[1]].colNum=a+2)}else{var r=0,n=0,o=this.getTowerColEdge(e[0],1),l=this.getTowerColEdge(t[0],1);for(s=e[1]+1;s<=8;s++)this.cellMoveAction(this.tower.children[10*e[0]+s],cc.moveBy(.2,-50,0),0,-1)&&r++;for(s=t[1]+1;s<=8;s++)this.cellMoveAction(this.tower.children[10*t[0]+s],cc.moveBy(.2,-50,0),0,-1)&&n++;0<r&&(this.tower.children[10*e[0]+e[1]].colNum=o+1),0<n&&(this.tower.children[10*t[0]+t[1]].colNum=l+1)}this.calcTilePosition(this.tower.children[10*e[0]+e[1]]),this.calcTilePosition(this.tower.children[10*t[0]+t[1]])}},moveRight:function(e,t){if(11!=t[0]||11!=t[1]){if(e[0]==t[0]){for(var i=0,a=this.getTowerColEdge(e[0],2),s=1;s<e[1];s++)this.cellMoveAction(this.tower.children[10*e[0]+s],cc.moveBy(.2,100,0),0,2)&&i++;for(s=e[1]+1;s<t[1];s++)this.cellMoveAction(this.tower.children[10*e[0]+s],cc.moveBy(.2,50,0),0,1)&&i++;0<i&&(this.tower.children[10*e[0]+e[1]].colNum=a,this.tower.children[10*t[0]+t[1]].colNum=a-1)}else{var r=0,n=0,o=this.getTowerColEdge(e[0],2),l=this.getTowerColEdge(t[0],2);for(s=1;s<e[1];s++)this.cellMoveAction(this.tower.children[10*e[0]+s],cc.moveBy(.2,50,0),0,1)&&r++;for(s=1;s<t[1];s++)this.cellMoveAction(this.tower.children[10*t[0]+s],cc.moveBy(.2,50,0),0,1)&&n++;0<r&&(this.tower.children[10*e[0]+e[1]].colNum=o),0<n&&(this.tower.children[10*t[0]+t[1]].colNum=l)}this.calcTilePosition(this.tower.children[10*e[0]+e[1]]),this.calcTilePosition(this.tower.children[10*t[0]+t[1]])}},moveUp:function(e,t){if(11!=t[0]||11!=t[1]){if(e[1]==t[1]){for(var i=0,a=this.getTowerRowEdge(e[1],1),s=e[0]+1;s<t[0];s++)this.cellMoveAction(this.tower.children[10*s+e[1]],cc.moveBy(.2,0,50),-1,0)&&i++;for(s=t[0]+1;s<=9;s++)this.cellMoveAction(this.tower.children[10*s+e[1]],cc.moveBy(.2,0,100),-2,0)&&i++;0<i&&(this.tower.children[10*e[0]+e[1]].rowNum=a+1,this.tower.children[10*t[0]+t[1]].rowNum=a+2)}else{var r=0,n=0,o=this.getTowerRowEdge(e[1],1),c=this.getTowerRowEdge(t[1],1);for(l=e[0]+1;l<=9;l++)this.cellMoveAction(this.tower.children[10*l+e[1]],cc.moveBy(.2,0,50),-1,0)&&r++;for(l=t[0]+1;l<=9;l++)this.cellMoveAction(this.tower.children[10*l+t[1]],cc.moveBy(.2,0,50),-1,0)&&n++;0<r&&(this.tower.children[10*e[0]+e[1]].rowNum=o+1),0<n&&(this.tower.children[10*t[0]+t[1]].rowNum=c+1)}this.calcTilePosition(this.tower.children[10*e[0]+e[1]]),this.calcTilePosition(this.tower.children[10*t[0]+t[1]])}},moveDown:function(e,t){if(11!=t[0]||11!=t[1]){if(e[1]==t[1]){for(var i=0,a=this.getTowerRowEdge(e[1],2),s=1;s<e[0];s++)this.cellMoveAction(this.tower.children[10*s+e[1]],cc.moveBy(.2,0,-100),2,0)&&i++;for(s=e[0]+1;s<t[0];s++)this.cellMoveAction(this.tower.children[10*s+e[1]],cc.moveBy(.2,0,-50),1,0)&&i++;0<i&&(this.tower.children[10*e[0]+e[1]].rowNum=a-1,this.tower.children[10*t[0]+t[1]].rowNum=a)}else{for(var r=0,n=0,o=this.getTowerRowEdge(e[1],2),l=this.getTowerRowEdge(t[1],2),c=1;c<e[0];c++)this.cellMoveAction(this.tower.children[10*c+e[1]],cc.moveBy(.2,0,-50),1,0)&&r++;for(c=1;c<t[0];c++)this.cellMoveAction(this.tower.children[10*c+t[1]],cc.moveBy(.2,0,-50),1,0)&&n++;0<r&&(this.tower.children[10*e[0]+e[1]].rowNum=o),0<n&&(this.tower.children[10*t[0]+t[1]].rowNum=l)}this.calcTilePosition(this.tower.children[10*e[0]+e[1]]),this.calcTilePosition(this.tower.children[10*t[0]+t[1]])}},moveRowLeftRight:function(e,t){e[0]<=5&&t[0]<=5?this.moveLeft(e,t):e[0]<=5&&5<t[0]?(this.moveLeft(e,[10,9]),this.moveRight(t,[10,9])):5<e[0]&&t[0]<=5?(this.moveRight(e,[10,9]),this.moveLeft(t,[10,9])):5<e[0]&&5<t[0]&&this.moveRight(e,t)},moveRowRightLeft:function(e,t){e[0]<=5&&t[0]<=5?this.moveRight(e,t):e[0]<=5&&5<t[0]?(this.moveRight(e,[10,9]),this.moveLeft(t,[10,9])):5<e[0]&&t[0]<=5?(this.moveLeft(e,[10,9]),this.moveRight(t,[10,9])):5<e[0]&&5<t[0]&&this.moveLeft(e,t)},moveColUpDown:function(e,t){e[1]<=4&&t[1]<=4?this.moveUp(e,t):e[1]<=4&&4<t[1]?(this.moveUp(e,[10,9]),this.moveDown(t,[10,9])):4<e[1]&&t[1]<=4?(this.moveDown(e,[10,9]),this.moveUp(t,[10,9])):4<=e[1]&&4<=t[1]&&this.moveDown(e,t)},moveColDownUp:function(e,t){e[1]<=4&&t[1]<=4?this.moveDown(e,t):e[1]<=4&&4<t[1]?(this.moveDown(e,[10,9]),this.moveUp(t,[10,9])):4<e[1]&&t[1]<=4?(this.moveUp(e,[10,9]),this.moveDown(t,[10,9])):4<=e[1]&&4<=t[1]&&this.moveUp(e,t)},onClickLockOnum:function(){null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.getComponent("ToastCtrl").init("",""),cc.global.opentoast.parent=this.parent.node)},showBombAttack:function(){this.bombCleared=!1,this.showBombEffect()},blockAllTiles:function(){for(var e=this,t=1;t<=9;t++)for(var i=1;i<=8;i++){var a=this.tower.children[10*t+i];this.canBlock(a)&&a.getComponent("OnetTile").block(4e3)}setTimeout(function(){e&&e.tower&&(e.bombCleared=!0)},4e3)},showBombEffect:function(){var e=this;this.bombEffect.clearTracks(),this.bombEffect.node.active=!0,0==this.seatid?this.bombEffect.setAnimation(0,"lujingyou",!1):1==this.seatid&&this.bombEffect.setAnimation(0,"lujingzuo",!1),this.bombEffect.attackPhase=0,this.bombEffect.setCompleteListener(function(){if(e&&e.bombEffect){if(e.bombEffect.attackPhase++,2<=e.bombEffect.attackPhase)return void(e.bombEffect.node.active=!1);e.bombEffect.setAnimation(0,"zha",!1),e.blockAllTiles()}})},updateBombCount:function(e){this.bbCnt=e,this.bombcnt.children[1].getComponent(cc.Label).string=this.bbCnt},bombUsed:function(){this.bbCnt--,this.updateBombCount(this.bbCnt)},isReady:function(){return this.getLanguageText("PREPARED_0")==this.status.string},onClickReady:function(){this.parent&&this.parent.processReadyState()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],OnetPlayer:[function(e,t,i){"use strict";cc._RF.push(t,"3befa0AE2tLWr/46QEII2Ur","OnetPlayer");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},nickname:{default:null,type:cc.Label},goldcoin_base:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},betup:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},winorlose:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.nickname.string=t.nickname,1==cc.global.championMode||cc.global.championMode,this.goldcoins.string=this.numformat(t.goldcoins),"normal"==cc.global.user.selplayway&&(this.goldcoins.node.parent.active=!0),this.loadAvatar(t.avatarurl,t.gender),this.layoutForSeat()},onClickDisInfo:function(){},updateCareer:function(e){},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},spendGoldForLuck:function(e){this.userdata.goldcoins-=e,this.updateBalance()},showCallPlayer:function(e,t){var i=this;this.hideCallPlayer(),cc.global.audio.playVoiceChatWithType(this.playcharacter,t),this.callplayer.active=!0,this.callplayer.children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onClickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userdata.id},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){cc.global.isOffline&&1==cc.global.isOffline||(cc.global.user.id==this.userdata.id?this.parent.onClickEmoticon&&this.parent.onClickEmoticon():this.onClickCallPlayer())},layoutForSeat:function(){0==this.seatid||this.seatid},summary:function(e){var a=this;if(this.updateCareer(e),!e.pig)return cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("lose"),this.winorlose.children[0].getComponent(cc.Label).string="-"+this.numformat(Math.abs(e.exp)),void(this.winorlose.children[1].getComponent(cc.Label).string="-"+this.numformat(-1*e.score));cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("win"),this.winorlose.children[0].getComponent(cc.Label).string="+"+this.numformat(e.exp),this.winorlose.children[1].getComponent(cc.Label).string="+"+this.numformat(e.score),e.orig_gold=e.gold-e.score,"diamond"==cc.global.user.selplayway&&(e.orig_gold=e.diamond-e.score);var t=cc.callFunc(function(e,t){t.orig_gold+Math.round(t.score/5)>("diamond"==cc.global.user.selplayway?t.diamond:t.gold)?"diamond"==cc.global.user.selplayway?t.orig_gold=t.diamond:t.orig_gold=t.gold:t.orig_gold=t.orig_gold+Math.round(t.score/5);var i=e.getComponent("OnetPlayer").goldcoins.node;i.getComponent(cc.Label).string=a.numformat(t.orig_gold),i.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1)))},this,e),i=cc.callFunc(function(e,t){e.getComponent("OnetPlayer").goldcoins.node.getComponent(cc.Label).string=a.numformat(t.gold)},this,e),s=cc.sequence(cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,i);this.node.runAction(s)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],OnetTileCross:[function(e,t,i){"use strict";cc._RF.push(t,"8b99eNAZk5JMZFY7MX0wNqn","OnetTileCross"),cc.Class({extends:cc.Component,properties:{seloutline:{type:cc.Node,default:null},left:{type:cc.Node,default:null},right:{type:cc.Node,default:null},top:{type:cc.Node,default:null},bottom:{type:cc.Node,default:null},dot:{type:cc.Node,default:null}},showCross:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],a=3<arguments.length&&void 0!==arguments[3]&&arguments[3],s=this;this.left.active=e,this.right.active=t,this.top.active=i,this.bottom.active=a,this.node.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(e){s&&s.hideCross&&s.hideCross()},this,null)))},hideCross:function(){this.left&&this.right&&this.top&&this.bottom&&this.dot&&(this.left.active=this.right.active=this.top.active=this.bottom.active=this.dot.active=this.seloutline.active=!1)},showDot:function(){var t=this;this.dot.active=!0,this.node.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(e){t&&t.hideDot&&t.hideDot()},this,null)))},hideDot:function(){this.dot&&(this.dot.active=!1)},showSelection:function(){this.seloutline.active=!0},hideSelection:function(){this.seloutline.active=!1}}),cc._RF.pop()},{}],OnetTile:[function(e,t,i){"use strict";cc._RF.push(t,"970f2UKMIZMMobMm+WHwu+f","OnetTile"),cc.Class({extends:cc.Component,properties:{tile:{type:cc.Sprite,default:null},blocked:{type:cc.Node,default:null}},onLoad:function(){this.idx=0,this.blockTimer=null},init:function(e,t,i){this.parent=e,this.idx=t,this.node.isAlive=0<t,this.tile.spriteFrame=i,this.tile.node.active=!0,this.tile.node.getComponent(cc.Animation).play("tile_spawn"),this.tile.node.color=new cc.Color(parseInt(1e3*Math.random())%35+220,parseInt(1e3*Math.random())%35+220,parseInt(1e3*Math.random())%35+220),this.tile.node.rotation=1e3*Math.random()%2*(.5<Math.random()?1:-1)},block:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3e3,t=this;t.blocked.active=!0,this.blocked.stopAllActions(),this.blocked.runAction(cc.sequence(cc.delayTime(e/1e3),cc.callFunc(function(e){t.unblock()},this,null)))},unblock:function(){this.blocked&&(this.blocked.active=!1)},tileTouched:function(e){this.node.isAlive&&!this.blocked.active?this.node.getNumberOfRunningActions()<=0&&this.parent.tileTouched(this.node):this.deselect()},select:function(){this.node.crossCell.getComponent("OnetTileCross").showSelection()},deselect:function(){this.node.crossCell.getComponent("OnetTileCross").hideSelection()},matched:function(){this.deselect(),this.node.isAlive=!1,this.blocked.active=!1,this.tile.node.getComponent(cc.Animation).play("tile_matched"),this.node.runAction(cc.sequence(cc.delayTime(.175),cc.callFunc(function(e){e&&e.node&&e.tile&&(e.tile.node.active=e.blocked.active=!1,e.tile.node.setScale(1,1))},this,null)))},changeTheme:function(e){this.tile.spriteFrame=e},hideAll:function(){this.tile.node.active=this.blocked.active=this.node.isAlive=!1,this.deselect()}}),cc._RF.pop()},{}],PadukBegin:[function(e,t,i){"use strict";cc._RF.push(t,"f1ba1+a+7VAM7dinehXJH8N","PadukBegin");var a=e("HHCommon"),s=e("PadukEngine"),c=null;cc.Class({extends:a,properties:{paduk_player:{default:null,type:cc.Prefab},paduk_player_board:{default:null,type:cc.Prefab},selfplayer:{default:null,type:cc.Node},opponentplayer:{default:null,type:cc.Node},mainBoard:{default:null,type:cc.Node},statusboard:{default:null,type:cc.Node},playersBoard:{default:null,type:cc.Node},boardclaim:{default:null,type:cc.Sprite},claimatlas:{default:null,type:cc.SpriteAtlas},roomdata:{default:null,type:cc.Node},turntimer:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},observer:{default:null,type:cc.Prefab},observerbench:{default:null,type:cc.Node},emodlg:{default:null,type:cc.Prefab},chat:{default:null,type:cc.Prefab},btn_enter:{default:null,type:cc.Node},btn_exit:{default:null,type:cc.Node},btn_giveup:{default:null,type:cc.Node},btn_chat:{default:null,type:cc.Node},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},pcs_cell_pref:{default:null,type:cc.Prefab},pcs_huazom:{default:null,type:cc.Prefab},finishLayer:{default:null,type:cc.Node},finishAct:{default:null,type:cc.Node},btnSfx:{default:null,type:cc.Node},lblTurnCount:{default:null,type:cc.Label},scoreResult:{default:null,type:cc.Node},bottomBoard:{default:null,type:cc.Node},padukAtlas:{default:null,type:cc.SpriteAtlas}},onLoad:function(){this.initEventCallback(),cc.game.setFrameRate(60),cc.global.amObserve="no",this.play_status=0,this.playerlist=new Array,this.playerboardlist=new Array,this.observerlist=new Array,this.posBaseIdx=0,this.inited=!1,this.playerBoardSlotPos=[cc.v2(0,-180),cc.v2(0,180)],this.notReplay=!0,this.startGameTimer=null,this.endGameTimer=null,this.pangolds=0,this.isGamePlaying=!1,this.isSuicide=!1,this.turnSeat=0,this.isNewRoom=!0,c=null,this.turnCount={local:0,server:0},null!=cc.global&&(this.initgame(),""!=cc.global.user.roomid&&(this.recovery(),this.isNewRoom=!1)),cc.global.watchReplayData.onReplay&&this.prepareReplay(),this.setEtcKeyBoardEvent();var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==e&&(e=!0),e?(this.btnSfx.children[0].active=!0,this.btnSfx.children[1].active=!1):(this.btnSfx.children[0].active=!1,this.btnSfx.children[1].active=!0),this.playersBoard.parent.height=272/cc.global.narrowContentRatio,this.playersBoard.parent.y=542/cc.global.narrowContentRatio,this.bottomBoard.parent.height=224/cc.global.narrowContentRatio,this.bottomBoard.parent.y=-416/cc.global.narrowContentRatio,cc.global.audio.playBGM("bgm_paduk")},showResult:function(e){return e<0||1==e?1==e:(2==e&&console.log(""),!0)},makeAllPieces:function(){this.pieces=[];for(var e=0;e<c.m_nPlaysetBoardsize;e++){for(var t=[],i=0;i<c.m_nPlaysetBoardsize;i++){var a=cc.instantiate(this.pcs_cell_pref);a.parent=this.mainBoard.getChildByName("PieceBoard"),a.getComponent("PadukPiece").init(e,i,c.m_nPlaysetBoardType);var s=c.getPos(e,i);a.setPosition(s[0],s[1]),t[i]=a}this.pieces[e]=t}},placePiece:function(e,t,i,a){for(var s=0;s<c.m_nPlaysetBoardsize;s++)for(var r=0;r<c.m_nPlaysetBoardsize;r++)this.pieces[s][r].getComponent("PadukPiece").hideId();-1!=e&&-1!=t&&this.pieces[e][t].getComponent("PadukPiece").showPiece(i,a,!0)},getCopyedStatus:function(e){for(var t=[],i=0;i<c.m_nPlaysetBoardsize;i++){for(var a=[],s=0;s<c.m_nPlaysetBoardsize;s++)a[s]=c.status[i][s];t[i]=a}return t},removeDeadPieces:function(e){for(var t=0;t<e.length;t++){var i=e[t].split(","),a=parseInt(i[0]),s=parseInt(i[1]),r=this.convertPoint(a,s);a=r[0],s=r[1],this.removePiece(a,s)}},removePiece:function(e,t){this.pieces[e][t].getComponent("PadukPiece").hidePiece()},drawPadukBoard:function(){var e=this.mainBoard.getChildByName("LineGraphics").getComponent(cc.Graphics);e.clear();for(var t=c.m_nPlaysetBoardsize,i=0;i<t;i++)e.moveTo(c.getPos(i,0)[0],c.getPos(i,0)[1]),e.lineTo(c.getPos(i,t-1)[0],c.getPos(i,t-1)[1]);for(i=0;i<t;i++)e.moveTo(c.getPos(0,i)[0],c.getPos(0,i)[1]),e.lineTo(c.getPos(t-1,i)[0],c.getPos(t-1,i)[1]);e.stroke();for(i=0;i<this.huazom.length;i++)this.huazom[i].destroy();this.huazom=[];for(i=0;i<c.huazom.length;i++){var a=c.huazom[i][0],s=c.huazom[i][1],r=cc.instantiate(this.pcs_huazom);r.parent=this.mainBoard.getChildByName("PieceBoard"),r.setPosition(c.getPos(a,s)[0],c.getPos(a,s)[1]),this.huazom.push(r)}},initgame:function(){var t=this;this.finishAct&&(this.finishAct.active=!1);var e=this.socket();this.map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("banker",this.banker_event),this.map("playpaduk",this.playpaduk_event),this.map("rer",this.recovery_event),this.map("selemoticon",this.emoticon_event),this.map("sendchat",this.sendchat_event),this.map("callplayer",this.callplayer_event),this.map("pexit",this.pexit_event),this.map("allcards",this.allcards_event),this.map("chpre",this.chpre_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)});var i={};switch(cc.global.user.roomInType){case"NormalCreate":null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i);break;case"NormalJoin":i.extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i);break;case"NormalObserve":i.extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i)}this.inited=!0,this.isShowTerritory=!1,this.loadding()},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},prepareReplay:function(){this.notReplay=!1,cc.global.amObserve="yes",this.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),this.replay_bar.active=!0,this.replayStep="ready_room",this.replaySeq=0,this.replayPrevCmd="",this.goReplay()},stopAllClock:function(){this.turntimer.getComponent("TurnTimer").pauseAllTimer()},resumeAllClock:function(){this.turntimer.getComponent("TurnTimer").resumeAllTimer()},pauseReplayTimer:function(){this.stopAllClock(),clearTimeout(this.replayTimer)},resumeReplayTimer:function(){var e=this;this.resumeAllClock(),this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay/cc.global.watchReplayData.replaySpeedX)},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):this.togglePlayToPause()},togglePlayToPause:function(){this.replayTimer&&clearTimeout(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replay_bar.children[0].opacity=100,this.pauseReplayTimer()},replayPrevMove:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.replayEventProcess(!0))},replayNextMove:function(){this.togglePlayToPause(),this.replayEventProcess(!0)},onClickReplaySpeedUp:function(){var e=this.getLanguageText("REPLAY_TIME");cc.global.watchReplayData.replaySpeedX<5&&(cc.global.watchReplayData.replaySpeedX++,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){var e=this.getLanguageText("REPLAY_TIME");1<cc.global.watchReplayData.replaySpeedX&&(cc.global.watchReplayData.replaySpeedX--,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},cleanAllPlayers:function(){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].destroy(),this.playerboardlist[e].destroy();this.playerlist.splice(0,this.playerlist.length),this.playerboardlist.splice(0,this.playerboardlist.length),this.playerlist=new Array,this.playerboardlist=new Array,this.selfplayer&&(this.selfplayer.destroyAllChildren(),this.selfplayer.removeAllChildren()),this.opponentplayer&&(this.opponentplayer.destroyAllChildren(),this.opponentplayer.removeAllChildren()),this.mainBoard&&(this.mainBoard.destroyAllChildren(),this.mainBoard.removeAllChildren(),this.piece_hint_array=null)},replayEventProcess:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.play_history&&this.play_history[this.replaySeq]){this.replayTimeDelay=0;var t=!1;switch(this.replayStep){case"ready_room":this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"playpaduk":t=!0,this.playpaduk_event(i,this);break;case"pexit":t=!0,this.pexit_event(i,this);break;case"allcards":t=!0,this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.emoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"players":this.players_event(i,this);break;case"chpre":t=!0,this.chpre_event(i,this)}this.replayPrevCmd=i.command}this.play_history[this.replaySeq+1]&&""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay+=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,e&&!t&&this.replayEventProcess(!0)}},goReplay:function(){var e=this;this.replayEventProcess(),this.play_history[this.replaySeq]?this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay):(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.replayPrevCmd="",this.pauseReplayTimer())},setEtcKeyBoardEvent:function(){var i=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e,t){switch(e){case cc.KEY.space:i.processReadyState();break;case cc.KEY.escape:case cc.KEY.back:if(!i.isemoticon&&!i.ischat)return void i.onclickBack();i.isemoticon&&(null!=i.emoticonpage&&i.emoticonpage.destroy(),i.isemoticon=!1),i.ischat&&(null!=i.chatpage&&i.chatpage.destroy(),i.ischat=!1);break;case 13:i.showChatSearch();break;case 48:i.onclickChat(0,9);break;case 49:i.onclickChat(1,0);break;case 50:i.onclickChat(2,1);break;case 51:i.onclickChat(3,2);break;case 52:i.onclickChat(4,3);break;case 53:i.onclickChat(5,4);break;case 54:i.onclickChat(6,5);break;case 55:i.onclickChat(7,6);break;case 56:i.onclickChat(8,7);break;case 57:i.onclickChat(9,8);break;case cc.KEY.q:i.sendEmoticon(0);break;case cc.KEY.w:i.sendEmoticon(1);break;case cc.KEY.e:i.sendEmoticon(2);break;case cc.KEY.r:i.sendEmoticon(3);break;case cc.KEY.t:i.sendEmoticon(4);break;case cc.KEY.y:i.sendEmoticon(5);break;case cc.KEY.u:i.sendEmoticon(6);break;case cc.KEY.a:i.sendEmoticon(7);break;case cc.KEY.s:i.sendEmoticon(8);break;case cc.KEY.d:i.sendEmoticon(9);break;case cc.KEY.f:i.sendEmoticon(10);break;case cc.KEY.g:i.sendEmoticon(11);break;case cc.KEY.h:i.sendEmoticon(12);break;case cc.KEY.j:i.sendEmoticon(13);break;case cc.KEY.z:i.sendEmoticon(14);break;case cc.KEY.x:i.sendEmoticon(15);break;case cc.KEY.c:i.sendEmoticon(16);break;case cc.KEY.v:i.sendEmoticon(17);break;case cc.KEY.n:i.sendEmoticon(19);break;case cc.KEY.m:i.sendEmoticon(20);break;case cc.KEY.i:i.sendEmoticon(21);break;case cc.KEY.o:i.sendEmoticon(22);break;case cc.KEY.p:i.sendEmoticon(23);break;case 219:i.sendEmoticon(24);break;case 221:i.sendEmoticon(25);break;case cc.KEY.k:i.sendEmoticon(26);break;case cc.KEY.l:i.sendEmoticon(27)}}},i.node)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;e<0||(this.socket().exec("selemoticon",{extparams:{emoticon:e}}),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1))},onCtrlKeyDown:function(e){e.keycode==cc.KEY.space&&2==this.playerlist.length&&(this.endGameTimer||this.sendState())},processReadyState:function(){2==this.playerlist.length&&(this.endGameTimer||this.sendState())},joinroom_event:function(e,t){cc.global.user.selplayway=e.name,t.roomid=e.id,t.panScore=cc.global.curPlaywayScore=e.score;var i=t.getLanguageText("ROOM_0"),a=t.getLanguageText("SCORE_0");switch(t.roomdata.children[0].getComponent(cc.Label).string=e.id+i,t.roomdata.children[1].getComponent(cc.Label).string="("+t.numformat(e.score)+a+")",null==c&&t.initPadukBoard(e.cond),cc.global.gamestatus){case"ready":cc.global.gamestatus="waiting",2==e.playerlist.length&&(cc.global.gamestatus="playing"),t.players_event(e,t);break;case"waiting":t.players_event(e,t);break;case"playing":cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)}"yes"==cc.global.amObserve?t.btn_giveup.active=!1:t.btn_giveup.active=!0,t.btn_chat.active=!0,t.btn_exit.active=!0,t.closeloadding()},players_event:function(e,t){2==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)if(e.observerlist[a].id==cc.global.user.id){i=!1;break}if(i&&t.notReplay)return cc.global.outReasonMsg=e.msg,void t.exitPlay();t.observer_event(e,t),t.isBoardPlayersChanged(e.playerlist)&&(t.startGameTimer&&(clearTimeout(t.startGameTimer),t.startGameTimer=null),t.endGameTimer&&(clearTimeout(t.endGameTimer),t.endGameTimer=null),t.players_engine(e,t))},players_engine:function(e){this.removeBoardPlayers(e.playerlist);for(var t=this.posBaseIdx,i=0;i<e.playerlist.length;i++){if(e.playerlist[i].seatid=i,"no"==cc.global.amObserve&&e.playerlist[i].id!=cc.global.user.id&&(t=1-this.posBaseIdx),this.playerexist(e.playerlist[i])){var a=this.getPlayer(e.playerlist[i].id),s=this.getPlayerBoard(e.playerlist[i].id);a.init(this,e.playerlist[i],t%2,i),s.init(this,e.playerlist[i],t%2,i),s.node.setPosition(this.playerBoardSlotPos[t%2]),a.seatid=s.seatid=t%2,a.layoutForSeat(),s.layoutForSeat()}else{var r=cc.instantiate(this.paduk_player);"yes"!=cc.global.amObserve?e.playerlist[i].id==cc.global.user.id?r.parent=this.selfplayer:r.parent=this.opponentplayer:r.parent=t%2==0?this.selfplayer:this.opponentplayer,r.getComponent("PadukPlayer").init(this,e.playerlist[i],t%2,i),this.playerlist.push(r);var n=cc.instantiate(this.paduk_player_board);n.parent=this.statusboard,n.setPosition(this.playerBoardSlotPos[t%2]),n.getComponent("PadukPlayerBoard").init(this,e.playerlist[i],t%2,i),this.playerboardlist.push(n)}t++}1==e.playerlist.length?(this.setWaitingState(),this.cleanAfterAllCards()):2==e.playerlist.length&&this.setReadyState(),"yes"==cc.global.amObserve&&e.playerlist.length<2?1==cc.global.championMode?this.btn_enter.active=!1:0==cc.global.championMode&&this.notReplay&&(this.btn_enter.active=!0):this.btn_enter.active=!1,this.showWaitingTimer()},setWaitingState:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("PadukPlayerBoard");t&&t.setState("Pending")}},setReadyState:function(){var e=this.getLanguageText("READY_0")+"?";if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("PadukPlayerBoard");i&&i.setState(e)}},observer_event:function(e,t){t.observerbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i],t),a.getComponent("Observer").nickname.node.active=!1,a.parent=t.observerbench,t.observerlist[i]=a}},removeBoardPlayers:function(e){for(var t=0;t<this.playerlist.length;t++){for(var i=this.playerlist[t].getComponent("PadukPlayer"),a=!1,s=0;s<e.length;s++)if(i.userdata.id==e[s].id){a=!0;break}1!=a&&(this.playerlist[t].destroy(),this.playerlist.splice(t,1),this.playerboardlist[t].destroy(),this.playerboardlist.splice(t,1))}},isBoardPlayersChanged:function(e){if(0==this.playerlist.length&&0!=e.length)return!0;if(this.playerlist.length!=e.length)return!0;for(var t=0;t<e.length;t++)if(!this.getPlayer(e[t].id))return!0;return!1},playerexist:function(e){for(var t=0;t<this.playerlist.length;t++)if(null!=this.playerlist[t]&&this.playerlist[t].getComponent("PadukPlayer").userdata.id==e.id)return!0;return!1},initGameboard:function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0];c.init(!0),this.canplay=!1,this.mainBoard.getChildByName("PieceBoard").on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.closeloadding()},onTouchStart:function(e){if(this.canplay&&this.isGamePlaying){var t=this.mainBoard.getChildByName("PieceBoard").convertTouchToNodeSpace(e.touch),i=c.getPosFromPosition(t.x,t.y);this.sendPlacePiece(i[0],i[1])}},hideGoAble:function(){},showGoAble:function(e,t){for(var i=1;i<c.goable.length;i++){var a=c.goable[i].point,s=13*a.row+a.col;this.piece_hint_array[s].getComponent("PadukPieceHint").show()}},unpickAllPieces:function(){},changeTurn:function(e,t){0==t.seatid?(e.turnSeat=0,e.giveTurn1(e.paduk_timer)):(e.turnSeat=1,e.giveTurn2(e.paduk_timer))},showJumpOff:function(e,t){var i=13*e+t;this.piece_hint_array&&this.piece_hint_array[i]&&this.piece_hint_array[i].getComponent("PadukPieceHint").show()},sendPlacePiece:function(e,t){if("no"==cc.global.amObserve&&0==this.turnSeat){this.turnCount.local+=1;var i=this.convertPoint(e,t);e=i[0],t=i[1],this.socket().exec("playpaduk",{extparams:{prow:e,pcol:t,roomid:this.roomid,localturn:this.turnCount.local}})}},convertPoint:function(e,t){return[e,t]},sendState:function(){this.getPlayerBoard(cc.global.user.id).isReady()||this.socket().exec("ready",{extparams:{roomid:this.roomid}})},userready_event:function(e,t){cc.global.audio.playEffectAud("ready");var i=t.getPlayerBoard(e.userid);if(i){var a=t.getLanguageText("PREPARED_0");i.setState(a),i.startTimer(30)}},initPadukBoard:function(e){(c=new s).setBoardInfo(680,30,e),c.init(!0),this.pieces=[],this.huazom=[],this.drawPadukBoard(),this.makeAllPieces()},banker_event:function(e,t){t.closeConfirm(),t.hideAllStatus(),t.initGameboard(!0),t.isGamePlaying=!0,t.isNewRoom=!1,t.paduk_timer=30,e.msg&&!isNaN(e.msg)&&(t.paduk_timer=parseInt(e.msg)),e.extmsg&&!isNaN(e.extmsg)&&(c.dem=parseInt(e.extmsg)),t.playersBoard.getChildByName("dem").getComponent(cc.Label).string=": "+c.dem/2;for(var i=t.getPlayer(e.userid),a=0;a<t.playerlist.length;a++)t.playerlist[a].getComponent("PadukPlayer").hideBanker();i&&(i.showBanker(),0==i.seatid?(t.turnSeat=0,t.giveTurn1(t.paduk_timer)):(t.turnSeat=1,t.giveTurn2(t.paduk_timer))),t.bankerId=e.userid,0==i.seatid?t.bottomBoard.getChildByName("black_board").getComponent(cc.Sprite).spriteFrame=t.padukAtlas.getSpriteFrame("black_board"):t.bottomBoard.getChildByName("black_board").getComponent(cc.Sprite).spriteFrame=t.padukAtlas.getSpriteFrame("white_board")},playpaduk_event:function(e,t){if((!t.notReplay||parseInt(t.roomid)==parseInt(e.extdata.roomid))&&(!e.extdata||!e.extdata.data||t.showResult(e.extdata.data.result))){t.lblTurnCount&&e.extdata&&e.extdata.turncount&&(t.lblTurnCount.string="\n"+Math.round(parseInt(e.extdata.turncount)/2)+"Turn",t.turnCount.server=parseInt(e.extdata.turncount),parseInt(cc.global.user.id)==parseInt(e.userid)&&"p"!=e.extdata.type||(t.turnCount.local+=1)),t.paduk_timer=30,e.extdata.timer&&!isNaN(e.extdata.timer)&&(t.paduk_timer=parseInt(e.extdata.timer)),t.closeConfirm(),t.stopTurnTimerAll();var i=t.getPlayer(e.userid),a=t.getPlayer(e.extdata.next);if(t.currentPlayerId=e.extdata.next,i){e.extdata.passcount&&i.updatePassCount(e.extdata.passcount);var s=e.extdata.data.row,r=e.extdata.data.col;if(-1!=s||-1!=r){t.placePiece(parseInt(e.extdata.data.prow),parseInt(e.extdata.data.pcol),parseInt(e.extdata.data.ptype),parseInt(e.extdata.data.pid)),null!=e.extdata.data.dpos&&0<e.extdata.data.dpos.length&&(t.removeDeadPieces(e.extdata.data.dpos),t.showDeadCount(e.extdata.data.deadb,e.extdata.data.deadw,e.extdata.data.ptype,i));var n=e.extdata.data.territory;if(n){c.territory=[];for(var o=0;o<n.length;o++)c.territory[o]=t.decode(n[o])}e.extdata.data.state&&e.extdata.data.score&&(c.setData(e.extdata.data.state.bscore,e.extdata.data.state.wscore,e.extdata.data.state.dem,e.extdata.data.score),t.playersBoard.getChildByName("dem").getComponent(cc.Label).string=": "+c.dem/2),t.showTerritory(),t.changeTurn(t,a)}else t.changeTurn(t,a)}t.showBoardClaim(e.extdata.type);var l="";switch(e.extdata.type){case"n":break;case"p":l="pass"}""!=l&&i.speech(l)}},pexit_event:function(e,t){t.paduk_timer=30,e.extdata.timer&&!isNaN(e.extdata.timer)&&(t.paduk_timer=parseInt(e.extdata.timer));var i=t.getPlayer(e.extdata.next);t.changeTurn(t,i);var a=t.bottomBoard.getChildByName("ControlButton").getChildByName("btnExit");a.getComponent(cc.Button).interactable=!0,a.opacity=255,e.userid!=cc.global.user.id&&t.notReplay&&"no"==cc.global.amObserve&&t.checkConfirm("?",function(){t.socket().exec("pexit",{extparams:{roomid:t.roomid}})},function(){},null,{isChess:!1})},showDeadCount:function(e,t,i,a){1==i?a.updateEarnCount(t):2==i&&a.updateEarnCount(e)},stopTurnTimerAll:function(){this.turntimer.getComponent("TurnTimer").stopAllTimer()},showBoardClaim:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";switch(e){case"n":break;case"p":"pass";break;case"w":"win";break;case"l":"defeat";break;case"d":"draw"}if("CH"==cc.global.curLanguage?"_ch":"RU"==cc.global.curLanguage?"_ru":"_en",this.boardclaim.node.children[0].active=!1,"tech"==t&&(this.boardclaim.node.children[0].active=!0,this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string={l:"Lose",w:"Victory"}[e]),"w"==e)this.runFinishAction("dzz_cj_win");else if("l"==e)this.runFinishAction("dzz_cj_lose");else if("p"==e){this.boardclaim.node.children[0].active=!0;var i=this.getLanguageText("PASS_0");this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string=i,this.boardclaim.getComponent(cc.Animation).play()}},showFinishLayer:function(){this.isSuicide?this.finishLayer.getChildByName("result").getComponent(cc.Label).string="":this.finishLayer.getChildByName("result").getComponent(cc.Label).string=this.getScoreFromNumber(),this.finishLayer.getComponent(cc.Animation).play()},runFinishAction:function(e){if("yes"!=cc.global.amObserve&&this.finishAct&&this.finishAct.getComponent(sp.Skeleton)){var t=cc.callFunc(this.enableFinishAni,this,e),i=cc.callFunc(this.disableFinishAni,this);this.node.runAction(cc.sequence(t,cc.delayTime(3.5),i)),this.showFinishLayer()}},enableFinishAni:function(e,t){if(this.finishAct){var i=this.finishAct.getComponent(sp.Skeleton);i&&(this.finishAct.active=!0,i.animation=t)}},disableFinishAni:function(e){this.finishAct&&(this.finishAct.active=!1)},hideAllPieces:function(){for(var e=0;e<c.m_nPlaysetBoardsize;e++)for(var t=0;t<c.m_nPlaysetBoardsize;t++)null!=this.pieces[e][t]&&this.pieces[e][t].getComponent("PadukPiece").hidePiece();if(this.piece_array&&0<this.piece_array.length)for(var i=0;i<this.piece_array.length;i++)this.piece_array[i].active=!1},recovery_event:function(e,t){t.isGamePlaying=!0,t.getPlayer(e.extdata.banker).showBanker(),t.hideAllStatus(),t.initGameboard(!1),e.timer&&!isNaN(e.timer)&&(t.paduk_timer=parseInt(e.timer)),e.userid&&e.extdata.timer&&t.setTurn(e.userid,e.extdata.timer),t.bankerId=e.extdata.banker,0==t.getPlayer(e.extdata.banker).seatid?t.bottomBoard.getChildByName("black_board").getComponent(cc.Sprite).spriteFrame=t.padukAtlas.getSpriteFrame("black_board"):t.bottomBoard.getChildByName("black_board").getComponent(cc.Sprite).spriteFrame=t.padukAtlas.getSpriteFrame("white_board");var i=e.extdata.lastpiece;"pass"!=i&&(i=e.extdata.lastpiece.split(","));for(var a=0;a<e.extdata.board.length;a++)for(var s=0;s<e.extdata.board[a].length;s++)0!=e.extdata.board[a][s]&&t.pieces[a][s].getComponent("PadukPiece").showPiece(e.extdata.board[a][s],e.extdata.pid,"pass"!=i&&a==parseInt(i[0])&&s==parseInt(i[1]));var r=e.extdata.territory;if(r){c.territory=[];for(var n=0;n<r.length;n++)c.territory[n]=t.decode(r[n])}t.showTerritory(),e.extdata.state&&e.extdata.score&&(c.setData(e.extdata.state.bscore,e.extdata.state.wscore,e.extdata.state.dem,e.extdata.score),t.playersBoard.getChildByName("dem").getComponent(cc.Label).string=": "+c.dem/2);for(n=0;n<e.extdata.players.length;n++){var o=t.getPlayer(e.extdata.players[n].playuser);o&&e.extdata.players[n].pass&&o.updatePassCount(e.extdata.players[n].pass),o&&(o.userdata.id==t.bankerId?o.updateEarnCount(e.extdata.deadw):o.updateEarnCount(e.extdata.deadb))}},setTurn:function(e,t){var i=this.getPlayer(e);i&&(this.turnSeat=i.seatid),this.stopTurnTimerAll(),0==this.turnSeat?this.giveTurn1(t):1==this.turnSeat&&this.giveTurn2(t)},giveTurn1:function(e){this.canplay=!0,this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer1(e),this.togglePcsTurn(0))},giveTurn2:function(e){this.canplay=!1,this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer2(e),this.togglePcsTurn(1))},togglePcsTurn:function(e){},hideAllStatus:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("PadukPlayerBoard");t&&t.hideStatus()}},sendlines_event:function(e,t){var i=parseInt(e.extmsg);if(0<i){2<=i&&(i/=2,cc.global.audio.playEffectAud("charge"));var a=t.panScore*i,s=0;if("normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway)for(r=0;r<t.playerlist.length;r++)if(n=t.playerlist[r].getComponent("PadukPlayer")){if(0==n.userdata.goldcoins)return;0==s?s=n.userdata.goldcoins:s>n.userdata.goldcoins&&(s=n.userdata.goldcoins)}s<a&&(a=s),t.updateBetUpBalance(a),t.multiBetUp(a),t.pangolds=t.pangolds+2*a}},multiBetUp:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("PadukPlayer");i&&i.betup.getComponent("TetrisBetUp").init(e,i.seatid)}},workOutMatchCareer:function(e){for(var t=0;t<e.players.length;t++){var i=this.getPlayer(e.players[t].userid),a=this.getPlayerBoard(e.players[t].userid);i&&a&&("normal"==cc.global.user.selplayway?0<e.players[t].score&&(this.matchCareerData.tgolds[i.userdata.id]+=e.players[t].score-this.pangolds/2):"diamond"==cc.global.user.selplayway&&0<e.players[t].score&&(this.matchCareerData.tdiamonds[i.userdata.id]+=e.players[t].score-this.pangolds/2),2==e.players[t].win&&(this.matchCareerData.wins[i.userdata.id]++,i.userdata.id))}},allcards_event:function(e,t){clearTimeout(t.changeTurnTimer),t.otherEventCache=[],t.isGamePlaying=!1,t.pickedPiece=null,t.stopTurnTimerAll(),t.hideGoAble(),t.isShowTerritory=!0,t.showTerritory(),t.matchCareerData&&t.workOutMatchCareer(e);var i=t.playerlist.length==e.players.length;t.isSuicide=!1;for(var a=0;a<e.players.length;a++){var s=t.getPlayer(e.players[a].userid);if(e.players[a].getout&&(i=!1),s&&("normal"==cc.global.user.selplayway&&(s.userdata.goldcoins=parseInt(e.players[a].gold)),s.summary(e.players[a])),t.getPlayerBoard(e.players[a].userid)&&("suicide"!=e.title||e.players[a].win||(t.isSuicide=!0,(s=t.getPlayer(e.players[a].userid))&&s.showEmoticon(-1))),e.players[a].userid==cc.global.user.id)switch(t.notReplay&&(cc.global.user.goldcoins=e.players[a].gold),e.players[a].win){case 0:t.showBoardClaim("l",e.title);break;case 1:t.showBoardClaim("d",e.title);break;case 2:t.showBoardClaim("w",e.title)}}c.init(),i&&(t.endGameTimer=setTimeout(function(){t.endGameTimer=null,t.boardclaim.getComponent(cc.Animation).stop(),t.boardclaim.node.setScale(0,0),t.cleanAfterAllCards(),t.setReadyState()},5e3))},cleanAfterAllCards:function(){this.pangolds=0,cc.global.amObserve&&"no"==cc.global.amObserve&&this.showWaitingTimer();for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].getComponent("PadukPlayer").hideBanker(),this.playerlist[e].getComponent("PadukPlayer").updatePassCount(0),this.playerlist[e].getComponent("PadukPlayer").updateEarnCount(0);this.lblTurnCount&&(this.lblTurnCount.string="\n",this.turnCount.local=0,this.turnCount.server=0),this.isShowTerritory=!1,this.showTerritory(),this.hideAllPieces(),this.playersBoard.getChildByName("dem").getComponent(cc.Label).string=""},updateBetUpBalance:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("PadukPlayer");i&&(i.userdata.goldcoins-=e)}this.updatePlayerBalance()},updatePlayerBalance:function(){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("PadukPlayer");t&&t.updateBalance()}},showWaitingTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("PadukPlayerBoard");t&&t.startTimer(30)}},showReadyTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("PadukPlayerBoard");t&&t.startTimer(3)}},hideTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("PadukPlayerBoard");t&&t.stopTimer()}},getPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("PadukPlayer");if(i.userdata.id==e)return i}},getOtherPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("PadukPlayer");if(i.userdata.id!=e)return i}},getPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("PadukPlayerBoard");if(i.userdata.id==e)return i}},getOtherPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("PadukPlayerBoard");if(i.userdata.id!=e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},onClickGiveUp:function(){if(this.isGamePlaying){var e=this;if(this.turnSeat)return void this.alert("No your turn.");cc.global.audio.playVoiceSpeech("support/12_give_up");var t=this.getLanguageText("ARE_YOU_GIVE_UP");this.checkConfirm(t,function(){e&&e.socket().exec("suicide",{})},null)}},onClickTerritory:function(){(this.isGamePlaying||"no"!=cc.global.amObserve)&&(this.isShowTerritory=!this.isShowTerritory,this.showTerritory())},onClickPass:function(){if("no"==cc.global.amObserve&&0==this.turnSeat&&this.isGamePlaying){var e=this.bottomBoard.getChildByName("ControlButton").getChildByName("btnExit");e.getComponent(cc.Button).interactable=!1,e.opacity=150,this.socket().exec("pexit",{extparams:{roomid:this.roomid}})}},showTerritory:function(){for(var e=0;e<c.m_nPlaysetBoardsize;e++)for(var t=0;t<c.m_nPlaysetBoardsize;t++){var i=this.convertPoint(e,t);if(this.pieces[i[0]][i[1]].getComponent("PadukPiece").hideTerritory(),this.isShowTerritory){var a,s;switch(c.territory[e][t]){case 1:a=1,s=8;break;case 2:a=2,s=8;break;default:continue}this.pieces[i[0]][i[1]].getComponent("PadukPiece").showTerritory(s,a)}}this.isShowTerritory?(this.bottomBoard.getChildByName("ControlButton").getChildByName("btnTerritory").getComponent(cc.Sprite).spriteFrame=this.padukAtlas.getSpriteFrame("ic_hide_territory"),this.scoreResult.active=!0,this.scoreResult.getComponent(cc.Label).string=this.getScoreFromNumber()):(this.bottomBoard.getChildByName("ControlButton").getChildByName("btnTerritory").getComponent(cc.Sprite).spriteFrame=this.padukAtlas.getSpriteFrame("ic_show_territory"),this.scoreResult.active=!1)},getScoreFromNumber:function(){var e=c.m_score/2;return 0==Math.floor(e)?(0<=e?"Black ":"white ")+"Win.":(0<=e?"Black "+Math.floor(e):"White "+-Math.floor(e))+" Win."},onClickSfx:function(){if(this.btnSfx){var e=this.btnSfx,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},showChatSearch:function(){},showChatDialog:function(){this.onclickChat(0)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.notReplay){if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}if(!(e<0)){this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root();var a=this.chatpage.getComponent("Chat");a.init(this,e),a.base.x=a.base.y=0,this.ischat=!0}}},onClickEmoticon:function(){if(this.notReplay){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),this.isemoticon=!1;this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root();var e=this.emoticonpage.getComponent("Emoticon");e.init(this,!1),e.base.x=e.base.y=0,this.isemoticon=!0}},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase,a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg);var s=t.getObserver(e.userid);s&&s.showCallPlayer(i,e.msg)},callplayer_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg);var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg,!1)},emoticon_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg);var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},onClickFindEmptyRoom:function(){},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},onClickChangePiece:function(){1==this.tgpcsbtn.children[0].active&&(this.tgpcsbtn.children[0].active=!1,this.tgpcsbtn.children[1].active=!0,this.togglePieceMode(!0)),1==this.tgpcsbtn.children[1].active&&(this.tgpcsbtn.children[0].active=!0,this.tgpcsbtn.children[1].active=!1,this.togglePieceMode(!1))},onclickBack:function(){var e=this;if(this.notReplay)if(this.isGamePlaying&&"no"==cc.global.amObserve){if(this.turnSeat)return void this.alert("No your turn.");cc.global.audio.playVoiceSpeech("support/14_roomout"),this.checkConfirm("Are you sure to leave room? You will lose.",function(){e.socket().exec("leave",{})},null)}else this.socket().exec("leave",{});else this.exitPlay()},exitPlay:function(){var e=this;cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),null==this.exitTimer&&(this.exitTimer=setInterval(function(){e.finishAct&&!e.finishAct.active&&(e.returnToHall(),clearInterval(e.exitTimer),e.exitTimer=null)},500))},returnToHall:function(){this.loadding(),clearInterval(this.otherEventInvoker),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.startGameTimer&&clearTimeout(this.startGameTimer),this.endGameTimer&&clearTimeout(this.endGameTimer),this.hideTimer(),this.cleanAllPlayers(),this.scene("hall",this)},chpre_event:function(e,t){}}),cc._RF.pop()},{HHCommon:"HHCommon",PadukEngine:"PadukEngine"}],PadukEngine:[function(e,t,i){"use strict";cc._RF.push(t,"78f228AldFM+75K/i8wvJEc","PadukEngine");t.exports=function(){this.status=[],this.m_nPlaysetBoardType=0,this.m_nPlaysetBoardsize=9,this.pieces=[],this.m_score=0,this.territory=[],this.territoryB=0,this.territoryW=0,this.dem=13,this.setBoardInfo=function(e,t,i){switch(this.m_nPlaysetBoardType=i){case 0:this.m_nPlaysetBoardsize=9;break;case 1:this.m_nPlaysetBoardsize=13;break;case 2:this.m_nPlaysetBoardsize=19}this._size=e,this._padding=t},this.init=function(){0<arguments.length&&void 0!==arguments[0]&&arguments[0]&&this.initStatus()},this.initStatus=function(){this.status=[],this.territory=[];for(var e=0;e<this.m_nPlaysetBoardsize;e++){for(var t=[],i=0;i<this.m_nPlaysetBoardsize;i++)t[i]=0;this.status[e]=t,this.territory[e]=t}0==this.m_nPlaysetBoardType?this.huazom=[[4,4]]:1==this.m_nPlaysetBoardType?this.huazom=[[3,3],[3,9],[6,6],[9,3],[9,9]]:2==this.m_nPlaysetBoardType&&(this.huazom=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]),this.m_nTakenBlack=0,this.m_nTakenWhite=0,this.m_wHistory=[],this.m_score=0,this.b_score=0,this.w_score=0,this.dem=13},this.placePiece=function(e,t,i){if(-1==e&&-1==t)return this.m_wHistory.push("pass"),1;if(this.isValid(e,t,i)){var a=this.testStone(e,t,i);return 0!=a&&2!=a||(this.m_wHistory.push(e+","+t),this.findDeadStones(e,t,i)),a}},this.isValid=function(e,t,i){return!(e>this.m_nPlaysetBoardsize||e<0||t>this.m_nPlaysetBoardsize||t<0||2<i||i<0)},this.containsPiece=function(e,t){return 0!=this.status[e][t]},this.getPos=function(e,t){var i=(this._size-2*this._padding)/(this.m_nPlaysetBoardsize-1);return[this._padding+i*t,this._size-this._padding-i*e]},this.getPosFromPosition=function(e,t){var i=(this._size-2*this._padding)/(this.m_nPlaysetBoardsize-1);return[Math.floor((this._size-this._padding-t)/i+.5),Math.floor((e-this._padding)/i+.5)]},this.testStone=function(e,t,i){var a=!1;if(this.m_nCaturedStones=0,this.containsPiece(e,t))return-4;this.status[e][t]=i;var s,r=this.testStoneA(e,t),n=3-i,o=0;if(0<e&&this.status[e-1][t]==n&&(1==(s=this.testStoneC(e-1,t))?(o+=1,t,e-1):2==s&&(a=!0)),0<t&&this.status[e][t-1]==n&&(1==(s=this.testStoneC(e,t-1))?(o+=1,t-1,e):2==s&&(a=!0)),e<this.m_nPlaysetBoardsize-1&&this.status[e+1][t]==n&&(1==(s=this.testStoneC(e+1,t))?(o+=1,t,e+1):2==s&&(a=!0)),t<this.m_nPlaysetBoardsize-1&&this.status[e][t+1]==n&&(1==(s=this.testStoneC(e,t+1))?(o+=1,t+1,e):2==s&&(a=!0)),r){if(0==o)return this.status[e][t]=0,-1;if(1==o&&1==this.m_nCaturedStones&&this.testStonePae(e,t))return this.status[e][t]=0,-5}return a?2:0},this.testStoneA=function(e,t){for(var i,a,s,r=[],n=this.status[e][t],o=0;o<this.m_nPlaysetBoardsize;o++){for(var l=[],c=0;c<this.m_nPlaysetBoardsize;c++)l[c]=0;r[o]=l}r[e][t]=1;do{for(s=i=0;s<this.m_nPlaysetBoardsize;s++)for(a=0;a<this.m_nPlaysetBoardsize;a++)r[s][a]||this.status[s][a]!=n||(0<a&&r[s][a-1]||0<s&&r[s-1][a]||a<this.m_nPlaysetBoardsize-1&&r[s][a+1]||s<this.m_nPlaysetBoardsize-1&&r[s+1][a])&&(r[s][a]=1,i++)}while(0!=i);for(s=i=0;s<this.m_nPlaysetBoardsize;s++){for(a=0;a<this.m_nPlaysetBoardsize&&(0!=this.status[s][a]||!(0<a&&r[s][a-1]||0<s&&r[s-1][a]||a<this.m_nPlaysetBoardsize-1&&r[s][a+1]||s<this.m_nPlaysetBoardsize-1&&r[s+1][a]));a++);if(a<this.m_nPlaysetBoardsize)break}return!(s<this.m_nPlaysetBoardsize)},this.testStoneB=function(e,t){for(var i,a,s,r=[],n=this.status[e][t],o=0;o<this.m_nPlaysetBoardsize;o++){for(var l=[],c=0;c<this.m_nPlaysetBoardsize;c++)l[c]=0;r[o]=l}r[e][t]=1;do{for(s=i=0;s<this.m_nPlaysetBoardsize;s++)for(a=0;a<this.m_nPlaysetBoardsize;a++)r[s][a]||this.status[s][a]!=n||(0<a&&r[s][a-1]||0<s&&r[s-1][a]||a<this.m_nPlaysetBoardsize-1&&r[s][a+1]||s<this.m_nPlaysetBoardsize-1&&r[s+1][a])&&(r[s][a]=1,i++)}while(0!=i);for(s=i=0;s<this.m_nPlaysetBoardsize;s++){for(a=0;a<this.m_nPlaysetBoardsize&&(0!=this.status[s][a]||!(0<a&&r[s][a-1]||0<s&&r[s-1][a]||a<this.m_nPlaysetBoardsize-1&&r[s][a+1]||s<this.m_nPlaysetBoardsize-1&&r[s+1][a]));a++);if(a<this.m_nPlaysetBoardsize)break}if(!(s<this.m_nPlaysetBoardsize))for(s=0;s<this.m_nPlaysetBoardsize;s++)for(a=0;a<this.m_nPlaysetBoardsize;a++)if(0!=r[s][a]){this.m_wHistory.push(s+","+a);var h=this.status[s][a];this.status[s][a]=0,1==h?this.m_nTakenBlack++:2==h&&this.m_nTakenWhite++}},this.testStoneC=function(e,t){for(var i,a,s,r=[],n=this.status[e][t],o=0,l=0;l<this.m_nPlaysetBoardsize;l++){for(var c=[],h=0;h<this.m_nPlaysetBoardsize;h++)c[h]=0;r[l]=c}r[e][t]=1;do{for(s=i=0;s<this.m_nPlaysetBoardsize;s++)for(a=0;a<this.m_nPlaysetBoardsize;a++)r[s][a]||this.status[s][a]!=n||(0<a&&r[s][a-1]||0<s&&r[s-1][a]||a<this.m_nPlaysetBoardsize-1&&r[s][a+1]||s<this.m_nPlaysetBoardsize-1&&r[s+1][a])&&(r[s][a]=1,i++)}while(0!=i);for(s=i=0;s<this.m_nPlaysetBoardsize;s++){for(a=0;a<this.m_nPlaysetBoardsize;a++)if(0==this.status[s][a])if(0<a&&r[s][a-1]||0<s&&r[s-1][a]||a<this.m_nPlaysetBoardsize-1&&r[s][a+1]||s<this.m_nPlaysetBoardsize-1&&r[s+1][a]){if(2<=++o)break}else;if(a<this.m_nPlaysetBoardsize)break}if(1==o)return 2;if(s<this.m_nPlaysetBoardsize||1<o)return 0;for(s=i=0;s<this.m_nPlaysetBoardsize;s++)for(a=0;a<this.m_nPlaysetBoardsize;a++)r[s][a]&&i++;return this.m_nCaturedStones=i,1},this.testStonePae=function(e,t){return 0<this.m_wHistory.length&&this.m_wHistory[this.m_wHistory.length-1]==e+","+t},this.findDeadStones=function(e,t,i){var a=3-i;0<e&&this.status[e-1][t]==a&&this.testStoneB(e-1,t),0<t&&this.status[e][t-1]==a&&this.testStoneB(e,t-1),e<this.m_nPlaysetBoardsize-1&&this.status[e+1][t]==a&&this.testStoneB(e+1,t),t<this.m_nPlaysetBoardsize-1&&this.status[e][t+1]==a&&this.testStoneB(e,t+1)},this.findDeadPos=function(e,t){for(var i=[],a=0;a<this.m_nPlaysetBoardsize;a++)for(var s=0;s<this.m_nPlaysetBoardsize;s++)0<e[a][s]&&0==t[a][s]&&i.push([a,s]);return i},this.setData=function(e,t,i,a){this.b_score=parseInt(e),this.w_score=parseInt(t),this.dem=parseInt(i),this.m_score=parseInt(a)}},cc._RF.pop()},{}],PadukPiece:[function(e,t,i){"use strict";cc._RF.push(t,"731489v8vNOq7kz6i9mvkod","PadukPiece");var a=e("HHCommon");cc.Class({extends:a,properties:{anim:{default:null,type:cc.Animation},piece:{default:null,type:cc.Sprite},pieceIndex:{default:null,type:cc.Label},pieceAtlas:{default:null,type:cc.SpriteAtlas},territory:{default:null,type:cc.Sprite},territoryAtlas:{default:null,type:cc.SpriteAtlas}},init:function(e,t,i){this.row=e,this.col=t,this.index=-1,this.boardtype=i},showHintPiece:function(e){var t="stone_";1==e?t+="black":2==e&&(t+="white"),t+="_"+this.boardtype,this.piece.node.active=!0,this.piece.spriteFrame=this.pieceAtlas.getSpriteFrame(t),this.piece.node.opacity=150},showPiece:function(e,t,i){this.hideTerritory();var a="stone_";1==e?a+="black":2==e&&(a+="white"),this.color=e,this.piece.node.active=!0,this.piece.spriteFrame=this.pieceAtlas.getSpriteFrame(a),this.piece.node.opacity=255,i&&(this.index=t,this.showId(e,t),this.playAnim()),1==this.boardtype?this.node.setScale(.7,.7):2==this.boardtype?this.node.setScale(.5,.5):this.node.setScale(1,1)},hidePiece:function(){this.piece.node.active=!1,this.pieceIndex.node.active=!1,this.hideAnim(),this.hideTerritory()},showId:function(e,t){this.pieceIndex.node.active=!0,1==e?this.pieceIndex.node.color=new cc.color(255,255,255):2==e&&(this.pieceIndex.node.color=new cc.color(0,0,0)),this.pieceIndex.string=t},hideId:function(){this.pieceIndex.node.active=!1},playAnim:function(){this.anim.node.active=!0,this.anim.play("pieceanim")},hideAnim:function(){this.anim.node.active=!1},showTerritory:function(e,t){this.piece.node.active&&this.color==t?this.territory.node.active=!1:(this.territory.node.active=!0,this.territory.spriteFrame=this.territoryAtlas.getSpriteFrame("territory"+e+"_"+(1==t?"black":"white")+"_"+this.boardtype))},hideTerritory:function(){this.territory.node.active=!1}}),cc._RF.pop()},{HHCommon:"HHCommon"}],PadukPlayerBoard:[function(e,t,i){"use strict";cc._RF.push(t,"2cba3m1oehJEaPAxX2Phf8b","PadukPlayerBoard");var a=e("HHCommon");cc.Class({extends:a,properties:{countdown:{default:null,type:cc.Label},status:{default:null,type:cc.Label},tip:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.layoutForSeat()},startTimer:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode||!(3<e)){var t=this;t.stopTimer(),t.countdown.node.active=!0,t.countdown.string=e,t.timer||(t.timer=setInterval(function(){0<e?t.countdown&&(e--,t.countdown.string=e):t.stopTimer()},1e3))}},stopTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null),this.countdown&&(this.countdown.node.active=!1)},setState:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode){this.status.node.active=!0,this.status.string=e;var t=this.getLanguageText("READY_0")+"?",i=this.getLanguageText("PREPARED_0");t==e&&this.userdata.id==cc.global.user.id&&"no"==cc.global.amObserve?this.tip.active=!0:this.tip.active=!1}else this.status.string=i},hideTip:function(){this.tip.active=!1},hideStatus:function(){this.stopTimer(),this.hideTip(),this.status.node.active=!1},layoutForSeat:function(){0==this.seatid||this.seatid},isReady:function(){return this.getLanguageText("PREPARED_0")==this.status.string},onClickReady:function(){this.parent&&this.parent.processReadyState()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],PadukPlayer:[function(e,t,i){"use strict";cc._RF.push(t,"c1307klLS9AsaS6D8MiUJ40","PadukPlayer");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},nickname:{default:null,type:cc.Label},goldcoin_base:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},betup:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},winorlose:{default:null,type:cc.Node},banker:{default:null,type:cc.Node},passCount:{default:null,type:cc.Label},earnCount:{default:null,type:cc.Label}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.nickname.string=t.nickname,1==cc.global.championMode||cc.global.championMode,this.goldcoins.string=this.numformat(t.goldcoins),this.goldcoins.node.parent.active=!0,this.loadAvatar(t.avatarurl,t.gender),this.layoutForSeat()},speech:function(e){var t=this.userdata.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)},onClickDisInfo:function(){},updateCareer:function(e){},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},spendDiamondForLuck:function(e){this.updateBalance()},showCallPlayer:function(e,t){var i=this;this.hideCallPlayer(),cc.global.audio.playVoiceChatWithType(this.userdata.playcharacter,t),this.callplayer.active=!0,this.callplayer.children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onClickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userdata.id},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){cc.global.user.id==this.userdata.id?this.parent.onClickEmoticon&&this.parent.onClickEmoticon():this.onClickCallPlayer()},layoutForSeat:function(){0==this.seatid?(this.node.scaleX=1,this.winorlose.scaleX=1,this.node.getChildByName("userinfosubpan").scaleX=1,this.node.getChildByName("avatar").scaleX=1,this.node.getChildByName("emoticon").scaleX=1,this.callplayer.children[0].scaleX=1,this.node.getChildByName("banker").scaleX=1,this.node.getChildByName("passCount").scaleX=1,this.node.getChildByName("earnCount").scaleX=1):1==this.seatid&&(this.node.scaleX=-1,this.winorlose.scaleX=-1,this.node.getChildByName("userinfosubpan").scaleX=-1,this.node.getChildByName("avatar").scaleX=-1,this.node.getChildByName("emoticon").scaleX=-1,this.callplayer.children[0].scaleX=-1,this.node.getChildByName("banker").scaleX=-1,this.node.getChildByName("passCount").scaleX=-1,this.node.getChildByName("earnCount").scaleX=-1)},summary:function(e){var a=this;if(this.updateCareer(e),this.winorlose.getComponent(cc.Animation).play(),2!=e.win)return cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("lose"),this.winorlose.children[0].getComponent(cc.Label).string="-"+this.numformat(Math.abs(e.exp)),this.winorlose.children[1].getComponent(cc.Label).string="-"+this.numformat(-1*e.score),void(this.goldcoins.string=this.numformat(e.gold));cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("win"),this.winorlose.children[0].getComponent(cc.Label).string="+"+this.numformat(e.exp),this.winorlose.children[1].getComponent(cc.Label).string="+"+this.numformat(e.score),e.orig_gold=e.gold-e.score,"diamond"==cc.global.user.selplayway&&(e.orig_gold=e.diamond-e.score);var t=cc.callFunc(function(e,t){t.orig_gold+Math.round(t.score/5)>("diamond"==cc.global.user.selplayway?t.diamond:t.gold)?"diamond"==cc.global.user.selplayway?t.orig_gold=t.diamond:t.orig_gold=t.gold:t.orig_gold=t.orig_gold+Math.round(t.score/5);var i=e.getComponent("PadukPlayer").goldcoins.node;i.getComponent(cc.Label).string=a.numformat(t.orig_gold),i.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1)))},this,e),i=cc.callFunc(function(e,t){e.getComponent("PadukPlayer").goldcoins.node.getComponent(cc.Label).string=a.numformat(t.gold)},this,e),s=cc.sequence(cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,i);this.node.runAction(s)},showFuncStatus:function(){},showBanker:function(){this.banker.active=!0,2<=this.banker.children.length&&(this.banker.children[0].active=0==this.seatid,this.banker.children[1].active=0!=this.seatid)},hideBanker:function(){this.banker.active=!1},updatePassCount:function(e){if(this.passCount){var t=3-parseInt(e);if(0<=t)this.passCount.string=""+t;else{var i=this.getLanguageText("NO_PASS_COUNT");this.passCount.string=i}}},updateEarnCount:function(e){this.earnCount&&(this.earnCount.string=e)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],Perspective3d:[function(e,t,i){"use strict";cc._RF.push(t,"ca8e3pcVthA8rf8ASRsy9Lz","Perspective3d"),Object.defineProperty(i,"__esModule",{value:!0}),i.Perspective3d=void 0;var a=function(){function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}}(),s=e("./Vector3d");i.Perspective3d=function(){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),this.initVariables(),this.view=e,this.vector=new s.Vector3d,this.vector1=new s.Vector3d,this.vector2=new s.Vector3d,this.projection=new s.Vector3d}return a(t,[{key:"initVariables",value:function(){this.projection=null,this.vector=null,this.vector1=null,this.vector2=null,this.view=null}},{key:"normSquared",value:function(e,t,i){var a=this.view.f12x-e,s=this.view.f13y-t,r=this.view.f14z-i;return a*a+s*s+r*r}},{key:"mapScale",value:function(e){if(0==e)return 1;var t=this.view.get(2);return t/(t-e)}},{key:"mapX",value:function(e,t){return 0==t?e:e+(this.view.get(0)-e)*(-t/(this.view.get(2)-t))}},{key:"mapY",value:function(e,t){return 0==t?e:e+(this.view.get(1)-e)*(-t/(this.view.get(2)-t))}},{key:"rMapX",value:function(e,t){if(0==t)return e;var i=this.view.get(2);return this.view.get(0)+(e-this.view.get(0))*((i-t)/i)}},{key:"rMapY",value:function(e,t){if(0==t)return e;var i=this.view.get(2);return this.view.get(1)+(e-this.view.get(1))*((i-t)/i)}},{key:"prepare",value:function(e,t){e.zoomRatio=t}}]),t}();cc._RF.pop()},{"./Vector3d":"Vector3d"}],PlayerRowItem:[function(e,t,i){"use strict";cc._RF.push(t,"582d9jWgVVOiasb8m6S1g+M","PlayerRowItem");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},player:{default:null,type:cc.Label},goldcoins:{default:null,type:cc.Label},diamonds:{default:null,type:cc.Label},game:{default:null,type:cc.Label},status:{default:null,type:cc.Label},online:{default:null,type:cc.Node},btn_invite:{default:null,type:cc.Node},no_invite:{default:null,type:cc.Node},favs:{default:null,type:cc.Label},favbtn:{default:null,type:cc.Node},userinfodlg:{default:null,type:cc.Prefab},column:{default:null,type:cc.Node},vipcrown:{default:null,type:cc.Node},crownlist:{default:null,type:cc.Node},vipbadge:{default:null,type:cc.Node},viplevel:{default:null,type:cc.Label}},init:function(e,t){"fms"==(this.parent=t).curMode?(this.hideColumn(1),this.hideColumn(2),this.showColumn(6),this.column.getComponent(cc.Layout).spacingX=75):"friends"==t.curMode?(this.showColumn(6),this.column.getComponent(cc.Layout).spacingX=0):"wanabes"==t.curMode&&(this.hideColumn(6),this.column.getComponent(cc.Layout).spacingX=32),this.data=e,this.loadAvatar(e.avatarurl,e.gender),this.player.string=e.nickname,e.nickname!=e.username&&(this.player.string+="\n"+e.username),this.goldcoins.string=this.numformat(e.free),this.favs.string=this.numformat(e.follow),this.initFavBtn(),null!=e.playertype&&""!=e.playertype?("playing"==e.gamestatus?(this.status.string="Playing",this.status.node.color=new cc.Color(255,255,255,255),this.no_invite.active=!0):("observe"==e.playertype?this.status.string="Watching":this.status.string="Pending",this.status.node.color=new cc.Color(231,218,66,255)),this.online.children[0].active=!0,this.online.children[1].active=!1):(this.status.string="- -",this.status.node.color=new cc.Color(255,255,255,255),this.no_invite.active=!0,this.online.children[0].active=!1,this.online.children[1].active=!0)},onClickInvite:function(){this.ready()&&("ready"==cc.global.gamestatus?this.alert(""):"waiting"==cc.global.gamestatus?(this.socket().exec("invite",{extparams:{callplayer:this.data.id}}),this.btn_invite.runAction(cc.sequence(cc.fadeOut(.1),cc.scaleTo(0,0,0),cc.delayTime(3),cc.scaleTo(0,1,1),cc.fadeIn(.1)))):"playing"==cc.global.gamestatus&&("yes"==cc.global.amObserve?this.alert("Watching"):this.alert("Playing")))},initFavBtn:function(){cc.global.user.id!=this.data.id?"fms"==this.parent.curMode?1==this.data.status&&(this.favbtn.children[0].active=!1,this.favbtn.children[1].active=!0):"friends"==this.parent.curMode&&(this.favbtn.children[0].active=!1,this.favbtn.children[1].active=!1,this.favbtn.children[2].active=!0):this.favbtn.active=!1},onClickFav:function(){},hideColumn:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e&&(this.column.children[e].active=!1)},showColumn:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e&&(this.column.children[e].active=!0)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],PointHistory:[function(e,t,i){"use strict";cc._RF.push(t,"f449em6Z7VK8YTm+M2qhQUs","PointHistory"),Object.defineProperty(i,"__esModule",{value:!0});i.PointHistory=function e(t,i,a){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.f5x=t,this.f6y=i,this.timestamp=a};cc._RF.pop()},{}],PojinDeclare:[function(i,e,t){"use strict";cc._RF.push(e,"83ce0wJ43JAAb/jsixjDaun","PojinDeclare");var a=i("HHCommon");cc.Class({extends:a,properties:{mypojin:{default:null,type:cc.Node},mclock:{default:null,type:cc.Node},enemypojin:{default:null,type:cc.Node},eclock:{default:null,type:cc.Node},panel:{default:null,type:cc.Node},confirmbtn:{default:null,type:cc.Button},endbtn:{default:null,type:cc.Button},kingcheckbtn:{default:null,type:cc.Toggle},timeselopt:{default:null,type:cc.Node},mynickname:{default:null,type:cc.Node},enemynickname:{default:null,type:cc.Node}},init:function(e,t){this.parent=e,this.chessEngine=t,this.curTurn=0},setPlayers:function(e){if(e)for(var t=0;t<e.length;t++){var i=e[t].getComponent("ChessPlayer");"no"==cc.global.amObserve&&this.parent.notReplay?i.userdata.id==cc.global.user.id?this.mynickname.getComponent(cc.Label).string=i.userdata.nickname:this.enemynickname.getComponent(cc.Label).string=i.userdata.nickname:0==i.seatid?this.mynickname.getComponent(cc.Label).string=i.userdata.nickname:this.enemynickname.getComponent(cc.Label).string=i.userdata.nickname}},showPojin:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:20;this.panel.active=!0,this.turnChangeCount=0,this.myPojinType=-1,this.initialTime=5,this.updateTimeSelOption(),this.isMyTurn=!1,this.endbtn.node.active=!1,this.kingcheckbtn.interactable=!1,this.confirmbtn.node.active=!1;var i=this.parent.getPlayer(e);i&&(0==i.seatid?("no"==cc.global.amObserve&&this.parent.notReplay&&(this.confirmbtn.node.active=!0,this.kingcheckbtn.interactable=!0),this.myTurn(t)):this.enemyTurn(t));t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:20},hidePojin:function(){this.panel.active=!1,this.stopMyTimer(),this.stopEnemyTimer();for(var e=0;e<this.mypojin.children[0].children.length;e++)this.mypojin.children[0].children[e].getComponent("NotifyTabButton").init(!0,0,!0,cc.hexToColor("#1F1002"),cc.Color.WHITE);for(e=0;e<this.enemypojin.children[0].children.length;e++)this.enemypojin.children[0].children[e].getComponent("NotifyTabButton").init(!0,0,!0,cc.hexToColor("#1F1002"),cc.Color.WHITE)},onClickPojin:function(e,t){"no"==cc.global.amObserve&&(this.isMyTurn?this.onChangeMyPojin(cc.global.user.id,t):null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.getComponent("ToastCtrl").init("",""),cc.global.opentoast.parent=this.panel.children[0]))},onChangeMyPojin:function(e,t){this.myPojinType!=t&&(this.myPojinType=t,this.endbtn.node.active=!1,this.confirmbtn.node.opacity=255,this.confirmbtn.interactable=!0),t=parseInt(t);for(var i=0;i<this.mypojin.children[0].children.length;i++)i==t-1?this.mypojin.children[0].children[i].getComponent("NotifyTabButton").init(!1,0,!0,cc.hexToColor("#1F1002"),cc.Color.WHITE):this.mypojin.children[0].children[i].getComponent("NotifyTabButton").init(!0,0,!0,cc.hexToColor("#1F1002"),cc.Color.WHITE);this.changePojinArrange(e,t)},onChangeEnemyPojin:function(e,t){t=parseInt(t);for(var i=0;i<this.enemypojin.children[0].children.length;i++)i==t-1?this.enemypojin.children[0].children[i].getComponent("NotifyTabButton").init(!1,0,!0,cc.hexToColor("#1F1002"),cc.Color.WHITE):this.enemypojin.children[0].children[i].getComponent("NotifyTabButton").init(!0,0,!0,cc.hexToColor("#1F1002"),cc.Color.WHITE);this.changePojinArrange(e,t)},changePojinArrange:function(e,t){this.parent.getPlayer(e).seatid%2==0?this.chessEngine.setPojinType(t,null):this.chessEngine.setPojinType(null,t),this.chessEngine.initStatus(),this.chessEngine.InitArrangement(this.chessEngine.bluePojinType,this.chessEngine.redPojinType)},enemyTurn:function(e){this.isMyTurn=!1,this.stopMyTimer();var t=i("GameTimer");this.enemyTimer=new t,this.enemyTimeSrc=this.enemyTimer.runtimer(this,this.eclock,null,this.eclock.children[0].getComponent(cc.Label),null,e,!0)},myTurn:function(e){this.isMyTurn=!0,this.stopEnemyTimer();var t=i("GameTimer");this.myTimer=new t,this.myTimeSrc=this.myTimer.runtimer(this,this.mclock,null,this.mclock.children[0].getComponent(cc.Label),null,e,!0)},stopMyTimer:function(){this.myTimer&&this.myTimer.stoptimer(this,this.mclock,this.myTimeSrc)},stopEnemyTimer:function(){this.enemyTimer&&this.enemyTimer.stoptimer(this,this.eclock,this.enemyTimeSrc)},pauseAllTimer:function(){this.isMyTurn?this.pauseMyTimer():this.pauseEnemyTimer()},pauseMyTimer:function(){this.myTimer&&this.myTimer.pauseTimer(this,this.mclock,this.myTimeSrc)},pauseEnemyTimer:function(){this.enemyTimer&&this.enemyTimer.pauseTimer(this,this.eclock,this.enemyTimeSrc)},resumeAllTimer:function(){this.isMyTurn?this.resumeMyTimer():this.resumeEnemyTimer()},resumeMyTimer:function(){this.myTimer&&this.myTimer.resumeTimer(this,this.mclock,this.mclock.children[0].getComponent(cc.Label),!0)},resumeEnemyTimer:function(){this.enemyTimer&&this.enemyTimer.resumeTimer(this,this.eclock,this.eclock.children[0].getComponent(cc.Label),!0)},onClickConfirm:function(e,t){-1!=this.myPojinType?("hide"==t&&this.hidePojin(),this.socket().exec("camp",{extparams:{camp:this.myPojinType,gong:this.kingcheckbtn.isChecked,ftime:this.initialTime}})):null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.getComponent("ToastCtrl").init("",""),cc.global.opentoast.parent=this.panel.children[0])},onChangeGong:function(e){"true"!=e&&1!=e||this.kingcheckbtn.check(),"false"!=e&&0!=e||this.kingcheckbtn.uncheck()},turnChanged:function(e,t,i){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:20,s=arguments[4];this.confirmbtn.node.active=!1,this.endbtn.node.active=!1,this.kingcheckbtn.interactable=!1;var r=this.parent.getPlayer(e);this.curTurn=this.parent.getPlayer(s).seatid,r&&(this.onChangeGong(i),r.seatid%2==0?(this.onChangeMyPojin(e,t),this.enemyTurn(a)):(this.onChangeEnemyPojin(e,t),this.myTurn(a),s==cc.global.user.id?"no"==cc.global.amObserve&&(this.parent.is_team_game?2<this.turnChangeCount&&(this.endbtn.node.active=!0,this.confirmbtn.node.children[0].active=!1,this.confirmbtn.node.children[1].active=!0,this.confirmbtn.interactable=!1):0<this.turnChangeCount&&(this.endbtn.node.active=!0,this.confirmbtn.node.children[0].active=!1,this.confirmbtn.node.children[1].active=!0,this.confirmbtn.interactable=!1),this.confirmbtn.node.active=!0,this.kingcheckbtn.interactable=!0):(this.parent.notReplay&&(this.mclock.active=!1),this.confirmbtn.node.active=!1))),this.turnChangeCount++},enableChangeBtn:function(){this.endbtn.node.active=!1,this.confirmbtn.node.opacity=255,this.confirmbtn.interactable=!0},onToggleKingCheck:function(){this.enableChangeBtn()},onClickTimeOption:function(e,t){this.isMyTurn&&"no"==cc.global.amObserve&&(this.initialTime=parseInt(t),this.updateTimeSelOption(),this.enableChangeBtn())},updateTimeSelOption:function(){for(var e=this.initialTime/5,t=0;t<this.timeselopt.children.length;t++)t==e-1?this.timeselopt.children[t].getComponent("NotifyTabButton").init(!1,0,!0,cc.hexToColor("#1F1002"),cc.Color.WHITE):this.timeselopt.children[t].getComponent("NotifyTabButton").init(!0,0,!0,cc.hexToColor("#1F1002"),cc.Color.WHITE)},setInitialTime:function(e){this.initialTime=e,this.updateTimeSelOption()}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],PopstarBegin1:[function(e,t,i){"use strict";cc._RF.push(t,"8c54aydjz1Nzoh9R0sioKZR","PopstarBegin1");var a=e("HHCommon");cc.Class({extends:a,properties:{selfplayer:{default:null,type:cc.Node},selfboard:{default:null,type:cc.Node},tet_player:{default:null,type:cc.Prefab},roomdata:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},finishAct:{default:null,type:cc.Node},btnSfx:{default:null,type:cc.Node},multi:{default:null,type:cc.Node},selfContainer:{default:null,type:cc.Node},orientation:{default:1,type:cc.Integer},background:{default:null,type:cc.Node},particlebackground:{default:null,type:cc.Node},popstar_piece:{default:null,type:cc.Prefab},tiles:{default:null,type:cc.SpriteAtlas},btn_bomb:{default:null,type:cc.Node},btn_paint:{default:null,type:cc.Node},btn_backPrev:{default:null,type:cc.Node},label_level:{default:null,type:cc.Label},label_goal:{default:null,type:cc.Label},label_breakcounts:{default:null,type:cc.Label},label_topscore:{default:null,type:cc.Label},actionlabel_level:{default:null,type:cc.Label},actionlabel_goal:{default:null,type:cc.Label},label_totalscore:{default:null,type:cc.Label},label_tmpscore:{default:null,type:cc.Label},label_bonus:{default:null,type:cc.Label},label_success:{default:null,type:cc.Label},label_task:{default:null,type:cc.Label},img_task:{default:null,type:cc.Sprite},painterpan:{default:null,type:cc.Node},layoutcolor:{default:null,type:cc.Node},board_block:{default:null,type:cc.Node},particle_sys:{default:[],type:[cc.Prefab]},starblock:{default:[]},particlenode:{default:[]},colorblock:{default:[]},checkflg:{default:[]},matrixval:{default:[]},savematrix:{default:[]},tmpmatrix:{default:[]},queue_destroyblocks:{default:[]},bonus:{default:[]},RowCount:10,ColCount:8,cntblocks:100,prevGoal:0,currentlevel:1,levelGoalScore:1e3,totalScore:0,taskcolor:0,taskcnt:0,taskflg:0,savetotal:0,savecntblocks:0,paintrow:-1,paintcol:-1,paintcolorval:-1,selectedBomb:0,selectedPaint:0,selectedBackprev:0,cntparticle:0,cntparticle0:0,cntlastblocks:0,blockactionstate:0,bheight:72,bwidth:72,particlestar:{default:[]}},onLoad:function(){if(!cc.global.isOffline&&this.initEventCallback(),cc.game.setFrameRate(60),cc.global.amObserve="no",this.play_status=0,this.playerlist=new Array,this.playerboardlist=new Array,this.inited=!1,this.startGameTimer=null,this.endGameTimer=null,this.krCacheArr={},this.myRound=1,this.isNewRoom=!0,this.isGamePlaying=!1,this.breakcounts=20,this.topscore=0,null!=cc.global&&this.initgame(),cc.global.watchReplayData.onReplay&&this.prepareReplay(),cc.global.audio.playBGM("bgm_tetris"),1==cc.global.curPlaywayScore){var e={command:"jr",cond:20,event:"command",game:"popstar",id:this.getLanguageText("TRAINING_ROOM_0"),name:"normal",playerlist:[{avatarurl:cc.global.user.avatarurl,exp:0,explevel:0,gender:0,goldcoins:1e4,id:cc.global.user.id,nickname:cc.global.user.nickname,playcharacter:1,rank:0,seatid:0,texp:0,viplevel:0,vipscore:0}],players:1,playway:"popstar",score:1};this.joinroom_event(e,this)}this.RowCount=10,this.ColCount=8,this.prevGoal=0,this.currentlevel=1,this.levelGoalScore=1e3,this.totalScore=0,this.colorblock=[],this.starblock=[],this.matrixval=[],this.savematrix=[],this.tmpmatrix=[];for(var t=0;t<10;t++)this.bonus[t]=Math.max(0,20*(100-t*t));for(t=0;t<this.RowCount;t++)this.starblock[t]=new Array(this.ColCount),this.matrixval[t]=new Array(this.ColCount),this.savematrix[t]=new Array(this.ColCount),this.checkflg[t]=new Array(this.ColCount),this.tmpmatrix[t]=new Array(this.ColCount);this.bwidth=this.board_block.width/this.ColCount,this.bheight=this.board_block.height/this.RowCount;for(t=0;t<this.RowCount;t++)for(var i=0;i<this.ColCount;i++)this.starblock[t][i]=cc.instantiate(this.popstar_piece),this.starblock[t][i].parent=this.board_block,this.starblock[t][i].getComponent("PopstarPiece").init(0,t,i,this),this.starblock[t][i].setContentSize(cc.size(this.bwidth,this.bheight));for(t=0;t<5;t++)this.colorblock[t]=cc.instantiate(this.popstar_piece),this.colorblock[t].parent=this.layoutcolor,this.colorblock[t].getComponent("PopstarPiece").init(t+1,0,0,this),this.colorblock[t].getComponent("PopstarPiece").setColor(t),this.colorblock[t].getComponent("PopstarPiece").drawImage(0),this.colorblock[t].setContentSize(cc.size(this.bwidth,this.bheight));var a=[cc.p(0,0),cc.p(280,400),cc.p(-200,100),cc.p(200,-300),cc.p(-100,-100)],s=[cc.p(0,200),cc.p(-200,-200),cc.p(300,-300)];for(t=0;t<11;t++)this.particlestar[t]=cc.instantiate(this.particle_sys[t]).getComponent(cc.ParticleSystem);for(t=0;t<53;t++)this.particlenode[t]=new cc.Node,this.particlenode[t].addComponent(cc.ParticleSystem),t<45?this.particlenode[t].parent=this.board_block:(t<50?(this.particlenode[t].getComponent(cc.ParticleSystem).file=this.particlestar[t-40].file,this.particlenode[t].setPosition(a[t-45])):(this.particlenode[t].getComponent(cc.ParticleSystem).file=this.particlestar[10].file,this.particlenode[t].setPosition(s[t-50])),this.particlenode[t].parent=this.particlebackground),this.particlenode[t].getComponent(cc.ParticleSystem).stopSystem();this.fun_startround();var r=cc.sys.localStorage.getItem("topscore_popstar");null!=r&&(this.topscore=parseInt(r)),this.manage_topscore()},fun_startround:function(){this.painterpan.active=!1,this.label_bonus.string="",this.label_success.node.active=!1,this.label_level.string=this.currentlevel+"Round",this.levelGoalScore=this.fun_getGoalScore(this.currentlevel),this.actionlabel_goal.node.active=!1,this.actionlabel_level.node.active=!1,this.btn_bomb.active=!1,this.btn_paint.active=!1,this.btn_backPrev.active=!1,this.selectedBomb=0,this.selectedPaint=0,this.selectedBackprev=0,this.blockactionstate=1,this.cntblocks=this.RowCount*this.ColCount;for(var e=0;e<this.RowCount;e++)for(var t=0;t<this.ColCount;t++){var i=Math.floor(5*Math.random());this.matrixval[e][t]=i,this.starblock[e][t].getComponent("PopstarPiece").setColor(i),this.starblock[e][t].getComponent("PopstarPiece").drawImage(0);var a=t*this.bwidth+this.bwidth/2,s=e*this.bheight+this.bheight/2;this.starblock[e][t].setPosition(a,s),this.starblock[e][t].getComponent("PopstarPiece").actionfallfirst(1)}this.label_totalscore.node.active=!1,this.label_totalscore.string="0",this.selfplayer.active=!1,this.label_breakcounts.node.active=!1,this.label_breakcounts.string=this.breakcounts+" / 20",this.success_flag=!1,this.fun_settext_labeltmpscore(0),this.fun_settask(),this.action_roundfirst(),this.label_success.node.active=!0},fun_settask:function(){this.img_task.node.children[0].active=!1;var e=Math.floor((this.currentlevel-1)/5)+4;this.taskcnt=Math.min(e,11),this.taskcolor=Math.floor(123*Math.random()*5)%5,this.taskflg=0;var t="100"+this.taskcolor;this.label_task.string="x"+this.taskcnt+" : "+this.numformat(100*this.taskcnt),this.img_task.spriteFrame=this.tiles.getSpriteFrame(t)},action_roundfirst:function(){this.action_roundsecond()},action_roundsecond:function(){var e=this;this.scheduleOnce(function(){e.selfplayer.active=!0,e.label_breakcounts.node.active=!0,e.label_totalscore.node.active=!0,e.label_success.node.active=!1},1),this.blockactionstate=0},fun_settext_labeltmpscore:function(e){if(e<2)this.label_tmpscore.string="";else{var t=cc.scaleTo(.1,1.2),i=cc.scaleTo(.05,1),a=cc.sequence(t,i);this.label_tmpscore.node.runAction(a),this.label_tmpscore.string=e+" : "+this.numformat(e*e*5)+"pt"}},fun_getGoalScore:function(e){return 1==e?1e3:e<10?2e3+this.prevGoal:e<25?3e3+this.prevGoal:e<50?6e3+this.prevGoal:7500+this.prevGoal},fun_endround:function(){var e=cc.sequence(cc.delayTime(1),cc.callFunc(this.actionroundend2.bind(this)));this.node.runAction(e)},fun_checkConnect:function(e,t){var i=this.starblock[e][t].getComponent("PopstarPiece").colorval,a=[];this.queue_destroyblocks=[];for(var s=0;s<this.RowCount;s++)for(var r=0;r<this.ColCount;r++)this.checkflg[s][r]=0,this.starblock[s][r].getComponent("PopstarPiece").drawOutline(0);if(1==this.selectedBomb){for(s=-1;s<=1;s++)for(r=-1;r<=1;r++){var n=t+r;(d=e+s)<0||n<0||d>=this.RowCount||n>=this.ColCount||-1!=this.starblock[d][n].getComponent("PopstarPiece").colorval&&this.queue_destroyblocks.push(this.starblock[d][n])}this.selectedBomb=0,this.btn_bomb.setOpacity(150)}else{for(a.push(this.starblock[e][t]),this.queue_destroyblocks.push(this.starblock[e][t]),this.checkflg[e][t]=1;a.length;){var o=a.shift(),l=o.getComponent("PopstarPiece").row,c=o.getComponent("PopstarPiece").col;if(-1!=this.checkflg[l][c]){var h=[[0,1],[1,0],[-1,0],[0,-1]];for(s=0;s<4;s++){var d=l+h[s][0];n=c+h[s][1];if(!(d<0||n<0||d>=this.RowCount||n>=this.ColCount))if(-1!=this.starblock[d][n].getComponent("PopstarPiece").colorval)if(0==this.checkflg[d][n])i==this.starblock[d][n].getComponent("PopstarPiece").colorval&&(a.push(this.starblock[d][n]),this.queue_destroyblocks.push(this.starblock[d][n]),this.checkflg[d][n]=1)}this.checkflg[l][c]=-1}}if(1==this.queue_destroyblocks.length)return void this.fun_settext_labeltmpscore(0)}for(s=0;s<this.queue_destroyblocks.length;s++)this.queue_destroyblocks[s].getComponent("PopstarPiece").drawOutline(1),this.queue_destroyblocks[s].getComponent("PopstarPiece").actionscale();this.fun_settext_labeltmpscore(this.queue_destroyblocks.length)},fun_destroyconnectblocks:function(e,t){this.blockactionstate=1;var i=this.queue_destroyblocks.length,a=0;if(!(i<2)){for(var s=0;s<this.RowCount;s++)for(var r=0;r<this.ColCount;r++)this.savematrix[s][r]=this.matrixval[s][r];for(s=0;s<this.queue_destroyblocks.length;s++){var n=this.queue_destroyblocks[s].getComponent("PopstarPiece").row,o=this.queue_destroyblocks[s].getComponent("PopstarPiece").col;this.matrixval[n][o]=-1,this.queue_destroyblocks[s].getComponent("PopstarPiece").colorval==this.taskcolor&&a++}this.taskcnt<=a&&0==this.taskflg&&(this.totalScore+=100*this.taskcnt,this.taskflg=1,this.img_task.node.children[0].active=!0),this.cntblocks-=i,this.btn_backPrev.children[0].active=!0,this.selectedBackprev=1,this.fun_setparticle(),this.fun_showbreakblock(),10<=i&&(this.cntparticleTen=50,this.fun_effectover10()),this.savetotal=this.totalScore,this.savecntblocks=this.cntblocks,this.effectgoal=Math.min(i*i*5,10*i),this.tmpgoal=this.totalScore+i*i*5-this.effectgoal,this.totalScore+=i*i*5,this.deltagoal=0,this.schedule(this.fun_effectgoal,.01)}},fun_effectgoal:function(){if(this.deltagoal==this.effectgoal)return this.label_totalscore.string=this.numformat(this.totalScore),void this.unschedule(this.fun_effectgoal);this.deltagoal++;var e=this.tmpgoal+this.deltagoal;this.label_totalscore.string=this.numformat(e)},fun_showbreakblock:function(){if(this.cntparticle0!=this.cntparticle){var e=this.queue_destroyblocks[this.cntparticle0].getComponent("PopstarPiece").row,t=this.queue_destroyblocks[this.cntparticle0].getComponent("PopstarPiece").col;this.starblock[e][t].getComponent("PopstarPiece").playsound("animal/click_box"),this.starblock[e][t].getComponent("PopstarPiece").node.active=!1,0<this.cntparticle0&&this.particlenode[this.cntparticle0-1].getComponent(cc.ParticleSystem).stopSystem(),this.particlenode[this.cntparticle0].getComponent(cc.ParticleSystem).resetSystem();var i=cc.sequence(cc.delayTime(.1),cc.callFunc(this.fun_calparticleeffect.bind(this)));this.node.runAction(i)}else this.fun_drawblocks()},fun_calparticleeffect:function(){if(this.cntparticle0++,this.cntparticle<45)this.fun_showbreakblock();else{this.fun_showsuccessround();var e="fireworks_"+(this.cntparticle0-44);cc.global.audio.playEffectAud(e)}},fun_setparticle:function(){for(var e=0;e<this.queue_destroyblocks.length;e++){var t=this.queue_destroyblocks[e].getComponent("PopstarPiece").colorval,i=this.queue_destroyblocks[e].getComponent("PopstarPiece").node.getPosition();this.particlenode[e].getComponent(cc.ParticleSystem).file=this.particlestar[t].file,this.particlenode[e].setPosition(i),this.particlenode[e].getComponent(cc.ParticleSystem).stopSystem()}this.cntparticle=this.queue_destroyblocks.length,this.cntparticle0=0},fun_drawblocks:function(){for(var e=0;e<this.ColCount;e++)this.tmpmatrix[e]=[];for(var t=0;t<this.ColCount;t++)for(e=0;e<this.RowCount;e++)-1<this.matrixval[e][t]&&(this.tmpmatrix[t].push(this.matrixval[e][t]),this.starblock[this.tmpmatrix[t].length-1][t].getComponent("PopstarPiece").srow=e,this.starblock[this.tmpmatrix[t].length-1][t].getComponent("PopstarPiece").scol=t),this.matrixval[e][t]=-1;for(t=0;t<this.ColCount;t++)for(e=0;e<this.tmpmatrix[t].length;e++)this.matrixval[e][t]=this.tmpmatrix[t][e];for(e=0;e<this.RowCount;e++)for(t=0;t<this.ColCount;t++){this.starblock[e][t].getComponent("PopstarPiece").setColor(this.matrixval[e][t]),this.starblock[e][t].getComponent("PopstarPiece").drawImage(0);var i,a,s=this.starblock[e][t].getComponent("PopstarPiece").scol,r=this.starblock[e][t].getComponent("PopstarPiece").srow;i=t*this.bwidth+this.bwidth/2,a=e*this.bheight+this.bheight/2,this.starblock[e][t].setPosition(s*this.bwidth+this.bwidth/2,r*this.bheight+this.bheight/2),this.starblock[e][t].getComponent("PopstarPiece").actionfalldestroy1(i,a)}var n=cc.sequence(cc.delayTime(.1),cc.callFunc(this.fun_getnewpiece.bind(this)));this.node.runAction(n),this.fun_settext_labeltmpscore(0)},fun_getnewpiece:function(){for(var e=0;e<this.RowCount;e++)for(var t=0;t<this.ColCount;t++)if(-1==this.matrixval[e][t]){var i,a,s=Math.floor(5*Math.random());this.starblock[e][t].getComponent("PopstarPiece").setColor(s),this.starblock[e][t].getComponent("PopstarPiece").drawImage(0),i=t*this.bwidth+this.bwidth/2,a=e*this.bheight+this.bheight/2,this.starblock[e][t].setPosition(i,this.selfboard.height),this.starblock[e][t].getComponent("PopstarPiece").actionfalldestroy2(i,a),this.matrixval[e][t]=s}var r=cc.sequence(cc.delayTime(.3),cc.callFunc(this.endnewpiece.bind(this)));this.node.runAction(r)},endnewpiece:function(){this.blockactionstate=0,this.breakcounts--,this.label_breakcounts.string=this.breakcounts+" / 20",0==this.breakcounts&&(this.blockactionstate=1,this.fun_endround())},fun_checkRemain:function(){for(var e=0;e<this.RowCount;e++)for(var t=0;t<this.ColCount;t++)if(-1!=this.matrixval[e][t])for(var i=[[0,1],[1,0],[-1,0],[0,-1]],a=0;a<4;a++){var s=e+i[a][0],r=t+i[a][1];if(!(s<0||r<0||s>=this.RowCount||r>=this.ColCount)&&this.matrixval[e][t]==this.matrixval[s][r])return 1}return 0},useItem:function(e){if(cc.global.isOffline)108==e?this.bomb_response():109==e?this.paint_response():this.backward_response();else{if(cc.global.user.goldcoins<500)return null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.parent=this.node),void cc.global.opentoast.getComponent("ToastCtrl").init("","200");var t=this;t.checkConfirm("200",function(){t.socket().exec("psitem",{extparams:{type:e}})},function(){},10)}},updateBalance:function(){if(this.playerlist[0]){var e=this.playerlist[0].getComponent("TetrisPlayer").goldcoins;e.string=this.numformat(parseInt(cc.global.user.goldcoins)),e.node.runAction(cc.sequence(cc.scaleTo(0,1),cc.scaleTo(.2,1.5),cc.scaleTo(.1,1)))}},psitem_event:function(e,t){switch(parseInt(e.msg)){case 108:t.bomb_response();break;case 109:t.paint_response();break;case 110:t.backward_response()}},onClick_btnbomb:function(){this.blockactionstate||(this.fun_settext_labeltmpscore(0),this.selectedPaint&&this.painterpan.active||this.useItem(108))},onClick_btnpaint:function(){this.blockactionstate||(this.fun_settext_labeltmpscore(0),this.selectedPaint&&this.painterpan.active||this.useItem(109))},onClick_btnprev:function(){this.blockactionstate||(this.fun_settext_labeltmpscore(0),this.selectedPaint&&this.painterpan.active||0!=this.selectedBackprev&&this.useItem(110))},bomb_response:function(){this.selectedPaint=0,this.btn_paint.setOpacity(150),this.selectedBackprev=0,this.btn_backPrev.children[0].active=!1;for(var e=0;e<this.RowCount;e++)for(var t=0;t<this.ColCount;t++)this.starblock[e][t].getComponent("PopstarPiece").drawOutline(0);0==this.selectedBomb?(this.selectedBomb=1,this.btn_bomb.setOpacity(255)):(this.selectedBomb=0,this.btn_bomb.setOpacity(150))},paint_response:function(){this.selectedBomb=0,this.btn_bomb.setOpacity(150),this.selectedBackprev=0,this.btn_backPrev.children[0].active=!1;for(var e=0;e<this.RowCount;e++)for(var t=0;t<this.ColCount;t++)this.starblock[e][t].getComponent("PopstarPiece").drawOutline(0);0==this.selectedPaint?(this.selectedPaint=1,this.btn_paint.setOpacity(255)):(this.selectedPaint=0,this.btn_paint.setOpacity(150))},backward_response:function(){this.selectedBomb=0,this.btn_bomb.setOpacity(150),this.selectedPaint=0,this.btn_paint.setOpacity(150),this.btn_backPrev.children[0].active=!1;for(var e=this.selectedBackprev=0;e<this.RowCount;e++)for(var t=0;t<this.ColCount;t++)this.matrixval[e][t]=this.savematrix[e][t],this.starblock[e][t].getComponent("PopstarPiece").drawOutline(0),this.starblock[e][t].getComponent("PopstarPiece").setColor(this.matrixval[e][t]);this.fun_drawblocks(),this.cntblocks=this.savecntblocks,this.totalScore=this.savetotal,this.label_totalscore.string=this.numformat(this.totalScore)},fun_showPainterpan:function(e,t){this.painterpan.active=!0;for(var i=0;i<5;i++)this.colorblock[i].getComponent("PopstarPiece").drawOutline(0);this.paintrow=e,this.paintcol=t,this.paintcolorval=-1},fun_selectpaintcolor:function(e){for(var t=0;t<5;t++)t+1==e?this.colorblock[t].getComponent("PopstarPiece").drawOutline(1):this.colorblock[t].getComponent("PopstarPiece").drawOutline(0);this.paintcolorval=e-1},onClick_btnnopaint:function(){this.painterpan.active=!1,this.selectedPaint=0,this.btn_paint.setOpacity(150),this.paintcolorval=-1},onClick_btnyespaint:function(){-1!=this.paintcolorval&&(this.painterpan.active=!1,this.selectedPaint=0,this.btn_paint.setOpacity(150),this.starblock[this.paintrow][this.paintcol].getComponent("PopstarPiece").setColor(this.paintcolorval),this.starblock[this.paintrow][this.paintcol].getComponent("PopstarPiece").drawImage(0),this.matrixval[this.paintrow][this.paintcol]=this.paintcolorval,this.btn_backPrev.children[0].active=!1,this.selectedBackprev=0)},actionroundend1:function(){for(var e=45;e<this.cntparticle;e++)this.particlenode[e].getComponent(cc.ParticleSystem).stopSystem();this.fun_setparticle(),this.schedule(this.fun_showsuccessround_blocks,.1)},actionroundend2:function(){this.node.cleanup(),this.totalScore>this.topscore&&this.manage_topscore(this.totalScore),this.breakcounts=20,this.totalScore=0,this.label_tmpscore.string="";var e=cc.sequence(cc.delayTime(1),cc.callFunc(this.fun_startround.bind(this)));this.node.runAction(e)},fun_failedround:function(){this.label_success.string="Round",this.label_success.node.active=!0,this.label_success.node.setScale(0);var e=cc.scaleTo(.5,1).easing(cc.easeBounceOut());this.label_success.node.runAction(e)},fun_showsuccessround:function(){if(this.cntparticle0!=this.cntparticle){this.particlenode[this.cntparticle0].getComponent(cc.ParticleSystem).resetSystem();e=cc.sequence(cc.delayTime(.5),cc.callFunc(this.fun_calparticleeffect.bind(this)));this.node.runAction(e)}else{var e=cc.sequence(cc.delayTime(.2),cc.callFunc(this.actionroundend1.bind(this)));this.node.runAction(e)}},fun_showsuccessround_blocks:function(){if(9==this.cntparticle0||0==this.queue_destroyblocks.length){for(;this.queue_destroyblocks.length;){var e=(i=this.queue_destroyblocks.shift()).getComponent("PopstarPiece").row,t=i.getComponent("PopstarPiece").col;this.starblock[e][t].getComponent("PopstarPiece").node.active=!1,this.particlenode[this.cntparticle0++].getComponent(cc.ParticleSystem).resetSystem()}return this.unschedule(this.fun_showsuccessround_blocks),void this.actionroundend2()}var i;e=(i=this.queue_destroyblocks.shift()).getComponent("PopstarPiece").row,t=i.getComponent("PopstarPiece").col;this.starblock[e][t].getComponent("PopstarPiece").node.active=!1,0<this.cntparticle0&&this.particlenode[this.cntparticle0-1].getComponent(cc.ParticleSystem).stopSystem(),this.particlenode[this.cntparticle0].getComponent(cc.ParticleSystem).resetSystem(),this.cntparticle0++},initgame:function(){var t=this;this.finishAct&&(this.finishAct.active=!1);var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));if(null==e&&(e=!0),e?(this.btnSfx.children[0].active=!0,this.btnSfx.children[1].active=!1):(this.btnSfx.children[0].active=!1,this.btnSfx.children[1].active=!0),!cc.global.isOffline){var i=this.socket();this.map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("play",this.play_event),this.map("rer",this.recovery_event),this.map("finished",this.roundfinished),this.map("callplayer",this.callplayer_event),this.map("kr",this.keyresult_event),this.map("sl",this.sendlines_event),this.map("allcards",this.allcards_event),this.map("chpre",this.chpre_event),this.map("psitem",this.psitem_event),i.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)})}this.inited=!0,this.loadding()},joinroom_event:function(e,t){if(cc.global.tetris_jrData=e,cc.global.user.selplayway=e.name,1==cc.global.curPlaywayScore)t.roomdata.getComponent(cc.Label).string=t.getLanguageText("TRAINING_ROOM_0");else{var i=t.getLanguageText("ROOM_0"),a=t.getLanguageText("SCORE_0");t.roomdata.getComponent(cc.Label).string=e.id+i+" ("+t.numformat(e.score)+a+")"}switch(cc.global.gamestatus){case"ready":cc.global.gamestatus="waiting",2==e.playerlist.length&&(cc.global.gamestatus="playing"),t.players_event(e,t);break;case"waiting":t.players_event(e,t);break;case"playing":cc.global.amObserve&&"yes"==cc.global.amObserve&&t.players_event(e,t)}t.closeloadding()},players_event:function(e,t){null!=cc.global.tetris_jrData&&(cc.global.tetris_jrData.playerlist=e.playerlist),e.msg&&(cc.global.outReasonMsg=e.msg),2==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}i&&t.notReplay?t.exitPlay():t.players_engine(e,t)},players_engine:function(e){if(this.playerexist(e.playerlist[0])){var t=this.getPlayer(e.playerlist[0].id),i=this.getPlayerBoard(e.playerlist[0].id);t.seatid=i.seatid=1,t.layoutForSeat(),i.layoutForSeat()}else{var a=cc.instantiate(this.tet_player);e.playerlist[0].id==cc.global.user.id&&(a.parent=this.selfplayer),a.getComponent("TetrisPlayer").init(this,e.playerlist[0],1,0),this.playerlist.push(a)}},playerexist:function(e){for(var t=0;t<this.playerlist.length;t++)if(null!=this.playerlist[t]&&this.playerlist[t].getComponent("TetrisPlayer").userdata.id==e.id)return!0;return!1},roundfinished:function(e,t){t.startGameTimer&&clearTimeout(t.startGameTimer),t.krCacheArr={},bLeftMove=bRightMove=bRotatePiece=bDropPiece=!1},userready_event:function(e,t){cc.global.audio.playEffectAud("ready");t.getPlayerBoard(e.userid)},chpre_event:function(e,t){t.closeOpenWin(),cc.global.openwin=cc.instantiate(t.roomrankdialog),cc.global.openwin.getComponent("RoomRankDialog").init(e.extdata),cc.global.openwin.parent=t.root(),t.notReplay||setTimeout(function(){null!=cc.global.openwin&&(cc.global.openwin.children[0].active=!1)},500)},play_event:function(e,t){},recovery_event:function(e,t){},prepareReplay:function(){var e=this;e.notReplay=!1,cc.global.amObserve="yes",e.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),e.replay_bar.active=!0,e.replayStep="ready_room",e.replaySeq=0,e.replayPrevCmd="",e.controlPanel&&(e.controlPanel.active=!1),e.chatPanel&&(e.chatPanel.active=!1),e.controlTip&&(e.controlTip.active=!1),e.btnOrientation&&(e.btnOrientation.active=!1),e.btnRestButtonBus&&(e.btnRestButtonBus.active=!1),e.checkRoundReplay(),e.goReplay()},startGame:function(){},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},onClickSfx:function(){if(this.btnSfx){var e=this.btnSfx,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},onclickBack:function(){1!=cc.global.curPlaywayScore||this.exitPlay()},exitPlay:function(){var e=this;cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),null==this.exitTimer&&(this.exitTimer=setInterval(function(){e.finishAct&&!e.finishAct.active&&(e.returnToHall(),clearInterval(e.exitTimer),e.exitTimer=null)},500))},returnToHall:function(){this.loadding(),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.tetris_jrData=null,cc.global.backToHall=!0,this.startGameTimer&&clearTimeout(this.startGameTimer),this.endGameTimer&&clearTimeout(this.endGameTimer),this.scene("hall",this)},fun_effectover10:function(){if(53!=this.cntparticleTen){this.particlenode[this.cntparticleTen].getComponent(cc.ParticleSystem).resetSystem();var e=cc.sequence(cc.delayTime(.2),cc.callFunc(this.fun_caleffect10.bind(this)));this.node.runAction(e);var t="fireworks_"+(this.cntparticleTen-47);cc.global.audio.playEffectAud(t)}},fun_caleffect10:function(){this.cntparticleTen++,this.fun_effectover10()},manage_topscore:function(){if(0<arguments.length){var e=parseInt(arguments[0]);this.topscore<e&&(this.topscore=e)}this.label_topscore.string="Top Record : "+this.numformat(this.topscore),cc.sys.localStorage.setItem("topscore_popstar",this.topscore)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],PopstarBegin:[function(e,t,i){"use strict";cc._RF.push(t,"f613bFekaBJUpxodI64wGt9","PopstarBegin");var a=e("HHCommon");cc.Class({extends:a,properties:{popstar_player:{default:null,type:cc.Prefab},popstar_selfplayer:{default:null,type:cc.Prefab},popstar_player_board:{default:null,type:cc.Prefab},selfplayer:{default:null,type:cc.Node},opponentplayer:{default:null,type:cc.Node},statusboard:{default:null,type:cc.Node},boardclaim:{default:null,type:cc.Sprite},claimatlas:{default:null,type:cc.SpriteAtlas},roomdata:{default:null,type:cc.Node},turntimer:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},observer:{default:null,type:cc.Prefab},observerbench:{default:null,type:cc.Node},emodlg:{default:null,type:cc.Prefab},chat:{default:null,type:cc.Prefab},btn_enter:{default:null,type:cc.Node},btn_giveup:{default:null,type:cc.Node},btn_chat:{default:null,type:cc.Node},btn_pass:{default:null,type:cc.Node},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},finishAct:{default:null,type:cc.Node},btnSfx:{default:null,type:cc.Node},lblTurnCount:{default:null,type:cc.Label},pandata:{default:null,type:cc.Node},multi:{default:null,type:cc.Node},popstar_piece:{default:null,type:cc.Prefab},tiles:{default:null,type:cc.SpriteAtlas},opponentlabel_totalscore:{default:null,type:cc.Label},selflabel_totalscore:{default:null,type:cc.Label},label_tmpscore:{default:null,type:cc.Label},label_totalcnt:{default:null,type:cc.Label},selfboard_block:{default:null,type:cc.Node},opponentboard_block:{default:null,type:cc.Node},opponent_Mask:{default:null,type:cc.Node},self_Mask:{default:null,type:cc.Node},progressbar_turn:{default:null,type:cc.Node},btn_Mask:{default:null,type:cc.Node},particle_sys:{default:[],type:[cc.Prefab]},piece_array:{default:[]},particlenode:{default:[]},checkflg:{default:[]},matrix:{default:[]},newmatrix:{default:[]},tmpmatrix:{default:[]},queue_destroyblocks:{default:[]},RowCount:10,ColCount:8,cntblocks:100,currentlevel:1,levelGoalScore:1e3,totalScore:0,savetotal:0,savecntblocks:0,cntparticle:0,cntparticle0:0,cntlastblocks:0,blockactionstate:0,bheight:72,bwidth:72,particlestar:{default:[]}},onLoad:function(){this.initEventCallback(),cc.game.setFrameRate(60),cc.global.amObserve="no",this.play_status=0,this.playerlist=new Array,this.playerboardlist=new Array,this.observerlist=new Array,this.posBaseIdx=0,this.inited=!1,this.playerBoardSlotPos=[cc.v2(0,-240),cc.v2(0,240)],this.notReplay=!0,this.startGameTimer=null,this.endGameTimer=null,this.pangolds=0,this.isGamePlaying=!1,this.turnSeat=0,this.isNewRoom=!0,this.sendFlag=!1,this.itemScore=0,this.maskCount_limit=5,this.maskCount=[-1,-1],this.turnCount={local:0,server:0},this.opponent_Mask.active=!1,this.opponent_Mask.children[0].getComponent(cc.Label).string="0",this.self_Mask.active=!1,this.self_Mask.children[0].getComponent(cc.Label).string="0",this.btn_Mask.children[0].getComponent(cc.Label).string="",null!=cc.global&&(this.initgame(),""!=cc.global.user.roomid&&(this.recovery(),this.isNewRoom=!1)),cc.global.watchReplayData.onReplay&&this.prepareReplay(),this.setEtcKeyBoardEvent();var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==e&&(e=!0),e?(this.btnSfx.children[0].active=!0,this.btnSfx.children[1].active=!1):(this.btnSfx.children[0].active=!1,this.btnSfx.children[1].active=!0),cc.global.audio.playBGM("bgm_popstar"),this.pandata.children[1].getComponent(cc.Label).string="0",this.RowCount=10,this.ColCount=8,this.totalScore=0,this.selfbwidth=this.selfboard_block.width/this.ColCount,this.selfbheight=this.selfboard_block.height/this.RowCount,this.opponentbwidth=this.opponentboard_block.width/this.ColCount,this.opponentbheight=this.opponentboard_block.height/this.RowCount;for(var t=0;t<2;t++)this.piece_array[t]=new Array,this.matrix[t]=new Array,this.newmatrix[t]=new Array;for(t=0;t<this.RowCount;t++)this.piece_array[0][t]=new Array(this.ColCount),this.piece_array[1][t]=new Array(this.ColCount),this.matrix[0][t]=new Array(this.ColCount),this.matrix[1][t]=new Array(this.ColCount),this.newmatrix[0][t]=new Array(this.ColCount),this.newmatrix[1][t]=new Array(this.ColCount),this.checkflg[t]=new Array(this.ColCount),this.tmpmatrix[t]=new Array(this.ColCount);for(t=0;t<5;t++)this.particlestar[t]=cc.instantiate(this.particle_sys[t]).getComponent(cc.ParticleSystem);for(t=0;t<100;t++)this.particlenode[t]=new cc.Node,this.particlenode[t].addComponent(cc.ParticleSystem),this.particlenode[t].parent=this.selfboard_block,this.particlenode[t].getComponent(cc.ParticleSystem).stopSystem(),this.particlenode[t].setLocalZOrder(5);this.fun_settext_labeltmpscore(0),this.selflabel_totalscore.string="",this.opponentlabel_totalscore.string="";for(var i=0;i<2;i++)for(t=0;t<this.RowCount;t++)for(var a=0;a<this.ColCount;a++)if(this.piece_array[i][t][a]=cc.instantiate(this.popstar_piece),0==i){this.piece_array[i][t][a].getComponent("PopstarPiece").init(0,t,a,this);var s=a*this.selfbwidth+this.selfbwidth/2,r=t*this.selfbheight+this.selfbheight/2;this.piece_array[i][t][a].parent=this.selfboard_block,this.piece_array[i][t][a].setContentSize(cc.size(this.selfbwidth,this.selfbheight)),this.piece_array[i][t][a].setPosition(s,r)}else{this.piece_array[i][t][a].getComponent("PopstarPiece").init(100,t,a,this);s=a*this.opponentbwidth+this.opponentbwidth/2,r=t*this.opponentbheight+this.opponentbheight/2;this.piece_array[i][t][a].parent=this.opponentboard_block,this.piece_array[i][t][a].setContentSize(cc.size(this.opponentbwidth,this.opponentbheight)),this.piece_array[i][t][a].setPosition(s,r)}this.allcards_flag=0,this.progressbar_turn.active=!1,this.label_totalcnt.string="0",this.ratio=0},initgame:function(){var t=this;this.finishAct&&(this.finishAct.active=!1);var e=this.socket();this.map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("banker",this.banker_event),this.map("playpopstar",this.playpopstar_event),this.map("rer",this.recovery_event),this.map("selemoticon",this.emoticon_event),this.map("sendchat",this.sendchat_event),this.map("callplayer",this.callplayer_event),this.map("allcards",this.allcards_event),this.map("chpre",this.chpre_event),this.map("psitem",this.psitem_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)});var i={};switch(cc.global.user.roomInType){case"NormalCreate":null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i);break;case"NormalJoin":i.extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i);break;case"NormalObserve":i.extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i)}this.inited=!0,this.loadding()},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},prepareReplay:function(){this.notReplay=!1,cc.global.amObserve="yes",this.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),this.replay_bar.active=!0,this.replayStep="ready_room",this.replaySeq=0,this.replayPrevCmd="",this.goReplay()},stopAllClock:function(){this.turntimer.getComponent("TurnTimer").pauseAllTimer()},resumeAllClock:function(){this.turntimer.getComponent("TurnTimer").resumeAllTimer()},pauseReplayTimer:function(){this.stopAllClock(),clearTimeout(this.replayTimer)},resumeReplayTimer:function(){var e=this;this.resumeAllClock(),this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay/cc.global.watchReplayData.replaySpeedX)},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):this.togglePlayToPause()},togglePlayToPause:function(){this.replayTimer&&clearTimeout(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replay_bar.children[0].opacity=100,this.pauseReplayTimer()},replayPrevMove:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.replayEventProcess(!0))},replayNextMove:function(){this.togglePlayToPause(),this.replayEventProcess(!0)},onClickReplaySpeedUp:function(){var e=this.getLanguageText("REPLAY_TIME");cc.global.watchReplayData.replaySpeedX<5&&(cc.global.watchReplayData.replaySpeedX++,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){var e=this.getLanguageText("REPLAY_TIME");1<cc.global.watchReplayData.replaySpeedX&&(cc.global.watchReplayData.replaySpeedX--,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},cleanAllPlayers:function(){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].destroy(),this.playerboardlist[e].destroy();this.playerlist.splice(0,this.playerlist.length),this.playerboardlist.splice(0,this.playerboardlist.length),this.playerlist=new Array,this.playerboardlist=new Array,this.selfplayer&&(this.selfplayer.destroyAllChildren(),this.selfplayer.removeAllChildren()),this.opponentplayer&&(this.opponentplayer.destroyAllChildren(),this.opponentplayer.removeAllChildren())},replayEventProcess:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.play_history&&this.play_history[this.replaySeq]){this.replayTimeDelay=0;var t=!1;switch(this.replayStep){case"ready_room":this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"playpopstar":t=!0,this.playpopstar_event(i,this);break;case"allcards":t=!0,this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.emoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"psitem":this.psitem_event(i,this);break;case"players":this.players_event(i,this);break;case"chpre":t=!0,this.chpre_event(i,this)}this.replayPrevCmd=i.command}this.play_history[this.replaySeq+1]&&""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay+=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,e&&!t&&this.replayEventProcess(!0)}},goReplay:function(){var e=this;this.replayEventProcess(),this.play_history[this.replaySeq]?this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay):(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.replayPrevCmd="",this.pauseReplayTimer())},setEtcKeyBoardEvent:function(){var i=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e,t){switch(e){case cc.KEY.space:i.processReadyState();break;case cc.KEY.escape:case cc.KEY.back:if(!i.isemoticon&&!i.ischat)return void i.onclickBack();i.isemoticon&&(null!=i.emoticonpage&&i.emoticonpage.destroy(),i.isemoticon=!1),i.ischat&&(null!=i.chatpage&&i.chatpage.destroy(),i.ischat=!1)}}},i.node)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;e<0||(this.socket().exec("selemoticon",{extparams:{emoticon:e}}),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1))},onCtrlKeyDown:function(e){e.keycode==cc.KEY.space&&2==this.playerlist.length&&(this.endGameTimer||this.sendState())},processReadyState:function(){2==this.playerlist.length&&(this.endGameTimer||this.sendState())},joinroom_event:function(e,t){cc.global.user.selplayway=e.name,t.roomid=e.id,t.panScore=cc.global.curPlaywayScore=e.score;var i=t.getLanguageText("ROOM_0"),a=t.getLanguageText("SCORE_0");switch(t.roomdata.children[0].children[0].getComponent(cc.Label).string=e.id+i,t.roomdata.children[0].children[1].getComponent(cc.Label).string="("+t.numformat(e.score)+a+")",cc.global.gamestatus){case"ready":cc.global.gamestatus="waiting",2==e.playerlist.length&&(cc.global.gamestatus="playing"),t.players_event(e,t);break;case"waiting":t.players_event(e,t);break;case"playing":cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)}e.hisdata?t.showMatchCareer(e.hisdata):t.hideMatchCareer(),"yes"==cc.global.amObserve?(t.btn_giveup.active=!1,t.btn_chat.active=!0,t.btn_Mask.active=!1,t.btn_pass.active=!1):(t.btn_giveup.active=!0,t.btn_chat.active=!0,t.btn_pass.active=!0),t.closeloadding()},players_event:function(e,t){2==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)if(e.observerlist[a].id==cc.global.user.id){i=!1;break}if(i&&t.notReplay)return cc.global.outReasonMsg=e.msg,void t.exitPlay();t.observer_event(e,t),t.isBoardPlayersChanged(e.playerlist)&&(t.allcards_flag=1==e.playerlist.length,t.startGameTimer&&(clearTimeout(t.startGameTimer),t.startGameTimer=null),t.endGameTimer&&(clearTimeout(t.endGameTimer),t.endGameTimer=null),t.players_engine(e,t))},players_engine:function(e){this.opponentlabel_totalscore&&(this.opponentlabel_totalscore.string=""),this.selflabel_totalscore&&(this.selflabel_totalscore.string=""),this.removeBoardPlayers(e.playerlist);for(var t=this.posBaseIdx,i=0;i<e.playerlist.length;i++){if(e.playerlist[i].seatid=i,"no"==cc.global.amObserve&&e.playerlist[i].id!=cc.global.user.id&&(t=1-this.posBaseIdx),this.playerexist(e.playerlist[i])){var a=this.getPlayer(e.playerlist[i].id),s=this.getPlayerBoard(e.playerlist[i].id);a.init(this,e.playerlist[i],t%2,i),s.init(this,e.playerlist[i],t%2,i),a.seatid=s.seatid=t%2,a.layoutForSeat(),s.layoutForSeat()}else{var r=cc.instantiate(this.popstar_player_board),n=cc.instantiate(this.popstar_player);"yes"!=cc.global.amObserve?e.playerlist[i].id==cc.global.user.id?(n.parent=this.selfplayer,r.parent=this.selfboard_block,r.setPosition(this.selfboard_block.width/2,this.selfboard_block.height/3)):(n.parent=this.opponentplayer,r.parent=this.opponentboard_block,r.setPosition(this.opponentboard_block.width/2,this.opponentboard_block.height/3)):this.selfplayer.children.length<1?(n.parent=this.selfplayer,r.parent=this.selfboard_block,r.setPosition(this.selfboard_block.width/2,this.selfboard_block.height/3)):(n.parent=this.opponentplayer,r.parent=this.opponentboard_block,r.setPosition(this.opponentboard_block.width/2,this.opponentboard_block.height/3)),n.getComponent("PopstarPlayer").init(this,e.playerlist[i],t%2,i),this.playerlist.push(n),r.getComponent("PopstarPlayerBoard").init(this,e.playerlist[i],t%2,i),this.playerboardlist.push(r)}t++}1==e.playerlist.length?(this.setWaitingState(),this.cleanAfterAllCards(),this.hideMatchCareer()):2==e.playerlist.length&&this.setReadyState(),"yes"==cc.global.amObserve&&e.playerlist.length<2?1==cc.global.championMode?this.btn_enter.active=!1:0==cc.global.championMode&&this.notReplay&&(this.btn_enter.active=!0):this.btn_enter.active=!1,this.showWaitingTimer()},setWaitingState:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("PopstarPlayerBoard");t&&t.setState("Pending")}},setReadyState:function(){var e=this.getLanguageText("READY_0")+"?";if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("PopstarPlayerBoard");i&&i.setState(e)}},observer_event:function(e,t){t.observerbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i],t),a.getComponent("Observer").nickname.node.active=!1,a.parent=t.observerbench,t.observerlist[i]=a}},removeBoardPlayers:function(e){for(var t=0;t<this.playerlist.length;t++){for(var i=this.playerlist[t].getComponent("PopstarPlayer"),a=!1,s=0;s<e.length;s++)if(i.userdata.id==e[s].id){a=!0;break}1!=a&&(this.playerlist[t].destroy(),this.playerlist.splice(t,1),this.playerboardlist[t].destroy(),this.playerboardlist.splice(t,1))}},isBoardPlayersChanged:function(e){if(0==this.playerlist.length&&0!=e.length)return!0;if(this.playerlist.length!=e.length)return!0;for(var t=0;t<e.length;t++)if(!this.getPlayer(e[t].id))return!0;return!1},playerexist:function(e){for(var t=0;t<this.playerlist.length;t++)if(null!=this.playerlist[t]&&this.playerlist[t].getComponent("PopstarPlayer").userdata.id==e.id)return!0;return!1},initGameboard:function(e,t){t.sendFlag=!1;var i=0;i=0==t.getPlayer(e.extdata.playerboards[0].userid).seatid?0:1;for(var a=0;a<2;a++){i=(i+a)%2;for(var s=0;s<t.RowCount;s++)for(var r=0;r<t.ColCount;r++){var n=parseInt(e.extdata.playerboards[i].board[s*t.ColCount+r]);t.matrix[a][s][r]=n,t.piece_array[a][s][r].getComponent("PopstarPiece").setColor(n),t.piece_array[a][s][r].getComponent("PopstarPiece").drawImage(a),t.piece_array[a][s][r].getComponent("PopstarPiece").actionfallfirst(.2)}}t.selflabel_totalscore.string="0",t.opponentlabel_totalscore.string="0",t.progressbar_turn.active=!0,t.progressbar_turn.getComponent(cc.ProgressBar).progress=1,t.progressbar_turn.children[2].getComponent(cc.Label).string="20 / 20",t.closeloadding()},changeTurn:function(e){if(0!=this.isGamePlaying){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];0==e?(this.turnSeat=1,t&&this.giveTurn2(this.popstar_timer)):1==e&&(this.turnSeat=0,t&&this.giveTurn1(this.popstar_timer))}},showMatchCareer:function(e){},hideMatchCareer:function(){},sendState:function(){this.getPlayerBoard(cc.global.user.id).isReady()||this.socket().exec("ready",{extparams:{roomid:this.roomid}})},userready_event:function(e,t){cc.global.audio.playEffectAud("ready");var i=t.getPlayerBoard(e.userid);if(i){var a=t.getLanguageText("PREPARED_0");i.setState(a),i.startTimer(30)}},banker_event:function(e,t){t.opponent_Mask.active=!1,t.opponent_Mask.children[0].getComponent(cc.Label).string="0",t.self_Mask.active=!1,t.self_Mask.children[0].getComponent(cc.Label).string="0",t.btn_Mask.children[0].getComponent(cc.Label).string="",t.btn_Mask.opacity=255,t.allcards_flag=0,t.maskCount=[-1,-1],t.closeConfirm(),t.hideAllStatus(),t.isGamePlaying=!0,t.isNewRoom=!1,t.popstar_timer=30,e.extdata.timer&&!isNaN(e.extdata.timer)&&(t.popstar_timer=parseInt(e.extdata.timer)),e.extdata.itemprice&&!isNaN(e.extdata.itemprice)?t.itemScore=parseInt(e.extdata.itemprice):t.btn_Mask.active=!1,e.extdata.masklimit&&!isNaN(e.extdata.masklimit)&&(t.maskCount_limit=parseInt(e.extdata.masklimit));for(var i=t.getPlayer(e.userid),a=0;a<t.playerlist.length;a++)t.playerlist[a].getComponent("PopstarPlayer").hideBanker();i&&(i.showBanker(),0==i.seatid?(t.turnSeat=0,t.giveTurn1(t.popstar_timer)):(t.turnSeat=1,t.giveTurn2(t.popstar_timer))),t.blockactionstate=0,t.totalScore=0,t.initGameboard(e,t);var s;s=Math.round(parseInt(e.extdata.limitcount)/2),t.progressbar_turn.children[1].color=cc.hexToColor("#FFFFFF"),t.progressbar_turn.active=!0,t.progressbar_turn.getComponent(cc.ProgressBar).progress=1,t.progressbar_turn.children[2].getComponent(cc.Label).string=s+" / "+s;var r;r=parseInt(e.extdata.totalcount),t.label_totalcnt.string=t.numformat(r),t.totalcount=0,t.ratio=1,t.check_betup(1,t,!0)},playpopstar_event:function(e,t){t.sendFlag=!0;for(var i=0;i<t.RowCount;i++)for(var a=0;a<t.ColCount;a++)t.piece_array[0][i][a].getComponent("PopstarPiece").drawOutline(0);if(!t.notReplay||parseInt(t.roomid)==parseInt(e.extdata.roomid)){if(t.lblTurnCount&&e.extdata&&e.extdata.turncount){var s,r;s=Math.floor(parseInt(e.extdata.turncount)/2),r=Math.floor(parseInt(e.extdata.limitcount)/2),t.progressbar_turn.getComponent(cc.ProgressBar).progress=1-s/r,t.progressbar_turn.children[2].getComponent(cc.Label).string=r-s+" / "+r,t.progressbar_turn.children[1].color=cc.hexToColor("#FFFFFF"),r-s<=5&&(t.progressbar_turn.children[1].color=cc.hexToColor("#FF3705")),t.turnCount.server=parseInt(e.extdata.turncount),parseInt(cc.global.user.id)==parseInt(e.userid)&&"p"!=e.extdata.type||(t.turnCount.local+=1)}e.extdata&&e.extdata.totalcount&&(t.totalcount=0,t.totalcount=parseInt(e.extdata.totalcount));var n;(n=parseInt(e.extdata.ratio))>t.ratio&&t.check_betup(n,t,!1),e.extdata.timer&&(t.popstar_timer=parseInt(e.extdata.timer)),t.closeConfirm(),t.stopTurnTimerAll();var o=t.getPlayer(e.userid);if(o){var l=0,c=t.getPlayer(e.extdata.playerboards[0].userid);l=0==c.seatid?0:1;for(var h=0;h<2;h++)l=(l+h)%2,t.maskCount[l]=parseInt(e.extdata.playerboards[h].maskcount);if(t.notReplay?(t.self_Mask.active=!1,0<t.maskCount[1]?t.opponent_Mask.active=!0:t.opponent_Mask.active=!1,"yes"==cc.global.amObserve&&0<t.maskCount[0]&&(t.self_Mask.active=!0)):(t.self_Mask.active=!1,t.opponent_Mask.active=!1),t.opponent_Mask.children[0].getComponent(cc.Label).string=t.maskCount[1],t.self_Mask.children[0].getComponent(cc.Label).string=t.maskCount[0],0<t.maskCount[0]?t.btn_Mask.children[0].getComponent(cc.Label).string=t.maskCount[0]:(t.btn_Mask.children[0].getComponent(cc.Label).string="",0==t.maskCount[0]?t.btn_Mask.opacity=140:t.btn_Mask.opacity=255),"p"!=e.extdata.type){l=0;var d=[];c=t.getPlayer(e.extdata.playerboards[0].userid);l=0==c.seatid?0:1;for(h=0;h<2;h++){l=(l+h)%2,(c=t.getPlayer(e.extdata.playerboards[h].userid)).updatePassCount(e.extdata.playerboards[h].pass),d[h]=parseInt(e.extdata.playerboards[h].score);for(i=0;i<t.RowCount;i++)for(a=0;a<t.ColCount;a++){var u=parseInt(e.extdata.playerboards[l].board[i*t.ColCount+a]);t.newmatrix[h][i][a]=u}}var p=t.tmpidx=0;if(e.extdata.linkcount&&(p=parseInt(e.extdata.linkcount)),t.linkcount=p,l=(l+1)%2,0==o.seatid){t.effectgoal=Math.min(p*p*5,50),t.tmpgoal=d[l]-t.effectgoal,t.totalScore=d[l],t.deltagoal=0;var g=-1,m=-1;g=parseInt(e.extdata.row),m=parseInt(e.extdata.col),"yes"==cc.global.amObserve&&t.fun_checkConnect(g,m),t.fun_destroyconnectblocks1(0)}else{g=-1,m=-1;g=parseInt(e.extdata.row),m=parseInt(e.extdata.col),t.tmpidx=1,t.fun_checkConnect1(g,m)}t.changeTurnTimer=setTimeout(function(){t.changeTurn(o.seatid,!0),t.opponentlabel_totalscore.string=t.numformat(d[(l+1)%2]),t.selflabel_totalscore.string=t.numformat(d[l]),t.blockactionstate=0},100*p+500)}else{t.fun_settext_labeltmpscore(0),t.changeTurn(o.seatid,!0);for(h=0;h<2;h++){(c=t.getPlayer(e.extdata.playerboards[h].userid)).updatePassCount(e.extdata.playerboards[h].pass)}}}t.showBoardClaim(e.extdata.type);var y="";switch(e.extdata.type){case"n":break;case"p":y="pass"}""!=y&&o.speech(y)}},stopTurnTimerAll:function(){this.turntimer&&this.turntimer.getComponent("TurnTimer")&&this.turntimer.getComponent("TurnTimer").stopAllTimer()},showBoardClaim:function(e){if(this.boardclaim&&this.boardclaim.node.children){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",i="";switch(e){case"n":break;case"p":i="pass";break;case"w":i="win";break;case"l":i="defeat";break;case"d":i="draw"}if("CH"==cc.global.curLanguage?i+="_ch":"RU"==cc.global.curLanguage?i+="_ru":i+="_en",this.boardclaim.node.children[0].active=!1,"tech"==t&&(this.boardclaim.node.children[0].active=!0,this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string={l:"Lose",w:"Victory"}[e]),"w"==e)this.runFinishAction("dzz_cj_win");else if("l"==e)this.runFinishAction("dzz_cj_lose");else if("p"==e){this.boardclaim.node.children[0].active=!0;var a=this.getLanguageText("PASS_0");this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string=a,this.boardclaim.getComponent(cc.Animation).play()}else this.boardclaim.spriteFrame=this.claimatlas.getSpriteFrame(i),this.boardclaim.getComponent(cc.Animation).play()}},runFinishAction:function(e){if(1==this.playerboardlist.length)for(var t=0;t<this.playerboardlist.length;t++){this.playerboardlist[t].getComponent("PopstarPlayerBoard").hidePlayCharacter()}if("yes"!=cc.global.amObserve&&this.finishAct&&this.finishAct.getComponent(sp.Skeleton)){var i=cc.callFunc(this.enableFinishAni,this,e),a=cc.callFunc(this.disableFinishAni,this);this.node.runAction(cc.sequence(i,cc.delayTime(3),a))}},enableFinishAni:function(e,t){if(this.finishAct){var i=this.finishAct.getComponent(sp.Skeleton);i&&(this.finishAct.active=!0,i.animation=t)}},disableFinishAni:function(e){if(this.finishAct&&(this.finishAct.active=!1),1==this.playerboardlist.length)for(var t=0;t<this.playerboardlist.length;t++){this.playerboardlist[t].getComponent("PopstarPlayerBoard").showPlayCharacter()}},recovery_event:function(e,t){t.isGamePlaying=!0,t.getPlayer(e.extdata.banker).showBanker(),t.hideAllStatus(),t.initGameboard(e,t),e.extdata.timer&&!isNaN(e.extdata.timer)&&(t.popstar_timer=parseInt(e.extdata.timer)),e.extdata.itemprice&&!isNaN(e.extdata.itemprice)?t.itemScore=parseInt(e.extdata.itemprice):t.btn_Mask.active=!1,e.extdata.masklimit&&!isNaN(e.extdata.masklimit)&&(t.maskCount_limit=parseInt(e.extdata.masklimit)),e.userid&&e.extdata.timer&&t.setTurn(e.userid,e.extdata.timer),t.lblTurnCount&&e.extdata.count&&(t.turnCount.local=parseInt(e.extdata.count),t.turnCount.server=parseInt(e.extdata.count));for(var i=0;i<2;i++){var a=t.getPlayer(e.extdata.playerboards[i].userid);a&&e.extdata.playerboards[i].pass&&a.updatePassCount(e.extdata.playerboards[i].pass),0==a.seatid?(t.selflabel_totalscore.string=t.numformat(e.extdata.playerboards[i].score),t.totalScore=parseInt(e.extdata.playerboards[i].score),t.maskCount[0]=e.extdata.playerboards[i].maskcount):(t.maskCount[1]=parseInt(e.extdata.playerboards[i].maskcount),t.opponentlabel_totalscore.string=t.numformat(e.extdata.playerboards[i].score))}t.notReplay?(0<t.maskCount[1]&&(t.opponent_Mask.active=!0),"yes"==cc.global.amObserve&&0<t.maskCount[0]&&(t.self_Mask.active=!0)):(t.self_Mask.active=!1,t.opponent_Mask.active=!1),t.opponent_Mask.children[0].getComponent(cc.Label).string=t.maskCount[1],t.self_Mask.children[0].getComponent(cc.Label).string=t.maskCount[0],0<t.maskCount[0]?t.btn_Mask.children[0].getComponent(cc.Label).string=t.maskCount[0]:(t.btn_Mask.children[0].getComponent(cc.Label).string="",0==t.maskCount[0]?t.btn_Mask.opacity=140:t.btn_Mask.opacity=255),t.progressbar_turn.active=!0;var s,r;s=Math.floor(parseInt(e.extdata.count)/2),r=Math.floor(parseInt(e.extdata.limitcount)/2),t.progressbar_turn.getComponent(cc.ProgressBar).progress=1-s/r,t.progressbar_turn.children[2].getComponent(cc.Label).string=r-s+" / "+r,t.progressbar_turn.children[1].color=cc.hexToColor("#FFFFFF"),r-s<=5&&(t.progressbar_turn.children[1].color=cc.hexToColor("#FF3705"));var n;n=parseInt(e.extdata.totalcount),t.totalcount=n,t.label_totalcnt.string=t.numformat(n);var o=parseInt(e.extdata.ratio);1<o&&(t.pangolds=t.panScore*o),t.check_betup(o,t,!1)},setPanInfo:function(e,t){this.getPlayer(e[0].playuser)},setTurn:function(e,t){var i=this.getPlayer(e);i&&(this.turnSeat=i.seatid),this.stopTurnTimerAll(),0==this.turnSeat?this.giveTurn1(t):1==this.turnSeat&&this.giveTurn2(t)},giveTurn1:function(e){this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer1(e),this.togglePcsTurn(0)),this.sendFlag=!1,this.opponentboard_block.opacity=180,this.selfboard_block.opacity=255},giveTurn2:function(e){this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer2(e),this.togglePcsTurn(1)),this.opponentboard_block.opacity=255,this.selfboard_block.opacity=180},togglePcsTurn:function(e){},hideAllStatus:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("PopstarPlayerBoard");t&&t.hideStatus()}},check_betup:function(e,t,i){var a=parseInt(e),s=parseInt(this.totalcount);if(1==i){var r=t.panScore*a;return t.updateBetUpBalance(r),t.multiBetUp(r),t.pangolds=t.pangolds+2*r,void(t.pandata.children[1].getComponent(cc.Label).string=t.numformat(t.pangolds))}if(0<a&&a>t.ratio){2<=(t.ratio=a)&&(a/=2,50<=s&&(cc.global.audio.playEffectAud("charge"),t.showMultiAni()));r=t.panScore*a;var n=0;if("normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway)for(var o=0;o<t.playerlist.length;o++){var l=t.playerlist[o].getComponent("PopstarPlayer");if(l){if(0==l.userdata.goldcoins)return;0==n?n=l.userdata.goldcoins:n>l.userdata.goldcoins&&(n=l.userdata.goldcoins)}}n<r&&(r=n),t.updateBetUpBalance(r),t.multiBetUp(r),t.pangolds=t.pangolds+2*r,t.pandata.children[1].getComponent(cc.Label).string=t.numformat(t.pangolds)}},showMultiAni:function(){if(this.multi){var e=this;this.multi.active=!0;var t=this.multi.getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"play",!1),setTimeout(function(){e&&e.multi&&(e.multi.active=!1)},2e3)}},multiBetUp:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("PopstarPlayer");i&&i.betup.getComponent("TetrisBetUp").init(e,i.seatid)}},workOutMatchCareer:function(e){for(var t=0;t<e.players.length;t++){var i=this.getPlayer(e.players[t].userid),a=this.getPlayerBoard(e.players[t].userid);i&&a&&("normal"==cc.global.user.selplayway?0<e.players[t].score&&(this.matchCareerData.tgolds[i.userdata.id]+=e.players[t].score-this.pangolds/2):"diamond"==cc.global.user.selplayway&&0<e.players[t].score&&(this.matchCareerData.tdiamonds[i.userdata.id]+=e.players[t].score-this.pangolds/2),2==e.players[t].win&&(this.matchCareerData.wins[i.userdata.id]++,i.userdata.id))}this.showMatchCareer(this.matchCareerData)},allcards_event:function(s,r){r.opponent_Mask.active=!1,r.opponent_Mask.children[0].getComponent(cc.Label).string="0",r.self_Mask.active=!1,r.self_Mask.children[0].getComponent(cc.Label).string="0",r.btn_Mask.children[0].getComponent(cc.Label).string="";for(var e=0;e<s.players.length;e++)s.players[e].userid==cc.global.user.id&&r.notReplay&&(cc.global.user.goldcoins=s.players[e].gold);var t=0;if(r.linkcount&&!isNaN(r.linkcount)&&(t=r.linkcount),r.maskCount=[-1,-1],r.blockactionstate=1,r.allcards_flag=1,r.hideAllStatus(),r.isGamePlaying=!1,r.otherEventCache=[],r.stopTurnTimerAll(),r.matchCareerData&&r.workOutMatchCareer(s),r&&r.playerlist){var n=r.playerlist.length==s.players.length;for(e=0;e<s.players.length;e++){var i=r.getPlayer(s.players[e].userid);s.players[e].getout&&(n=!1),r.getPlayerBoard(s.players[e].userid)&&("suicide"!=s.title||s.players[e].win||(i=r.getPlayer(s.players[e].userid))&&i.showEmoticon(-1))}if(r.piece_array)for(e=0;e<r.RowCount;e++)for(var a=0;a<r.ColCount;a++)r.piece_array[0][e][a].getComponent("PopstarPiece").drawOutline(0);setTimeout(function(){clearTimeout(r.changeTurnTimer);for(var e=0;e<s.players.length;e++){var t=r.getPlayer(s.players[e].userid);if(t&&("normal"==cc.global.user.selplayway&&(t.userdata.goldcoins=parseInt(s.players[e].gold)),t.summary(s.players[e])),s.players[e].userid==cc.global.user.id)switch(s.players[e].win){case 0:r.showBoardClaim("l",s.title);break;case 1:r.showBoardClaim("d",s.title);break;case 2:r.showBoardClaim("w",s.title)}}for(var i=0;i<2;i++)for(e=0;e<r.RowCount;e++)for(var a=0;a<r.ColCount;a++)r.piece_array[i][e][a]&&(r.piece_array[i][e][a].active=!1,r.matrix[i][e][a]=-1);r.allcards_flag=0,n?setTimeout(function(){r.endGameTimer=null,r.boardclaim.getComponent(cc.Animation).stop(),r.boardclaim.node.setScale(0,0),r.setReadyState(),r.cleanAfterAllCards(),r.selflabel_totalscore.string="",r.opponentlabel_totalscore.string="",r.progressbar_turn.active=!1,r.node.cleanup()},4e3):setTimeout(function(){r.selflabel_totalscore&&(r.selflabel_totalscore.string=""),r.opponentlabel_totalscore&&(r.opponentlabel_totalscore.string=""),r.progressbar_turn&&(r.progressbar_turn.active=!1),r.label_totalcnt&&(r.label_totalcnt.string="0"),r.pandata&&(r.pandata.children[1].getComponent(cc.Label).string="0")},1e3)},100*t+800)}},cleanAfterAllCards:function(){if((this.pangolds=0)==this.allcards_flag)for(var e=0;e<this.playerboardlist.length;e++){this.playerboardlist[e].getComponent("PopstarPlayerBoard").showPlayCharacter()}cc.global.amObserve&&"no"==cc.global.amObserve&&this.showWaitingTimer();for(var t=0;t<this.playerlist.length;t++)this.playerlist[t].getComponent("PopstarPlayer").hideBanker(),this.playerlist[t].getComponent("PopstarPlayer").updatePassCount(0);this.lblTurnCount&&(this.lblTurnCount.string="",this.turnCount.local=0,this.turnCount.server=0),this.pandata.children[1].getComponent(cc.Label).string="0",this.label_totalcnt.string="0",this.fun_settext_labeltmpscore(0),this.opponentboard_block.opacity=255,this.selfboard_block.opacity=255,this.progressbar_turn.active=!1,this.selflabel_totalscore.string="",this.opponentlabel_totalscore.string=""},updateBetUpBalance:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("PopstarPlayer");i&&(i.userdata.goldcoins-=e)}this.updatePlayerBalance()},updatePlayerBalance:function(){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("PopstarPlayer");t&&t.updateBalance()}},showWaitingTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("PopstarPlayerBoard");t&&t.startTimer(30)}},showReadyTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("PopstarPlayerBoard");t&&t.startTimer(3)}},hideTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("PopstarPlayerBoard");t&&t.stopTimer()}},getPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("PopstarPlayer");if(i.userdata.id==e)return i}},getOtherPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("PopstarPlayer");if(i.userdata.id!=e)return i}},getPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("PopstarPlayerBoard");if(i.userdata.id==e)return i}},getOtherPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("PopstarPlayerBoard");if(i.userdata.id!=e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},onClickGiveUp:function(){if(this.isGamePlaying){if(this.turnSeat)return void this.alert("No your turn.");var e=this;cc.global.audio.playVoiceSpeech("support/12_give_up");var t=this.getLanguageText("ARE_YOU_GIVE_UP");this.checkConfirm(t,function(){e&&e.socket().exec("suicide",{})},null)}},onClickSfx:function(){if(this.btnSfx){var e=this.btnSfx,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},showChatSearch:function(){},showChatDialog:function(){this.onclickChat(0)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.notReplay){if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}if(!(e<0)){this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root();var a=this.chatpage.getComponent("Chat");a.init(this,e),a.base.x=a.base.y=0,this.ischat=!0}}},onClickEmoticon:function(){if(this.notReplay){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),this.isemoticon=!1;this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root();var e=this.emoticonpage.getComponent("Emoticon");e.init(this,!1),e.base.x=e.base.y=0,this.isemoticon=!0}},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase,a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg);var s=t.getObserver(e.userid);s&&s.showCallPlayer(i,e.msg)},callplayer_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg);var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg,!1)},emoticon_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg);var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},onClickFindEmptyRoom:function(){},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},onClickChangePiece:function(){1==this.tgpcsbtn.children[0].active&&(this.tgpcsbtn.children[0].active=!1,this.tgpcsbtn.children[1].active=!0,this.togglePieceMode(!0)),1==this.tgpcsbtn.children[1].active&&(this.tgpcsbtn.children[0].active=!0,this.tgpcsbtn.children[1].active=!1,this.togglePieceMode(!1))},onclickBack:function(){var e=this;this.notReplay?this.isGamePlaying&&"no"==cc.global.amObserve?this.turnSeat?this.alert("No your turn."):(cc.global.audio.playVoiceSpeech("support/14_roomout"),this.checkConfirm("Are you sure to leave room? You will lose.",function(){e.socket().exec("leave",{})},null)):this.socket().exec("leave",{}):this.exitPlay()},exitPlay:function(){var e=this;cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),null==this.exitTimer&&(this.exitTimer=setInterval(function(){e.finishAct&&!e.finishAct.active&&(e.returnToHall(),clearInterval(e.exitTimer),e.exitTimer=null)},500))},returnToHall:function(){this.stopTurnTimerAll(),this.loadding(),clearInterval(this.otherEventInvoker),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.startGameTimer&&clearTimeout(this.startGameTimer),this.endGameTimer&&clearTimeout(this.endGameTimer),this.hideTimer(),this.cleanAllPlayers(),this.scene("hall",this)},chpre_event:function(e,t){t.closeOpenWin(),cc.global.openwin=cc.instantiate(t.roomrankdialog),cc.global.openwin.getComponent("RoomRankDialog").init(e.extdata),cc.global.openwin.parent=t.root(),t.notReplay||setTimeout(function(){null!=cc.global.openwin&&(cc.global.openwin.children[0].active=!1)},500)},fun_checkConnect:function(e,t){if(!(e<0||9<e||t<0||9<t)){var i=this.piece_array[0][e][t].getComponent("PopstarPiece").colorval,a=[];this.queue_destroyblocks=[];for(var s=0;s<this.RowCount;s++)for(var r=0;r<this.ColCount;r++)this.checkflg[s][r]=0,this.piece_array[0][s][r].getComponent("PopstarPiece").drawOutline(0);for(a.push(this.piece_array[0][e][t]),this.queue_destroyblocks.push(this.piece_array[0][e][t]),this.checkflg[e][t]=1;a.length;){var n=a.shift(),o=n.getComponent("PopstarPiece").row,l=n.getComponent("PopstarPiece").col;if(-1!=this.checkflg[o][l]){var c=[[0,1],[1,0],[-1,0],[0,-1]];for(s=0;s<4;s++){var h=o+c[s][0],d=l+c[s][1];if(!(h<0||d<0||h>=this.RowCount||d>=this.ColCount))if(-1!=this.piece_array[0][h][d].getComponent("PopstarPiece").colorval)if(0==this.checkflg[h][d])i==this.piece_array[0][h][d].getComponent("PopstarPiece").colorval&&(a.push(this.piece_array[0][h][d]),this.queue_destroyblocks.push(this.piece_array[0][h][d]),this.checkflg[h][d]=1)}this.checkflg[o][l]=-1}}if(1!=this.queue_destroyblocks.length){for(s=0;s<this.queue_destroyblocks.length;s++)this.queue_destroyblocks[s].getComponent("PopstarPiece").drawOutline(1),this.queue_destroyblocks[s].getComponent("PopstarPiece").actionscale();this.fun_settext_labeltmpscore(this.queue_destroyblocks.length)}else this.fun_settext_labeltmpscore(0)}},fun_settext_labeltmpscore:function(e){if(e<2)this.label_tmpscore.string="";else{var t=cc.scaleTo(.1,1.2),i=cc.scaleTo(.05,1),a=cc.sequence(t,i);this.label_tmpscore.node.runAction(a),this.label_tmpscore.string=e+" : "+this.numformat(e*e*5)+"pt"}},fun_destroyconnectblocks:function(e,t){this.blockactionstate=1,this.queue_destroyblocks.length<2||(this.socket().exec("playpopstar",{extparams:{row:e,col:t,roomid:this.roomid,localturn:this.turnCount.local}}),this.sendFlag=!0)},fun_destroyconnectblocks1:function(e){this.queue_destroyblocks.length;for(var t=0;t<this.queue_destroyblocks.length;t++){var i=this.queue_destroyblocks[t].getComponent("PopstarPiece").row,a=this.queue_destroyblocks[t].getComponent("PopstarPiece").col;this.queue_destroyblocks[t].getComponent("PopstarPiece").drawOutline(0),this.matrix[e][i][a]=-1}this.fun_setparticle(e),this.fun_showbreakblock(),0==e&&this.schedule(this.fun_effectgoal,.05)},fun_effectgoal:function(){if(this.deltagoal>=this.effectgoal)return this.selflabel_totalscore.string=this.numformat(this.totalScore),void this.unschedule(this.fun_effectgoal);this.deltagoal+=5;var e=this.tmpgoal+this.deltagoal;this.selflabel_totalscore.string=this.numformat(e)},fun_checkConnect1:function(e,t){if(!(e<0||9<e||t<0||9<t)){var i=this.piece_array[1][e][t].getComponent("PopstarPiece").colorval,a=[];this.queue_destroyblocks=[];for(var s=0;s<this.RowCount;s++)for(var r=0;r<this.ColCount;r++)this.checkflg[s][r]=0;for(a.push(this.piece_array[1][e][t]),this.queue_destroyblocks.push(this.piece_array[1][e][t]),this.checkflg[e][t]=1;a.length;){var n=a.shift(),o=n.getComponent("PopstarPiece").row,l=n.getComponent("PopstarPiece").col;if(-1!=this.checkflg[o][l]){var c=[[0,1],[1,0],[-1,0],[0,-1]];for(s=0;s<4;s++){var h=o+c[s][0],d=l+c[s][1];if(!(h<0||d<0||h>=this.RowCount||d>=this.ColCount))if(-1!=this.piece_array[1][h][d].getComponent("PopstarPiece").colorval)if(0==this.checkflg[h][d])i==this.piece_array[1][h][d].getComponent("PopstarPiece").colorval&&(a.push(this.piece_array[1][h][d]),this.queue_destroyblocks.push(this.piece_array[1][h][d]),this.checkflg[h][d]=1)}this.checkflg[o][l]=-1}}1!=this.queue_destroyblocks.length&&this.fun_destroyconnectblocks1(1)}},fun_showbreakblock:function(){if(this.cntparticle0==this.cntparticle)return this.fun_drawblocks(),void(this.label_totalcnt.string=this.numformat(this.totalcount));if(this.cntparticle0>this.cntparticle||this.cntparticle0<0||this.cntparticle0>=this.queue_destroyblocks.length)return this.cntparticle=this.cntparticle0=0,void this.fun_setLast();var e=this.queue_destroyblocks[this.cntparticle0].getComponent("PopstarPiece").row,t=this.queue_destroyblocks[this.cntparticle0].getComponent("PopstarPiece").col;this.piece_array[this.tmpidx][e][t].getComponent("PopstarPiece").node.active=!1,0==this.tmpidx&&(0<this.cntparticle0&&this.particlenode[this.cntparticle0-1].getComponent(cc.ParticleSystem).stopSystem(),this.particlenode[this.cntparticle0].getComponent(cc.ParticleSystem).resetSystem());this.piece_array[this.tmpidx][e][t].getComponent("PopstarPiece").playsound("animal/click_box");var i=cc.sequence(cc.delayTime(.1),cc.callFunc(this.fun_calparticleeffect.bind(this)));this.node.runAction(i)},fun_calparticleeffect:function(){this.cntparticle0++,this.fun_showbreakblock()},fun_setparticle:function(e){if(this.cntparticle=this.queue_destroyblocks.length,this.cntparticle0=0,1!=e)for(var t=0;t<this.queue_destroyblocks.length;t++){var i=this.queue_destroyblocks[t].getComponent("PopstarPiece").colorval,a=this.queue_destroyblocks[t].getComponent("PopstarPiece").node.getPosition();this.particlenode[t].getComponent(cc.ParticleSystem).file=this.particlestar[i].file,this.particlenode[t].setPosition(a),this.particlenode[t].getComponent(cc.ParticleSystem).stopSystem()}},fun_drawblocks:function(){for(var e=this.tmpidx,t=0;t<this.ColCount;t++)this.tmpmatrix[t]=[];for(var i=0;i<this.ColCount;i++)for(t=0;t<this.RowCount;t++)-1<this.matrix[e][t][i]&&(this.tmpmatrix[i].push(this.matrix[e][t][i]),this.piece_array[e][this.tmpmatrix[i].length-1][i].getComponent("PopstarPiece").srow=t,this.piece_array[e][this.tmpmatrix[i].length-1][i].getComponent("PopstarPiece").scol=i),this.matrix[e][t][i]=-1;for(i=0;i<this.ColCount;i++)for(t=0;t<this.tmpmatrix[i].length;t++)this.matrix[e][t][i]=this.tmpmatrix[i][t];for(t=0;t<this.RowCount;t++)for(i=0;i<this.ColCount;i++){this.piece_array[e][t][i].getComponent("PopstarPiece").setColor(this.matrix[e][t][i]),this.piece_array[e][t][i].getComponent("PopstarPiece").drawImage(e);var a,s,r=this.piece_array[e][t][i].getComponent("PopstarPiece").scol,n=this.piece_array[e][t][i].getComponent("PopstarPiece").srow;0==e?(a=i*this.selfbwidth+this.selfbwidth/2,s=t*this.selfbheight+this.selfbheight/2,this.piece_array[e][t][i].setPosition(r*this.selfbwidth+this.selfbwidth/2,n*this.selfbheight+this.selfbheight/2)):(a=i*this.opponentbwidth+this.opponentbwidth/2,s=t*this.opponentbheight+this.opponentbheight/2,this.piece_array[e][t][i].setPosition(r*this.opponentbwidth+this.opponentbwidth/2,n*this.opponentbheight+this.opponentbheight/2)),this.piece_array[e][t][i].getComponent("PopstarPiece").actionfalldestroy1(a,s)}var o=cc.sequence(cc.delayTime(.1),cc.callFunc(this.fun_getnewpiece.bind(this)));this.node.runAction(o),this.fun_settext_labeltmpscore(0)},fun_getnewpiece:function(){for(var e=this.tmpidx,t=0;t<this.RowCount;t++)for(var i=0;i<this.ColCount;i++)if(-1==this.matrix[e][t][i]){var a,s,r=this.newmatrix[e][t][i];this.piece_array[e][t][i].getComponent("PopstarPiece").setColor(r),this.piece_array[e][t][i].getComponent("PopstarPiece").drawImage(e),0==e?(a=i*this.selfbwidth+this.selfbwidth/2,s=t*this.selfbheight+this.selfbheight/2,this.piece_array[e][t][i].setPosition(a,this.selfboard_block.height)):(a=i*this.opponentbwidth+this.opponentbwidth/2,s=t*this.opponentbheight+this.opponentbheight/2,-1==this.maskCount[1]?this.piece_array[e][t][i].setPosition(a,this.opponentboard_block.height+this.opponentbheight/2):this.piece_array[e][t][i].setPosition(a,this.opponentboard_block.height-this.opponentbheight/2)),this.piece_array[e][t][i].getComponent("PopstarPiece").actionfalldestroy2(a,s)}var n=cc.sequence(cc.delayTime(.3),cc.callFunc(this.endnewpiece.bind(this)));this.node.runAction(n)},endnewpiece:function(){this.blockactionstate=0,this.fun_setLast()},fun_setLast:function(){for(var e=0;e<2;e++)for(var t=0;t<this.RowCount;t++)for(var i=0;i<this.ColCount;i++){var a=this.newmatrix[e][t][i];this.matrix[e][t][i]=a}for(e=0;e<2;e++)for(t=0;t<this.RowCount;t++)for(i=0;i<this.ColCount;i++){a=this.matrix[e][t][i];this.piece_array[e][t][i].getComponent("PopstarPiece").setColor(a),this.piece_array[e][t][i].getComponent("PopstarPiece").drawImage(e);var s=0,r=0;0==e?(s=i*this.selfbwidth+this.selfbwidth/2,r=t*this.selfbheight+this.selfbheight/2):(s=i*this.opponentbwidth+this.opponentbwidth/2,r=t*this.opponentbheight+this.opponentbheight/2),this.piece_array[e][t][i].setPosition(s,r)}},on_click_btnMask:function(){"yes"!=cc.global.amObserve&&this.notReplay&&this.isGamePlaying&&-1==this.maskCount[0]&&this.useItem(111)},on_click_btnPass:function(){if(this.isGamePlaying){if(this.turnSeat)return;if(this.sendFlag)return;if("yes"==cc.global.amObserve)return;if(!this.notReplay)return;this.socket().exec("playpopstar",{extparams:{row:-100,col:-100,roomid:this.roomid,localturn:this.turnCount.local}}),this.sendFlag=!0}},useItem:function(e){if(cc.global.user.goldcoins<this.itemScore+100)return null==cc.global.opentoast&&(cc.global.opentoast=cc.instantiate(cc.global.toastPrefab),cc.global.opentoast.parent=this.node),void cc.global.opentoast.getComponent("ToastCtrl").init("",this.itemScore+".");var t=this;t.checkConfirm(" "+this.maskCount_limit+". "+this.itemScore+"?",function(){t.socket().exec("psitem",{extparams:{type:e}})},function(){},10)},psitem_event:function(e,t){switch(parseInt(e.extdata.type)){case 111:t.mask_response(e)}},mask_response:function(e){var t,i=this.getPlayer(e.extdata.userid);t=e.extdata.maskcount,i&&(0==i.seatid?("yes"==cc.global.amObserve&&(this.self_Mask.active=!0,this.self_Mask.children[0].getComponent(cc.Label).string=t),this.btn_Mask.children[0].getComponent(cc.Label).string=t,this.maskCount[0]=t):(this.opponent_Mask.active=!0,this.opponent_Mask.children[0].getComponent(cc.Label).string=t,this.maskCount[1]=t),this.update_goldcoin(i))},update_goldcoin:function(e){if(e){var t=e.getComponent("PopstarPlayer").goldcoins;t.string=this.numformat(e.getComponent("PopstarPlayer").userdata.goldcoins-this.itemScore),t.node.runAction(cc.sequence(cc.scaleTo(0,1),cc.scaleTo(.2,1.5),cc.scaleTo(.1,1)))}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],PopstarEngine:[function(e,t,i){"use strict";cc._RF.push(t,"63d64WZCgZAspz5O2ry7C39","PopstarEngine"),t.exports=function(){},cc._RF.pop()},{}],PopstarPiece:[function(e,t,i){"use strict";cc._RF.push(t,"1515bCzRMxCIYXyBhLUOAML","PopstarPiece"),cc.Class({extends:cc.Component,properties:{img:{default:null,type:cc.Sprite},outline:{default:null,type:cc.Node},tiles:{default:null,type:cc.SpriteAtlas},colorval:-1,actionstate:0,srow:0,id:-1,scol:0},init:function(e,t,i,a){this.id=e,this.row=t,this.col=i,this.colorval=-1,this.parent=a,this.node.active=!1},onClick:function(){if("yes"!=cc.global.amObserve&&(1!=cc.global.curPlaywayScore||!this.parent.blockactionstate)&&!this.actionstate&&!this.parent.turnSeat&&100!=this.id&&(1!=this.parent.allcards_flag||isNaN(this.parent.allcards_flag))&&1!=this.parent.sendFlag)if(this.parent.selectedPaint){if(0<this.id)return this.actionscale(),void this.parent.fun_selectpaintcolor(this.id);if(this.parent.painterpan.active)return;this.parent.fun_showPainterpan(this.row,this.col)}else this.outline.active&&this.node.active&&0<=this.colorval?this.parent.fun_destroyconnectblocks(this.row,this.col):this.parent.fun_checkConnect(this.row,this.col)},drawOutline:function(e){this.outline.active=e},setColor:function(e){this.colorval=e},drawImage:function(e){if(this.outline.active=!1,-1!=this.colorval){this.node.active=!0;var t="100"+this.colorval;this.img.spriteFrame=this.tiles.getSpriteFrame(t)}else this.node.active=!1},actionscale:function(){if(this.node.active){this.actionstate=1;var e=cc.scaleTo(.05,1.1),t=cc.scaleTo(.05,1),i=cc.sequence(e,t,cc.callFunc(this.endaction.bind(this)));this.node.runAction(i)}},actionfallfirst:function(e){var t=this;if(this.node.active){this.actionstate=1,this.node.setOpacity(0);var i=cc.fadeTo(.2,50),a=cc.fadeTo(.3,150),s=cc.fadeTo(.5,255),r=cc.sequence(cc.delayTime(e),i,a,s,cc.callFunc(function(){t.actionstate=0},this));this.node.runAction(r)}},actionfalldestroy:function(e,t,i,a,s){if(this.node.active){this.actionstate=1;var r,n=cc.moveTo(.5,cc.p(t,i)).easing(cc.easeBounceOut()),o=cc.moveTo(.2,cc.p(e,i)).easing(cc.easeBackOut());r=0==a?cc.sequence(o,cc.callFunc(this.endaction.bind(this))):0==s?cc.sequence(n,cc.callFunc(this.endaction.bind(this))):cc.sequence(n,o,cc.callFunc(this.endaction.bind(this))),this.node.runAction(r)}},actiondestroyend:function(){if(this.node.active){this.actionstate=1,this.drawOutline(1);var e=cc.scaleTo(.1,1.1),t=cc.scaleTo(.1,1),i=(cc.delayTime(.1),cc.sequence(e,t,cc.callFunc(this.endaction_last.bind(this))));this.node.runAction(i)}},endaction:function(){this.actionstate=0,1==cc.global.curPlaywayScore&&(this.parent.blockactionstate=0)},endaction_last:function(){this.actionstate=0,this.parent.blockactionstate=0,this.node.active=!1},actionfalldestroy1:function(e,t){if(this.node.active){this.actionstate=1;var i=cc.moveTo(.2,cc.p(e,t)).easing(cc.easeBounceOut()),a=cc.sequence(i,cc.callFunc(this.endaction1.bind(this)));this.node.runAction(a)}},endaction1:function(){this.actionstate=0},actionfalldestroy2:function(e,t){if(this.actionstate=1,this.node.active){var i=cc.moveTo(.2,cc.p(e,t)).easing(cc.easeBounceOut()),a=cc.sequence(i,cc.callFunc(this.endaction2.bind(this)));this.node.runAction(a)}},endaction2:function(){this.actionstate=0},playsound:function(e){cc.global.audio.playEffectAud(e)}}),cc._RF.pop()},{}],PopstarPlayerBoard:[function(e,t,i){"use strict";cc._RF.push(t,"a2de3y6DKROiZJOmKTqZyHM","PopstarPlayerBoard");var a=e("HHCommon");cc.Class({extends:a,properties:{countdown:{default:null,type:cc.Label},status:{default:null,type:cc.Label},tip:{default:null,type:cc.Node},character:{default:null,type:cc.Node},character1:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.layoutForSeat(),this.parent.allcards_flag||this.showPlayCharacter(i)},startTimer:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode||!(3<e)){var t=this;t.stopTimer(),t.countdown.node.active=!0,t.countdown.string=e,t.timer||(t.timer=setInterval(function(){0<e?t.countdown&&(e--,t.countdown.string=e):t.stopTimer()},1e3))}},stopTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null),this.countdown&&(this.countdown.node.active=!1)},setState:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode){this.status.node.active=!0,this.status.string=e;var t=this.getLanguageText("READY_0")+"?",i=this.getLanguageText("PREPARED_0");t==e&&this.userdata.id==cc.global.user.id&&"no"==cc.global.amObserve?this.tip.active=!0:this.tip.active=!1}else this.status.string=i},hideTip:function(){this.tip.active=!1},hideStatus:function(){this.stopTimer(),this.hideTip(),this.status.node.active=!1,this.hidePlayCharacter()},hidePlayCharacter:function(){this.character1.active=!1},layoutForSeat:function(){0==this.seatid||this.seatid},isReady:function(){return this.getLanguageText("PREPARED_0")==this.status.string},onClickReady:function(){this.parent&&this.parent.processReadyState()},showPlayCharacter:function(){this.character.active=!0,this.character1.active=!0,this.character.getComponent("Character").disUserCharacter(this.userdata.playcharacter%2,!1,this.userdata.avatarurl)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],PopstarPlayer:[function(e,t,i){"use strict";cc._RF.push(t,"6f99a1ach5DgYDFoSum6Vqa","PopstarPlayer");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},nickname:{default:null,type:cc.Label},goldcoin_base:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},betup:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},winorlose:{default:null,type:cc.Node},banker:{default:null,type:cc.Node},passCount:{default:null,type:cc.Label}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.nickname.string=t.nickname,1==cc.global.championMode||cc.global.championMode,this.goldcoins.string=this.numformat(t.goldcoins),this.goldcoins.node.parent.active=!0,this.loadAvatar(t.avatarurl,t.gender),this.layoutForSeat()},speech:function(e){var t=this.userdata.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)},onClickDisInfo:function(){},updateCareer:function(e){},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},spendDiamondForLuck:function(e){this.updateBalance()},showCallPlayer:function(e,t){var i=this;this.hideCallPlayer(),cc.global.audio.playVoiceChatWithType(this.userdata.playcharacter,t),this.callplayer.active=!0,this.callplayer.children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onClickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userdata.id},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){cc.global.user.id==this.userdata.id?this.parent.onClickEmoticon&&this.parent.onClickEmoticon():this.onClickCallPlayer()},layoutForSeat:function(){0==this.seatid?(this.banker.x=-55,this.callplayer.scaleX=1,this.callplayer.children[0].scaleX=1):(this.banker.x=55,this.winorlose.x=-116,this.callplayer.scaleX=-1,this.callplayer.children[0].scaleX=-1,this.callplayer.children[0].anchorX=.5)},summary:function(e){var a=this;if(this.updateCareer(e),this.winorlose.getComponent(cc.Animation).play(),2==e.win){cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("win"),this.winorlose.children[1].getComponent(cc.Label).string="+"+this.numformat(e.exp),this.winorlose.children[2].getComponent(cc.Label).string="+"+this.numformat(e.score),e.orig_gold=e.gold-e.score,"diamond"==cc.global.user.selplayway&&(e.orig_gold=e.diamond-e.score);var t=cc.callFunc(function(e,t){t.orig_gold+Math.round(t.score/5)>("diamond"==cc.global.user.selplayway?t.diamond:t.gold)?"diamond"==cc.global.user.selplayway?t.orig_gold=t.diamond:t.orig_gold=t.gold:t.orig_gold=t.orig_gold+Math.round(t.score/5);var i=e.getComponent("PopstarPlayer").goldcoins.node;i.getComponent(cc.Label).string=a.numformat(t.orig_gold),i.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1)))},this,e),i=cc.sequence(cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t);this.node.runAction(i)}else cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("lose"),this.winorlose.children[1].getComponent(cc.Label).string="-"+this.numformat(Math.abs(e.exp)),this.winorlose.children[2].getComponent(cc.Label).string="-"+this.numformat(-1*e.score),this.goldcoins.string=this.numformat(e.gold)},showFuncStatus:function(){},showBanker:function(){this.banker.active=!0,2<=this.banker.children.length&&(this.banker.children[0].active=0==this.seatid,this.banker.children[1].active=0!=this.seatid)},hideBanker:function(){this.banker.active=!1},updatePassCount:function(e){if(this.passCount){var t=3-parseInt(e);if(0<=t){var i=this.getLanguageText("PASS_COUNT");this.passCount.string=i+": "+t}else{i=this.getLanguageText("NO_PASS_COUNT");this.passCount.string=i}}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],PurchaseNumber:[function(e,t,i){"use strict";cc._RF.push(t,"d34a2mmg81HZayxon2IrP0y","PurchaseNumber");var a=e("HHCommon");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},input_number:cc.Node,button_label:cc.Label},onLoad:function(){this.disDialogEffect(this.base),cc.global.audio.playDialogAud()},init:function(e,t){this.parent=e,this.number_pos=0,this.numbers=[],this.numbers[3]=this.numbers[2]=this.numbers[1]=this.numbers[0]="-"},onClickNumber:function(e,t){if(!(4<=this.number_pos)){var i=parseInt(t);0<=i&&i<=9&&(this.numbers[this.number_pos]=i+"",this.input_number.children[this.number_pos].children[0].runAction(cc.sequence(cc.scaleTo(.2,2.8,1.4).easing(cc.easeIn(.2)),cc.scaleTo(.2,2,1).easing(cc.easeOut(.2)))),this.number_pos++),this.refreshnumber()}},onClickCancel:function(){this.number_pos=0,this.refreshnumber()},onClickBackspace:function(){this.numbers[this.number_pos]="-",this.number_pos--,this.number_pos<0&&(this.number_pos=0),this.refreshnumber()},refreshnumber:function(){for(var e=0;e<4;e++)"-"==this.numbers[e]&&e<this.number_pos?this.number_pos=e:e>=this.number_pos&&(this.numbers[e]="-"),this.input_number.children[e].children[0].getComponent(cc.Label).string=this.numbers[e]},onClickClose:function(){this.destroy(),this.node.destroy()},onClickCreateOrJoin:function(){if(this.number_pos<4)this.alert("");else{for(var e=0;e<4;e++)(this.numbers[e]<"0"||"9"<this.numbers[e])&&(this.number_pos=e,this.refreshnumber(),this.alert(""));this.loadding();var i=this;cc.global.http.httpPost("/hall/purchase_with_number",{number:this.numbers.join("")},function(e){i.closeloadding();var t=i.parse(e);t&&"00"==t.status?(cc.global.user.walletvalued=t.valued,cc.global.user.walletfree=t.free,cc.global.user.walledadded=t.added,i.parent.alert(t.msg),i.parent.updatePointLabel(),i.onClickClose()):t&&t.msg&&i.alert(t.msg)},function(){i.closeloadding(),i.alert("")},i,5e3)}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],RankDialog:[function(e,t,i){"use strict";cc._RF.push(t,"89cdesByBlEzrfV+5LsQcBr","RankDialog");var a=e("HallDialog");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},title:{default:null,type:cc.Label},tabs:{default:null,type:cc.Node},modes:{default:null,type:cc.Node},contentView:{default:null,type:cc.Node},itemPrefab:{default:null,type:cc.Prefab},keywordInput:{default:null,type:cc.EditBox},pagenum:{default:null,type:cc.Label},column:{default:null,type:cc.Node},noContent:{default:null,type:cc.Node},scrollview:{default:null,type:cc.ScrollView},msnBg:{default:null,type:cc.Node},greenBackground:cc.SpriteFrame,blueBackground:cc.SpriteFrame,btnClear:{default:null,type:cc.Node},myRank:{default:null,type:cc.Node}},init:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=arguments[2];this.parent=e,this.data=i,this.initState(t),this.initTheme()},initTheme:function(){4===cc.global.theme_idx?this.msnBg&&this.msnBg.getComponent(cc.Sprite)&&(this.msnBg.getComponent(cc.Sprite).spriteFrame=this.blueBackground):this.msnBg&&this.msnBg.getComponent(cc.Sprite)&&(this.msnBg.getComponent(cc.Sprite).spriteFrame=this.greenBackground)},initState:function(e){this.curGame="ofc";for(var t=0;t<this.tabs.children.length;t++)if(this.tabs.children[t].name==this.curGame){this.curTab=t;break}this.curMode=2,this.curPage=0,this.origPage=-1,this.updateTab(),this.updateMode();var i=this;setTimeout(function(){i.updatePage()},100)},updateTab:function(){for(var e=0;e<this.tabs.children.length;e++)e==this.curTab?this.tabs.children[e].getComponent("NotifyTabButton").init(!0,0):this.tabs.children[e].getComponent("NotifyTabButton").init(!1,0)},updateMode:function(){for(var e=0;e<this.modes.children.length;e++)e==this.curMode?this.modes.children[e].getComponent("NotifyTabButton").init(!0,0):this.modes.children[e].getComponent("NotifyTabButton").init(!1,0);3==this.curMode?(this.btnClear.parent.active=!1,this.myRank.active=!0):(this.btnClear.parent.active=!0,this.myRank.active=!1)},onClickTab:function(e,t){var i=t.split(",");this.curTab!=parseInt(i[0])&&(this.curTab=parseInt(i[0]),this.curGame=i[1],this.origPage=-1,this.curPage=0,this.updateTab(),this.updatePage())},onClickMode:function(e,t){this.curMode!=parseInt(t)&&(this.curMode=parseInt(t),this.origPage=-1,this.curPage=0,this.updateMode(),this.updatePage())},onClickPrevPage:function(){this.curPage<=0||this.data&&this.data[this.curGame]&&this.data[this.curGame][this.curMode]&&(this.origPage=this.curPage,this.curPage--,this.updatePage())},onClickNextPage:function(){this.data&&this.data[this.curGame]&&this.data[this.curGame][this.curMode]&&10<=this.data[this.curGame][this.curMode].length&&(this.origPage=this.curPage,this.curPage++,this.updatePage())},updatePage:function(){if(this.origPage!=this.curPage){this.contentView.removeAllChildren(),4==this.curMode?this.changeColumn(2,"Step (Exp)"):this.changeColumn(2,"Exp");var o=this;o.loadding(),cc.global.http.httpPost("/hall/getrecordlist",{recordpage:this.curPage+1,keyname:this.keywordInput.string,curgame:this.curGame,occasion:this.curMode},function(e){if(o.closeloadding(),null!=e&&""!=e){var t=e.split("$$$");if(1<t.length&&"00"==t[0]){var i=JSON.parse(t[1]);o.data=i.alist,o.ext=i.blist,o.totalPage=i.totalPage;var a=o.getLanguageText("MYRANK_0"),s=o.getLanguageText("UNKNOWN_0"),r=o.getLanguageText("RANK_TH_0");3==o.curMode&&o.myRank&&(0<=parseInt(i.myrank)&&0<i.totalPage?o.myRank.getComponent(cc.Label).string=a+": "+(parseInt(i.myrank)+1)+r:o.myRank.getComponent(cc.Label).string=a+": "+s),o.loadContent(o)}else{n=o.getLanguageText("ERROR_IN_SERVER_RESPONSE");o.alert(n+": "+t[0])}}else{var n=o.getLanguageText("ERROR_IN_SERVER_RESPONSE");o.alert(n+": 01")}},function(){o.closeloadding();var e=o.getLanguageText("CONNECTING_FAILED_0");o.alert(e)})}},changeTitle:function(e,t){this.title.string="Rank"},loadContent:function(e){if(this.pagenum.string=this.numformat(this.curPage+1)+"/"+this.numformat(this.totalPage),e&&e.scrollview&&e.scrollview.scrollToTop(.1),e.data[e.curGame]&&e.data[e.curGame][e.curMode])for(var t=0;t<e.data[e.curGame][e.curMode].length;t++)if(e.data[e.curGame][e.curMode][t]){e.ext[e.curGame]&&e.ext[e.curGame][e.curMode]&&e.data[e.curGame][e.curMode][t]&&e.ext[e.curGame][e.curMode][e.data[e.curGame][e.curMode][t].nickname]?e.data[e.curGame][e.curMode][t].normalrank=e.ext[e.curGame][e.curMode][e.data[e.curGame][e.curMode][t].nickname]:e.data[e.curGame][e.curMode][t].normalrank=10*e.curPage+t+1;var i=cc.instantiate(e.itemPrefab);i.getComponent("RankItem").init(e,e.data[e.curGame][e.curMode][t]),i.parent=e.contentView}e.noContent&&(e.noContent.active=!(0<e.contentView.children.length))},onClickClose:function(){this.parent.closeDialog(this)},search:function(){this.curPage=0,this.totalPage=1,this.keyname=this.keywordInput.string,this.updatePage()},changeColumn:function(e,t){this.column.getComponent("LabelArray").labels[e].string=t},onClickBtnClear:function(){this.keywordInput.string="",this.btnClear.active=!1,this.keyname&&""!=this.keyname&&this.search()},onChangeKeyword:function(e){0<this.keywordInput.string.length?this.btnClear.active=!0:this.btnClear.active=!1}}),cc._RF.pop()},{HallDialog:"HallDialog"}],RankItem:[function(e,t,i){"use strict";cc._RF.push(t,"ef808SzVBFFhatyYDnMqNO+","RankItem");var a=e("HHCommon"),r=["month","month","week","day","championdf","championprm"];cc.Class({extends:a,properties:{player:{default:null,type:cc.Label},rank:{default:null,type:cc.Label},matchcount:{default:null,type:cc.Label},win:{default:null,type:cc.Label},loss:{default:null,type:cc.Label},winrate:{default:null,type:cc.Label},point:{default:null,type:cc.Label},bg:{default:null,type:cc.Node},avatar:{default:null,type:cc.Sprite}},init:function(e,t){if(this.parent=e,this.matchcount.string=this.numformat(t.matchcount)+"",this.rank.string=this.numformat(t.normalrank)+"th",t.avatarurl&&this.loadAvatar(t.avatarurl,1,this.avatar.node),t.normalrank<=3){this.rank.node.children[0].active=!0,this.rank.string="";var i=this,a="images/other/rank/rank_"+r[this.parent.curMode]+"_"+t.normalrank;cc.loader.loadRes(a,cc.SpriteFrame,function(e,t){e?i.rank.node.children[0].active=!1:i.rank&&(i.rank.node.children[0].getComponent(cc.Sprite).spriteFrame=t)})}this.win.string=this.numformat(t.win)+" win",this.loss.string=this.numformat(t.loss)+" lose",this.winrate.string=(0!=t.matchcount?parseInt(1e3*t.win/t.matchcount)/10:0)+"%",4!=this.parent.curMode?(this.point.string=this.numformat(t.normalscore),3==this.parent.curMode&&(this.matchcount.string="count: "+this.numformat(t.matchcount),this.win.string="continue win: "+this.numformat(t.winningstreak)+" ",this.loss.node.active=!1,this.winrate.node.active=!1)):this.point.string=t.step+"step ("+this.numformat(t.normalscore)+")";var s=t.nickname.split("#")[0];this.player.string=s,this.bg.children[0].active=!1,this.bg.children[1].active=!1,s==cc.global.user.nickname?this.bg.children[1].active=!0:this.bg.children[0].active=!0}}),cc._RF.pop()},{HHCommon:"HHCommon"}],RankRewardItem:[function(e,t,i){"use strict";cc._RF.push(t,"947f26qHY9PcYtmUQZmNmsv","RankRewardItem"),cc.Class({extends:cc.Component,properties:{rank:{default:null,type:cc.Label},nickname:{default:null,type:cc.Label},reward:{default:null,type:cc.Label}},init:function(e,t){if(this.parent=e,this.initTheme(),null!=t&&""!=t){var i=t.split("#");null==i||i.length<3||(this.rank.string=i[0]+"th",this.nickname.string=i[1],this.reward.string=i[2])}},initTheme:function(){4===cc.global.theme_idx?(this.rank&&(this.rank.node.color=cc.hexToColor("#c7f2ff")),this.nickname&&(this.nickname.node.color=cc.hexToColor("#c7f2ff")),this.reward&&(this.reward.node.color=cc.hexToColor("#c7f2ff"))):(this.rank&&(this.rank.node.color=cc.hexToColor("#D2FFD2")),this.nickname&&(this.nickname.node.color=cc.hexToColor("#D2FFD2")),this.reward&&(this.reward.node.color=cc.hexToColor("#D2FFD2")))}}),cc._RF.pop()},{}],RecordDialog:[function(e,t,i){"use strict";cc._RF.push(t,"3c984A0NT1DooI54sKWRkVN","RecordDialog");var a=e("HallDialog");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},tabs:{default:null,type:cc.Node},contentView:{default:null,type:cc.Node},itemPrefab:{default:null,type:cc.Prefab},topsview:{default:null,type:cc.Node},toprecodrow:{default:null,type:cc.Prefab},noContent:{default:null,type:cc.Node},msnBg:{default:null,type:cc.Node},greenBackground:cc.SpriteFrame,blueBackground:cc.SpriteFrame},init:function(e){var t,i,a,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=arguments[2];this.isOpening=0,this.parent=e,this.data=r,this.initTheme(),this.tipDesc={dizhu:{"":"",Victory:""},five:{"":""},tetris:{"":""},onet:(t={"":""},i="",a="",i in t?Object.defineProperty(t,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[i]=a,t),chess:{"":""},koni:{"":""}},this.initState(s)},initTheme:function(){4===cc.global.theme_idx?this.msnBg&&this.msnBg.getComponent(cc.Sprite)&&(this.msnBg.getComponent(cc.Sprite).spriteFrame=this.blueBackground):this.msnBg&&this.msnBg.getComponent(cc.Sprite)&&(this.msnBg.getComponent(cc.Sprite).spriteFrame=this.greenBackground)},initState:function(e){this.curGame="ofc";for(var t=0;t<this.tabs.children.length;t++)if(this.tabs.children[t].name==this.curGame){this.curTab=t;break}this.updateTab(),this.updatePage()},updateTab:function(){for(var e=0;e<this.tabs.children.length;e++){var t=this.tabs.children[e].getComponent("NotifyTabButton");t&&(e==this.curTab?t.init(!0,0):t.init(!1,0))}},onClickTab:function(e,t){var i=t.split(",");this.curTab!=parseInt(i[0])&&(this.curTab=parseInt(i[0]),this.curGame=i[1],this.updateTab(),this.updatePage())},updatePage:function(){this.contentView.destroyAllChildren();var n=this;n.loadding(),cc.global.http.httpPost("/hall/gtops",{game:this.curGame,f:this.isOpening},function(e){if(n.closeloadding(),null!=e&&""!=e){var t=e.split("$$$");if(1<t.length&&"00"==t[0]){n.isOpening=1;var i=JSON.parse(t[1]);i.tlist&&n.initBigRecords(i.tlist);for(var a=0;a<i.list.length;a++)if(i.list[a]){var s=cc.instantiate(n.itemPrefab);s.parent=n.contentView,s.getComponent("GameRecordItem").init(n,n.curGame,i.list[a])}n.noContent.active=!(0<n.contentView.children.length)}else{r=n.getLanguageText("ERROR_IN_SERVER_RESPONSE");n.alert(r+": "+t[0])}}else{var r=n.getLanguageText("ERROR_IN_SERVER_RESPONSE");n.alert(r+": 01")}},function(){n.closeloadding();var e=n.getLanguageText("CONNECTING_FAILED_0");n.alert(e)})},initBigRecords:function(e){this.topsview.getComponent(cc.PageView).removeAllPages();for(var t=0;t<e.length;t++){var i=cc.instantiate(this.toprecodrow);i.getComponent("BigRecordItem").init(e[t],t),this.topsview.getComponent(cc.PageView).addPage(i)}this.schedule(this.animatePageView,3)},onClickClose:function(){this.parent.closeDialog(this)},animatePageView:function(e,t){var i=this.topsview.getComponent(cc.PageView).getCurrentPageIndex();this.topsview.getComponent(cc.PageView).setCurrentPageIndex((i+1)%3)}}),cc._RF.pop()},{HallDialog:"HallDialog"}],RewardHistory:[function(e,t,i){"use strict";cc._RF.push(t,"4511ddE8wBDCo3leHPpOLmn","RewardHistory");var a=e("HallDialog");cc.Class({extends:a,properties:{base:{default:null,type:cc.Node},tabs:{default:null,type:cc.Node},modes:{default:null,type:cc.Node},pagenum:{default:null,type:cc.Label},msnBg:{default:null,type:cc.Node},content:{default:null,type:cc.Node},noContent:{default:null,type:cc.Node},greenBackground:cc.SpriteFrame,blueBackground:cc.SpriteFrame},init:function(e){this.parent=e;for(var t=0;t<3;t++){var i=this.content.children[t],a=1;0==t&&(a=Math.max(.8,cc.global.narrowContentRatio)),i.scaleX/=a,i.scaleY/=a}this.initState(),this.initTheme()},initTheme:function(){4===cc.global.theme_idx?this.msnBg&&this.msnBg.getComponent(cc.Sprite)&&(this.msnBg.getComponent(cc.Sprite).spriteFrame=this.blueBackground):this.msnBg&&this.msnBg.getComponent(cc.Sprite)&&(this.msnBg.getComponent(cc.Sprite).spriteFrame=this.greenBackground)},initState:function(){this.curGame="ofc",this.curMode=3,this.curPage=0,this.totalPage=0,this.updateTab(),this.updateMode(),this.updatePage()},updateTab:function(){for(var e=0;e<this.tabs.children.length;e++)this.tabs.children[e].name==this.curGame?this.tabs.children[e].getComponent("NotifyTabButton").init(!0,0):this.tabs.children[e].getComponent("NotifyTabButton").init(!1,0)},updateMode:function(){for(var e=0;e<this.modes.children.length;e++)e==this.curMode-1?this.modes.children[e].getComponent("NotifyTabButton").init(!0,0):this.modes.children[e].getComponent("NotifyTabButton").init(!1,0)},onClickTab:function(e,t){this.curGame!=t&&(this.curGame=t,this.curPage=0,this.updateTab(),this.updatePage())},onClickMode:function(e,t){this.curMode!=parseInt(t)&&(this.curMode=parseInt(t),this.curPage=0,this.updateMode(),this.updatePage())},onClickPrevPage:function(){this.curPage<=0||(this.curPage--,this.updatePage())},onClickNextPage:function(){this.curPage>=this.totalPage||(this.curPage++,this.updatePage())},updatePage:function(){var a=this;a.loadding(),cc.global.http.httpPost("/hall/rank_history",{game:this.curGame,type:this.curMode,page:this.curPage},function(e){if(a.closeloadding(),null==e||""==e){var t=a.getLanguageText("ERROR_IN_SERVER_RESPONSE");return a.alert(t+": 01"),void(a.content&&a.noContent&&(a.content.active=!1,a.noContent.active=!0,a.pagenum.string="- - -"))}var i=e.split("$$$");2<i.length&&"00"==i[0]?(a.totalPage=parseInt(i[1])-1,a.drawContent(a,i[2])):a.content&&a.noContent&&(a.content.active=!1,a.noContent.active=!0,a.pagenum.string="- - -")},function(){var e=a.getLanguageText("CONNECTING_FAILED_0");a.closeloadding(),a.alert(e),a.content&&a.noContent&&(a.content.active=!1,a.noContent.active=!0,a.pagenum.string="- - -")})},drawContent:function(e,t){e.content&&e.noContent&&(e.content.active=!0,e.noContent.active=!1);for(var i=0;i<3;i++)i==e.curMode-1?e.content.children[i].active=!0:e.content.children[i].active=!1;var a=t.split("#");e.pagenum.string=a[0].replace("-m","").replace("-w","").replace("-c","").replace(/-/g,".");var s=e.content.children[e.curMode-1];for(i=0;i<3;i++){var r=s.children[i],n=r.children[0].children[0],o=r.children[2].getComponent(cc.Label);t=a[i+1];if(console.log(t),t)if(!(t=t.split(","))||t.length<3)o.string="- - -",e.loadAvatar("",0,n);else{var l=t[0],c=t[1],h=t[2];null==l||""==l?(o.string="- - -",e.loadAvatar("",0,n)):(o.string=l,e.loadAvatar(c,h,n))}else o.string="- - -",e.loadAvatar("",0,n)}},onClickClose:function(){this.parent.closeDialog(this)}}),cc._RF.pop()},{HallDialog:"HallDialog"}],RoomInfo:[function(e,t,i){"use strict";cc._RF.push(t,"7deeavl46pPC72qYhwpZswi","RoomInfo");var a=e("HHCommon");cc.Class({extends:a,properties:{servertime:cc.Label,batteryinfo:cc.Node,signalinfo:cc.Node,signalalert:{default:null,type:cc.Node}},onLoad:function(){cc.global.onBatteryChanged=this.onBatteryInfo,cc.global.batteryobj=this.batteryinfo,this.onBatteryInfo(cc.global.batery),this.sendping=!1,this.animatesignal=!1,cc.global.isOffline&&(this.signalinfo.active=!1)},onBatteryInfo:function(e){null==e&&(e=50);var t=(cc.global.batery=e)/100*35;cc.global.batteryobj&&((cc.global.batteryobj.children[0].width=t)<=3?(cc.global.batteryobj.children[0].active=!1,cc.global.batteryobj.children[1].active=!1,cc.global.batteryobj.children[2].active=!0):(cc.global.batteryobj.children[0].active=!0,cc.global.batteryobj.children[1].active=!0,cc.global.batteryobj.children[2].active=!1))},onSingalInfo:function(e){switch(e){case 0:this.signalinfo.children[0].getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("signal_connectivity_none");break;case 1:this.signalinfo.children[0].getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("signal_wifi_strength_1");break;case 2:this.signalinfo.children[0].getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("signal_wifi_strength_2");break;case 3:this.signalinfo.children[0].getComponent(cc.Sprite).spriteFrame=cc.global.commonAtlas.getSpriteFrame("signal_wifi_strength_3")}0==e?(this.animatesignal||(this.animatesignal=!0,this.signalinfo.stopAllActions(),this.signalinfo.runAction(cc.sequence(cc.scaleTo(.4,1.2,1.2),cc.scaleTo(.4,1,1)).repeatForever())),this.signalalert&&(this.signalalert.active=!0)):(this.animatesignal=!1,this.signalinfo.stopAllActions(),this.signalalert&&(this.signalalert.active=!1),this.sendping=!1)},update:function(){if(!cc.global.isOffline&&cc.global&&cc.global.serverDateTime){this.servertime.string=cc.global.serverDateTime;var e=cc.global.logintime-cc.global.lastactivetime;if("yes"==cc.global.amObserve||"playing"!=cc.global.gamestatus)return;e<2e3?this.onSingalInfo(3):e<3e3?this.onSingalInfo(2):e<4e3?this.onSingalInfo(1):e<6e3?(this.sendping||this.socket().ping(),this.sendping=!0):e<8e3&&this.onSingalInfo(0)}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],RoomType:[function(e,t,i){"use strict";cc._RF.push(t,"ad0a74ZmoRFZpnYWW1MzEXC","RoomType");var a=e("HHCommon");cc.Class({extends:a,properties:{level:{default:null,type:cc.Node},score:{default:null,type:cc.Node},players:{default:null,type:cc.Node},seets:{default:null,type:cc.Node},play_btn:{default:null,type:cc.Node},loading:{default:null,type:cc.Node},gameicon:{default:null,type:cc.Node},atlas:{default:null,type:cc.SpriteAtlas},cond:0,room_price:0},init:function(e,t){this.parent=e;for(var i=0;i<4;i++)this.level.children[i].active=!1},onDestroy:function(){this.hideTimer&&clearTimeout(this.hideTimer)},changeStates:function(e,t){this.parent=e;var i=cc.global.hallTabIdx,a=cc.global.allgames[i],s=0;1e5<=cc.global.user.goldcoins?s=3:2e4<=cc.global.user.goldcoins?s=2:5e3<=cc.global.user.goldcoins&&(s=1),(!a||!a.rooms||a.rooms.length<7)&&(s=0),t+=s;var r=(this.stepidx=t)+1;this.minscore=0,this.parent=e;for(var n=0;n<4;n++)this.level.children[n].active=!1;if(null!=this.level&&1<=r-s&&r-s<=4&&(this.level.children[t-s].active=!0),null!=a){var o=a.rooms[t+1];if(null!=o){this.players.children[0].children[1].getComponent(cc.Label).string=o.players,this.players.children[1].children[1].getComponent(cc.Label).string=o.players,this.score.children[0].getComponent(cc.Label).string=";"+this.numformat(o.score).replace(" ",":")+"<",this.score.children[1].getComponent(cc.Label).string=";"+this.numformat(o.score).replace(" ",":")+"<",this.room_price=o.score;var l=o.ready,c=a.seets;this.minscore=o.minscore;for(n=0;n<5;n++)this.seets.children[n].children[0].active=!1,this.seets.children[n].children[1].active=!1,this.seets.children[n].active=!0,c<=n?this.seets.children[n].active=!1:l<=n?this.seets.children[n].children[1].active=!0:this.seets.children[n].children[0].active=!0;this.seets.getComponent(cc.Layout).spacingX=40*(5-c)+5,this.status=!1}}},update:function(e){var t=cc.global.allgames[cc.global.hallTabIdx];if(null!=t){var i=t.rooms[this.stepidx+1];if(null!=i){this.players.children[0].children[1].getComponent(cc.Label).string=i.players,this.players.children[1].children[1].getComponent(cc.Label).string=i.players;var a=i.ready,s=t.seets;this.minscore=i.minscore;for(var r=0;r<5;r++)this.seets.children[r].children[0].active=!1,this.seets.children[r].children[1].active=!1,this.seets.children[r].active=!0,s<=r?this.seets.children[r].active=!1:a<=r?this.seets.children[r].children[1].active=!0:this.seets.children[r].children[0].active=!0;cc.global.curPlaywayScore==this.room_price?this.showLoading(!0):this.showLoading(!1)}}},onClick:function(){if(this.minscore>cc.global.user.goldcoins)return cc.global.audio.playVoiceSpeech("support/2_no_enough_money"),void this.alert(this.numformat(this.minscore)+"");5==this.parent.tutorial_id&&this.parent.goNextTutorial(),this.parent.freeroomtypes.children[0].children[1].active=!1,cc.global.audio.playEffectAud("hall_click_game"),this.parent.checkTutorial(),cc.global.curPlaywayScore==this.room_price?cc.global.curPlaywayScore=0:cc.global.curPlaywayScore=this.room_price,this.parent.gameSelect(this)},showLoading:function(e){this.status!=e&&(this.status=e,null!=this.loading&&(this.loading.active=e,this.play_btn.active=!e),e?this.getComponent(cc.Animation).play():this.getComponent(cc.Animation).stop())},roomSplitClick:function(){0==this.chpMode&&(cc.global.curplaywayCond=this.cond,this.parent.updateHallTabs())}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ServerConfig:[function(e,t,i){"use strict";cc._RF.push(t,"2d404dHqW5NCIBr+nCrN60N","ServerConfig"),t.exports={baseURL:"http://138.201.19.250:8095/player",wsURL:"ws://138.201.19.250:8094",avatarURL:"",baseURL3g:"http://138.201.19.250:8095/player",wsURL3g:"ws://138.201.19.250:8094",avatarURL3g:"",apiURL:""},cc._RF.pop()},{}],SettingDialog:[function(e,t,i){"use strict";cc._RF.push(t,"8c4c7W68YFHwpDLNAkCzDHe","SettingDialog");var a=e("HallDialog");cc.Class({extends:a,properties:{btnSound:{default:null,type:cc.Node},bgmVolume:{default:null,type:cc.Slider},effectVolume:{default:null,type:cc.Slider},soundIcon:cc.Node},init:function(e){this.parent=e,this.initView()},initView:function(){var e=cc.sys.localStorage.getItem("sfx_on1");null==e&&(e=!0),this.btnSound&&2<=this.btnSound.children.length&&(this.btnSound.children[0].active=e,this.btnSound.children[1].active=!e,this.soundIcon.children[0].active=e,this.soundIcon.children[1].active=!e);var t=cc.sys.localStorage.getItem("bgVolume"),i=cc.sys.localStorage.getItem("effectVolume");null==t&&(t=.5),null==i&&(i=.5),this.bgmVolume.progress=t,this.bgmVolume.node.getComponent(cc.ProgressBar).progress=t,this.effectVolume.progress=i,this.effectVolume.node.getComponent(cc.ProgressBar).progress=i},onToggleSfx:function(){if(this.btnSound&&!(this.btnSound<2)){var e=this.btnSound,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0,this.soundIcon.children[0].active=!1,this.soundIcon.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1,this.soundIcon.children[0].active=!0,this.soundIcon.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},onChangeBgmVolume:function(e){cc.global.audio.setBGMVolume(e.progress),e.node.getComponent(cc.ProgressBar).progress=e.progress},onChangeEffectVolume:function(e){cc.global.audio.setEffectVolume(e.progress)},onClickClose:function(){cc.sys.localStorage.setItem("bgVolume",this.bgmVolume.progress),cc.sys.localStorage.setItem("effectVolume",this.effectVolume.progress),this.parent.closeDialog(this)}}),cc._RF.pop()},{HallDialog:"HallDialog"}],Slot:[function(e,t,i){"use strict";cc._RF.push(t,"73a2cXPc4lFt79JIrCeMbMT","Slot"),cc.Class({extends:cc.Component,properties:{},setVariables:function(e,t,i){this._spacex=e,this._spacey=t,this._slotWidth=i},setOffset:function(e,t){this.offsetx=e,this.offsety=t},reset:function(e){e.setX(this._spacex),e.setY(this._spacey)},setPos:function(e,t){this.node.x=e+this.offsetx,this.node.y=t+this.offsety}}),cc._RF.pop()},{}],Space3d:[function(e,t,i){"use strict";cc._RF.push(t,"1ef453jiZdCp6eVR8Je94jj","Space3d"),Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}}();i.Space3d=function(){function l(e,t,i,a,s){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,l),this.initVariables(),this.pictureW=e,this.pictureH=t;var r=(this.spaceX=e)/i;this.spaceY=r*a,this.spaceZ=s;var n=this.pictureH-a,o=n/(r-1);this.viewX=this.spaceX/2,this.viewY=this.pictureH-(o+n),this.viewZ=-o*s/n}return a(l,[{key:"initVariables",value:function(){this.pictureH=0,this.pictureW=0,this.scaleX=1,this.scaleY=1,this.spaceX=0,this.spaceY=0,this.spaceZ=0,this.viewX=0,this.viewY=0,this.viewZ=0}},{key:"scale",value:function(e,t){this.scaleX=e/this.pictureW,this.scaleY=t/this.pictureH}},{key:"getWidth",value:function(){return this.spaceX*this.scaleX}},{key:"getHeight",value:function(){return this.spaceY*this.scaleY}},{key:"getDeepth",value:function(){return this.spaceZ}},{key:"fillViewPoint",value:function(e){e.set(this.viewX*this.scaleX,this.viewY*this.scaleY,this.viewZ)}}]),l}();cc._RF.pop()},{}],SusliksMove:[function(e,t,i){"use strict";cc._RF.push(t,"01f8dgOJqJP2K5I2VvpkB6V","SusliksMove"),cc.Class({extends:cc.Component,properties:{tiles:{default:null,type:cc.SpriteAtlas},num:0,objectType:null,worth:0,liftSpeed:0,dh:0,collisonid:1,positionX:0},init:function(e,t,i,a,s,r){this.num=e,this.objectType=t,this.worth=i,this.liftSpeed=a,this.parent=r,this.positionX=s,this.susliks_action()},onCollisionEnter:function(e,t){if(1!=e.collisonid&&"hook"==e.node.name&&-1!=e.node.parent.getComponent("hookrope").hasdig&&(e.node.parent.getComponent("hookrope").collideCount++,!(1<e.node.parent.getComponent("hookrope").collideCount))){this.node.stopAction(this.susliks_sequence),"mouse"==this.objectType?this.node.getComponent(cc.Animation).pause("susliks_move"):"gemmouse"==this.objectType&&this.node.getComponent(cc.Animation).pause("susliks_gem_move"),e.node.parent.getComponent("hookrope").collide_object(this.num,this.liftSpeed,this.objectType),this.node.rotation=e.node.parent.rotation;var i=this.node.height;this.node.x=(e.node.y-i/2-10)*Math.sin(this.node.rotation*Math.PI/180),this.node.y=(e.node.y-i/2-10)*Math.cos(this.node.rotation*Math.PI/180)+195,this.dh=this.liftSpeed}},susliks_action:function(){var e=this;if(this.positionX<=50){this.node.scaleX*=-1;var t=cc.pDistance(this.node.position,cc.p(1e3,this.node.getPosition().y)),i=cc.pDistance(this.node.position,cc.p(0,this.node.getPosition().y)),a=cc.moveTo(t/30,cc.p(1e3,this.node.getPosition().y)),s=cc.moveTo(i/30,cc.p(0,this.node.getPosition().y));this.susliks_sequence=cc.repeatForever(cc.sequence(a,cc.callFunc(function(){e.node.scaleX*=-1},this),s,cc.callFunc(function(){e.node.scaleX*=-1},this)))}else{t=cc.pDistance(this.node.position,cc.p(-1e3,this.node.getPosition().y)),i=cc.pDistance(this.node.position,cc.p(0,this.node.getPosition().y)),a=cc.moveTo(t/30,cc.p(-1e3,this.node.getPosition().y)),s=cc.moveTo(i/30,cc.p(0,this.node.getPosition().y));this.susliks_sequence=cc.repeatForever(cc.sequence(a,cc.callFunc(function(){e.node.scaleX*=-1},this),s,cc.callFunc(function(){e.node.scaleX*=-1},this)))}this.node.runAction(this.susliks_sequence)},update:function(e){var t=Math.cos(this.node.rotation*Math.PI/180)*this.dh,i=Math.sin(this.node.rotation*Math.PI/180)*this.dh;this.node.x+=i,this.node.y+=t}}),cc._RF.pop()},{}],TetrisBegin:[function(e,t,i){"use strict";cc._RF.push(t,"05730ESbWBPBbrpDdmRijwZ","TetrisBegin");var a=e("HHCommon"),s=e("TetrisEngine"),d={},r=!1,n=!1,o=!1,l=!1;cc.Class({extends:a,properties:{selfplayer:{default:null,type:cc.Node},opponentplayer:{default:null,type:cc.Node},selfboard:{default:null,type:cc.Node},opponentboard:{default:null,type:cc.Node},tet_player:{default:null,type:cc.Prefab},tet_player_board:{default:null,type:cc.Prefab},roomdata:{default:null,type:cc.Node},pandata:{default:null,type:cc.Node},sendpiece:{default:null,type:cc.Prefab},receivepiece:{default:null,type:cc.Prefab},receiveroot:{default:null,type:cc.Node},sendroot:{default:null,type:cc.Node},senddata:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},observer:{default:null,type:cc.Prefab},observerbench:{default:null,type:cc.Node},emodlg:{default:null,type:cc.Prefab},chat:{default:null,type:cc.Prefab},chatsearch:{default:null,type:cc.Prefab},userinfodlg:{default:null,type:cc.Prefab},btn_enter:{default:null,type:cc.Node},btn_record_play:{default:null,type:cc.Node},lbl_record_status:{default:null,type:cc.Label},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},illegalconfirm:{default:null,type:cc.Prefab},btn_find_empty:{default:null,type:cc.Node},btn_replay_next_round:{default:null,type:cc.Node},btn_replay_prev_round:{default:null,type:cc.Node},pieceAtlas:{default:null,type:cc.SpriteAtlas},roomrankdialog:{default:null,type:cc.Prefab},finishAct:{default:null,type:cc.Node},leftControl:{default:null,type:cc.Node},rightControl:{default:null,type:cc.Node},rotateControl:{default:null,type:cc.Node},dropControl:{default:null,type:cc.Node},btnSfx:{default:null,type:cc.Node},controlPanel:{default:null,type:cc.Node},chatPanel:{default:null,type:cc.Node},multi:{default:null,type:cc.Node},controlTip:{default:null,type:cc.Node},selfContainer:{default:null,type:cc.Node},orientation:{default:1,type:cc.Integer},btnOrientation:{default:null,type:cc.Node},btnRestButtonBus:{default:null,type:cc.Node},background:{default:null,type:cc.Node},btnTheme:{default:null,type:cc.Node}},onLoad:function(){!cc.global.isOffline&&this.initEventCallback(),cc.game.setFrameRate(60);var e=cc.sys.localStorage.getItem("tet_theme");if(null==e&&(e="1"),this.initTheme(e),cc.global.amObserve="no",this.selfContainer&&1==this.orientation&&(this.selfContainer.scaleX/=Math.max(.81,cc.global.narrowContentRatio),this.selfContainer.scaleY/=Math.max(.81,cc.global.narrowContentRatio),this.opponentboard.parent.scaleX/=Math.max(.81,cc.global.narrowContentRatio),this.opponentboard.parent.scaleY/=Math.max(.81,cc.global.narrowContentRatio)),2==this.orientation){this.selfplayer.parent.scaleX/=Math.max(.81,cc.global.narrowContentRatio),this.selfplayer.parent.scaleY/=Math.max(.81,cc.global.narrowContentRatio);var t=1280/cc.global.narrowContentRatio/2;this.leftControl.setPosition(cc.v2(-1*t+112,this.leftControl.getPositionY())),this.dropControl.setPosition(cc.v2(-1*t+162,this.dropControl.getPositionY())),this.rightControl.setPosition(cc.v2(t-112,this.rightControl.getPositionY())),this.rotateControl.setPosition(cc.v2(t-162,this.rotateControl.getPositionY()))}if(this.play_status=0,this.playerlist=new Array,this.playerboardlist=new Array,this.observerlist=new Array,this.posBaseIdx=0,this.inited=!1,this.prevData1=null,this.prevData2=null,this.longPressInterval=.08,this.dropInterval=.03,this.blockInterval=-.07,this.timeElapse=0,this.trainTowerHeight=0,this.keyMap=[[65,83,68,17],[74,75,76,40],[100,101,102,39]],this.notReplay=!0,this.startGameTimer=null,this.endGameTimer=null,this.krCacheArr={},this.myRound=1,this.isNewRoom=!0,this.isGamePlaying=!1,null!=cc.global&&(this.initgame(),cc.sys.isMobile||(cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onCtrlKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onCtrlKeyUp,this))),this.initControlBtnsPos(),this.setEtcKeyBoardEvent(),this.setTouchEvent(),this.scheduler=cc.director.getScheduler(),cc.global.watchReplayData.onReplay&&this.prepareReplay(),cc.global.audio.playBGM("bgm_tetris"),1==cc.global.curPlaywayScore){var i={command:"jr",cond:20,event:"command",game:"tetris",id:this.getLanguageText("TRAINING_ROOM_0"),name:"normal",observerlist:[],playerlist:[{avatarurl:cc.global.user.avatarurl,exp:0,explevel:0,gender:0,goldcoins:cc.global.user.goldcoins,id:cc.global.user.id,nickname:cc.global.user.nickname,playcharacter:1,rank:0,seatid:0,texp:0,viplevel:0,vipscore:0},{avatarurl:"",exp:0,explevel:0,gender:0,goldcoins:9999,id:0,nickname:this.getLanguageText("AI_PLAYER_0"),playcharacter:1,rank:0,seatid:1,texp:0,viplevel:0,vipscore:0}],players:2,playway:"tetris",score:1};this.joinroom_event(i,this)}},onClickResetControlBtnPos:function(){switch(this.orientation){case 1:var e={left:cc.v2(-206,404),right:cc.v2(206,404),drop:cc.v2(0,150),rotate:cc.v2(0,404)};cc.sys.localStorage.setItem("tet_control_pos_"+this.orientation,JSON.stringify(e));break;case 2:e={left:cc.v2(-504/cc.global.narrowContentRatio,330),right:cc.v2(504/cc.global.narrowContentRatio,330),drop:cc.v2(-450/cc.global.narrowContentRatio,121),rotate:cc.v2(450/cc.global.narrowContentRatio,121)};cc.sys.localStorage.setItem("tet_control_pos_"+this.orientation,JSON.stringify(e))}this.initControlBtnsPos()},initControlBtnsPos:function(){if("no"==cc.global.amObserve){var e=cc.sys.localStorage.getItem("tet_control_pos_"+this.orientation),t=this;if(null==e)this.controlBtnPos={left:this.leftControl.getPosition(),right:this.rightControl.getPosition(),drop:this.dropControl.getPosition(),rotate:this.rotateControl.getPosition()},this.controlTip&&(this.controlTip.active=!0,this.scheduleOnce(function(){t.controlTip&&(t.controlTip.active=!1)},6));else{var i=JSON.parse(e);this.controlBtnPos={left:cc.v2(i.left.x,i.left.y),right:cc.v2(i.right.x,i.right.y),drop:cc.v2(i.drop.x,i.drop.y),rotate:cc.v2(i.rotate.x,i.rotate.y)},this.leftControl.setPosition(this.controlBtnPos.left),this.rightControl.setPosition(this.controlBtnPos.right),this.dropControl.setPosition(this.controlBtnPos.drop),this.rotateControl.setPosition(this.controlBtnPos.rotate)}}},initgame:function(){var t=this;this.finishAct&&(this.finishAct.active=!1);var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));if(null==e&&(e=!0),e?(this.btnSfx.children[0].active=!0,this.btnSfx.children[1].active=!1):(this.btnSfx.children[0].active=!1,this.btnSfx.children[1].active=!0),!cc.global.isOffline){var i=this.socket();this.map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("play",this.play_event),this.map("rer",this.recovery_event),this.map("finished",this.roundfinished),this.map("selemoticon",this.emoticon_event),this.map("sendchat",this.sendchat_event),this.map("callplayer",this.callplayer_event),this.map("keyresult",this.keyresult_event),this.map("kr",this.keyresult_event),this.map("changepiece",this.changepiece_event),this.map("cp",this.changepiece_event),this.map("sendlines",this.sendlines_event),this.map("sl",this.sendlines_event),this.map("allcards",this.allcards_event),this.map("startrecordresult",this.startrecord_event),i.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)})}this.inited=!0,(d=new s).pieceAtlas=this.pieceAtlas,d.init(this),this.loadding();var a={};if("NormalObserve"==cc.global.user.roomInType||1<cc.global.curPlaywayScore)switch(cc.global.user.roomInType){case"NormalCreate":null!=cc.global.extparams.roomid?a.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:a.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?i.exec("jcr",a):0==cc.global.championMode&&i.exec("cnr",a);break;case"NormalJoin":null==cc.global.tetris_jrData?(a.extparams={roomid:cc.global.extparams.roomid},i.exec("jnr",a)):this.joinroom_event(cc.global.tetris_jrData,this);break;case"NormalObserve":a.extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",i.exec("onr",a),t.controlPanel&&(t.controlPanel.active=!1),t.chatPanel&&(t.chatPanel.active=!1),t.btnOrientation&&(t.btnOrientation.active=!1),t.btnRestButtonBus&&(t.btnRestButtonBus.active=!1)}},setTouchEvent:function(){var i=this;this.leftControl&&(this.leftControl.on(cc.Node.EventType.TOUCH_START,function(e){i.leftControl.getChildByName("press").active=!0,i.onPieceLeftMove()},this.leftControl),this.leftControl.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(!i.isGamePlaying){var t=e.getDelta();i.controlBtnPos.left=cc.v2(t.x+i.controlBtnPos.left.x,t.y+i.controlBtnPos.left.y),i.leftControl.setPosition(i.controlBtnPos.left)}},this.leftControl),this.leftControl.on(cc.Node.EventType.TOUCH_END,function(e){i.leftControl.getChildByName("press").active=!1,i.onKeyDownEnd(65),i.isGamePlaying||cc.sys.localStorage.setItem("tet_control_pos_"+i.orientation,JSON.stringify(i.controlBtnPos))},this.leftControl),this.leftControl.on(cc.Node.EventType.TOUCH_CANCEL,function(e){i.leftControl.getChildByName("press").active=!1,i.onKeyDownEnd(65)},this.leftControl)),this.rightControl&&(this.rightControl.on(cc.Node.EventType.TOUCH_START,function(e){i.rightControl.getChildByName("press").active=!0,i.onPieceRightMove()},this.rightControl),this.rightControl.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(!i.isGamePlaying){var t=e.getDelta();i.controlBtnPos.right=cc.v2(t.x+i.controlBtnPos.right.x,t.y+i.controlBtnPos.right.y),i.rightControl.setPosition(i.controlBtnPos.right)}},this.rightControl),this.rightControl.on(cc.Node.EventType.TOUCH_END,function(e){i.rightControl.getChildByName("press").active=!1,i.onKeyDownEnd(65),i.isGamePlaying||cc.sys.localStorage.setItem("tet_control_pos_"+i.orientation,JSON.stringify(i.controlBtnPos))},this.rightControl),this.rightControl.on(cc.Node.EventType.TOUCH_CANCEL,function(e){i.rightControl.getChildByName("press").active=!1,i.onKeyDownEnd(65)},this.rightControl)),this.rotateControl&&(this.rotateControl.on(cc.Node.EventType.TOUCH_START,function(e){i.rotateControl.getChildByName("press").active=!0,i.onPieceRotate(),e.stopPropagation()},this.rotateControl),this.rotateControl.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(!i.isGamePlaying){var t=e.getDelta();i.controlBtnPos.rotate=cc.v2(t.x+i.controlBtnPos.rotate.x,t.y+i.controlBtnPos.rotate.y),i.rotateControl.setPosition(i.controlBtnPos.rotate)}},this.rotateControl),this.rotateControl.on(cc.Node.EventType.TOUCH_END,function(e){i.rotateControl.getChildByName("press").active=!1,i.onKeyDownEnd(83),i.isGamePlaying||cc.sys.localStorage.setItem("tet_control_pos_"+i.orientation,JSON.stringify(i.controlBtnPos))},this.rotateControl),this.rotateControl.on(cc.Node.EventType.TOUCH_CANCEL,function(e){i.rotateControl.getChildByName("press").active=!1,i.onKeyDownEnd(83)},this.rotateControl)),this.dropControl&&(this.dropControl.on(cc.Node.EventType.TOUCH_START,function(e){i.dropControl.getChildByName("press").active=!0,i.onPieceDrop(),e.stopPropagation()},this.dropControl),this.dropControl.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(!i.isGamePlaying){var t=e.getDelta();i.controlBtnPos.drop=cc.v2(t.x+i.controlBtnPos.drop.x,t.y+i.controlBtnPos.drop.y),i.dropControl.setPosition(i.controlBtnPos.drop)}},this.dropControl),this.dropControl.on(cc.Node.EventType.TOUCH_END,function(e){i.dropControl.getChildByName("press").active=!1,i.onKeyDownEnd(17),i.isGamePlaying||cc.sys.localStorage.setItem("tet_control_pos_"+i.orientation,JSON.stringify(i.controlBtnPos))},this.dropControl),this.dropControl.on(cc.Node.EventType.TOUCH_CANCEL,function(e){i.dropControl.getChildByName("press").active=!1,i.onKeyDownEnd(17)},this.dropControl))},prepareReplay:function(){var e=this;e.notReplay=!1,cc.global.amObserve="yes",e.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),e.replay_bar.active=!0,e.replayStep="ready_room",e.replaySeq=0,e.replayPrevCmd="",e.controlPanel&&(e.controlPanel.active=!1),e.chatPanel&&(e.chatPanel.active=!1),e.controlTip&&(e.controlTip.active=!1),e.btnOrientation&&(e.btnOrientation.active=!1),e.btnRestButtonBus&&(e.btnRestButtonBus.active=!1),e.checkRoundReplay(),e.goReplay()},pauseReplayTimer:function(){clearTimeout(this.replayTimer)},resumeReplayTimer:function(){this.goReplay()},checkRoundReplay:function(){this.play_history&&0!=this.play_history.length&&(this.checkNextRoundReplay(),this.checkPrevRoundReplay())},checkNextRoundReplay:function(){for(var e=0,t=this.replaySeq;t<this.play_history.length;t+=2)"finished"==JSON.parse(this.play_history[t]).command&&e++;this.btn_replay_next_round.active=2<=e},checkPrevRoundReplay:function(){for(var e=0,t=this.replaySeq-2;2<=t;t-=2)"finished"==JSON.parse(this.play_history[t]).command&&e++;this.btn_replay_prev_round.active=1<=e},onClickNextRoundReplay:function(){this.prepareChangeRound();for(var e=this.replaySeq+2;e<this.play_history.length-5;e+=2)if("finished"==JSON.parse(this.play_history[e]).command)return this.replaySeq=e,this.replayStep="play",this.changeRoundReplay(),void this.checkRoundReplay();this.gameTimerSpeedChange(!0),this.resumeReplayTimer()},onClickPrevRoundReplay:function(){this.prepareChangeRound();for(var e=0,t=this.replaySeq;0<=t;t-=2){var i=JSON.parse(this.play_history[t]);if("finished"==i.command&&e++,0==t)return this.replayStep="ready_room",this.replaySeq=0,this.replayTimeDelay=0,this.replayPrevCmd="",this.checkRoundReplay(),void this.resumeReplayTimer();if(2<=e&&"finished"==i.command)return this.replaySeq=t,this.changeRoundReplay(),void this.checkRoundReplay()}this.gameTimerSpeedChange(!0),this.resumeReplayTimer()},prepareChangeRound:function(){this.hideTimer(),this.hideCharacter(),this.hideAllStatus(),this.gameTimerSpeedChange(!1),this.pauseReplayTimer()},changeRoundReplay:function(){this.replayEventProcess(),this.replayEventProcess(),this.resumeReplayTimer()},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.checkRoundReplay(),this.gameTimerSpeedChange(!0),this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):(this.replayTimer&&clearTimeout(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.btn_replay_next_round.active=this.btn_replay_prev_round.active=!1,this.gameTimerSpeedChange(!1),this.replay_bar.children[0].opacity=100,this.pauseReplayTimer())},gameTimerSpeedChange:function(e){e&&"play"==this.replayStep&&6<=this.replaySeq?d.setAllState("PLAYING"):d.setAllState("WAITING")},cleanAllPlayers:function(){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].destroy(),this.playerboardlist[e].destroy();this.playerlist.splice(0,this.playerlist.length),this.playerboardlist.splice(0,this.playerboardlist.length),this.playerlist=new Array,this.playerboardlist=new Array,this.selfplayer&&(this.selfplayer.destroyAllChildren(),this.selfplayer.removeAllChildren()),this.opponentplayer&&(this.opponentplayer.destroyAllChildren(),this.opponentplayer.removeAllChildren()),this.selfboard&&(this.selfboard.destroyAllChildren(),this.selfboard.removeAllChildren()),this.opponentboard&&(this.opponentboard.destroyAllChildren(),this.opponentboard.removeAllChildren())},replayEventProcess:function(){if(this.play_history){switch(this.checkRoundReplay(),this.replayStep){case"ready_room":this.cleanAllPlayers(),this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var e=JSON.parse(this.play_history[this.replaySeq]);switch(e.command){case"play":"play"!=this.replayPrevCmd&&this.play_event(e,this);break;case"keyresult":case"kr":this.keyresult_event(e,this);break;case"changepiece":case"cp":this.changepiece_event(e,this);break;case"sendlines":case"sl":this.sendlines_event(e,this);break;case"finished":this.roundfinished(e,this);break;case"allcards":this.allcards_event(e,this);break;case"callplayer":this.callplayer_event(e,this);break;case"selemoticon":this.emoticon_event(e,this);break;case"sendchat":this.sendchat_event(e,this);break;case"jr":this.joinroom_event(e,this);break;case"players":this.players_event(e,this)}this.replayPrevCmd=e.command}this.play_history[this.replaySeq+1]&&""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2}},goReplay:function(){var e=this;this.replayEventProcess(),this.play_history[this.replaySeq]?this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay):(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.btn_replay_next_round.active=this.btn_replay_prev_round.active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.replayPrevCmd="",this.pauseReplayTimer(),d.setAllState("READY"))},setEtcKeyBoardEvent:function(){var i=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e,t){switch(e){case cc.KEY.escape:case cc.KEY.back:if(!i.isemoticon&&!i.ischat)return void i.onclickBack();i.isemoticon&&(null!=i.emoticonpage&&i.emoticonpage.destroy(),i.isemoticon=!1),i.ischat&&(null!=i.chatpage&&i.chatpage.destroy(),i.ischat=!1)}}},i.node)},onChangePosition:function(){"no"!=cc.global.amObserve&&(this.pauseReplayTimer(),this.play_history=[],this.changePosition(),this.prepareReplay())},onShowGrid:function(){},onShowHint:function(){var e=JSON.parse(cc.sys.localStorage.getItem("tetris_hint_show"));null==e&&(e=!1),e=!e,cc.sys.localStorage.setItem("tetris_hint_show",JSON.stringify(e))},onGoRobot:function(){var e=JSON.parse(cc.sys.localStorage.getItem("tetris_go_robot"));null==e&&(e=!1),e=!e,cc.sys.localStorage.setItem("tetris_go_robot",JSON.stringify(e))},onPieceLeftMove:function(){if("no"==cc.global.amObserve&&"playing"==cc.global.gamestatus){var e=d.getEnginePlayer(cc.global.user.id);"PLAYING"!=e.state||1==d.data.roundFinish||d.data.overflowed||(65!=e.keycode&&(e.keycode=65,0!=e.keycode?e.leftkeytime=this.blockInterval:e.leftkeytime=0,e.rightkeytime=0,n=r=!1),d.tryMove(e,e.curpos[0]-1,e.curpos[1]),this.drawGame())}},onPieceRightMove:function(){if("no"==cc.global.amObserve&&"playing"==cc.global.gamestatus){var e=d.getEnginePlayer(cc.global.user.id);"PLAYING"!=e.state||1==d.data.roundFinish||d.data.overflowed||(83!=e.keycode&&(e.keycode=83,0!=e.keycode?(e.rightkeytime=this.blockInterval,e.leftkeytime=0):(e.leftkeytime=0,e.rightkeytime=0),n=r=!1),d.tryMove(e,e.curpos[0]+1,e.curpos[1]),this.drawGame())}},onPieceRotate:function(){if("no"==cc.global.amObserve&&"playing"==cc.global.gamestatus){var e=d.getEnginePlayer(cc.global.user.id);"PLAYING"!=e.state||1==d.data.roundFinish||d.data.overflowed||d.data.keydown_success_s||(0==e.keycode&&(e.leftkeytime=0,e.rightkeytime=0),d.data.keydown_success_s=!0,e.leftkeytime>=this.dropInterval||e.rightkeytime>=this.dropInterval?o=!0:(e.prevstate=e.curstate,e.curstate=(e.curstate+1)%4,d.tryRotate(e,e.curpos[0],e.curpos[1])?this.drawGame():e.curstate=e.prevstate))}},onPieceDrop:function(){if("no"==cc.global.amObserve&&"playing"==cc.global.gamestatus){var e=d.getEnginePlayer(cc.global.user.id);if("PLAYING"==e.state&&1!=d.data.roundFinish&&!d.data.overflowed&&!d.data.keydown_success)if(e.leftkeytime>=this.dropInterval||e.rightkeytime>=this.dropInterval)l=!0;else{for(var t=e.curpos[1];t<d.data.boardHeight&&d.tryMove(e,e.curpos[0],e.curpos[1]+1);)++t;d.data.keydown_success=!0;var i=d.pieceDropped(e);i&&(d.newPiece(e),i[0]&&this.sendadd(e,i[0]),this.sendevent(1,i[1])),this.drawGame()}}},onCtrlKeyDown:function(e){switch(e.keyCode){case 112:this.onClickShowKeyMode();break;case 113:this.onShowGrid();break;case 114:this.onShowHint();break;case 115:this.onChangePosition();break;case 116:this.onGoRobot();break;case 32:this.processReadyState();break;case 65:case 74:case 100:this.onPieceLeftMove();break;case 68:case 76:case 102:this.onPieceRightMove();break;case 17:case 40:case 39:this.onPieceDrop(),e.stopPropagation();break;case 83:case 75:case 101:this.onPieceRotate(),e.stopPropagation()}},onCtrlKeyUp:function(e){var t=e.keyCode;e.keyCode!=this.keyMap[0][3]&&e.keyCode!=this.keyMap[1][3]&&e.keyCode!=this.keyMap[2][3]&&16!=e.keyCode||(t=17),e.keyCode!=this.keyMap[0][1]&&e.keyCode!=this.keyMap[1][1]&&e.keyCode!=this.keyMap[2][1]||(t=83),e.keyCode!=this.keyMap[0][0]&&e.keyCode!=this.keyMap[1][0]&&e.keyCode!=this.keyMap[2][0]&&e.keyCode!=this.keyMap[0][2]&&e.keyCode!=this.keyMap[1][2]&&e.keyCode!=this.keyMap[2][2]||(t=65),this.onKeyDownEnd(t)},onKeyDownEnd:function(e){if("no"==cc.global.amObserve){var t=d.getEnginePlayer(cc.global.user.id);17==e||16==e?(d.data.keydown_success=!1,d.data.keydown_success_s=!1,t.keycode=0,t.leftkeytime=0,t.rightkeytime=0,l=r=n=!1):83==e?(d.data.keydown_success_s=!1,o=!1):65==e&&(t.keycode=0,t.leftkeytime=0,t.rightkeytime=0,r=n=!1)}},joinroom_event:function(e,t){cc.global.tetris_jrData=e,cc.global.user.selplayway=e.name,d.data.roomid=e.id,d.data.panScore=cc.global.curPlaywayScore=e.score;var i=t.getLanguageText("ROOM_0");switch(1==cc.global.curPlaywayScore?t.roomdata.getComponent(cc.Label).string="TetrisTraning ("+t.numformat(e.score)+"pt)":t.roomdata.getComponent(cc.Label).string=e.id+i+" ("+t.numformat(e.score)+"pt)",cc.global.gamestatus){case"ready":cc.global.gamestatus="waiting",2==e.playerlist.length&&(cc.global.gamestatus="playing"),t.players_event(e,t);break;case"waiting":t.players_event(e,t);break;case"playing":cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)}e.hisdata?t.showMatchCareer(e.hisdata):t.hideMatchCareer(),t.drawroot(),t.closeloadding()},players_event:function(e,t){null!=cc.global.tetris_jrData&&(cc.global.tetris_jrData.playerlist=e.playerlist),e.msg&&(cc.global.outReasonMsg=e.msg),2==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)if(e.observerlist[a].id==cc.global.user.id){i=!1;break}i&&t.notReplay?t.exitPlay():(t.observer_event(e,t),t.isBoardPlayersChanged(e.playerlist)&&(t.startGameTimer&&(clearTimeout(t.startGameTimer),t.startGameTimer=null),t.endGameTimer&&(clearTimeout(t.endGameTimer),t.endGameTimer=null),t.players_engine(e,t)))},players_engine:function(e){this.removeBoardPlayers(e.playerlist);for(var t=this.posBaseIdx,i=0;i<e.playerlist.length;i++){if(e.playerlist[i].seatid=i,"no"==cc.global.amObserve&&e.playerlist[i].id!=cc.global.user.id&&(t=1-this.posBaseIdx),this.playerexist(e.playerlist[i])){var a=this.getPlayer(e.playerlist[i].id),s=this.getPlayerBoard(e.playerlist[i].id);a.seatid=s.seatid=t%2,a.layoutForSeat(),s.layoutForSeat()}else{var r=cc.instantiate(this.tet_player),n=cc.instantiate(this.tet_player_board);"yes"==cc.global.amObserve?this.selfplayer.children.length<1?(r.parent=this.selfplayer,n.parent=this.selfboard):(r.parent=this.opponentplayer,n.parent=this.opponentboard):this.notReplay&&(e.playerlist[i].id==cc.global.user.id?(r.parent=this.selfplayer,n.parent=this.selfboard):(r.parent=this.opponentplayer,n.parent=this.opponentboard)),r.getComponent("TetrisPlayer").init(this,e.playerlist[i],t%2,i),this.playerlist.push(r),n.getComponent("TetrisPlayerBoard").init(this,e.playerlist[i],t%2,i,e.cardsnum),this.playerboardlist.push(n)}t++,d.setPlayerId(i,e.playerlist[i].id)}1==e.playerlist.length?(this.setWaitingState(),this.cleanAfterAllCards(),this.hideMatchCareer()):2==e.playerlist.length&&this.setReadyState(),"yes"==cc.global.amObserve&&e.playerlist.length<2?1==cc.global.championMode?this.btn_enter&&(this.btn_enter.active=!1):0==cc.global.championMode&&this.notReplay&&this.btn_enter&&(this.btn_enter.active=!0):this.btn_enter&&(this.btn_enter.active=!1),this.showWaitingTimer()},observer_event:function(e,t){t.observerbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i],t),a.getComponent("Observer").nickname.node.active=!1,a.parent=t.observerbench,t.observerlist[i]=a}},removeBoardPlayers:function(e){for(var t=0;t<this.playerlist.length;t++){for(var i=this.playerlist[t].getComponent("TetrisPlayer"),a=!1,s=0;s<e.length;s++)if(i.userdata.id==e[s].id){a=!0;break}1!=a&&(this.playerlist[t].destroy(),this.playerlist.splice(t,1),this.playerboardlist[t].destroy(),this.playerboardlist.splice(t,1))}},isBoardPlayersChanged:function(e){if(0==this.playerlist.length&&0!=e.length)return!0;if(this.playerlist.length!=e.length)return!0;for(var t=0;t<e.length;t++)if(!this.getPlayer(e[t].id))return!0;return!1},playerexist:function(e){for(var t=0;t<this.playerlist.length;t++)if(null!=this.playerlist[t]&&this.playerlist[t].getComponent("TetrisPlayer").userdata.id==e.id)return!0;return!1},changePosition:function(){if(0!=this.playerlist.length){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("TetrisPlayer"),i=this.playerboardlist[e].getComponent("TetrisPlayerBoard");t&&i&&(t.seatid=i.seatid=(t.seatid+1)%2,t.layoutForSeat(),i.layoutForSeat())}this.posBaseIdx=1-this.posBaseIdx}},showMatchCareer:function(e){},hideMatchCareer:function(){},setWaitingState:function(){if(this.playerboardlist){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("TetrisPlayerBoard");t&&t.setState("Pending")}d.setAllState("WAITING"),this.btnOrientation&&"no"==cc.global.amObserve&&(this.btnOrientation.active=!0),this.btnRestButtonBus&&"no"==cc.global.amObserve&&(this.btnRestButtonBus.active=!0)}},setReadyState:function(){if(this.playerboardlist){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("TetrisPlayerBoard");if(t){var i=this.getLanguageText("READY_0")+"?",a=this.getLanguageText("PREPARED_0");1==cc.global.curPlaywayScore&&parseInt(t.userdata.id)<=0?t.setState(a):t.setState(i)}}d.setAllState("READY"),this.btnOrientation&&"no"==cc.global.amObserve&&(this.btnOrientation.active=!0),this.btnRestButtonBus&&"no"==cc.global.amObserve&&(this.btnRestButtonBus.active=!0)}},sendState:function(){if(1!=cc.global.curPlaywayScore)this.socket().exec("ready",{extparams:{roomid:d.data.roomid}});else{var e=this.getPlayerBoard(cc.global.user.id);if(d.setTrainMode(!0),e){var t=this.getLanguageText("PREPARED_0");e.setState(t),d.setPlayerState(cc.global.user.id,"START")}var i={command:"play",event:"command",id:cc.global.user.id,players:[{curgame:"tetris",pieces:"AgAEBAQFAwMFBgUGBQUGAAMGBgQGAQIEAwUAAQAABgEGAwAEAgMAAwYFAAIBAwMCBQEAAwIBAgUGBgYGBgEFAgMAAQYCAQECAQMEAgIGBgQCAgIGBgIFBAACBgYGBAYCBAUGAQ==",playuser:cc.global.user.id,playcharacter:cc.global.user.playcharacter,round:0,towers:[]},{curgame:"tetris",pieces:"",playuser:0,round:0,towers:[]}],ratio:1,round:1,sendlines:0,status:"playing"};this.play_event(i,this)}},getInitTowers:function(e){for(var t=[24][10],i=0;i<24;i++)for(var a=0;a<10;a++)t[i][a]=0;if(e)for(i=0;i<2;i++){for(var s=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());r==s;)r=Math.floor(10*Math.random());for(a=0;a<10;a++)t[i][a]=a==s||a==r?0:1}return t},sendevent:function(e){if(1!=cc.global.curPlaywayScore&&"no"==cc.global.amObserve){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";1!=d.data.roundFinish&&this.socket().exec("ke",{extparams:{tc:e+t+"/"+this.myRound}})}},sendadd:function(e,t){var i=this,a=(i.socket(),i.getPlayer(e.userid).seatid),s=null;0==a&&(s=cc.instantiate(i.sendpiece)).getComponent("playersend").init(this,d,e,t),1==a&&(s=cc.instantiate(i.receivepiece)).getComponent("playersend").init(this,d,e,t);var r=!1;"no"==cc.global.amObserve?e.userid!=cc.global.user.id?(s.parent=i.receiveroot,r=!0):s.parent=i.sendroot:"yes"==cc.global.amObserve&&(s.parent=0==a?i.sendroot:i.receiveroot),e.changepiece=null;var n="";if(r){for(var o=t[0].length-1;0<=o;o--)for(var l=0;l<d.data.boardWidth;l++)0==t[l][o]&&(n+=l+10*o+"/");n=n.slice(0,n.length-1),s.getComponent("playersend").sendingBlockData=n,i.socket().exec("ke",{extparams:{tc:"10/"+n+"/"+i.myRound}})}},roundfinished:function(e,t){t.startGameTimer&&clearTimeout(t.startGameTimer),t.krCacheArr={},n=r=o=l=!1,d.data.overflowed=!0,d.initPieces(),d.setAllState("FINISHED"),d.data.curRound++;for(var i=0;i<t.playerboardlist.length;i++){var a=t.playerboardlist[i].getComponent("TetrisPlayerBoard");a&&(a.userdata.id==e.userid?(a.showRoundResult(!1),a.showRoundScore(e.msg)):(a.showRoundResult(!0),a.showRoundScore(e.extmsg)))}d.data.tsPSCG=d.data.tsPSCT=0,t.drawGame()},showTrainRound:function(e){if(d.data.trainMode)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("TetrisPlayerBoard");if(i&&i.userdata.id==cc.global.user.id){i.showRoundScore(e);break}}},drawGrid:function(){if(this.playerboardlist&&0!=this.playerboardlist.length){var e=JSON.parse(cc.sys.localStorage.getItem("tetris_grid_show"));if(null==e&&(e=!1),this.playerboardlist[0]&&(t=this.playerboardlist[0].getComponent("TetrisPlayerBoard"))&&(e?d.drawGrid(t.grid):d.hideGrid(t.grid)),this.playerboardlist[1]){var t=this.playerboardlist[1].getComponent("TetrisPlayerBoard");t&&(e?d.drawGrid(t.grid):d.hideGrid(t.grid))}}},drawGame:function(){if(this.playerboardlist&&0!=this.playerboardlist.length){if(this.playerboardlist[0]&&(t=this.playerboardlist[0].getComponent("TetrisPlayerBoard"))){var e=d.getEnginePlayer(t.userdata.id);this.drawPlayerTower(this.playerboardlist[0].getComponent("TetrisPlayerBoard").tower,e)}if(this.playerboardlist[1]){var t=this.playerboardlist[1].getComponent("TetrisPlayerBoard");if(t){e=d.getEnginePlayer(t.userdata.id);this.drawPlayerTower(this.playerboardlist[1].getComponent("TetrisPlayerBoard").tower,e)}}}},drawroot:function(){"normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway?(this.pandata.children[0].children[0].active=!0,this.pandata.children[0].children[1].active=!1):"diamond"==cc.global.user.selplayway&&(this.pandata.children[0].children[0].active=!1,this.pandata.children[0].children[1].active=!0)},userready_event:function(e,t){cc.global.audio.playEffectAud("ready");var i=t.getPlayerBoard(e.userid),a=this.getLanguageText("PREPARED_0");i&&(i.setState(a),d.setPlayerState(e.userid,"START"),i.startTimer(d.data.waitTime))},play_event:function(e,t){t.receiveroot&&(t.receiveroot.destroyAllChildren(),t.receiveroot.removeAllChildren()),t.sendroot&&(t.sendroot.destroyAllChildren(),t.sendroot.removeAllChildren());for(var i=0;i<t.playerboardlist.length;i++){var a=t.playerboardlist[i].getComponent("TetrisPlayerBoard");a&&(a.hideRoundResult(),a.clearTower())}t.isNewRoom=!1,t.isGamePlaying=!0,t.senddata.getComponent(cc.Label).string="0",t.showReadyTimer(),t.notReplay&&(t.myRound=e.round),t.startGameTimer=setTimeout(function(){d.setMat(e.players),t.resolveKrCacheArr(e.players),t.startGame()},1e3*d.data.readyTime),d.initMat(),d.initPieceDownTimer(),0==d.data.curRound&&t.sendlines_event({msg:0,extmsg:1},t),"yes"!=cc.global.amObserve?(t.controlPanel&&(t.controlPanel.active=!0),t.chatPanel&&(t.chatPanel.active=!0),t.controlTip&&(t.controlTip.active=!1)):(t.controlPanel&&(t.controlPanel.active=!1),t.chatPanel&&(t.chatPanel.active=!1),t.btnOrientation&&(t.btnOrientation.active=!1),t.btnRestButtonBus&&(t.btnRestButtonBus.active=!1)),t.closeloadding()},resolveKrCacheArr:function(e){for(var t=0;t<e.length;t++)if(this.krCacheArr[e[t].playuser])for(var i=0;i<this.krCacheArr[e[t].playuser].length;i++)this.keyresult_event(this.krCacheArr[e[t].playuser][i],this,!0)},resolveCacheAttackBlocks:function(e){for(var t=0;t<e.length;t++)for(var i=0;i<e[t].slist.length;i++){var a=d.getOtherEnginePlayer(e[t].playuser);this.attackBlocksUp(a.userid,"0/"+e[t].slist[i]),d.newPiece(a)}},recovery_event:function(e,t){d.initMat(),d.setMat(e.players),d.initPieceDownTimer(),d.data.curRound=e.players[0].round+e.players[1].round;for(var i=0;i<e.players.length;i++){var a=t.getPlayerBoard(e.players[i].playuser);a&&a.showRoundScore(e.players[i].round)}t.sendlines_event({extmsg:2*e.ratio,msg:e.sendlines},t),t.startGame(),t.closeloadding(),t.isGamePlaying=!0},drawPlayerTower:function(e,t){"PLAYING"!=t.state&&"FINISHED"!=t.state||d.drawBoard(e,t)},startGame:function(){d.setAllState("PLAYING"),this.hideAllStatus(),this.drawGame()},processReadyState:function(){2==this.playerlist.length&&(this.sendState(),this.btnOrientation&&(this.btnOrientation.active=!1),this.btnRestButtonBus&&(this.btnRestButtonBus.active=!1))},hideAllStatus:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("TetrisPlayerBoard");t&&(t.hideStatus(),t.hideTip())}},sendlines_event:function(e,t){t.senddata.getComponent(cc.Label).string=t.numformat(parseInt(e.msg));var i=parseInt(e.extmsg),a=parseInt(e.msg);if(0<i){2<=i&&(i/=2,20<=a&&(cc.global.audio.playEffectAud("charge"),t.showMultiAni()));var s=d.data.panScore*i,r=0;if("normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway)for(var n=0;n<t.playerlist.length;n++){var o=t.playerlist[n].getComponent("TetrisPlayer");if(o){if(0==o.userdata.goldcoins)return;0==r?r=o.userdata.goldcoins:r>o.userdata.goldcoins&&(r=o.userdata.goldcoins)}}r<s&&(s=r),t.updateBetUpBalance(s),t.multiBetUp(s),d.data.pangolds=d.data.pangolds+2*s,t.pandata.children[1].getComponent(cc.Label).string=t.numformat(d.data.pangolds)}},showMultiAni:function(){if(this.multi){var e=this;this.multi.active=!0;var t=this.multi.getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"play",!1),setTimeout(function(){e.multi.active=!1},2e3)}},multiBetUp:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("TetrisPlayer");i&&i.betup.getComponent("TetrisBetUp").init(e,i.seatid,this.orientation)}},workOutMatchCareer:function(e){for(var t=void 0,i=0,a=0;a<e.players.length;a++){var s=this.getPlayer(e.players[a].userid),r=this.getPlayerBoard(e.players[a].userid);s&&r&&("normal"==cc.global.user.selplayway?0<e.players[a].score&&(this.matchCareerData.tgolds[s.userdata.id]+=e.players[a].score-d.data.pangolds/2):"diamond"==cc.global.user.selplayway&&0<e.players[a].score&&(this.matchCareerData.tdiamonds[s.userdata.id]+=e.players[a].score-d.data.pangolds/2),e.players[a].pig?(this.matchCareerData.wins[s.userdata.id]++,t=s.userdata.id):i=e.players[a].win)}0==i&&this.matchCareerData.bankerwins[t]++,this.showMatchCareer(this.matchCareerData)},allcards_event:function(e,t){t.matchCareerData&&t.workOutMatchCareer(e),d.data.curRound=0,t.isGamePlaying=!1;for(var i=t.playerlist.length==e.players.length,a=0;a<e.players.length;a++){e.players[a].getout&&(i=!1);var s=t.getPlayer(e.players[a].userid);if(s&&("normal"==cc.global.user.selplayway&&(s.userdata.goldcoins=parseInt(e.players[a].gold)),s.summary(e.players[a])),e.players[a].userid==cc.global.user.id)t.notReplay&&(cc.global.user.goldcoins=e.players[a].gold),e.players[a].pig?t.runFinishAction("dzz_cj_win"):t.runFinishAction("dzz_cj_lose")}d.setAllState("FINISHED"),t.drawGame(),i&&(t.endGameTimer=setTimeout(function(){t.cleanAfterAllCards(),t.setReadyState()},2500))},runFinishAction:function(e){if("yes"!=cc.global.amObserve&&this.finishAct&&this.finishAct.getComponent(sp.Skeleton)){var t=cc.callFunc(this.enableFinishAni,this,e),i=cc.callFunc(this.disableFinishAni,this);this.node.runAction(cc.sequence(t,cc.delayTime(3),i))}},enableFinishAni:function(e,t){if(this.finishAct){var i=this.finishAct.getComponent(sp.Skeleton);i&&(this.finishAct.active=!0,i.animation=t)}},disableFinishAni:function(e){this.finishAct&&(this.finishAct.active=!1)},cleanAfterAllCards:function(){if(d&&this.receiveroot){this.receiveroot.destroyAllChildren(),this.receiveroot.removeAllChildren(),this.sendroot.destroyAllChildren(),this.sendroot.removeAllChildren(),d.setAllState("READY"),d.initPan(),d.initMat(),d.initPieces(),this.senddata.getComponent(cc.Label).string="0",this.pandata.children[1].getComponent(cc.Label).string=d.data.pangolds;for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("TetrisPlayerBoard");t&&(t.hideRoundResult(),t.hideRoundScore(),t.clearTower(),t.showPlayCharacter())}cc.global.amObserve&&"no"==cc.global.amObserve&&this.showWaitingTimer()}},updateBetUpBalance:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("TetrisPlayer");i&&(i.userdata.goldcoins-=e)}this.updatePlayerBalance()},updatePlayerBalance:function(){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("TetrisPlayer");t&&t.updateBalance()}},changepiece_event:function(e,t){t.updateReceivedBlock(e.userid,""+e.msg);var i=d.getEnginePlayer(e.userid);i&&d.push_piece(i,parseInt(e.extmsg)),"no"==cc.global.amObserve?e.userid!=cc.global.user.id&&i&&d.newPiece(i):i&&d.newPiece(i)},attackBlocksUp:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",i=t.split("/"),a=[[]],s=0,r=24,n=1;n<i.length;n++)r>(o=Math.floor(parseInt(i[n])/10))&&(r=o);for(n=1;n<i.length;n++)i[n]=i[n]-10*r,s<(o=Math.floor(parseInt(i[n])/10))&&(s=o);for(n=1;n<i.length;n++){var o=Math.floor(parseInt(i[n])/10),l=Math.floor(parseInt(i[n])%10);i[n]=10*(s-o)+l}for(n=0;n<d.data.boardWidth;n++){a[n]=[];for(var c=s;0<=c;c--)a[n][c]=2}for(n=1;n<i.length;n++){l=parseInt(i[n])%10,o=Math.floor(parseInt(i[n])/10);a[l][o]=0}var h=d.getEnginePlayer(e);h&&"no"==cc.global.amObserve&&(d.addFullLines(h,a),1<cc.global.curPlaywayScore&&this.socket().exec("ke",{extparams:{tc:"9/"+t}}))},updateReceivedBlock:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";if(this.sendroot.children)if("no"==cc.global.amObserve){if(this.sendroot.children.length)if("no"!=cc.global.amObserve&&this.notReplay)for(a=0;a<this.sendroot.children.length;a++){var i=this.sendroot.children[a].getComponent("playersend");if(i&&i.playerData.userid!=e){i.hide(),i.removeSelf();break}}else(i=this.sendroot.children[0].getComponent("playersend"))&&i.playerData.userid!=e&&(i.hide(),i.removeSelf())}else if(this.sendroot.children.length){for(var a=0;a<this.sendroot.children.length;a++)if((i=this.sendroot.children[a].getComponent("playersend"))&&i.playerData.userid!=e){i.hide(),i.removeSelf();break}}else this.attackBlocksUp(e,t)},keyresult_event:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],a=e.msg.charCodeAt(0);if(d.isPlaying()||i)if("no"!=cc.global.amObserve||e.userid!=cc.global.user.id){var s=d.getEnginePlayer(e.userid);if(s){switch(a){case 49:for(;d.tryMove(s,s.curpos[0],s.curpos[1]+1););var r=d.updateDropPiece(s,e.msg);r&&t.sendadd(s,r),d.push_piece(s,parseInt(e.extmsg));break;case 50:for(;d.tryMove(s,s.curpos[0]-1,s.curpos[1]););break;case 51:for(;d.tryMove(s,s.curpos[0]+1,s.curpos[1]););break;case 52:d.tryMove(s,s.curpos[0]-1,s.curpos[1]);break;case 53:d.tryMove(s,s.curpos[0]+1,s.curpos[1]);break;case 54:var n=s.curstate;s.curstate=(s.curstate+1)%4,d.tryRotate(s,s.curpos[0],s.curpos[1])||(s.curstate=n);break;case 55:for(;d.tryMove(s,s.curpos[0]-1,s.curpos[1]););d.tryRotateToLeft(s,s.curpos[0],s.curpos[1]);break;case 56:for(;d.tryMove(s,s.curpos[0]+1,s.curpos[1]););d.tryRotateToRight(s,s.curpos[0],s.curpos[1]);break;case 57:t.changepiece_event(e,t)}t.drawGame()}}else 49==a&&d.push_piece(d.getEnginePlayer(cc.global.user.id),parseInt(e.extmsg));else 49==a&&(t.krCacheArr[e.userid]||(t.krCacheArr[e.userid]=[]),t.krCacheArr[e.userid].push(e))},showWaitingTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("TetrisPlayerBoard");t&&t.startTimer(d.data.waitTime)}},showReadyTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("TetrisPlayerBoard");t&&t.startTimer(d.data.readyTime)}},hideTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("TetrisPlayerBoard");t&&t.stopTimer()}},hideCharacter:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("TetrisPlayerBoard");t&&t.hidePlayCharacter()}},update:function(e){if(d&&!d.data.overflowed&&this.isGamePlaying){var t=d.getEnginePlayer(cc.global.user.id);if("no"==cc.global.amObserve&&t){if(0!=t.keycode&&"no"==cc.global.amObserve&&"PLAYING"==t.state)switch(t.keycode){case 65:t.leftkeytime+=e,t.leftkeytime>=this.longPressInterval&&(n=!0);break;case 83:t.rightkeytime+=e,t.rightkeytime>=this.longPressInterval&&(r=!0)}if(n){d.tryMove(t,t.curpos[0]-1,t.curpos[1])||(t.leftkeytime=0,t.keyCode=0),o&&(t.prevstate=t.curstate,t.curstate=(t.curstate+1)%4,d.tryRotateToLeft(t,t.curpos[0],t.curpos[1])?7:t.curstate=t.prevstate),n=o=!1,t.rightkeytime=0,this.drawGame()}if(r){d.tryMove(t,t.curpos[0]+1,t.curpos[1])||(t.rightkeytime=0,t.keyCode=0),o&&(t.prevstate=t.curstate,t.curstate=(t.curstate+1)%4,d.tryRotateToRight(t,t.curpos[0],t.curpos[1])?8:t.curstate=t.prevstate),r=o=!1,t.leftkeytime=0,this.drawGame()}if(l){for(var i=t.curpos[1];i<d.data.boardHeight&&d.tryMove(t,t.curpos[0],t.curpos[1]+1);)++i;d.data.keydown_success=!0;var a=d.pieceDropped(t);a&&(d.newPiece(t),a[0]&&this.sendadd(t,a[0]),this.sendevent(1,a[1])),l=!1,this.drawGame()}}if("PLAYING"==d.data.playerData[0].state&&"PLAYING"==d.data.playerData[1].state){this.timeElapse||(this.timeElapse=0),this.timeElapse+=7*e;var s=.06<1-this.timeElapse/1e3?1-this.timeElapse/1e3:.06;1==cc.global.curPlaywayScore?(d.updateLineDown(e,s),this.playerboardlist[1].getComponent("TetrisPlayerBoard").updateTrainOpp(this.trainTowerHeight)):d.updateLineDown(e)}}},getPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("TetrisPlayer");if(i.userdata.id==e)return i}},getPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("TetrisPlayerBoard");if(i.userdata.id==e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},showChatDialog:function(){this.onclickChat(0)},onclickChat:function(){if(!cc.global.isOffline||1!=cc.global.isOffline){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}if(!(e<0)){this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root();var a=this.chatpage.getComponent("Chat");a.init(this,e),a.base.x=a.base.y=0,this.ischat=!0}}},onClickEmoticon:function(){if(!cc.global.isOffline||1!=cc.global.isOffline){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),this.isemoticon=!1;this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root();var e=this.emoticonpage.getComponent("Emoticon");e.init(this,!1),e.base.x=e.base.y=0,this.isemoticon=!0}},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase,a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg)},callplayer_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg);var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg,!0)},emoticon_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg);var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},startrecord_event:function(e,t){},onClickRecordPlay:function(){this.socket().exec("startrecord",{})},onClickFindEmptyRoom:function(){var t=this;t.socket().exec("fnr",{}),cc.global.socket.on("fnr",function(e){t.alert(e.extmsg)})},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},onClickSfx:function(){if(this.btnSfx){var e=this.btnSfx,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},onclickBack:function(){if(this.ready())if(1!=cc.global.curPlaywayScore){var e=this;this.notReplay?this.isGamePlaying&&"no"==cc.global.amObserve?(cc.global.audio.playVoiceSpeech("support/14_roomout"),this.checkConfirm("Are you sure to leave room? You will lose.",function(){e.socket().exec("leave",{})},null)):this.socket().exec("leave",{}):this.exitPlay()}else this.exitPlay()},exitPlay:function(){var e=this;cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),null==this.exitTimer&&(this.exitTimer=setInterval(function(){e.finishAct&&!e.finishAct.active&&(e.returnToHall(),clearInterval(e.exitTimer),e.exitTimer=null)},500))},returnToHall:function(){this.loadding(),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.tetris_jrData=null,cc.global.backToHall=!0,d=null,this.startGameTimer&&clearTimeout(this.startGameTimer),this.endGameTimer&&clearTimeout(this.endGameTimer),this.cleanAllPlayers(),this.scene("hall",this)},onClickShowKeyMode:function(){},hideKeyMode:function(){},onClickOrientation:function(){1==this.orientation?cc.sys.localStorage.setItem("tet_scene_v2","tetris1"):cc.sys.localStorage.setItem("tet_scene_v2","tetris"),cc.global.gamestatus="ready",cc.global.user.roomNo="",cc.global.user.roomInType="NormalJoin",cc.global.user.roomid="",this.startGameTimer&&clearTimeout(this.startGameTimer),this.endGameTimer&&clearTimeout(this.endGameTimer),this.cleanAllPlayers(),this.scene("tetris",this)},onClickTheme:function(){var e=cc.sys.localStorage.getItem("tet_theme");null==e&&(e="1"),e="1"==e?"2":"1",cc.sys.localStorage.setItem("tet_theme",e),this.initTheme(e)},initTheme:function(e){"1"==e?(this.background.children[0].active=!0,this.background.children[1].active=!1,this.roomdata.color=cc.hexToColor("#212121"),this.roomdata.parent.opacity=255,this.senddata.getComponent(cc.LabelOutline).enabled=!0,this.senddata.parent.parent.children[0].getComponent(cc.LabelOutline).enabled=!0,this.pandata.children[1].getComponent(cc.LabelOutline).enabled=!0,this.controlPanel.opacity=1==this.orientation?100:255):(this.background.children[0].active=!1,this.background.children[1].active=!0,this.roomdata.color=cc.hexToColor("#FFFFFF"),this.roomdata.parent.opacity=150,this.senddata.getComponent(cc.LabelOutline).enabled=!1,this.senddata.parent.parent.children[0].getComponent(cc.LabelOutline).enabled=!1,this.pandata.children[1].getComponent(cc.LabelOutline).enabled=!1,this.controlPanel.opacity=1==this.orientation?50:100)},stucked:function(){if(d.data.trainMode){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("TetrisPlayerBoard");if(t&&t.userdata.id==cc.global.user.id){t.showRoundResult(!1);break}}var i=this;d.setAllState("FINISHED"),i.drawGame(),i.endGameTimer=setTimeout(function(){i.cleanAfterAllCards(),i.setReadyState(),i.isGamePlaying=!1},2500),this.trainTowerHeight=0,this.timeElapse=0}},updaetTowerHeight:function(e){this.trainTowerHeight=24-e}}),cc._RF.pop()},{HHCommon:"HHCommon",TetrisEngine:"TetrisEngine"}],TetrisBetUp:[function(e,t,i){"use strict";cc._RF.push(t,"21b36GS+Y1CpIQ5qyowErmn","TetrisBetUp");var a=e("HHCommon");cc.Class({extends:a,properties:{goldcoin_base:{default:null,type:cc.Node},diamond_base:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},diamonds:{default:null,type:cc.Label}},init:function(e,t){this.node.active=!0;var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;"normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway?(this.goldcoin_base.active=!0,this.diamond_base.active=!1,this.goldcoins.string=this.numformat(e)):"diamond"==cc.global.user.selplayway&&(this.goldcoin_base.active=!1,this.diamond_base.active=!0,this.goldcoins.string="");var a=1==i?"betup_left":"betup_left_down";1==t&&(a=1==i?"betup_right":"betup_right_down"),this.node.getComponent(cc.Animation).play(a);var s=this;setTimeout(function(){s&&s.node&&(s.node.active=!1)},750)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],TetrisEngine:[function(e,t,i){"use strict";cc._RF.push(t,"17353AuxvRE66j5B+yB3tm9","TetrisEngine"),t.exports=function(){this.data={},this.Color=function(e,t,i){return{r:e,g:t,b:i,getColorName:function(){return""+"rgb("+this.r+","+this.g+","+this.b+")"},R:function(){return this.r},G:function(){return this.g},B:function(){return this.b}}},this.changeColor=function(e,t){var i=e.R()+t,a=e.G()+t,s=e.B()+t;return i=255<i?255:i<0?0:i,a=255<a?255:a<0?0:a,s=255<s?255:s<0?0:s,this.Color(i,a,s)},this.init=function(e){this.data={DC:e,trainMode:!1,roomid:"",curRound:0,winCount:2,pangolds:0,roundFinish:!1,panScore:0,panRatio:0,tsPSCG:0,tsPSCT:0,piece:[[[[-1,-1],[0,-1],[0,0],[1,0]],[[0,0],[0,1],[1,-1],[1,0]],[[-1,-1],[0,-1],[0,0],[1,0]],[[0,0],[0,1],[1,-1],[1,0]]],[[[-1,0],[0,0],[0,-1],[1,-1]],[[-1,0],[0,0],[0,1],[-1,-1]],[[-1,0],[0,0],[0,-1],[1,-1]],[[-1,0],[0,0],[0,1],[-1,-1]]],[[[-1,-1],[0,0],[1,0],[-1,0]],[[0,-1],[0,0],[0,1],[1,-1]],[[-1,-1],[0,-1],[1,-1],[1,0]],[[-1,0],[0,0],[0,-1],[0,-2]]],[[[-1,0],[0,0],[1,0],[1,-1]],[[0,-1],[0,0],[0,1],[1,1]],[[-1,0],[0,0],[1,0],[-1,1]],[[-1,-1],[0,-1],[0,0],[0,1]]],[[[-1,0],[0,0],[0,-1],[-1,-1]],[[-1,0],[0,0],[0,-1],[-1,-1]],[[-1,0],[0,0],[0,-1],[-1,-1]],[[-1,0],[0,0],[0,-1],[-1,-1]]],[[[-2,0],[-1,0],[0,0],[1,0]],[[0,-2],[0,-1],[0,0],[0,1]],[[-2,0],[-1,0],[0,0],[1,0]],[[0,-2],[0,-1],[0,0],[0,1]]],[[[-1,0],[0,0],[1,0],[0,-1]],[[0,-1],[0,0],[0,1],[1,0]],[[-1,0],[0,0],[1,0],[0,1]],[[0,-1],[0,0],[0,1],[-1,0]]]],boardHeight:24,boardWidth:10,tileWidth:25,tileHeight:22,tileColors:[this.Color(61,202,116),this.Color(21,168,187),this.Color(200,53,133),this.Color(170,170,170),this.Color(44,87,177),this.Color(246,64,57),this.Color(210,180,57)],waitTime:30,readyTime:3,sign:!1,isLineFull:!1,numFullLines:0,keydown_success:!1,keydown_success_s:!1,pieceAtlas:void 0,overflowed:!1,playerData:[{userid:"",cellIdx:1,pieces:[],curpiece:null,longstate:null,prevstate:null,curstate:null,curpos:[],nextpiece:null,stpos:[0,0],mat:[[]],nextpos:[5,0],namepos:[],leftkeytime:0,rightkeytime:0,keycode:0,color:this.Color(105,139,133),score:0,state:"UNCONNECTED",result:0,linelength:20,pieceDownTimer:0},{userid:"",cellIdx:2,pieces:[],curpiece:null,longstate:null,prevstate:null,curstate:null,curpos:[],nextpiece:null,stpos:[0,0],mat:[[]],nextpos:[5,0],namepos:[],leftkeytime:0,rightkeytime:0,keycode:0,color:this.Color(124,79,172),score:0,state:"UNCONNECTED",result:0,linelength:20,pieceDownTimer:0}]}},this.initMat=function(){this.data.overflowed=!1,this.initPlayer1Mat(),this.initPlayer2Mat()},this.initPlayer1Mat=function(){for(var e=this.data.boardWidth-1;0<=e;e--){this.data.playerData[0].mat[e]=[];for(var t=0;t<this.data.boardHeight;t++)this.data.playerData[0].mat[e][t]=0}this.data.playerData[0].linelength=22},this.initPlayer2Mat=function(){for(var e=this.data.boardWidth-1;0<=e;e--){this.data.playerData[1].mat[e]=[];for(var t=0;t<this.data.boardHeight;t++)this.data.playerData[1].mat[e][t]=0}this.data.playerData[1].linelength=22},this.setTrainMode=function(e){this.data.trainMode=e},this.initPieces=function(){for(var e=0;e<2;e++)this.data.playerData[e].pieces=[],this.data.playerData[e].curpiece=null,this.data.playerData[e].curstate=null,this.data.playerData[e].curpos=[],this.data.playerData[e].nextpiece=null},this.initPan=function(){this.data.pangolds=0,this.data.curRound=0,this.data.roundFinish=!1},this.setMat=function(e){for(var t=0;t<e.length;t++){var i=this.getEnginePlayer(e[t].playuser);if(i){var a=[];for(n=0;n<e[t].towers.length;n++)for(var s=this.data.DC.decode(e[t].towers[n]),r=0;r<s.length;r++)a.push(s[r]);i.pieces=this.data.DC.decode(e[t].pieces),i.curpiece=i.pieces[0],i.nextpiece=i.pieces[1],i.curstate=0,i.curpos=[5,2],i.keycode=0,i.leftkeytime=0;for(var n=i.rightkeytime=0;n<Math.ceil(a.length/this.data.boardWidth);n++)for(r=0;r<this.data.boardWidth;r++)i.mat[r][this.data.boardHeight-1-n]=a[n*this.data.boardWidth+r]*i.cellIdx}}},this.setPlayerId=function(e,t){this.data.playerData[e].userid=t},this.setAllState=function(e){this.data.playerData[0].state=e,this.data.playerData[1].state=e},this.setPlayerState=function(e,t){var i=this.getEnginePlayer(e);i&&(i.state=t)},this.initPieceDownTimer=function(){this.data.playerData[0].pieceDownTimer=0,this.data.playerData[1].pieceDownTimer=0},this.tryMove=function(e,t,i){if(null!=e.curpiece&&null!=e.curpiece&&NaN!=e.curpiece&&null!=e.curstate&&null!=e.curstate&&NaN!=e.curstate){if(i<2)return!1;for(var a=0;a<4;a++){var s=t+this.data.piece[e.curpiece][e.curstate][a][0],r=i-this.data.piece[e.curpiece][e.curstate][a][1];if(s<0||s>=this.data.boardWidth||r>=this.data.boardHeight)return!1;if(0!=e.mat[s][r]&&0<=r)return!1}return e.curpos=[t,i],!0}return!1},this.tryRotateToLeft=function(e,t,i){for(var a=1,s=0;s<4;s++)a>this.data.piece[e.curpiece][e.curstate][s][0]&&(a=this.data.piece[e.curpiece][e.curstate][s][0]);return t-=a+2,this.tryRotate(e,t,i,!0)},this.tryRotateToRight=function(e,t,i){for(var a=-2,s=0;s<4;s++)a<this.data.piece[e.curpiece][e.curstate][s][0]&&(a=this.data.piece[e.curpiece][e.curstate][s][0]);return t+=1-a,this.tryRotate(e,t,i,!0)},this.tryRotate=function(e,t,i){var a=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(4==e.curpiece)return!1;if(null!=e.curpiece&&null!=e.curpiece&&NaN!=e.curpiece&&null!=e.curstate&&null!=e.curstate&&NaN!=e.curstate){if(a){for(var s=0,r=0,n=0;n<4;n++){var o=t+this.data.piece[e.curpiece][e.curstate][n][0],l=i-this.data.piece[e.curpiece][e.curstate][n][1];o<0&&(s=0-o),o>=this.data.boardWidth&&(s=o-23),l<2&&r++}t+=s,i+=r}for(n=0;n<4;n++){if(o=t+this.data.piece[e.curpiece][e.curstate][n][0],(l=i-this.data.piece[e.curpiece][e.curstate][n][1])<2&&i++,o<0||o>=this.data.boardWidth||l>=this.data.boardHeight)return!1;if(0!=e.mat[o][l]&&0<=l)return!1}return e.curpos=[t,i],!0}return!1},this.removeFullLines=function(e){this.data.isLineFull=!0;for(var t=this.data.numFullLines=0;t<this.data.boardHeight;t++){for(this.data.isLineFull=!0,a=0;a<this.data.boardWidth;++a)if(0==e.mat[a][t]){this.data.isLineFull=!1;break}if(this.data.isLineFull){++this.data.numFullLines;for(var i=t-1;0<=i;--i)for(a=0;a<this.data.boardWidth;++a)e.mat[a][i+1]=e.mat[a][i];for(var a=0;a<this.data.boardWidth;a++)e.mat[a][0]=0}}},this.addFullLines=function(e,t){for(var i=[[]],a=t[0].length,s=0;s<this.data.boardWidth;s++){i[s]=[];for(var r=0;r<this.data.boardHeight;r++)i[s][r]=0,r<this.data.boardHeight-a?i[s][r]=e.mat[s][r+a]:i[s][r]=t[s][a-(this.data.boardHeight-r)]}e.mat=i;var n=this.getTowerHeight(e.mat);if(this.data.trainMode)if(n<=1){for(s=0;s<this.data.boardWidth;s++)for(r=0;r<this.data.boardHeight;r++)r<this.data.boardHeight-a+n?e.mat[s][r]=0:e.mat[s][r]=t[s][a-(this.data.boardHeight-r)];this.data.curRound++,this.data.DC.showTrainRound(this.data.curRound),n=this.getTowerHeight(e.mat),this.data.DC.updaetTowerHeight(n)}else this.data.DC.updaetTowerHeight(n)},this.newPiece=function(e){if(e.userid==cc.global.user.id&&this.data.tsPSCG++,e.pieceDownTimer=0,this.popup_piece(e),this.data.trainMode&&this.push_piece(this.getEnginePlayer(cc.global.user.id),parseInt(100*Math.random())%7),e.curpiece=e.pieces[0],e.nextpiece=e.pieces[1],e.curstate=0,e.curpos=[5,2],e.keycode=0,e.leftkeytime=0,e.rightkeytime=0,4<=e.linelength)e.curpos=[5,2];else{var t=this;if(t&&e&&!t.tryMove(e,e.curpos[0],e.curpos[1])){for(e.curpos=[5,this.getTowerHeight(e.mat)-t.getCurPieceHeight(e)];t.tryMove(e,e.curpos[0],e.curpos[1]+1););this.data.trainMode?(cc.global.user.id==e.userid&&t.data.DC.notReplay&&t.goDrop(e),e.curpiece=void 0,e.nextpiece=void 0):t.tryMove(e,e.curpos[0],e.curpos[1])&&setTimeout(function(){cc.global.user.id==e.userid&&t.data.DC.notReplay&&t.goDrop(e),e.curpiece=void 0,e.nextpiece=void 0},200)}}e.pieceDownTimer=0},this.getCurPieceHeight=function(e){if(null!=e.curpiece&&null!=e.curpiece){for(var t=1,i=-2,a=0;a<4;a++)t>this.data.piece[e.curpiece][e.curstate][a][1]&&(t=this.data.piece[e.curpiece][e.curstate][a][1]),i<this.data.piece[e.curpiece][e.curstate][a][1]&&(i=this.data.piece[e.curpiece][e.curstate][a][1]);return i-t+1}},this.goDrop=function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=this.pieceDropped(e,t);i&&(this.newPiece(e),null!=i[0]&&this.data.DC.sendadd(e,i[0]),this.data.trainMode?this.push_piece(this.getEnginePlayer(cc.global.user.id),parseInt(100*Math.random())%7):(this.data.DC.sendevent(1,i[1]),this.data.DC.drawGame()))},this.getDropPieceData=function(e){if(null==e.curpiece||null==e.curpiece)return"";for(var t="",i=0;i<4;i++)t+="/"+(e.curpos[0]+this.data.piece[e.curpiece][e.curstate][i][0]+10*(23-(e.curpos[1]-this.data.piece[e.curpiece][e.curstate][i][1])));return t},this.pieceDropped=function(e){if(!(1<arguments.length&&void 0!==arguments[1])||arguments[1],!this.data.overflowed&&null!=e.curpiece&&null!=e.curpiece){this.data.tsPSCT++;var t=[void 0,""],i=[];for(t[1]=this.getDropPieceData(e),n=0;n<4;n++){var a=e.curpos[0]+this.data.piece[e.curpiece][e.curstate][n][0],s=e.curpos[1]-this.data.piece[e.curpiece][e.curstate][n][1];e.mat[a][s]=e.cellIdx}this.data.DC.drawGame();var r=this.getSendingLines(e);null!=r&&(t[0]=r),this.removeFullLines(e);for(var n=0;n<4;n++){a=e.curpos[0]+this.data.piece[e.curpiece][e.curstate][n][0],s=e.curpos[1]-this.data.piece[e.curpiece][e.curstate][n][1];i[n]=s}return e.linelength=this.getminlength(i),this.getTowerHeight(e.mat)<=1&&(this.data.overflowed=!0,this.data.trainMode&&this.data.DC.stucked()),t}},this.updateDropPiece=function(e,t){if(!this.data.overflowed){for(var i=void 0,a=t.split("/"),s=1;s<=4;s++){var r=parseInt(a[s])%10,n=23-Math.floor(parseInt(a[s])/10);e.mat[r][n]=e.cellIdx}this.data.DC.drawGame();var o=this.getPieceMatrixFromArray(a),l=this.getSendingLines(e,o);return null!=l&&(i=l),this.removeFullLines(e),this.getTowerHeight(e.mat)<=1&&(this.data.overflowed=!0),this.newPiece(e),i}},this.getTowerHeight=function(e){for(var t=24,i=0;i<this.data.boardWidth;i++)for(var a=0;a<this.data.boardHeight;a++)0!=e[i][a]&&a<t&&(t=a);return t},this.popup_piece=function(e){e.pieces.shift()},this.push_piece=function(e,t){e.pieces.push(t)},this.getminlength=function(e){for(var t=e[0],i=0;i<e.length;i++)if(t>e[i]){var a=e[i];e[i]=t,t=a}return t},this.getPieceMatrixFromArray=function(e){for(var t=[[0,0],[0,0],[0,0],[0,0]],i=1;i<e.length;i++){var a=parseInt(e[i])%10,s=23-Math.floor(parseInt(e[i])/10);t[i-1]=[a,s]}return t},this.getSendingLines=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.data.isLineFull=!0,this.data.numFullLines=0,this.data.sign=!0;for(var i=[[]],a=0;a<this.data.boardWidth;a++)i[a]=[];for(a=0;a<this.data.boardHeight;a++){for(this.data.isLineFull=!0,s=0;s<this.data.boardWidth;++s)if(0==e.mat[s][a]){this.data.isLineFull=!1;break}if(this.data.isLineFull){for(var s=0;s<this.data.boardWidth;s++)i[s][this.data.numFullLines]=e.mat[s][a];if(null==t)for(r=0;r<4;r++)n=e.curpos[0]+this.data.piece[e.curpiece][e.curstate][r][0],a==(o=e.curpos[1]-this.data.piece[e.curpiece][e.curstate][r][1])&&(i[n][this.data.numFullLines]=0);else for(var r=0;r<4;r++){var n=t[r][0],o=t[r][1];a==o&&(i[n][this.data.numFullLines]=0)}++this.data.numFullLines}}return 2<=this.data.numFullLines?this.isSendingFullBlock(i)?(cc.log("Oops! Block is Full!"),null):i:null},this.getHoleCount=function(e){for(var t=0,i=(this.getTowerHeight(e),0);i<this.data.boardWidth;i++)for(var a=0,s=0;s<this.data.boardHeight;s++)0!=e[i][s]&&(a=1),1==a&&0==e[i][s]&&t++;return t},this.getFullLines=function(e,t,i,a){for(var s=!0,r=0,n=[[]],o=0;o<this.data.boardWidth;o++)n[o]=[];for(o=0;o<this.data.boardHeight;o++){for(s=!0,l=0;l<this.data.boardWidth;++l)if(0==e[l][o]){s=!1;break}if(s){for(var l=0;l<this.data.boardWidth;l++)n[l][r]=e[l][o];for(var c=0;c<4;c++){var h=t[0]+this.data.piece[i][a][c][0];o==t[1]-this.data.piece[i][a][c][1]&&(n[h][r]=0)}++r}}return 2<=r?this.isSendingFullBlock(n)?(cc.log("Oops! Block is Full!"),null):n:null},this.isSendingFullBlock=function(e){for(var t=0;t<this.data.boardWidth;t++)for(var i=0;i<e[0].length;i++)if(0==e[t][i])return!1;return!0},this.clearMat=function(){for(var e=this.data.boardHeight-1;0<=e;e--)for(var t=0;t<this.data.boardwidth;t++)this.data.playerData[0].mat[t][e]=0,this.data.playerData[1].mat[t][e]=0},this.getEnginePlayer=function(e){return this.data.playerData[0].userid==e?this.data.playerData[0]:this.data.playerData[1].userid==e?this.data.playerData[1]:null},this.getOtherEnginePlayer=function(e){for(var t=0;t<this.data.playerData.length;t++)if(this.data.playerData[t].userid!=e)return this.data.playerData[t]},this.drawBoard=function(e,t){this.cleanTower(e,t),this.drawMainTower(e,t);var i=JSON.parse(cc.sys.localStorage.getItem("tetris_hint_show"));null==i&&(i=!1),i&&this.drawHintPiece(e,t),this.drawNextPiece(e,t),this.drawCurPiece(e,t)},this.drawGrid=function(e){e.clear(),e.lineWidth=1,e.fillColor=new cc.Color(255,255,255,15);for(var t=1;t<this.data.boardWidth;t++)e.rect(t*this.data.tileWidth,44,1,(this.data.boardHeight-2)*this.data.tileHeight),e.fill();for(t=2;t<this.data.boardHeight;t++)e.rect(0,t*this.data.tileHeight,this.data.boardWidth*this.data.tileWidth,1),e.fill()},this.hideGrid=function(e){e.clear()},this.cleanTower=function(e,t){},this.drawMainTower=function(e,t){if(t.mat&&0!=t.mat.length&&0!=t.mat[0].length)for(var i=0;i<this.data.boardWidth;i++)for(var a=0;a<this.data.boardHeight;a++)0!=t.mat[i][a]?this.data.trainMode?this.drawPiece(e,i,a,t.mat[i][a],255,!0):1==t.mat[i][a]?this.drawPiece(e,i,a,1,255,!0):this.drawPiece(e,i,a,2,255,!0):e.children[this.data.boardHeight*i+a].active=!1},this.drawNextPiece=function(e,t){if(!(this.data.overflowed||null==t.nextpiece||null==t.nextpiece||t.curpos&&t.curpos[1]<2))for(var i=0;i<4;i++){var a=t.nextpos[0]+this.data.piece[t.nextpiece][0][i][0],s=t.nextpos[1]-this.data.piece[t.nextpiece][0][i][1];this.drawPiece(e,a,s,t.nextpiece+3,255,!0)}},this.drawCurPiece=function(e,t){if(!this.data.overflowed&&null!=t.curpiece&&null!=t.curpiece)for(var i=0;i<4;i++){var a=t.curpos[0]+this.data.piece[t.curpiece][t.curstate][i][0],s=t.curpos[1]-this.data.piece[t.curpiece][t.curstate][i][1];this.drawPiece(e,a,s,t.curpiece+3,255,!0)}},this.drawHintPiece=function(e,t){if(null!=t.curpiece&&null!=t.curpiece&&!(t.linelength<=6)){for(var i=t.curpos;this.tryMove(t,t.curpos[0],t.curpos[1]+1););var a=t.curpos;t.curpos=i;for(var s=0;s<4;s++){var r=a[0]+this.data.piece[t.curpiece][t.curstate][s][0],n=a[1]-this.data.piece[t.curpiece][t.curstate][s][1];this.drawPiece(e,r,n,t.cellIdx,50,!0)}}},this.updateLineDown=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.7;this.data.playerData[0].pieceDownTimer+=e,this.data.playerData[1].pieceDownTimer+=e;var i=this.getTowerHeight(this.data.playerData[0].mat)<=4?.4:0;this.data.trainMode&&(i=0),this.data.playerData[0].pieceDownTimer>=t+i&&("PLAYING"==this.data.playerData[0].state&&"PLAYING"==this.data.playerData[1].state&&this.oneLineDown(this.data.playerData[0]),this.data.playerData[0].pieceDownTimer=0,this.data.DC.drawGame()),this.data.trainMode||(i=this.getTowerHeight(this.data.playerData[1].mat)<=4?.4:0,this.data.playerData[1].pieceDownTimer>=t+i&&("PLAYING"==this.data.playerData[0].state&&"PLAYING"==this.data.playerData[1].state&&this.oneLineDown(this.data.playerData[1]),this.data.playerData[1].pieceDownTimer=0,this.data.DC.drawGame()))},this.getLinelengthAfterDrop=function(e){for(;this.tryMove(e,e.curpos[0],e.curpos[1]+1););for(var t=[],i=0;i<4;i++){e.curpos[0],this.data.piece[e.curpiece][e.curstate][i][0];var a=e.curpos[1]-this.data.piece[e.curpiece][e.curstate][i][1];t[i]=a}return this.getminlength(t)},this.oneLineDown=function(e){this.tryMove(e,e.curpos[0],e.curpos[1]+1)||cc.global.user.id==e.userid&&this.data.DC.notReplay&&this.goDrop(e)},this.drawPiece=function(e,t,i,a,s,r){var n=this.data.boardHeight*t+i,o=e.children[n];o.active=r,o.opacity=s,o.PSN!=a&&(o.PSN=a,o.getComponent(cc.Sprite).spriteFrame=this.pieceAtlas.getSpriteFrame(a))},this.isPlaying=function(){return"PLAYING"==this.data.playerData[0].state&&"PLAYING"==this.data.playerData[1].state}},cc._RF.pop()},{}],TetrisPlayerBoard:[function(e,t,i){"use strict";cc._RF.push(t,"8b9d0uqmAtOJYQWNwUZS0Nj","TetrisPlayerBoard");var a=e("HHCommon");cc.Class({extends:a,properties:{grid:{default:null,type:cc.Node},tower:{default:null,type:cc.Node},countdown:{default:null,type:cc.Label},status:{default:null,type:cc.Label},dw:{default:null,type:cc.Node},round:{default:null,type:cc.Node},character:{default:null,type:cc.Node},tip:{default:null,type:cc.Node},pieceImg:{default:null,type:cc.Node},pieceAtlas:{default:null,type:cc.SpriteAtlas},portraitRoundNode:{default:null,type:cc.Node},landscapeRoundNode:{default:null,type:cc.Node},trainOpp:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.roundResult=!1,this.roundScore=0,this.roundCount=4<arguments.length&&void 0!==arguments[4]?arguments[4]:3,this.layoutForSeat(),this.showPlayCharacter(),this.initTowerPieces(),this.xOffset=5,this.yOffset=5},initTowerPieces:function(){for(var e=0;e<10;e++)for(var t=0;t<24;t++){var i=cc.instantiate(this.pieceImg);i.parent=this.tower,i.PSN=this.seatid+1,i.getComponent(cc.Sprite).spriteFrame=this.pieceAtlas.getSpriteFrame(""+i.PSN),i.setPosition(this.pieceImg.width*e,this.pieceImg.height*t)}},startTimer:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode||!(3<e)){var t=this;t.stopTimer(),t.countdown.node.active=!0,t.countdown.string=e,t.timer||(t.timer=setInterval(function(){0<e?t.countdown&&(e--,t.countdown.string=e):t.stopTimer()},1e3))}},stopTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=void 0,this.tip&&1==this.tip.active&&1==cc.global.curPlaywayScore&&this.parent.onclickBack()),this.countdown&&(this.countdown.node.active=!1)},setTrainMode:function(){this.portraitRoundNode&&(this.portraitRoundNode.children[0].active=!1),this.landscapeRoundNode&&(this.landscapeRoundNode.children[0].active=!1)},setState:function(e){var t=this.getLanguageText("READY_0")+"?",i=this.getLanguageText("PREPARED_0");1!=cc.global.championMode&&2!=cc.global.championMode?(this.status.node.active=!0,t==(this.status.string=e)&&this.userdata.id==cc.global.user.id&&"no"==cc.global.amObserve?this.tip.active=!0:this.tip.active=!1):this.status.string=i},hideTip:function(){this.tip.active=!1},hideStatus:function(){this.stopTimer(),this.countdown.node.active=!1,this.status.node.active=!1,this.hideTip(),this.hidePlayCharacter()},showRoundResult:function(e){this.roundResult=e,this.showPlayCharacter(),e?this.characterAction("Victory"):this.characterAction("Lost")},hideRoundResult:function(){this.roundResult=!1},showRoundScore:function(e){this.roundScore=e,this.hideRoundScore();for(var t=0;t<e;t++)this.round.children[t].active=!0},hideRoundScore:function(){for(var e=this.roundScore=0;e<3;e++)this.round.children[e].active=!1},clearTower:function(){for(var e=0;e<10;e++)for(var t=0;t<24;t++)this.tower.children[24*e+t].active=!1;this.trainOpp.active=!1},layoutForSeat:function(){if(2==this.parent.orientation){this.landscapeRoundNode.active=!0,this.portraitRoundNode.active=!1,this.round=this.landscapeRoundNode.children[1],this.landscapeRoundNode.scaleX=1.03,this.character.parent.scaleX=.853,this.countdown.node.scaleX=.83,this.status.node.scaleX=.83,this.tip.scaleX=.38;for(var e=0;e<this.landscapeRoundNode.children[0].children.length;e++)this.landscapeRoundNode.children[0].children[e].active=e<this.roundCount;var t;if(0==this.seatid)(t=this.landscapeRoundNode.getComponent(cc.Widget))&&(t.isAlignLeft=!1,t.isAlignRight=!0,t.right=-36,t.updateAlignment());else(t=this.landscapeRoundNode.getComponent(cc.Widget))&&(t.isAlignLeft=!0,t.isAlignRight=!1,t.left=-36,t.updateAlignment())}else{this.landscapeRoundNode.active=!1,this.portraitRoundNode.active=!0;for(e=0;e<this.portraitRoundNode.children[0].children.length;e++)this.portraitRoundNode.children[0].children[e].active=e<this.roundCount;this.round=this.portraitRoundNode.children[1]}1==cc.global.curPlaywayScore&&this.setTrainMode()},showPlayCharacter:function(){this.character.active=!0,this.character.getComponent("Character").disUserCharacter(this.userdata.playcharacter%2,!1,this.userdata.avatarurl)},hidePlayCharacter:function(){this.character.active=!1},characterAction:function(e){this.character.getComponent("Character").disChPos(e)},onClickReady:function(){this.parent&&this.parent.processReadyState()},updateTrainOpp:function(e){if(this.trainOpp){0==this.trainOpp.active&&(this.trainOpp.setPosition(0,0),this.trainOpp.active=!0,this.xOffset=5,this.yOffset=5);var t=this.trainOpp.getPosition(),i=this.trainOpp.parent,a=22*e;t.y<a&&(t.y=a,this.yOffset=5),(t.x+this.trainOpp.width>i.width||t.x<0)&&(this.xOffset*=-1),(t.y+this.trainOpp.height>i.height||t.y<a)&&(this.yOffset*=-1),t.x+=this.xOffset,t.y+=this.yOffset,this.trainOpp.setPosition(t)}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],TetrisPlayer:[function(e,t,i){"use strict";cc._RF.push(t,"6ee7br81UNFDplq9giOMnjE","TetrisPlayer");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},nickname:{default:null,type:cc.Label},goldcoin_base:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},betup:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},winorlose:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.nickname.string=t.nickname,1==cc.global.championMode||cc.global.championMode,this.goldcoins.string=this.numformat(t.goldcoins),this.goldcoins.node.parent.active=!0,this.loadAvatar(t.avatarurl,t.gender),this.layoutForSeat()},onClickDisInfo:function(){},updateCareer:function(e){},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},showCallPlayer:function(e,t){var i=this;this.hideCallPlayer(),cc.global.audio.playVoiceChatWithType(this.playcharacter,t),this.callplayer.active=!0,this.callplayer.children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onClickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userdata.id},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){cc.global.isOffline&&1==cc.global.isOffline||(cc.global.user.id==this.userdata.id?this.parent.onClickEmoticon&&this.parent.onClickEmoticon():this.onClickCallPlayer())},layoutForSeat:function(){},summary:function(e){var a=this;if(this.updateCareer(e),this.winorlose.getComponent(cc.Animation).play(),!e.pig)return cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("lose"),this.winorlose.children[0].getComponent(cc.Label).string="-"+this.numformat(Math.abs(e.exp)),void(this.winorlose.children[1].getComponent(cc.Label).string="-"+this.numformat(-1*e.score));cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("win"),this.winorlose.children[0].getComponent(cc.Label).string="+"+this.numformat(e.exp),this.winorlose.children[1].getComponent(cc.Label).string="+"+this.numformat(e.score),e.orig_gold=e.gold-e.score,"diamond"==cc.global.user.selplayway&&(e.orig_gold=e.diamond-e.score);var t=cc.callFunc(function(e,t){t.orig_gold+Math.round(t.score/5)>("diamond"==cc.global.user.selplayway?t.diamond:t.gold)?"diamond"==cc.global.user.selplayway?t.orig_gold=t.diamond:t.orig_gold=t.gold:t.orig_gold=t.orig_gold+Math.round(t.score/5);var i=e.getComponent("TetrisPlayer").goldcoins.node;i.getComponent(cc.Label).string=a.numformat(t.orig_gold),i.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1)))},this,e),i=cc.callFunc(function(e,t){e.getComponent("TetrisPlayer").goldcoins.node.getComponent(cc.Label).string=a.numformat(t.gold)},this,e),s=cc.sequence(cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,i);this.node.runAction(s)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ThemeSelectDialog:[function(e,t,i){"use strict";cc._RF.push(t,"6e57eDiHC5BK7L7spTrH7ay","ThemeSelectDialog");var a=e("HHCommon");cc.Class({extends:a,properties:{backgrounds:cc.Node,types:cc.Node,sizes:cc.Node,orders:cc.Node},init:function(e){this.parent=e,this.changeBackgroundState(),this.changeTypeState(),this.changeSizeState(),this.changeOrderState()},changeBackgroundState:function(){for(var e=0;e<this.backgrounds.children.length;e++)this.backgrounds.children[e].children[0].active=cc.global.theme.background==e+1},onSelectBackground:function(e,t){isNaN(t)||(cc.global.theme.background=parseInt(t),this.parent.node.emit("theme-changed")),this.changeBackgroundState()},changeTypeState:function(){for(var e=0;e<this.types.children.length;e++)this.types.children[e].children[0].active=cc.global.theme.card_theme==e+1},onSelectCardType:function(e,t){isNaN(t)||(cc.global.theme.card_theme=parseInt(t),this.parent.node.emit("theme-changed")),this.changeTypeState()},changeSizeState:function(){for(var e=0;e<this.sizes.children.length;e++)this.sizes.children[e].children[1].active=cc.global.theme.card_size==e+1},onSelectCardSize:function(e,t){isNaN(t)||(cc.global.theme.card_size=parseInt(t),this.parent.node.emit("theme-changed")),this.changeSizeState()},changeOrderState:function(){for(var e=0;e<this.orders.children.length;e++)this.orders.children[e].color=cc.global.theme.card_sort==e+1?cc.hexToColor("#00FF00"):cc.Color.WHITE},onSelectCardOrder:function(e,t){isNaN(t)||cc.global.theme.card_sort!=t&&(cc.global.theme.card_sort=t,this.parent.changeCardSortOrder()),this.changeOrderState()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ThreekBegin:[function(e,t,i){"use strict";cc._RF.push(t,"34ec52tbKhDH6jXhfcomioE","ThreekBegin");var a=e("HHCommon");cc.Class({extends:a,properties:{threek_player:{default:null,type:cc.Prefab},threek_player_board:{default:null,type:cc.Prefab},selfplayer:{default:null,type:cc.Node},opponentplayer:{default:null,type:cc.Node},statusboard:{default:null,type:cc.Node},boardclaim:{default:null,type:cc.Sprite},claimatlas:{default:null,type:cc.SpriteAtlas},roomdata:{default:null,type:cc.Node},turntimer:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},observer:{default:null,type:cc.Prefab},observerbench:{default:null,type:cc.Node},emodlg:{default:null,type:cc.Prefab},chat:{default:null,type:cc.Prefab},btn_enter:{default:null,type:cc.Node},btn_giveup:{default:null,type:cc.Node},btn_chat:{default:null,type:cc.Node},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},finishAct:{default:null,type:cc.Node},btnSfx:{default:null,type:cc.Node},lblTurnCount:{default:null,type:cc.Label},gameboard:{default:null,type:cc.Node},matrixboard:{default:null,type:cc.Node},threekpiece:{default:null,type:cc.Prefab},emptybutton:{default:null,type:cc.Prefab},konier:{default:[]},emptykoni:{default:[]},label_stage:{default:null,type:cc.Label},label_mode:{default:null,type:cc.Label},pandata:{default:null,type:cc.Node},multi:{default:null,type:cc.Node},matrix_pos:{default:[]},matrix:{default:[]},checkboard:{default:[]},particle_sys:{default:null,type:cc.Prefab},particlenode:{default:[]}},onLoad:function(){this.initEventCallback(),cc.game.setFrameRate(60),cc.global.amObserve="no",this.play_status=0,this.playerlist=new Array,this.playerboardlist=new Array,this.observerlist=new Array,this.posBaseIdx=0,this.inited=!1,this.playerBoardSlotPos=[cc.v2(0,-220),cc.v2(0,80)],this.notReplay=!0,this.startGameTimer=null,this.endGameTimer=null,this.pangolds=0,this.isGamePlaying=!1,this.turnSeat=0,this.isNewRoom=!0,this.sendFlag=!1,this.turnCount={local:0,server:0},null!=cc.global&&(this.initgame(),""!=cc.global.user.roomid&&(this.recovery(),this.isNewRoom=!1)),cc.global.watchReplayData.onReplay&&this.prepareReplay(),this.setEtcKeyBoardEvent();var e=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==e&&(e=!0),e?(this.btnSfx.children[0].active=!0,this.btnSfx.children[1].active=!1):(this.btnSfx.children[0].active=!1,this.btnSfx.children[1].active=!0),cc.global.audio.playBGM("bgm_koni");for(var t=0;t<3;t++)this.matrix_pos[t]=new Array,this.emptykoni[t]=new Array,this.matrix[t]=new Array;this.emptywidth=this.piecewidth=100,this.emptyheight=this.pieceheight=100,this.boardwidth=this.matrixboard.width,this.boardheight=this.matrixboard.height,this.boardspacex=this.boardwidth/6,this.boardspacey=this.boardheight/6;for(t=0;t<3;t++)for(var i=this.boardspacex*(3-t)*-1,a=this.boardspacey*(3-t),s=0;s<8;s++)this.matrix_pos[t][s]=cc.p(i,a),s<2?i+=(3-t)*this.boardspacex:s<4?a-=(3-t)*this.boardspacey:s<6?i-=(3-t)*this.boardspacex:a+=(3-t)*this.boardspacey;for(t=0;t<3;t++){this.konier[t]=new Array;for(s=0;s<8;s++)this.emptykoni[t][s]=cc.instantiate(this.emptybutton),this.emptykoni[t][s].parent=this.matrixboard,this.emptykoni[t][s].getComponent("Emptybutton3").init(t,s,!1,this),this.emptykoni[t][s].getComponent("Emptybutton3").setGeometry(this.emptywidth,this.emptyheight,this.matrix_pos[t][s])}for(t=0;t<3;t++)for(s=0;s<8;s++)this.konier[t][s]=cc.instantiate(this.threekpiece),this.konier[t][s].parent=this.matrixboard,this.konier[t][s].getComponent("ThreekPiece").init(t,s,this),this.konier[t][s].getComponent("ThreekPiece").setSize(this.piecewidth,this.pieceheight),this.konier[t][s].setPosition(this.matrix_pos[t][s]);this.settext_labelmode(-1),this.settext_labelstage(-1);for(t=0;t<3;t++)this.particlenode[t]=cc.instantiate(this.particle_sys),this.particlenode[t].parent=this.matrixboard,this.particlenode[t].getComponent(cc.ParticleSystem).stopSystem();this.lblTurnCount.string="",this.ratio=0},initgame:function(){var t=this;this.finishAct&&(this.finishAct.active=!1);var e=this.socket();this.map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("banker",this.banker_event),this.map("playthreek",this.playthreek_event),this.map("rer",this.recovery_event),this.map("selemoticon",this.emoticon_event),this.map("sendchat",this.sendchat_event),this.map("callplayer",this.callplayer_event),this.map("sl",this.sendlines_event),this.map("allcards",this.allcards_event),this.map("chpre",this.chpre_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)});var i={};switch(cc.global.user.roomInType){case"NormalCreate":null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i);break;case"NormalJoin":i.extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i);break;case"NormalObserve":i.extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i)}this.inited=!0,this.loadding()},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},prepareReplay:function(){this.notReplay=!1,cc.global.amObserve="yes",this.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),this.replay_bar.active=!0,this.replayStep="ready_room",this.replaySeq=0,this.replayPrevCmd="",this.goReplay()},stopAllClock:function(){this.turntimer.getComponent("TurnTimer").pauseAllTimer()},resumeAllClock:function(){this.turntimer.getComponent("TurnTimer").resumeAllTimer()},pauseReplayTimer:function(){this.stopAllClock(),clearTimeout(this.replayTimer)},resumeReplayTimer:function(){var e=this;this.resumeAllClock(),this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay/cc.global.watchReplayData.replaySpeedX)},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):this.togglePlayToPause()},togglePlayToPause:function(){this.replayTimer&&clearTimeout(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replay_bar.children[0].opacity=100,this.pauseReplayTimer()},replayPrevMove:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.replayEventProcess(!0))},replayNextMove:function(){this.togglePlayToPause(),this.replayEventProcess(!0)},onClickReplaySpeedUp:function(){var e=this.getLanguageText("REPLAY_TIME");cc.global.watchReplayData.replaySpeedX<5&&(cc.global.watchReplayData.replaySpeedX++,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){var e=this.getLanguageText("REPLAY_TIME");1<cc.global.watchReplayData.replaySpeedX&&(cc.global.watchReplayData.replaySpeedX--,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},cleanAllPlayers:function(){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].destroy(),this.playerboardlist[e].destroy();this.playerlist.splice(0,this.playerlist.length),this.playerboardlist.splice(0,this.playerboardlist.length),this.playerlist=new Array,this.playerboardlist=new Array,this.selfplayer&&(this.selfplayer.destroyAllChildren(),this.selfplayer.removeAllChildren()),this.opponentplayer&&(this.opponentplayer.destroyAllChildren(),this.opponentplayer.removeAllChildren())},replayEventProcess:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.play_history&&this.play_history[this.replaySeq]){this.replayTimeDelay=0;var t=!1;switch(this.replayStep){case"ready_room":this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"playthreek":t=!0,this.playthreek_event(i,this);break;case"allcards":t=!0,this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.emoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"players":this.players_event(i,this);break;case"chpre":t=!0,this.chpre_event(i,this)}this.replayPrevCmd=i.command}this.play_history[this.replaySeq+1]&&""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay+=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,e&&!t&&this.replayEventProcess(!0)}},goReplay:function(){var e=this;this.replayEventProcess(),this.play_history[this.replaySeq]?this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay):(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.replayPrevCmd="",this.pauseReplayTimer())},setEtcKeyBoardEvent:function(){var i=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e,t){switch(e){case cc.KEY.space:i.processReadyState();break;case cc.KEY.escape:case cc.KEY.back:if(!i.isemoticon&&!i.ischat)return void i.onclickBack();i.isemoticon&&(null!=i.emoticonpage&&i.emoticonpage.destroy(),i.isemoticon=!1),i.ischat&&(null!=i.chatpage&&i.chatpage.destroy(),i.ischat=!1)}}},i.node)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;e<0||(this.socket().exec("selemoticon",{extparams:{emoticon:e}}),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1))},onCtrlKeyDown:function(e){e.keycode==cc.KEY.space&&2==this.playerlist.length&&(this.endGameTimer||this.sendState())},processReadyState:function(){2==this.playerlist.length&&(this.endGameTimer||this.sendState())},joinroom_event:function(e,t){cc.global.user.selplayway=e.name,t.roomid=e.id,t.panScore=cc.global.curPlaywayScore=e.score;var i=t.getLanguageText("ROOM_0"),a=t.getLanguageText("SCORE_0");switch(t.roomdata.children[0].children[0].getComponent(cc.Label).string=e.id+i,t.roomdata.children[0].children[1].getComponent(cc.Label).string="("+t.numformat(e.score)+a+")",cc.global.gamestatus){case"ready":cc.global.gamestatus="waiting",2==e.playerlist.length&&(cc.global.gamestatus="playing"),t.players_event(e,t);break;case"waiting":t.players_event(e,t);break;case"playing":cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)}e.hisdata?t.showMatchCareer(e.hisdata):t.hideMatchCareer(),"yes"==cc.global.amObserve?t.btn_giveup.active=!1:t.btn_giveup.active=!0,t.btn_chat.active=!0,t.closeloadding()},players_event:function(e,t){2==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)if(e.observerlist[a].id==cc.global.user.id){i=!1;break}if(i&&t.notReplay)return cc.global.outReasonMsg=e.msg,void t.exitPlay();t.observer_event(e,t),t.isBoardPlayersChanged(e.playerlist)&&(t.startGameTimer&&(clearTimeout(t.startGameTimer),t.startGameTimer=null),t.endGameTimer&&(clearTimeout(t.endGameTimer),t.endGameTimer=null),t.players_engine(e,t))},players_engine:function(e){this.removeBoardPlayers(e.playerlist);for(var t=this.posBaseIdx,i=0;i<e.playerlist.length;i++){if(e.playerlist[i].seatid=i,"no"==cc.global.amObserve&&e.playerlist[i].id!=cc.global.user.id&&(t=1-this.posBaseIdx),this.playerexist(e.playerlist[i])){var a=this.getPlayer(e.playerlist[i].id),s=this.getPlayerBoard(e.playerlist[i].id);a.init(this,e.playerlist[i],t%2,i),s.init(this,e.playerlist[i],t%2,i),a.seatid=s.seatid=t%2,a.layoutForSeat(),s.layoutForSeat()}else{var r;"yes"!=cc.global.amObserve?(r=cc.instantiate(this.threek_player),e.playerlist[i].id==cc.global.user.id?r.parent=this.selfplayer:r.parent=this.opponentplayer):(r=cc.instantiate(this.threek_player)).parent=t%2==0?this.selfplayer:this.opponentplayer,r.getComponent("Threekplayer").init(this,e.playerlist[i],t%2,i),this.playerlist.push(r);var n=cc.instantiate(this.threek_player_board);n.parent=this.statusboard,n.setPosition(this.playerBoardSlotPos[t%2]),n.getComponent("ThreekplayerBoard").init(this,e.playerlist[i],t%2,i),this.playerboardlist.push(n)}t++}1==e.playerlist.length?(this.setWaitingState(),this.cleanAfterAllCards(),this.hideMatchCareer()):2==e.playerlist.length&&this.setReadyState(),"yes"==cc.global.amObserve&&e.playerlist.length<2?1==cc.global.championMode?this.btn_enter.active=!1:0==cc.global.championMode&&this.notReplay&&(this.btn_enter.active=!0):this.btn_enter.active=!1,this.showWaitingTimer()},setWaitingState:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ThreekplayerBoard");t&&t.setState("Pending")}},setReadyState:function(){var e=this.getLanguageText("READY_0")+"?";if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("ThreekplayerBoard");i&&i.setState(e)}},observer_event:function(e,t){t.observerbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i],t),a.getComponent("Observer").nickname.node.active=!1,a.parent=t.observerbench,t.observerlist[i]=a}},removeBoardPlayers:function(e){for(var t=0;t<this.playerlist.length;t++){for(var i=this.playerlist[t].getComponent("Threekplayer"),a=!1,s=0;s<e.length;s++)if(i.userdata.id==e[s].id){a=!0;break}1!=a&&(this.playerlist[t].destroy(),this.playerlist.splice(t,1),this.playerboardlist[t].destroy(),this.playerboardlist.splice(t,1))}},isBoardPlayersChanged:function(e){if(0==this.playerlist.length&&0!=e.length)return!0;if(this.playerlist.length!=e.length)return!0;for(var t=0;t<e.length;t++)if(!this.getPlayer(e[t].id))return!0;return!1},playerexist:function(e){for(var t=0;t<this.playerlist.length;t++)if(null!=this.playerlist[t]&&this.playerlist[t].getComponent("Threekplayer").userdata.id==e.id)return!0;return!1},initGameboard:function(){this.closeloadding()},changeTurn:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];0==(this.turnSeat=e)?t&&this.giveTurn1(this.threek_timer):1==e&&t&&this.giveTurn2(this.threek_timer)},showMatchCareer:function(e){},hideMatchCareer:function(){},sendState:function(){this.getPlayerBoard(cc.global.user.id).isReady()||this.socket().exec("ready",{extparams:{roomid:this.roomid}})},userready_event:function(e,t){cc.global.audio.playEffectAud("ready");var i=t.getPlayerBoard(e.userid);if(i){var a=t.getLanguageText("PREPARED_0");i.setState(a),i.startTimer(30)}},banker_event:function(e,t){t.closeConfirm(),t.hideAllStatus(),t.initGameboard(!0),t.isGamePlaying=!0,t.isNewRoom=!1,t.threek_timer=30,t.sendFlag=!1,e.timer&&!isNaN(e.timer)&&(t.threek_timer=parseInt(e.timer));for(var i=t.getPlayer(e.banker),a=0;a<t.playerlist.length;a++)t.playerlist[a].getComponent("Threekplayer").hideBanker();i&&(i.showBanker(),0==i.seatid?(t.turnSeat=0,t.giveTurn1(t.threek_timer)):(t.turnSeat=1,t.giveTurn2(t.threek_timer)));for(a=0;a<e.players.length;a++)0==t.getPlayer(e.players[a].playuser).seatid&&(0==parseInt(e.players[a].type)?t.positive=1:t.positive=-1);t.stage=e.stage,t.ratio=1;for(a=0;a<3;a++)for(var s=0;s<8;s++)t.matrix[a][s]=parseInt(e.board[a][s]);t.settext_labelstage(t.stage),t.settext_labelmode(0),t.check_betup(1,t,!0)},playthreek_event:function(e,t){if(t.sendFlag=!0,!t.notReplay||parseInt(t.roomid)==parseInt(e.room_id)){t.lblTurnCount&&e.extdata&&e.extdata.turncount&&(t.lblTurnCount.string=Math.round(parseInt(e.extdata.turncount)/2)+"Turn",t.turnCount.server=parseInt(e.extdata.turncount),parseInt(cc.global.user.id)==parseInt(e.userid)&&"p"!=e.extdata.type||(t.turnCount.local+=1)),t.closeConfirm(),t.stopTurnTimerAll();var i=t.getPlayer(e.userid),a=t.getPlayer(e.extdata.next);t.stage=parseInt(e.extdata.stage),t.nextmode=parseInt(e.extdata.nextmode),t.mode=parseInt(e.extdata.mode);for(var s=0;s<3;s++)for(var r=0;r<8;r++)-1==t.konier[s][r].getComponent("ThreekPiece").isself&&1==t.konier[s][r].active&&t.konier[s][r].getComponent("ThreekPiece").blink_animation(!1);if(1==t.mode?cc.global.audio.playEffectAud("hall_click_game"):0==t.mode?cc.global.audio.playEffectAud("hall_click_game"):2==t.mode&&cc.global.audio.playEffectAud("pickcard"),1==t.nextmode&&3<=e.extdata.threepair.length){if(t.show_connecteffect(e.extdata.threepair),cc.global.audio.playEffectAud("onet/match"),parseInt(cc.global.user.id)==parseInt(e.userid))for(s=0;s<3;s++)for(r=0;r<8;r++)-1==t.konier[s][r].getComponent("ThreekPiece").isself&&1==t.konier[s][r].active&&t.konier[s][r].getComponent("ThreekPiece").blink_animation(!0)}else t.stop_particle();t.settext_labelstage(t.stage);for(s=0;s<3;s++)for(r=0;r<8;r++)t.emptykoni[s][r].getComponent("Emptybutton3").showRed(!1),t.konier[s][r].getComponent("ThreekPiece").showanimation(!1);if(i){e.extdata.passcount&&i.updatePassCount(e.extdata.passcount);var n;if((n=parseInt(e.extdata.ratio))>t.ratio&&t.check_betup(n,t,!1),0==parseInt(e.extdata.stage))for(s=0;s<3;s++)for(r=0;r<8;r++){var o=parseInt(e.extdata.board[s][r]);if(t.matrix[s][r]=o,1==Math.abs(o)){var l=o*t.positive;t.konier[s][r].getComponent("ThreekPiece").drawPiece(l),t.konier[s][r].getComponent("ThreekPiece").showPiece(!0)}else t.konier[s][r].getComponent("ThreekPiece").showPiece(!1),100==o?t.emptykoni[s][r].getComponent("Emptybutton3").showBlack(!0):t.emptykoni[s][r].getComponent("Emptybutton3").showBlack(!1);t.emptykoni[s][r].getComponent("Emptybutton3").showRed(!1)}else{for(s=0;s<3;s++)for(r=0;r<8;r++){t.emptykoni[s][r].getComponent("Emptybutton3").showBlack(!1);o=parseInt(e.extdata.board[s][r]);t.matrix[s][r]=o}var c,h,d,u;l=0;c=parseInt(e.extdata.srow),h=parseInt(e.extdata.scol),d=parseInt(e.extdata.erow),u=parseInt(e.extdata.ecol),2==parseInt(e.extdata.mode)&&"m"==e.extdata.type?t.konier[c][h].getComponent("ThreekPiece").movePiece(d,u):t.endmovePiece()}t.threek_timer=30,e.extdata.timer&&!isNaN(e.extdata.timer)&&(t.threek_timer=parseInt(e.extdata.timer)),e.extdata.type,t.changeTurn(a.seatid,!0),t.settext_labelmode(t.nextmode)}t.showBoardClaim(e.extdata.type);var p="";switch(e.extdata.type){case"n":break;case"p":p="pass"}""!=p&&i.speech(p)}},stopTurnTimerAll:function(){this.turntimer&&this.turntimer.getComponent("TurnTimer")&&this.turntimer.getComponent("TurnTimer").stopAllTimer()},showBoardClaim:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",i="";switch(e){case"n":break;case"p":i="pass";break;case"w":i="win";break;case"l":i="defeat";break;case"d":i="draw"}if("CH"==cc.global.curLanguage?i+="_ch":"RU"==cc.global.curLanguage?i+="_ru":i+="_en",this.boardclaim.node.children[0].active=!1,"tech"==t&&(this.boardclaim.node.children[0].active=!0,this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string={l:"Lose",w:"Victory"}[e]),"w"==e)this.runFinishAction("dzz_cj_win");else if("l"==e)this.runFinishAction("dzz_cj_lose");else if("p"==e){this.boardclaim.node.children[0].active=!0;var a=this.getLanguageText("PASS_0");this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string=a,this.boardclaim.getComponent(cc.Animation).play()}else this.boardclaim.spriteFrame=this.claimatlas.getSpriteFrame(i),this.boardclaim.getComponent(cc.Animation).play()},runFinishAction:function(e){if("yes"!=cc.global.amObserve&&this.finishAct&&this.finishAct.getComponent(sp.Skeleton)){var t=cc.callFunc(this.enableFinishAni,this,e),i=cc.callFunc(this.disableFinishAni,this);this.node.runAction(cc.sequence(t,cc.delayTime(3),i))}},enableFinishAni:function(e,t){if(this.finishAct){var i=this.finishAct.getComponent(sp.Skeleton);i&&(this.finishAct.active=!0,i.animation=t)}},disableFinishAni:function(e){this.finishAct&&(this.finishAct.active=!1)},recovery_event:function(e,t){t.isGamePlaying=!0,t.lblTurnCount&&e.count&&(t.lblTurnCount.string=Math.round(parseInt(e.count)/2)+"Turn",t.turnCount.local=parseInt(e.count),t.turnCount.server=parseInt(e.count));for(var i=0;i<e.players.length;i++){(a=t.getPlayer(e.players[i].playuser))&&e.players[i].pass&&a.updatePassCount(e.players[i].pass)}t.closeConfirm(),t.hideAllStatus(),t.initGameboard(!0),t.isGamePlaying=!0,t.isNewRoom=!1,t.threek_timer=30,e.timer&&!isNaN(e.timer)&&(t.threek_timer=parseInt(e.timer));var a=t.getPlayer(e.banker);for(i=0;i<t.playerlist.length;i++)t.playerlist[i].getComponent("Threekplayer").hideBanker();a&&(a.showBanker(),0==a.seatid?(t.turnSeat=0,t.giveTurn1(t.threek_timer)):(t.turnSeat=1,t.giveTurn2(t.threek_timer)));for(i=0;i<e.players.length;i++)0==t.getPlayer(e.players[i].playuser).seatid&&(0==parseInt(e.players[i].type)?t.positive=1:t.positive=-1);t.stage=e.stage;for(i=0;i<3;i++)for(var s=0;s<8;s++)t.matrix[i][s]=parseInt(e.board[i][s]);for(i=0;i<3;i++)for(s=0;s<8;s++){var r=t.matrix[i][s];if(1==Math.abs(r)){var n=r*t.positive;t.konier[i][s].getComponent("ThreekPiece").drawPiece(n),t.konier[i][s].getComponent("ThreekPiece").showPiece(!0)}else t.konier[i][s].getComponent("ThreekPiece").showPiece(!1),100==r?t.emptykoni[i][s].getComponent("Emptybutton3").showBlack(!0):t.emptykoni[i][s].getComponent("Emptybutton3").showBlack(!1);t.emptykoni[i][s].getComponent("Emptybutton3").showRed(!1)}t.settext_labelstage(t.stage),t.settext_labelmode(parseInt(e.mode));var o=parseInt(e.ratio);1<o&&(t.pangolds=t.panScore*o),t.check_betup(o,t,!1)},setPanInfo:function(e,t){this.getPlayer(e[0].playuser)},setTurn:function(e,t){var i=this.getPlayer(e);i&&(this.turnSeat=i.seatid),this.stopTurnTimerAll(),0==this.turnSeat?this.giveTurn1(t):1==this.turnSeat&&this.giveTurn2(t)},giveTurn1:function(e){this.sendFlag=!1,this.label_mode.node.color=new cc.Color(250,120,60),this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer1(e),this.togglePcsTurn(0))},giveTurn2:function(e){this.label_mode.node.color=new cc.Color(100,240,100),this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer2(e),this.togglePcsTurn(1))},togglePcsTurn:function(e){},hideAllStatus:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ThreekplayerBoard");t&&t.hideStatus()}},multiBetUp:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("Threekplayer");i&&i.betup.getComponent("TetrisBetUp").init(e,i.seatid)}},workOutMatchCareer:function(e){for(var t=0;t<e.players.length;t++){var i=this.getPlayer(e.players[t].userid),a=this.getPlayerBoard(e.players[t].userid);i&&a&&("normal"==cc.global.user.selplayway?0<e.players[t].score&&(this.matchCareerData.tgolds[i.userdata.id]+=e.players[t].score-this.pangolds/2):"diamond"==cc.global.user.selplayway&&0<e.players[t].score&&(this.matchCareerData.tdiamonds[i.userdata.id]+=e.players[t].score-this.pangolds/2),2==e.players[t].win&&(this.matchCareerData.wins[i.userdata.id]++,i.userdata.id))}this.showMatchCareer(this.matchCareerData)},allcards_event:function(a,s){clearTimeout(s.changeTurnTimer),s.otherEventCache=[],s.isGamePlaying=!1,s.stopTurnTimerAll(),s.matchCareerData&&s.workOutMatchCareer(a);for(var r=s.playerlist.length==a.players.length,e=0;e<a.players.length;e++){s.getPlayer(a.players[e].userid);a.players[e].getout&&(r=!1),a.players[e].userid==cc.global.user.id&&s.notReplay&&(cc.global.user.goldcoins=a.players[e].gold)}setTimeout(function(){for(var e=0;e<a.players.length;e++){var t=s.getPlayer(a.players[e].userid);if(a.players[e].getout&&(r=!1),t&&("normal"==cc.global.user.selplayway&&(t.userdata.goldcoins=parseInt(a.players[e].gold)),t.summary(a.players[e])),s.getPlayerBoard(a.players[e].userid)&&("suicide"!=a.title||a.players[e].win||(t=s.getPlayer(a.players[e].userid))&&t.showEmoticon(-1)),a.players[e].userid==cc.global.user.id)switch(a.players[e].win){case 0:s.showBoardClaim("l",a.title);break;case 1:s.showBoardClaim("d",a.title);break;case 2:s.showBoardClaim("w",a.title)}}s.settext_labelmode(-1),s.settext_labelstage(-1);for(e=0;e<3;e++)s.particlenode[e].getComponent(cc.ParticleSystem).stopSystem();for(e=0;e<3;e++)for(var i=0;i<8;i++)s.konier[e][i].getComponent("ThreekPiece").blink_animation(!1);r?setTimeout(function(){s.endGameTimer=null,s.boardclaim.getComponent(cc.Animation).stop(),s.boardclaim.node.setScale(0,0),s.cleanAfterAllCards(),s.setReadyState()},5e3):setTimeout(function(){s.endGameTimer=null,s.boardclaim.getComponent(cc.Animation).stop(),s.boardclaim.node.setScale(0,0),s.cleanAfterAllCards()},3e3)},500)},cleanAfterAllCards:function(){this.pangolds=0,cc.global.amObserve&&"no"==cc.global.amObserve&&this.showWaitingTimer();for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].getComponent("Threekplayer").hideBanker(),this.playerlist[e].getComponent("Threekplayer").updatePassCount(0);this.lblTurnCount&&(this.lblTurnCount.string="",this.turnCount.local=0,this.turnCount.server=0);for(e=0;e<3;e++)for(var t=0;t<8;t++)this.matrix[e][t]=0,this.emptykoni[e][t].getComponent("Emptybutton3").showBlack(!1);this.endmovePiece(),this.pandata.children[1].getComponent(cc.Label).string="0"},updateBetUpBalance:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("Threekplayer");i&&(i.userdata.goldcoins-=e)}this.updatePlayerBalance()},updatePlayerBalance:function(){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("Threekplayer");t&&t.updateBalance()}},showWaitingTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ThreekplayerBoard");t&&t.startTimer(30)}},showReadyTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ThreekplayerBoard");t&&t.startTimer(3)}},hideTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("ThreekplayerBoard");t&&t.stopTimer()}},getPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("Threekplayer");if(i.userdata.id==e)return i}},getOtherPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("Threekplayer");if(i.userdata.id!=e)return i}},getPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("ThreekplayerBoard");if(i.userdata.id==e)return i}},getOtherPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("ThreekplayerBoard");if(i.userdata.id!=e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},onClickGiveUp:function(){if(this.isGamePlaying){if(this.turnSeat)return void this.alert("No your turn.");var e=this;cc.global.audio.playVoiceSpeech("support/12_give_up");var t=this.getLanguageText("ARE_YOU_GIVE_UP");this.checkConfirm(t,function(){e&&e.socket().exec("suicide",{})},null)}},onClickSfx:function(){if(this.btnSfx){var e=this.btnSfx,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},showChatSearch:function(){},showChatDialog:function(){this.onclickChat(0)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.notReplay){if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}if(!(e<0)){this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root();var a=this.chatpage.getComponent("Chat");a.init(this,e),a.base.x=a.base.y=0,this.ischat=!0}}},onClickEmoticon:function(){if(this.notReplay){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),this.isemoticon=!1;this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root();var e=this.emoticonpage.getComponent("Emoticon");e.init(this,!1),e.base.x=e.base.y=0,this.isemoticon=!0}},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase,a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg);var s=t.getObserver(e.userid);s&&s.showCallPlayer(i,e.msg)},callplayer_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg);var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg,!1)},emoticon_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg);var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},onClickFindEmptyRoom:function(){},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},onClickChangePiece:function(){1==this.tgpcsbtn.children[0].active&&(this.tgpcsbtn.children[0].active=!1,this.tgpcsbtn.children[1].active=!0,this.togglePieceMode(!0)),1==this.tgpcsbtn.children[1].active&&(this.tgpcsbtn.children[0].active=!0,this.tgpcsbtn.children[1].active=!1,this.togglePieceMode(!1))},onclickBack:function(){var e=this;if(this.notReplay)if(this.isGamePlaying&&"no"==cc.global.amObserve){if(this.turnSeat)return void this.alert("No your turn.");cc.global.audio.playVoiceSpeech("support/14_roomout"),this.checkConfirm("Are you sure to leave room? You will lose.",function(){e.socket().exec("leave",{})},null)}else this.socket().exec("leave",{});else this.exitPlay()},exitPlay:function(){var e=this;cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),null==this.exitTimer&&(this.exitTimer=setInterval(function(){e.finishAct&&!e.finishAct.active&&(e.returnToHall(),clearInterval(e.exitTimer),e.exitTimer=null)},500))},returnToHall:function(){this.loadding(),clearInterval(this.otherEventInvoker),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.startGameTimer&&clearTimeout(this.startGameTimer),this.endGameTimer&&clearTimeout(this.endGameTimer),this.hideTimer(),this.cleanAllPlayers(),this.scene("hall",this)},chpre_event:function(e,t){t.closeOpenWin(),cc.global.openwin=cc.instantiate(t.roomrankdialog),cc.global.openwin.getComponent("RoomRankDialog").init(e.extdata),cc.global.openwin.parent=t.root(),t.notReplay||setTimeout(function(){null!=cc.global.openwin&&(cc.global.openwin.children[0].active=!1)},500)},on_clickempty:function(e,t){100!=this.matrix[e][t]&&0==this.matrix[e][t]&&1!=this.sendFlag&&(0==this.stage?this.socket().exec("playthreek",{extparams:{srow:-1,scol:-1,erow:e,ecol:t,stage:this.stage,mode:0,roomid:this.roomid,localturn:this.turnCount.local}}):this.socket().exec("playthreek",{extparams:{srow:this.srow,scol:this.scol,erow:e,ecol:t,stage:this.stage,mode:2,roomid:this.roomid,localturn:this.turnCount.local}}),this.sendFlag=!0)},on_clickblue:function(e,t){100!=this.matrix[e][t]&&1==this.nextmode&&this.positive!=this.matrix[e][t]&&1!=this.sendFlag&&(this.socket().exec("playthreek",{extparams:{srow:-1,scol:-1,erow:e,ecol:t,stage:this.stage,mode:1,roomid:this.roomid,localturn:this.turnCount.local}}),this.sendFlag=!0)},on_clickred:function(e,t){for(var i=0;i<3;i++)for(var a=0;a<8;a++)this.emptykoni[i][a].getComponent("Emptybutton3").showRed(!1);if(0!=this.stage&&this.matrix[e][t]==this.positive&&1!=this.nextmode){this.srow=e,this.scol=t;var s=[[0,1],[1,0],[-1,0],[0,-1]];for(i=0;i<3;i++)for(a=0;a<8;a++)i==e&&a==t?this.konier[i][a].getComponent("ThreekPiece").showanimation(!0):this.konier[i][a].getComponent("ThreekPiece").showanimation(!1);for(i=0;i<4;i++){var r=e+s[i][0],n=t+s[i][1];r<0||2<r||(n=(n+8)%8,0==this.matrix[r][n]&&this.emptykoni[r][n].getComponent("Emptybutton3").showRed(!0))}}},endmovePiece:function(){for(var e=0;e<3;e++)for(var t=0;t<8;t++){var i=parseInt(this.matrix[e][t]);if(this.konier[e][t].getComponent("ThreekPiece").init(e,t,this),this.konier[e][t].setPosition(this.matrix_pos[e][t]),1==Math.abs(i)){var a=i*this.positive;this.konier[e][t].getComponent("ThreekPiece").drawPiece(a),this.konier[e][t].getComponent("ThreekPiece").showPiece(!0)}else this.konier[e][t].getComponent("ThreekPiece").showPiece(!1)}},settext_labelstage:function(e){this.label_stage.string=e<0?"":"Step"+(e+1)},settext_labelmode:function(e){if(e<0)this.label_mode.string="";else{var t;t=0==e?0==this.turnSeat?this.getLanguageText("THREEK_COMMAND_PUT_0"):this.getLanguageText("THREEK_COMMAND_PUT_1"):1==e?0==this.turnSeat?this.getLanguageText("THREEK_COMMAND_CATCH_0"):this.getLanguageText("THREEK_COMMAND_CATCH_1"):0==this.turnSeat?this.getLanguageText("THREEK_COMMAND_MOVE_0"):this.getLanguageText("THREEK_COMMAND_MOVE_1"),this.label_mode.string=t;var i=cc.scaleTo(.1,1.2),a=cc.scaleTo(.1,1),s=cc.sequence(i,cc.delayTime(.2),a);this.label_mode.node.runAction(s)}},show_connecteffect:function(e){for(var t=0;t<e.length;t++){var i=parseInt(e[t].split(",")[0]),a=parseInt(e[t].split(",")[1]);this.particlenode[t].setPosition(this.matrix_pos[i][a]),this.particlenode[t].getComponent(cc.ParticleSystem).resetSystem()}},stop_particle:function(){for(var e=0;e<this.particlenode.length;e++)this.particlenode[e].getComponent(cc.ParticleSystem).stopSystem()},check_betup:function(e,t,i){var a=parseInt(e);parseInt(this.totalcount);if(1==i){var s=t.panScore*a;return t.updateBetUpBalance(s),t.multiBetUp(s),t.pangolds=t.pangolds+2*s,void(t.pandata.children[1].getComponent(cc.Label).string=t.numformat(t.pangolds))}if(0<a&&a>t.ratio){2<=(t.ratio=a)&&(a/=2,cc.global.audio.playEffectAud("charge"),t.showMultiAni());s=t.panScore*a;var r=0;if("normal"==cc.global.user.selplayway||"champion"==cc.global.user.selplayway)for(var n=0;n<t.playerlist.length;n++){var o=t.playerlist[n].getComponent("Threekplayer");if(o){if(0==o.userdata.goldcoins)return;0==r?r=o.userdata.goldcoins:r>o.userdata.goldcoins&&(r=o.userdata.goldcoins)}}r<s&&(s=r),t.updateBetUpBalance(s),t.multiBetUp(s),t.pangolds=t.pangolds+2*s,t.pandata.children[1].getComponent(cc.Label).string=t.numformat(t.pangolds)}},showMultiAni:function(){if(this.multi){var e=this;this.multi.active=!0;var t=this.multi.getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"play",!1),setTimeout(function(){e&&e.multi&&(e.multi.active=!1)},2e3)}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ThreekPiece:[function(e,t,i){"use strict";cc._RF.push(t,"12e80n8EcNOH4OJgMhlY46l","ThreekPiece"),cc.Class({extends:cc.Component,properties:{img1:{default:null,type:cc.Node},img2:{default:null,type:cc.Node},isself:0},init:function(e,t,i){this.row=e,this.col=t,this.parent=i,this.node.active=!1,this.life=!1},onClick:function(){if("yes"!=cc.global.amObserve&&!this.parent.turnSeat)if(0==this.parent.stage){if(0==this.parent.nextmode)return;if(1==this.isself)return;this.parent.on_clickblue(this.row,this.col)}else if(2==this.parent.nextmode){if(1!=this.isself)return;this.showanimation(!0),this.parent.on_clickred(this.row,this.col)}else{if(1==this.isself)return;this.parent.on_clickblue(this.row,this.col)}},setSize:function(e,t){this.node.width=e,this.node.height=t,this.node.children[0].width=e,this.node.children[0].height=t,this.node.children[1].width=e,this.node.children[1].height=t,this.node.children[2].width=e,this.node.children[2].height=t},drawPiece:function(e){this.img1.active=1==e,this.img2.active=-1==e,this.isself=e},showPiece:function(e){this.node.active=e,this.life=e},showanimation:function(e){e?this.node.getComponent(cc.Animation).play("connectkoni"):(this.node.getComponent(cc.Animation).stop("connectkoni"),this.node.setScale(1,1))},blink_animation:function(e){e?this.node.getComponent(cc.Animation).play("blink_piece"):(this.node.getComponent(cc.Animation).stop("blink_piece"),this.img2.opacity=255)},clickaction:function(e){var t=cc.scaleTo(.2,1.2),i=cc.scaleTo(.2,1);1==e?this.node.runAction(t):this.node.runAction(i)},movePiece:function(e,t){var i=this.parent.matrix_pos[e][t],a=cc.moveTo(.2,i),s=cc.sequence(a,cc.callFunc(this.end_move.bind(this)));this.node.runAction(s)},end_move:function(){this.parent.endmovePiece()}}),cc._RF.pop()},{}],ThreekplayerBoard:[function(e,t,i){"use strict";cc._RF.push(t,"66bbfOUjEhLmJ8E8S75OMuU","ThreekplayerBoard");var a=e("HHCommon");cc.Class({extends:a,properties:{countdown:{default:null,type:cc.Label},status:{default:null,type:cc.Label},tip:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.layoutForSeat()},startTimer:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode||!(3<e)){var t=this;t.stopTimer(),t.countdown.node.active=!0,t.countdown.string=e,t.timer||(t.timer=setInterval(function(){0<e?t.countdown&&(e--,t.countdown.string=e):t.stopTimer()},1e3))}},stopTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null),this.countdown&&(this.countdown.node.active=!1)},setState:function(e){var t=this.getLanguageText("READY_0")+"?",i=this.getLanguageText("PREPARED_0");1!=cc.global.championMode&&2!=cc.global.championMode?(this.status.node.active=!0,t==(this.status.string=e)&&this.userdata.id==cc.global.user.id&&"no"==cc.global.amObserve?this.tip.active=!0:this.tip.active=!1):this.status.string=i},hideTip:function(){this.tip.active=!1},hideStatus:function(){this.stopTimer(),this.hideTip(),this.status.node.active=!1},layoutForSeat:function(){0==this.seatid||this.seatid},isReady:function(){return this.getLanguageText("PREPARED_0")==this.status.string},onClickReady:function(){this.parent&&this.parent.processReadyState()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],Threekplayer:[function(e,t,i){"use strict";cc._RF.push(t,"58685Q22nhKQoNryoGmg/qf","Threekplayer");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},nickname:{default:null,type:cc.Label},goldcoin_base:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},betup:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},winorlose:{default:null,type:cc.Node},banker:{default:null,type:cc.Node},passCount:{default:null,type:cc.Label}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.nickname.string=t.nickname,1==cc.global.championMode||cc.global.championMode,this.goldcoins.string=this.numformat(t.goldcoins),this.goldcoins.node.parent.active=!0,this.loadAvatar(t.avatarurl,t.gender),this.layoutForSeat()},speech:function(e){var t=this.userdata.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)},onClickDisInfo:function(){},updateCareer:function(e){},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},spendDiamondForLuck:function(e){this.updateBalance()},showCallPlayer:function(e,t){var i=this;this.hideCallPlayer(),cc.global.audio.playVoiceChatWithType(this.userdata.playcharacter,t),this.callplayer.active=!0,this.callplayer.children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onClickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userdata.id},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){cc.global.user.id==this.userdata.id?this.parent.onClickEmoticon&&this.parent.onClickEmoticon():this.onClickCallPlayer()},layoutForSeat:function(){0==this.seatid?(this.winorlose.x=140,this.banker.x=-65,this.callplayer.scaleX=1,this.callplayer.children[0].scaleX=1):1==this.seatid&&(this.winorlose.x=-140,this.banker.x=65,this.callplayer.scaleX=-1,this.callplayer.children[0].scaleX=-1)},summary:function(e){var a=this;if(this.updateCareer(e),this.winorlose.getComponent(cc.Animation).play(),2==e.win){cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("win"),this.winorlose.children[1].getComponent(cc.Label).string="+"+this.numformat(e.exp),this.winorlose.children[2].getComponent(cc.Label).string="+"+this.numformat(e.score),e.orig_gold=e.gold-e.score,"diamond"==cc.global.user.selplayway&&(e.orig_gold=e.diamond-e.score);var t=cc.callFunc(function(e,t){t.orig_gold+Math.round(t.score/5)>("diamond"==cc.global.user.selplayway?t.diamond:t.gold)?"diamond"==cc.global.user.selplayway?t.orig_gold=t.diamond:t.orig_gold=t.gold:t.orig_gold=t.orig_gold+Math.round(t.score/5);var i=e.getComponent("Threekplayer").goldcoins.node;i.getComponent(cc.Label).string=a.numformat(t.orig_gold),i.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1)))},this,e),i=cc.sequence(cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t);this.node.runAction(i)}else cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("lose"),this.winorlose.children[1].getComponent(cc.Label).string="-"+this.numformat(Math.abs(e.exp)),this.winorlose.children[2].getComponent(cc.Label).string="-"+this.numformat(-1*e.score),this.goldcoins.string=this.numformat(e.gold)},showFuncStatus:function(){},showBanker:function(){this.banker.active=!0,2<=this.banker.children.length&&(this.banker.children[0].active=0==this.seatid,this.banker.children[1].active=0!=this.seatid)},hideBanker:function(){this.banker.active=!1},updatePassCount:function(e){if(this.passCount){var t=3-parseInt(e);if(0<=t){var i=this.getLanguageText("PASS_COUNT");this.passCount.string=i+": "+t}else{i=this.getLanguageText("NO_PASS_COUNT");this.passCount.string=i}}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ThrownCards:[function(e,t,i){"use strict";cc._RF.push(t,"73496W2X5NBc7xp6dXTUAsT","ThrownCards");var a=e("HHCommon");cc.Class({extends:a,properties:{cardspanel:{default:null,type:cc.Node},cardprefab:{default:null,type:cc.Prefab},hidden_money:{default:null,type:cc.Label}},onLoad:function(){},init:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(this.money=0,this.node.active=t,this.addCards(e),i){for(var a=0;a<e.length;a++){var s=(e[a]-e[a]%4)/4+3;5!=s&&10!=s||(this.money+=s),13==s&&(this.money+=10)}this.hidden_money.string="+ "+this.money}},addCards:function(e){this.cardspanel.destroyAllChildren(),this.cardspanel.removeAllChildren();for(var t=0;t<e.length;t++){var i=cc.instantiate(this.cardprefab);i.parent=this.cardspanel;var a=i.getComponent("HHCard");a.setCard(e[t]),a.order()}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],ToastCtrl:[function(e,t,i){"use strict";cc._RF.push(t,"54667slUJVI/Zct6hHa64iz","ToastCtrl");var a=e("HHCommon");cc.Class({extends:a,properties:{icon:{default:null,type:cc.Node},msg:{default:null,type:cc.Label}},init:function(e,t){this.msg.string=t;var i=!(2<arguments.length)||arguments[2];this.icon.active=i;var a=cc.callFunc(function(e){e.destroy(),cc.global.opentoast=null},this);"invisible"==e?this.node.runAction(cc.sequence(cc.scaleTo(.1,1),cc.delayTime(2),cc.scaleTo(.1,0))):this.node.runAction(cc.sequence(cc.fadeIn(.1),cc.delayTime(2),cc.fadeOut(.1),cc.delayTime(.5),a))}}),cc._RF.pop()},{HHCommon:"HHCommon"}],Tooltip:[function(e,t,i){"use strict";cc._RF.push(t,"f8570lYEbpB0JnCfSHGNUNJ","Tooltip"),cc.Class({extends:cc.Component,properties:{tooltip:{default:null,type:cc.Node},time:{default:1,type:cc.Integer}},onLoad:function(){this.node.on(cc.Node.EventType.MOUSE_ENTER,function(){this.tooltip.stopAllActions(),this.tooltip.runAction(cc.sequence(cc.fadeIn(.05),cc.delayTime(this.time),cc.fadeOut(.05)))},this)}}),cc._RF.pop()},{}],TurnTimer:[function(i,e,t){"use strict";cc._RF.push(e,"cecd09syvtOcZQGh4cNAWi0","TurnTimer");var a=i("HHCommon");cc.Class({extends:a,properties:{clock_1:{default:null,type:cc.Node},clock_2:{default:null,type:cc.Node},progress_1:{default:null,type:cc.ProgressBar},progress_2:{default:null,type:cc.ProgressBar},teamTurnTimer:{default:null,type:cc.Node}},start:function(){this.progress_1&&this.progress_2&&(this.progress_1.progress=this.progress_2.progress=1),this.myTimesStatic=this.enemyTimesStatic=30,this.myTimes=this.enemyTimes=this.myTimes1=0,this.isPaused=!1,this.ourTeamTimesStatic1=this.ourTeamTimesStatic2=this.enemyTeamTimesStatic1=this.enemyTeamTimesStatic2=0,this.ourTeamTimes1=this.ourTeamTimes2=this.enemyTeamTimes1=this.enemyTeamTimes2=0},setParent:function(e){this.parent=e},turnTimer1:function(e){this.stopEnemyTimer(),this.myTimesStatic=this.myTimes=e;var t=i("GameTimer");this.myTimer=new t,this.myTimer.is_cardgame=!1,this.parent&&this.parent.is_team_game?(this.teamTurnTimer.children[0].active=!1,this.teamTurnTimer.children[1].active=!1,this.teamTurnTimer.children[2].active=!1,this.teamTurnTimer.children[3].active=!1,this.teamTurnTimer.children[this.parent.curTurn].active=!0,this.myTimeSrc=this.myTimer.runtimer(this,this.teamTurnTimer.children[this.parent.curTurn],null,this.teamTurnTimer.children[this.parent.curTurn].children[0].getComponent(cc.Label),null,e),0==this.parent.curTurn&&(this.myTimes1=e,this.myTimer1=new t,this.myTimeSrc1=this.myTimer1.runtimer(this,this.clock_1,null,this.clock_1.children[0].getComponent(cc.Label),null,e))):this.myTimeSrc=this.myTimer.runtimer(this,this.clock_1,null,this.clock_1.children[0].getComponent(cc.Label),null,e)},turnTimer2:function(e){this.stopMyTimer(),this.enemyTimesStatic=this.enemyTimes=this.enemyTimes1=e;var t=i("GameTimer");this.enemyTimer=new t,this.enemyTimer.is_cardgame=!1,this.parent&&this.parent.is_team_game?(this.teamTurnTimer.children[0].active=!1,this.teamTurnTimer.children[1].active=!1,this.teamTurnTimer.children[2].active=!1,this.teamTurnTimer.children[3].active=!1,this.teamTurnTimer.children[this.parent.curTurn].active=!0,this.enemyTimeSrc=this.enemyTimer.runtimer(this,this.teamTurnTimer.children[this.parent.curTurn],null,this.teamTurnTimer.children[this.parent.curTurn].children[0].getComponent(cc.Label),null,e),this.enemyTimer1=new t,this.enemyTimeSrc1=this.enemyTimer1.runtimer(this,this.clock_2,null,this.clock_2.children[0].getComponent(cc.Label),null,e)):this.enemyTimeSrc=this.enemyTimer.runtimer(this,this.clock_2,null,this.clock_2.children[0].getComponent(cc.Label),null,e)},stopAllTimer:function(){this.stopMyTimer(),this.stopEnemyTimer(),this.progress_1&&this.progress_2&&(this.progress_1.progress=this.progress_2.progress=0)},stopMyTimer:function(){this.myTimer&&(this.parent&&this.parent.is_team_game?(this.myTimer.stoptimer(this,this.teamTurnTimer.children[this.parent.curTurn],this.myTimeSrc),this.myTimer1&&(this.myTimer1.stoptimer(this,this.clock_1,this.myTimeSrc1),this.myTimes1=0)):(this.myTimer.stoptimer(this,this.clock_1,this.myTimeSrc),this.myTimes=0))},stopEnemyTimer:function(){this.enemyTimer&&(this.parent&&this.parent.is_team_game?(this.enemyTimer.stoptimer(this,this.teamTurnTimer.children[this.parent.curTurn],this.enemyTimeSrc),this.enemyTimer1&&(this.enemyTimer1.stoptimer(this,this.clock_2,this.enemyTimeSrc1),this.enemyTimes1=0)):this.enemyTimer.stoptimer(this,this.clock_2,this.enemyTimeSrc),this.enemyTimes=0)},update:function(e){this.isPaused||(this.parent&&this.parent.is_team_game?(0<this.myTimes1?this.myTimes1-=e*cc.global.watchReplayData.replaySpeedX:this.myTimes1=0,this.progress_1&&(this.progress_1.progress=this.myTimes1/this.myTimesStatic),0<this.enemyTimes1?this.enemyTimes1-=e*cc.global.watchReplayData.replaySpeedX:this.enemyTimes1=0,this.progress_2&&(this.progress_2.progress=this.enemyTimes1/this.enemyTimesStatic)):(0<this.myTimes?this.myTimes-=e*cc.global.watchReplayData.replaySpeedX:this.myTimes=0,this.progress_1&&(this.progress_1.progress=this.myTimes/this.myTimesStatic),0<this.enemyTimes?this.enemyTimes-=e*cc.global.watchReplayData.replaySpeedX:this.enemyTimes=0,this.progress_2&&(this.progress_2.progress=this.enemyTimes/this.enemyTimesStatic)))},pauseAllTimer:function(){this.isPaused=!0,this.pauseMyTimer(),this.pauseEnemyTimer()},pauseMyTimer:function(){this.myTimer&&(this.parent&&this.parent.is_team_game?(this.myTimer.pauseTimer(this,this.teamTurnTimer.children[this.parent.curTurn],this.myTimeSrc),this.myTimer1&&this.myTimer1.pauseTimer(this,this.clock_1,this.myTimeSrc1)):this.myTimer.pauseTimer(this,this.clock_1,this.myTimeSrc))},pauseEnemyTimer:function(){if(this.enemyTimer){if(this.parent&&this.parent.is_team_game)return this.enemyTimer.pauseTimer(this,this.teamTurnTimer.children[this.parent.curTurn],this.enemyTimeSrc),void(this.enemyTimer1&&this.enemyTimer1.pauseTimer(this,this.clock_2,this.enemyTimeSrc1));this.enemyTimer.pauseTimer(this,this.clock_2,this.enemyTimeSrc)}},resumeAllTimer:function(){this.isPaused=!1,this.resumeMyTimer(),this.resumeEnemyTimer()},resumeMyTimer:function(){if(this.myTimer){if(this.parent&&this.parent.is_team_game)return this.myTimer.resumeTimer(this,this.teamTurnTimer.children[this.parent.curTurn],this.teamTurnTimer.children[this.parent.curTurn].children[0].getComponent(cc.Label)),void(this.myTimer1&&this.myTimer1.resumeTimer(this,this.clock_1,this.clock_1.children[0].getComponent(cc.Label)));this.myTimer.resumeTimer(this,this.clock_1,this.clock_1.children[0].getComponent(cc.Label))}},resumeEnemyTimer:function(){if(this.parent&&this.parent.is_team_game)return this.enemyTimer&&this.enemyTimer.resumeTimer(this,this.teamTurnTimer.children[this.parent.curTurn],this.teamTurnTimer.children[this.parent.curTurn].children[0].getComponent(cc.Label)),void(this.enemyTimer1&&this.enemyTimer1.resumeTimer(this,this.clock_2,this.clock_2.children[0].getComponent(cc.Label)));this.enemyTimer&&this.enemyTimer.resumeTimer(this,this.clock_2,this.clock_2.children[0].getComponent(cc.Label))}}),cc._RF.pop()},{GameTimer:"GameTimer",HHCommon:"HHCommon"}],VIPStatus:[function(e,t,i){"use strict";cc._RF.push(t,"69c41CtTgtCIJXk1LbTUWB5","VIPStatus");var a=e("HHCommon");cc.Class({extends:a,properties:{prev_lvl:{default:null,type:cc.Label},next_lvl:{default:null,type:cc.Label},vip_prgs:{default:null,type:cc.ProgressBar},prev_ord:{default:null,type:cc.Label},next_ord:{default:null,type:cc.Label},upto_rem:{default:null,type:cc.Label}},start:function(){this.init()},init:function(){this.prev_lvl.string=cc.global.user.viplevel,this.next_lvl.string=parseInt(cc.global.user.viplevel)+1;var e=0;0<cc.global.user.viplevel&&(e=5e3*Math.pow(2,cc.global.user.viplevel-1));var t=5e3*Math.pow(2,cc.global.user.viplevel);this.prev_ord.string=this.numformat(e),this.next_ord.string=this.numformat(t),this.upto_rem.string=" Next Level "+this.numformat(t-cc.global.user.vipscore),this.vip_prgs.progress=(cc.global.user.vipscore-e)/(t-e)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],Vector3d:[function(e,t,a){"use strict";cc._RF.push(t,"169aajVTbtM1Kg6G/4Pr+fB","Vector3d"),Object.defineProperty(a,"__esModule",{value:!0});var s=function(){function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}}();a.Vector3d=function(){function a(e,t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,a),this.set(e,t,i)}return s(a,[{key:"get",value:function(e){switch(e){case 0:return this.f12x;case 1:return this.f13y;case 2:return this.f14z;default:throw new ArrayIndexOutOfBoundsException(e)}}},{key:"set",value:function(e){if(3==arguments.length)this.f12x=e,this.f13y=arguments[1],this.f14z=arguments[2];else if(2==arguments.length){var t=arguments[1];switch(e){case 0:return void(this.f12x=t);case 1:return void(this.f13y=t);case 2:return void(this.f14z=t);default:throw new ArrayIndexOutOfBoundsException(i)}}else this.f12x=e.f12x,this.f13y=e.f13y,this.f14z=e.f14z}},{key:"add",value:function(e){if(2==arguments.length){var t=arguments[1];this.f12x=e.f12x+t.f12x,this.f13y=e.f13y+t.f13y,this.f14z=e.f14z+t.f14z}else this.f12x+=e.f12x,this.f13y+=e.f13y,this.f14z+=e.f14z}},{key:"sub",value:function(e){if(2==arguments.length){var t=arguments[1];this.f12x=e.f12x-t.f12x,this.f13y=e.f13y-t.f13y,this.f14z=e.f14z-t.f14z}else this.f12x-=e.f12x,this.f13y-=e.f13y,this.f14z-=e.f14z}},{key:"scale",value:function(e){this.f12x*=e,this.f13y*=e,this.f14z*=e}},{key:"norm",value:function(){return Math.sqrt(this.f12x*this.f12x+this.f13y*this.f13y+this.f14z*this.f14z)}},{key:"normSquared",value:function(){return this.f12x*this.f12x+this.f13y*this.f13y+this.f14z*this.f14z}},{key:"distance",value:function(e){var t=this.f12x-e.f12x,i=this.f13y-e.f13y,a=this.f14z-e.f14z;return Math.sqrt(t*t+i*i+a*a)}},{key:"distanceSquared",value:function(e){var t=this.f12x-e.f12x,i=this.f13y-e.f13y,a=this.f14z-e.f14z;return t*t+i*i+a*a}},{key:"dot",value:function(e){return this.f12x*e.f12x+this.f13y*e.f13y+this.f14z*e.f14z}},{key:"cross",value:function(e,t){var i=e.f13y*t.f14z-e.f14z*t.f13y,a=e.f14z*t.f12x-e.f12x*t.f14z;this.f12x=i,this.f13y=a,this.f14z=e.f12x*t.f13y-e.f13y*t.f12x}},{key:"setRandom",value:function(e,t,i){var a=t-e;this.f12x=i.nextDouble()*a+e,this.f13y=i.nextDouble()*a+e,this.f14z=i.nextDouble()*a+e}},{key:"toString",value:function(){return String.valueOf(this.f12x)+" "+this.f13y+" "+this.f14z}}]),a}();cc._RF.pop()},{}],Wall:[function(e,t,i){"use strict";cc._RF.push(t,"b5cc6VjDVxIIIeISvndx6vR","Wall"),Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}}();i.Wall=function(){function i(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,i),this.coordinate=e,this.rate=t}return a(i,[{key:"setRate",value:function(e){this.rate=e}},{key:"getRate",value:function(){return this.rate}},{key:"setCoordinate",value:function(e){this.coordinate=e}},{key:"getCoordinate",value:function(){return this.coordinate}}]),i}();cc._RF.pop()},{}],WebView:[function(e,t,i){"use strict";cc._RF.push(t,"91276LZwKpGBJGso8bIQNUp","WebView"),cc.Class({extends:cc.Component,properties:{webview:{default:null,type:cc.WebView}},onLoad:function(){""==cc.global.webviewurl?this.webview.url=cc.global.http.f7URL+"?token="+cc.global.authorization+"&userid="+cc.global.user.username:this.webview.url=cc.global.http.f7URL+cc.global.webviewurl,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},onKeyDown:function(e){switch(e.keyCode){case cc.KEY.escape:case cc.KEY.back:return void cc.director.loadScene("login")}}}),cc._RF.pop()},{}],YutBegin:[function(e,t,i){"use strict";cc._RF.push(t,"212aa8NNEJG4JBRRdIccEzg","YutBegin");var c,a=e("HHCommon"),s=e("YutEngine");cc.Class({extends:a,properties:{body:cc.Node,yut_player:{default:null,type:cc.Prefab},yut_player_board:{default:null,type:cc.Prefab},statusboard:{default:null,type:cc.Node},boardclaim:{default:null,type:cc.Sprite},claimatlas:{default:null,type:cc.SpriteAtlas},roomdata:{default:null,type:cc.Node},turntimer:{default:null,type:cc.Node},msndone:{default:null,type:cc.Prefab},msndonelist:{default:null,type:cc.Node},observer:{default:null,type:cc.Prefab},observerbench:{default:null,type:cc.Node},emodlg:{default:null,type:cc.Prefab},chat:{default:null,type:cc.Prefab},btn_enter:{default:null,type:cc.Node},btn_giveup:{default:null,type:cc.Node},btn_chat:{default:null,type:cc.Node},btn_replay_play:{default:null,type:cc.Node},lbl_replaySpeedX:{default:null,type:cc.Label},replay_bar:{default:null,type:cc.Node},finishAct:{default:null,type:cc.Node},btnSfx:{default:null,type:cc.Node},lblTurnCount:{default:null,type:cc.Label},gameboard:{default:null,type:cc.Node},listbox:{default:null,type:cc.Node},listbox1:{default:null,type:cc.Node},yutpiece:{default:null,type:cc.Prefab},yutbtn:{default:null,type:cc.Prefab},konier:{default:[]},board_pos:{default:[]},waiting_pos:{default:[]},out_pos:{default:[]},indexPos:{default:[]},saveidx:{default:[]},matrixboard:{default:null,type:cc.Node},opponentplayer:{default:null,type:cc.Node},selfplayer:{default:null,type:cc.Node},middlepan:{default:null,type:cc.Node},selfpan:{default:null,type:cc.Node},opponentpan:{default:null,type:cc.Node},dillar:{default:null,type:cc.Node},yutbars:{default:null,type:cc.Node},label_prebanker:{default:null,type:cc.Label},listbox_yuts:{default:null,type:cc.Node},dillarpan:{default:[],type:[cc.Node]},dillar1_tile:{default:null,type:cc.SpriteAtlas},dillar2_tile:{default:null,type:cc.SpriteAtlas},yut_tile:{default:null,type:cc.SpriteAtlas},hole19:{default:null,type:cc.Node},hole29:{default:null,type:cc.Node},multi:{default:null,type:cc.Node},yutresult:0},onLoad:function(){!cc.global.isOffline&&this.initEventCallback(),cc.game.setFrameRate(60),cc.global.amObserve="no",this.ratio=1,this.play_status=0,this.playerlist=new Array,this.playerboardlist=new Array,this.observerlist=new Array,this.posBaseIdx=0,this.inited=!1,this.playerBoardSlotPos=[cc.v2(0,-100),cc.v2(0,200)],this.notReplay=!0,this.startGameTimer=null,this.endGameTimer=null,this.pangolds=0,this.isGamePlaying=!1,this.turnSeat=0,this.isNewRoom=!0,this.sendFlag=!1,this.turnCount={local:0,server:0},this.boygirlidx=[0,0],this.koni_zindex=0,this.body.height=1205/cc.global.narrowContentRatio,this.body.y=-37.5/cc.global.narrowContentRatio,this.body.children[0].height=this.body.children[2].height=220/cc.global.narrowContentRatio,this.yutqueue=[],null!=cc.global&&(this.initgame(),""!=cc.global.user.roomid&&(this.recovery(),this.isNewRoom=!1)),this.cal_matrixPos(),this.cal_indexPos();var e=1-cc.global.narrowContentRatio;if(0<e){var t=200*e;this.selfpan.y-=t,this.opponentpan.y+=t}this.piecewidth=54.72,this.pieceheight=80;var i=-440/cc.global.narrowContentRatio,a=420/cc.global.narrowContentRatio;this.waiting_pos[0]=[],this.waiting_pos[1]=[];for(var s=-296,r=i,n=4;0<=n;n--)this.waiting_pos[0][n]=cc.p(s,r),s+=this.piecewidth;var o=296,l=a;for(n=4;0<=n;n--)this.waiting_pos[1][n]=cc.p(o,l),o-=this.piecewidth;this.out_pos[0]=new Array,this.out_pos[1]=new Array,this.out_pos[0][0]=cc.p(-1*this.matrixboard.width/4,this.pieceheight/2),this.out_pos[0][1]=cc.p(-1*this.matrixboard.width/4,-1*this.pieceheight/2),this.out_pos[0][2]=cc.p(-1*this.matrixboard.width/4-this.piecewidth,this.pieceheight),this.out_pos[0][3]=cc.p(-1*this.matrixboard.width/4-this.piecewidth,0),this.out_pos[0][4]=cc.p(-1*this.matrixboard.width/4-this.piecewidth,-this.pieceheight);for(n=0;n<5;n++)this.out_pos[1][n]=cc.p(-1*this.out_pos[0][n].x,this.out_pos[0][n].y);this.konier[0]=[],this.konier[1]=[];for(n=0;n<2;n++)for(var c=0;c<5;c++)this.konier[n][c]=cc.instantiate(this.yutpiece),this.konier[n][c].getComponent("YutPiece").init(c,n,-1,-1,0,this),this.konier[n][c].getComponent("YutPiece").setPieceSize(this.piecewidth,this.pieceheight),this.konier[n][c].setPosition(this.waiting_pos[n][c]),this.konier[n][c].parent=this.matrixboard,this.konier[n][c].getComponent("YutPiece").drawPiece(n);this.saveidx[0]=[-1,-1,-1,-1,-1],this.saveidx[1]=[-1,-1,-1,-1,-1],this.label_prebanker.node.active=!1,this.isprebanker=0,this.isend=0;for(n=this.isshowresult=0;n<10;n++){var h=cc.instantiate(this.yutbtn);h.getComponent("Yutbtn").init(n,0,1,this),h.parent=this.listbox_yuts.children[1],h.active=!1}this.listbox_yuts.active=!1,this.yutbars.active=!1,this.dillar.active=!1;for(n=0;n<2;n++)this.dillarpan[n].children[1].active=!1;this.hole=0,this.hole19.active=!1,this.hole29.active=!1,cc.global.watchReplayData.onReplay&&this.prepareReplay(),this.setEtcKeyBoardEvent();var d=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));if(null==d&&(d=!0),d?(this.btnSfx.children[0].active=!0,this.btnSfx.children[1].active=!1):(this.btnSfx.children[0].active=!1,this.btnSfx.children[1].active=!0),cc.global.audio.playBGM("bgm_koni"),1==cc.global.curPlaywayScore&&cc.global.isOffline){var u={command:"jr",cond:20,event:"command",game:"yut",id:this.getLanguageText("TRAINING_ROOM_0"),name:"normal",observerlist:[],playerlist:[{avatarurl:cc.global.user.avatarurl,exp:0,explevel:0,gender:0,goldcoins:1e4,id:cc.global.user.id,nickname:cc.global.user.nickname,playcharacter:1,rank:0,seatid:0,texp:0,viplevel:0,vipscore:0},{avatarurl:"",exp:0,explevel:0,gender:0,goldcoins:1e4,id:0,nickname:this.getLanguageText("AI_PLAYER_0"),playcharacter:1,rank:0,seatid:1,texp:0,viplevel:0,vipscore:0}],players:2,playway:"yut",score:1};this.joinroom_event(u,this)}},initgame:function(){var t=this;if(this.finishAct&&(this.finishAct.active=!1),!cc.global.isOffline){var e=this.socket();this.map("jr",this.joinroom_event),this.map("userready",this.userready_event),this.map("players",this.players_event),this.map("prebanker",this.prebanker_event),this.map("banker",this.banker_event),this.map("playyut",this.playyut_event),this.map("rer",this.recovery_event),this.map("selemoticon",this.emoticon_event),this.map("sendchat",this.sendchat_event),this.map("callplayer",this.callplayer_event),this.map("allcards",this.allcards_event),this.map("chpre",this.chpre_event),e.on("command",function(e){1==t.inited&&t.route(e.command)(e,t)})}var i={};switch(cc.global.user.roomInType){case"NormalCreate":null!=cc.global.extparams.roomid?i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond,roomid:cc.global.extparams.roomid}:i.extparams={playway:cc.global.extparams.playway,cond:cc.global.extparams.cond},1==cc.global.championMode||2==cc.global.championMode?e.exec("jcr",i):0==cc.global.championMode&&e.exec("cnr",i);break;case"NormalJoin":i.extparams={roomid:cc.global.extparams.roomid},e.exec("jnr",i);break;case"NormalObserve":i.extparams={roomid:cc.global.extparams.roomid},cc.global.amObserve="yes",e.exec("onr",i)}this.inited=!0,this.loadding(),(c=new s).init()},recovery:function(){this.goRecovery=!0,this.socket().exec("rer",{})},prepareReplay:function(){this.notReplay=!1,cc.global.amObserve="yes",this.play_history=[cc.global.watchReplayData.gameroom].concat(cc.global.watchReplayData.commands.split("=>")),this.replay_bar.active=!0,this.replayStep="ready_room",this.replaySeq=0,this.replayPrevCmd="",this.goReplay()},stopAllClock:function(){this.turntimer.getComponent("TurnTimer").pauseAllTimer()},resumeAllClock:function(){this.turntimer.getComponent("TurnTimer").resumeAllTimer()},pauseReplayTimer:function(){this.stopAllClock(),clearTimeout(this.replayTimer)},resumeReplayTimer:function(){var e=this;this.resumeAllClock(),this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay/cc.global.watchReplayData.replaySpeedX)},onClickReplayTogglePlay:function(){this.btn_replay_play.getComponent(cc.Sprite).enabled?(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer()):this.togglePlayToPause()},togglePlayToPause:function(){this.replayTimer&&clearTimeout(this.replayTimer),this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replay_bar.children[0].opacity=100,this.pauseReplayTimer()},replayPrevMove:function(){this.togglePlayToPause(),6<=this.replaySeq&&(this.replaySeq-=4,this.replayEventProcess(!0))},replayNextMove:function(){this.togglePlayToPause(),this.replayEventProcess(!0)},onClickReplaySpeedUp:function(){var e=this.getLanguageText("REPLAY_TIME");cc.global.watchReplayData.replaySpeedX<5&&(cc.global.watchReplayData.replaySpeedX++,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},onClickReplaySpeedDown:function(){var e=this.getLanguageText("REPLAY_TIME");1<cc.global.watchReplayData.replaySpeedX&&(cc.global.watchReplayData.replaySpeedX--,this.lbl_replaySpeedX.string=e+" : "+cc.global.watchReplayData.replaySpeedX+"x",this.pauseReplayTimer(),this.resumeReplayTimer()),this.btn_replay_play.getComponent(cc.Sprite).enabled&&(this.btn_replay_play.getComponent(cc.Sprite).enabled=!1,this.btn_replay_play.children[0].active=!0,this.replay_bar.children[0].opacity=0,this.pauseReplayTimer(),this.resumeReplayTimer())},cleanAllPlayers:function(){for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].destroy(),this.playerboardlist[e].destroy();this.playerlist.splice(0,this.playerlist.length),this.playerboardlist.splice(0,this.playerboardlist.length),this.playerlist=new Array,this.playerboardlist=new Array,this.selfplayer&&(this.selfplayer.destroyAllChildren(),this.selfplayer.removeAllChildren()),this.opponentplayer&&(this.opponentplayer.destroyAllChildren(),this.opponentplayer.removeAllChildren())},replayEventProcess:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.play_history&&this.play_history[this.replaySeq]){this.replayTimeDelay=0;var t=!1;switch(this.replayStep){case"ready_room":this.joinroom_event(JSON.parse(this.play_history[this.replaySeq]),this),this.replayStep="play";break;case"play":var i=JSON.parse(this.play_history[this.replaySeq]);switch(i.command){case"banker":t=!0,this.banker_event(i,this);break;case"playyut":t=!0,this.playyut_event(i,this);break;case"prebanker":t=!0,this.prebanker_event(i,this);break;case"allcards":t=!0,this.allcards_event(i,this);break;case"callplayer":this.callplayer_event(i,this);break;case"selemoticon":this.emoticon_event(i,this);break;case"sendchat":this.sendchat_event(i,this);break;case"jr":this.joinroom_event(i,this);break;case"players":this.players_event(i,this);break;case"chpre":t=!0,this.chpre_event(i,this)}this.replayPrevCmd=i.command}this.play_history[this.replaySeq+1]&&""!=this.play_history[this.replaySeq+1]?this.replayTimeDelay+=parseInt(this.play_history[this.replaySeq+1])/cc.global.watchReplayData.replaySpeedX:this.replayTimeDelay=0,this.replaySeq+=2,e&&!t&&this.replayEventProcess(!0)}},goReplay:function(){var e=this;this.replayEventProcess(),this.play_history[this.replaySeq]?this.replayTimer=setTimeout(function(){e.goReplay()},this.replayTimeDelay):(this.btn_replay_play.getComponent(cc.Sprite).enabled=!0,this.btn_replay_play.children[0].active=!1,this.replayStep="ready_room",this.replaySeq=0,this.replay_bar.children[0].opacity=100,this.replayTimeDelay=0,this.replayPrevCmd="",this.pauseReplayTimer())},setEtcKeyBoardEvent:function(){var i=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e,t){switch(e){case cc.KEY.space:i.processReadyState();break;case cc.KEY.escape:case cc.KEY.back:if(!i.isemoticon&&!i.ischat)return void i.onclickBack();i.isemoticon&&(null!=i.emoticonpage&&i.emoticonpage.destroy(),i.isemoticon=!1),i.ischat&&(null!=i.chatpage&&i.chatpage.destroy(),i.ischat=!1)}}},i.node)},sendEmoticon:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;e<0||(this.socket().exec("selemoticon",{extparams:{emoticon:e}}),this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1))},onCtrlKeyDown:function(e){e.keycode==cc.KEY.space&&2==this.playerlist.length&&(this.endGameTimer||this.sendState())},processReadyState:function(){2==this.playerlist.length&&(this.endGameTimer||this.sendState())},joinroom_event:function(e,t){cc.global.user.selplayway=e.name,t.roomid=e.id,t.panScore=cc.global.curPlaywayScore=e.score;var i=t.getLanguageText("ROOM_0");switch(t.roomdata.children[0].children[0].getComponent(cc.Label).string=e.id+i,t.roomdata.children[0].children[1].getComponent(cc.Label).string="("+t.numformat(e.score*t.ratio)+"pt)",cc.global.isOffline&&(t.roomdata.children[0].children[0].getComponent(cc.Label).string="",t.roomdata.children[0].children[1].getComponent(cc.Label).string=t.getLanguageText("TRAINING_ROOM_0")),cc.global.gamestatus){case"ready":cc.global.gamestatus="waiting",2==e.playerlist.length&&(cc.global.gamestatus="playing"),t.players_event(e,t);break;case"waiting":t.players_event(e,t);break;case"playing":cc.global.amObserve&&"yes"==cc.global.amObserve?t.players_event(e,t):t.observer_event(e,t)}e.hisdata?t.showMatchCareer(e.hisdata):t.hideMatchCareer(),"yes"==cc.global.amObserve?t.btn_giveup.active=!1:t.btn_giveup.active=!0,t.btn_chat.active=!0,cc.global.isOffline&&(t.btn_giveup.active=!1,t.btn_chat.active=!1),t.closeloadding()},players_event:function(e,t){2==e.playerlist.length?(t.play_status=1,cc.global.gamestatus="playing"):(t.play_status=0,cc.global.gamestatus="waiting");for(var i=!0,a=0;a<e.playerlist.length;a++)if(e.playerlist[a].id==cc.global.user.id){i=!1;break}for(a=0;a<e.observerlist.length;a++)if(e.observerlist[a].id==cc.global.user.id){i=!1;break}if(i&&t.notReplay)return cc.global.outReasonMsg=e.msg,void t.exitPlay();if(t.observer_event(e,t),t.isBoardPlayersChanged(e.playerlist)){if(e.playerlist.length<2){t.dillarpan[1].children[1].active=!1;for(var s=0;s<5;s++)t.konier[1][s].active=!1}else{t.dillarpan[1].children[1].active=!0;for(s=0;s<5;s++)t.konier[1][s].setPosition(t.waiting_pos[1][s]),t.konier[1][s].active=!0}t.startGameTimer&&(clearTimeout(t.startGameTimer),t.startGameTimer=null),t.endGameTimer&&(clearTimeout(t.endGameTimer),t.endGameTimer=null),t.players_engine(e,t)}},players_engine:function(e){this.removeBoardPlayers(e.playerlist);for(var t=this.posBaseIdx,i=0;i<e.playerlist.length;i++){if(e.playerlist[i].seatid=i,"no"==cc.global.amObserve&&e.playerlist[i].id!=cc.global.user.id&&(t=1-this.posBaseIdx),this.playerexist(e.playerlist[i])){var a=this.getPlayer(e.playerlist[i].id),s=this.getPlayerBoard(e.playerlist[i].id),r=a.seatid;if(a.init(this,e.playerlist[i],t%2,i),s.init(this,e.playerlist[i],t%2,i),a.seatid=s.seatid=t%2,a.layoutForSeat(),s.layoutForSeat(),1==e.playerlist.length&&"yes"==cc.global.amObserve&&1==r){a.winorlose.x=120,a.callplayer.scaleX=-1,a.callplayer.children[0].scaleX=-1,a.userinformationpan.x=-70,a.userinformationpan.anchorX=1,a.goldcoin_base.anchorX=1,a.nickname.node.anchorX=1,a.banker.x=55,a.winorlose.x=-260;for(var n=0;n<5;n++)this.konier[1][n].setPosition(this.waiting_pos[1][n]),this.konier[1][n].active=!0,this.konier[0][n].setPosition(this.waiting_pos[0][n]),this.konier[0][n].active=!1}}else{var o=cc.instantiate(this.yut_player);"yes"!=cc.global.amObserve?e.playerlist[i].id==cc.global.user.id?o.parent=this.selfplayer:o.parent=this.opponentplayer:o.parent=t%2==0?this.selfplayer:this.opponentplayer,o.getComponent("Yutplayer").init(this,e.playerlist[i],t%2,i),o.zIndex=1e3,this.playerlist.push(o);var l=cc.instantiate(this.yut_player_board);l.parent=this.statusboard,l.setPosition(this.playerBoardSlotPos[t%2]),l.getComponent("YutplayerBoard").init(this,e.playerlist[i],t%2,i),this.playerboardlist.push(l);var c=e.playerlist[i].seatid;this.dillarpan[c].children[1].active=!1,isNaN(o.getComponent("Yutplayer").userdata.playcharacter)?this.dillarpan[c].children[1].getComponent(cc.Sprite).spriteFrame=this.dillar2_tile.getSpriteFrame("c1"):(this.dillarpan[c].children[1].active=!0,this.boygirlidx[c]=o.getComponent("Yutplayer").userdata.playcharacter%2,o.getComponent("Yutplayer").userdata.playcharacter%2==0?this.dillarpan[c].children[1].getComponent(cc.Sprite).spriteFrame=this.dillar2_tile.getSpriteFrame("c1"):this.dillarpan[c].children[1].getComponent(cc.Sprite).spriteFrame=this.dillar1_tile.getSpriteFrame("c1"))}t++}1==e.playerlist.length?(this.setWaitingState(),this.cleanAfterAllCards(),this.hideMatchCareer()):2==e.playerlist.length&&this.setReadyState(),"yes"==cc.global.amObserve&&e.playerlist.length<2?1==cc.global.championMode?this.btn_enter.active=!1:0==cc.global.championMode&&this.notReplay&&(this.btn_enter.active=!0):this.btn_enter.active=!1,this.showWaitingTimer()},setWaitingState:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("YutplayerBoard");t&&t.setState("Pending")}},setReadyState:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("YutplayerBoard");if(t){var i=this.getLanguageText("READY_0")+"?",a=this.getLanguageText("PREPARED_0");1==cc.global.curPlaywayScore&&parseInt(t.userdata.id)<=0?t.setState(a):t.setState(i)}}},observer_event:function(e,t){t.observerbench.destroyAllChildren(),t.observerlist=new Array;for(var i=0;i<e.observerlist.length;i++){var a=cc.instantiate(t.observer);a.getComponent("Observer").init(e.observerlist[i],t),a.getComponent("Observer").nickname.node.active=!1,a.parent=t.observerbench,t.observerlist[i]=a}},removeBoardPlayers:function(e){for(var t=0;t<this.playerlist.length;t++){for(var i=this.playerlist[t].getComponent("Yutplayer"),a=!1,s=0;s<e.length;s++)if(i.userdata.id==e[s].id){a=!0;break}1!=a&&(this.playerlist[t].destroy(),this.playerlist.splice(t,1),this.playerboardlist[t].destroy(),this.playerboardlist.splice(t,1))}},isBoardPlayersChanged:function(e){if(0==this.playerlist.length&&0!=e.length)return!0;if(this.playerlist.length!=e.length)return!0;for(var t=0;t<e.length;t++)if(!this.getPlayer(e[t].id))return!0;return!1},playerexist:function(e){for(var t=0;t<this.playerlist.length;t++)if(null!=this.playerlist[t]&&this.playerlist[t].getComponent("Yutplayer").userdata.id==e.id)return!0;return!1},initGameboard:function(){this.closeloadding()},changeTurn:function(e){if(0!=this.isGamePlaying){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];0==(this.turnSeat=e)?t&&this.giveTurn1(this.yut_timer):1==e&&t&&this.giveTurn2(this.yut_timer)}},showMatchCareer:function(e){},hideMatchCareer:function(){},sendState:function(){if(1==cc.global.curPlaywayScore&&cc.global.isOffline){var e=this.getPlayerBoard(cc.global.user.id);e&&e.setState("Ready");var t={command:"prebanker",event:"command",userid:cc.global.user.id,msg:60,extmsg:c.hole,ratio:1,status:"playing"};this.prebanker_event(t,this)}else this.getPlayerBoard(cc.global.user.id).isReady()||this.socket().exec("ready",{extparams:{roomid:this.roomid}})},userready_event:function(e,t){cc.global.audio.playEffectAud("ready");var i=t.getPlayerBoard(e.userid);if(i){var a=t.getLanguageText("PREPARED_0");i.setState(a),i.startTimer(30)}},prebanker_event:function(e,t){var i;if(cc.global.isOffline&&c.init(),t.stopTurnTimerAll(),t.closeConfirm(),t.hideAllStatus(),t.initGameboard(!0),t.isGamePlaying=!0,t.isNewRoom=!1,t.yut_timer=30,t.sendFlag=!1,e.msg&&!isNaN(e.msg)&&(t.yut_timer=parseInt(e.msg)),t.hole=0,t.nexttype="b",e.extdata?(t.showHand(!1),t.yutresult=parseInt(e.extdata.yutresult),t.showResult(!0),e.extdata.timer&&!isNaN(e.extdata.timer)&&(t.yut_timer=parseInt(e.extdata.timer)),i=t.getOtherPlayer(e.userid),t.changeTurnTimer=setTimeout(function(){t.prebanker_tmp(i.seatid)},1200)):(e.extmsg&&!isNaN(e.extmsg)&&(t.hole=parseInt(e.extmsg)),t.hole29.active=1==t.hole||3==t.hole,t.hole19.active=2==t.hole||3==t.hole,i=t.getPlayer(e.userid),t.changeTurn(i.seatid,!0),t.showHand(!0)),t.label_prebanker.node.active=!0,0==t.isprebanker){t.isprebanker=1;for(var a=0;a<2;a++)for(var s=0;s<5;s++)t.konier[a][s].setPosition(t.waiting_pos[a][s]),t.konier[a][s].active=!0}},prebanker_tmp:function(e){"b"==this.nexttype&&(this.changeTurn(e,!0),this.showResult(!1),this.showHand(!0))},banker_event:function(a,s){s.stopTurnTimerAll(),s.sendFlag=!1,s.yutqueue=[],s.nexttype="y",s.ratio=1,s.changeTurnTimer=setTimeout(function(){s.label_prebanker.node.active=!1,s.closeConfirm(),s.hideAllStatus(),s.initGameboard(!0),s.isend=0,s.isGamePlaying=!0,s.isNewRoom=!1,s.yut_timer=30,s.cntmovekonitmp=0,s.cntmovekoni=0,a.timer&&!isNaN(a.timer)&&(s.yut_timer=parseInt(a.timer));for(var e=s.getPlayer(a.banker),t=0;t<s.playerlist.length;t++)s.playerlist[t].getComponent("Yutplayer").hideBanker();e&&(e.showBanker(),0==e.seatid?(s.turnSeat=0,s.giveTurn1(s.yut_timer)):(s.turnSeat=1,s.giveTurn2(s.yut_timer)));for(t=0;t<2;t++)for(var i=0;i<5;i++)s.konier[t][i].setPosition(s.waiting_pos[t][i]),s.konier[t][i].getComponent("YutPiece").currentIdx=-1,s.konier[t][i].active=!0;s.isprebanker=0,s.listbox.removeAllChildren(),s.listbox1.removeAllChildren(),s.showResult(!1),s.showHand(!0),s.koni_zindex=0},1500)},playyut_event:function(e,t){if(t.sendFlag=!0,t.isend=0,t.yutqueue=[],cc.global.isOffline||!t.notReplay||parseInt(t.roomid)==parseInt(e.room_id)){t.lblTurnCount&&e.extdata&&e.extdata.turncount&&(t.lblTurnCount.string=Math.round(parseInt(e.extdata.turncount)/2)+"Turn",t.turnCount.local=parseInt(e.extdata.turncount));var i;(i=parseInt(e.extdata.ratio))>t.ratio&&t.check_betup(i,t),t.listbox_yuts.active=!1,t.closeConfirm(),t.stopTurnTimerAll();var a=t.getPlayer(e.userid),s=t.getPlayer(e.extdata.next);if(t.yut_timer=20,e.extdata.timer&&!isNaN(e.extdata.timer)&&(t.yut_timer=parseInt(e.extdata.timer)),t.nexttype=e.extdata.nexttype,a){e.extdata.passcount&&a.updatePassCount(e.extdata.passcount);for(var r=0,n=0;n<2;n++){var o=0;0!=t.getPlayer(e.extdata.board[n].playuser).seatid&&(o=1);for(var l=0;l<5;l++){30==(d=parseInt(e.extdata.board[n].koni[l]))?d=100:d--,t.konier[o][l].getComponent("YutPiece").currentIdx!=t.saveidx[o][l]&&(r=1),t.saveidx[o][l]=d}}if("y"==e.extdata.type)t.yutresult=parseInt(e.extdata.yutresult),t.showHand(!1),t.showResult(!0),"y"==e.extdata.nexttype?t.changeTurnTimer=setTimeout(function(){t.yutresult=parseInt(e.extdata.yutresult),t.changeTurn(s.seatid,!0),t.showResult(!1),t.showHand(!t.isend),parseInt(e.userid)!=parseInt(e.extdata.next)&&(t.listbox.removeAllChildren(),t.listbox1.removeAllChildren())},1e3):t.changeTurnTimer=setTimeout(function(){if(0==s.seatid){for(var e=0;e<t.listbox.childrenCount;e++)t.yutqueue.push(t.listbox.children[e].getComponent("Yutbtn").val);t.fun_checkpos(),t.changeTurn(s.seatid,!0)}else t.changeTurn(s.seatid,!0)},1e3);else if("m"==e.extdata.type){var c=parseInt(e.extdata.yutresult);if(0==r)if(0==t.cntmovekoni&&0==t.cntmovekonitmp)for(n=0;n<2;n++){o=0;var h=0;0!=t.getPlayer(e.extdata.board[n].playuser).seatid&&(o=1),e.userid!=e.extdata.board[n].playuser&&(h=1);for(l=0;l<5;l++){var d;30==(d=parseInt(e.extdata.board[n].koni[l]))?d=100:d--,d!=t.konier[o][l].getComponent("YutPiece").currentIdx&&(t.cntmovekoni++,t.koni_zindex++,t.konier[o][l].setLocalZOrder(t.koni_zindex),t.move_Piece1(o,l,t.konier[o][l].getComponent("YutPiece").currentIdx,d,c,h))}}else t.cntmovekoni=0,t.cntmovekonitmp=0,t.fun_exception(c);else t.fun_exception(c);var u=500;0==r&&(u=200*Math.abs(c)+500),"y"==e.extdata.nexttype?t.changeTurnTimer=setTimeout(function(){t.changeTurn(s.seatid,!0),t.showResult(!1),t.showHand(!t.isend),parseInt(e.userid)!=parseInt(e.extdata.next)&&(t.listbox.removeAllChildren(),t.listbox1.removeAllChildren())},u):t.changeTurnTimer=setTimeout(function(){t.changeTurn(s.seatid,!0),t.showResult(!1),t.showHand(!1)},u)}}t.showBoardClaim(e.extdata.type);var p="";switch(e.extdata.type){case"n":break;case"p":p="pass"}""!=p&&a.speech(p)}},stopTurnTimerAll:function(){this.turntimer&&this.turntimer.getComponent("TurnTimer")&&this.turntimer.getComponent("TurnTimer").stopAllTimer()},showBoardClaim:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";switch(e){case"n":break;case"p":"pass";break;case"w":"win";break;case"l":"defeat";break;case"d":"draw"}if("CH"==cc.global.curLanguage?"_ch":"RU"==cc.global.curLanguage?"_ru":"_en",this.boardclaim)if(this.boardclaim.node.children[0].active=!1,"tech"==t&&(this.boardclaim.node.children[0].active=!0,this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string={l:"Lose",w:"Victory"}[e]),"w"==e)this.runFinishAction("dzz_cj_win");else if("l"==e)this.runFinishAction("dzz_cj_lose");else if("p"==e){this.boardclaim.node.children[0].active=!0;var i=this.getLanguageText("PASS_0");this.boardclaim.node.children[0].children[0].getComponent(cc.Label).string=i,this.boardclaim.getComponent(cc.Animation).play()}},runFinishAction:function(e){if("yes"!=cc.global.amObserve&&this.finishAct&&this.finishAct.getComponent(sp.Skeleton)){var t=cc.callFunc(this.enableFinishAni,this,e),i=cc.callFunc(this.disableFinishAni,this);this.node.runAction(cc.sequence(t,cc.delayTime(3),i))}},enableFinishAni:function(e,t){if(this.finishAct){var i=this.finishAct.getComponent(sp.Skeleton);i&&(this.finishAct.active=!0,i.animation=t)}},disableFinishAni:function(e){this.finishAct&&(this.finishAct.active=!1)},recovery_event:function(e,t){t.isGamePlaying=!0,t.cntmovekonitmp=0,t.cntmovekoni=0,t.hideAllStatus(),t.yut_timer=20,e.timer&&!isNaN(e.timer)&&(t.yut_timer=parseInt(e.timer)),e.hole&&!isNaN(e.hole)&&(t.hole=parseInt(e.hole)),t.hole29.active=1==t.hole||3==t.hole,t.hole19.active=2==t.hole||3==t.hole,e.userid&&t.setTurn(e.userid,t.yut_timer),e.banker?(t.getPlayer(e.banker).showBanker(),0==parseInt(e.yutTurn)?(t.showHand(!0),t.nexttype="y"):1==parseInt(e.yutTurn)&&(t.showHand(!1),t.nexttype="m",t.getPlayer(e.userid).seatid)):1==t.isGamePlaying&&(t.label_prebanker.node.active=!0,t.nexttype="b",t.showHand(!0)),t.lblTurnCount&&e.count&&(t.lblTurnCount.string=Math.round(parseInt(e.count)/2)+"Turn",t.turnCount.local=parseInt(e.count),t.turnCount.server=parseInt(e.count));for(var i=0;i<e.players.length;i++){var a=t.getPlayer(e.players[i].playuser);a&&e.players[i].pass&&a.updatePassCount(e.players[i].pass);var s=0;0!=a.seatid&&(s=1);var r=0;if(0<e.players[i].yutes.length)for(var n=0;n<e.players[i].yutes.length;n++){var o=cc.instantiate(t.yutbtn);o.getComponent("Yutbtn").init(t.listbox.childrenCount,parseInt(e.players[i].yutes[n]),0,t),o.getComponent("Yutbtn").setImg(parseInt(e.players[i].yutes[n]),-1),0==a.seatid?o.parent=t.listbox:o.parent=t.listbox1}for(n=0;n<5;n++){if(30==(h=parseInt(e.players[i].koni[n]))){h=100;for(var l=0,c=0;c<5;c++)100==t.konier[s][c].getComponent("YutPiece").currentIdx&&l++;t.konier[s][n].setPosition(t.out_pos[s][l])}else h--;t.saveidx[s][n]=h,t.konier[s][n].getComponent("YutPiece").currentIdx=h}for(n=4;0<=n;n--){var h=parseInt(e.players[i].koni[n]);-1==--h&&(t.konier[s][n].setPosition(t.waiting_pos[s][4-r]),r++)}}if(1==parseInt(e.yutTurn)&&0==t.getPlayer(e.userid).seatid){for(i=0;i<t.listbox.childrenCount;i++)t.yutqueue.push(t.listbox.children[i].getComponent("Yutbtn").val);t.yutresult=t.yutqueue[0],t.fun_checkpos()}if(t.set_multikoni(),e.ratio){var d=parseInt(e.ratio);1<d&&t.check_betup(d,t)}},setPanInfo:function(e,t){this.getPlayer(e[0].playuser)},setTurn:function(e,t){var i=this.getPlayer(e);i&&(this.turnSeat=i.seatid),this.stopTurnTimerAll(),0==this.turnSeat?this.giveTurn1(t):1==this.turnSeat&&this.giveTurn2(t)},giveTurn1:function(e){this.sendFlag=!1,this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer1(e),this.togglePcsTurn(0))},giveTurn2:function(e){var t=this;if(cc.global.isOffline)if("y"==this.nexttype){var i={type:"y",roomid:this.roomid,testyut:0,localturn:this.turnCount.local};(a=this).scheduleOnce(function(){t.play_offline(i,0)},1)}else if("m"==this.nexttype){var a;i=c.play_trainer();(a=this).scheduleOnce(function(){a.play_offline(i,0)},1)}this.turntimer&&(this.turntimer.getComponent("TurnTimer").turnTimer2(e),this.togglePcsTurn(1))},togglePcsTurn:function(e){},hideAllStatus:function(){if(this.playerboardlist)for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("YutplayerBoard");t&&t.hideStatus()}},multiBetUp:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("Yutplayer");i&&i.betup.getComponent("TetrisBetUp").init(e,i.seatid)}},workOutMatchCareer:function(e){for(var t=0;t<e.players.length;t++){var i=this.getPlayer(e.players[t].userid),a=this.getPlayerBoard(e.players[t].userid);i&&a&&("normal"==cc.global.user.selplayway?0<e.players[t].score&&(this.matchCareerData.tgolds[i.userdata.id]+=e.players[t].score-this.pangolds/2):"diamond"==cc.global.user.selplayway&&0<e.players[t].score&&(this.matchCareerData.tdiamonds[i.userdata.id]+=e.players[t].score-this.pangolds/2),2==e.players[t].win&&(this.matchCareerData.wins[i.userdata.id]++,i.userdata.id))}this.showMatchCareer(this.matchCareerData)},allcards_event:function(i,a){for(var e=0;e<i.players.length;e++)i.players[e].userid==cc.global.user.id&&a.notReplay&&(cc.global.user.goldcoins=i.players[e].gold);a.isend=1,clearTimeout(a.changeTurnTimer),a.otherEventCache=[],a.isGamePlaying=!1,a.stopTurnTimerAll(),a.matchCareerData&&a.workOutMatchCareer(i);var s=!0;a.playerlist&&i.players&&(s=a.playerlist.length==i.players.length);for(e=0;e<i.players.length;e++){var t=a.getPlayer(i.players[e].userid);i.players[e].getout&&(s=!1),a.getPlayerBoard(i.players[e].userid)&&("suicide"!=i.title||i.players[e].win||(t=a.getPlayer(i.players[e].userid))&&t.showEmoticon(-1))}a.showHand(!1),a.showResult(!1),setTimeout(function(){for(var e=0;e<i.players.length;e++){var t=a.getPlayer(i.players[e].userid);if(t&&("normal"==cc.global.user.selplayway&&(t.userdata.goldcoins=parseInt(i.players[e].gold)),cc.global.isOffline||t.summary(i.players[e])),i.players[e].userid==cc.global.user.id)switch(i.players[e].win){case 0:a.showBoardClaim("l",i.title);break;case 1:a.showBoardClaim("d",i.title);break;case 2:a.showBoardClaim("w",i.title)}}if(a.listbox_yuts&&(a.listbox_yuts.active=!1),a.listbox&&a.listbox.removeAllChildren(),a.listbox1&&a.listbox1.removeAllChildren(),a.label_prebanker&&(a.label_prebanker.node.active=!1),a.konier)for(e=0;e<5;e++)a.konier[0][e].getComponent("YutPiece").showanimation(0);s&&a.boardclaim?a.endGameTimer=setTimeout(function(){if(a.boardclaim){a.endGameTimer=null,a.boardclaim.getComponent(cc.Animation).stop(),a.boardclaim.node.setScale(0,0),a.cleanAfterAllCards();for(var e=0;e<2;e++)for(var t=0;t<5;t++)a.konier[e][t].setPosition(a.waiting_pos[e][t]),a.konier[e][t].active=!0,a.konier[e][t].getComponent("YutPiece").currentIdx=-1;for(e=0;e<2;e++)for(t=0;t<5;t++)a.konier[e][t].active=!0;a.setReadyState()}},5e3):a.konier&&setTimeout(function(){if(a.konier){for(var e=0;e<2;e++)for(var t=0;t<5;t++)a.konier[e][t].setPosition(a.waiting_pos[e][t]),a.konier[e][t].getComponent("YutPiece").currentIdx=-1,1==e&&(a.konier[e][t].active=2==a.playerlist.length);a.dillarpan[1].children[1].active=2==a.playerlist.length,a.dillarpan[0].children[1].active=!0,a.ratio=1;var i=a.panScore;cc.global.isOffline||(a.roomdata.children[0].children[1].getComponent(cc.Label).string="("+a.numformat(i)+"pt)")}},3e3)},1e3)},cleanAfterAllCards:function(){this.pangolds=0,cc.global.amObserve&&"no"==cc.global.amObserve&&this.showWaitingTimer();for(var e=0;e<this.playerlist.length;e++)this.playerlist[e].getComponent("Yutplayer").hideBanker(),this.playerlist[e].getComponent("Yutplayer").updatePassCount(0);this.lblTurnCount&&(this.lblTurnCount.string="",this.turnCount.local=0,this.turnCount.server=0),this.isprebanker=0,this.ratio=1;var t=this.panScore;cc.global.isOffline||(this.roomdata.children[0].children[1].getComponent(cc.Label).string="("+this.numformat(t)+"pt)")},updateBetUpBalance:function(e){for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("Yutplayer");i&&(i.userdata.goldcoins-=e)}this.updatePlayerBalance()},updatePlayerBalance:function(){for(var e=0;e<this.playerlist.length;e++){var t=this.playerlist[e].getComponent("Yutplayer");t&&t.updateBalance()}},showWaitingTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("YutplayerBoard");t&&t.startTimer(30)}},showReadyTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("YutplayerBoard");t&&t.startTimer(3)}},hideTimer:function(){for(var e=0;e<this.playerboardlist.length;e++){var t=this.playerboardlist[e].getComponent("YutplayerBoard");t&&t.stopTimer()}},getPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("Yutplayer");if(i.userdata.id==e)return i}},getOtherPlayer:function(e){if(this.playerlist)for(var t=0;t<this.playerlist.length;t++){var i=this.playerlist[t].getComponent("Yutplayer");if(i.userdata.id!=e)return i}},getPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("YutplayerBoard");if(i.userdata.id==e)return i}},getOtherPlayerBoard:function(e){if(this.playerboardlist)for(var t=0;t<this.playerboardlist.length;t++){var i=this.playerboardlist[t].getComponent("YutplayerBoard");if(i.userdata.id!=e)return i}},getObserver:function(e){if(this&&this.observerlist)for(var t=0;t<this.observerlist.length;t++){var i=this.observerlist[t].getComponent("Observer");if(i&&i.data.id==e)return i}},onClickGiveUp:function(){if(this.isGamePlaying){if(this.turnSeat)return void this.alert("No Your Turn.");var e=this;cc.global.audio.playVoiceSpeech("support/12_give_up");var t=this.getLanguageText("ARE_YOU_GIVE_UP");this.checkConfirm(t,function(){e&&e.socket().exec("suicide",{})},null)}},onClickSfx:function(){if(this.btnSfx){var e=this.btnSfx,t=JSON.parse(cc.sys.localStorage.getItem("sfx_on1"));null==t&&(t=!0),t?(cc.global.audio.pauseAll(),e.children[0].active=!1,e.children[1].active=!0):(cc.global.audio.resumeAll(),e.children[0].active=!0,e.children[1].active=!1),cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!t))}},showChatSearch:function(){},showChatDialog:function(){this.onclickChat(0)},onclickChat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(this.notReplay){if(this.isemoticon&&(this.emoticonpage.destroy(),this.isemoticon=!1),this.ischat){if(0<=t){var i=this.chatpage.getComponent("Chat").content.children[t];i&&i.getComponent("ChatItem").onClickMessage()}return this.chatpage.destroy(),void(this.ischat=!1)}if(!(e<0)){this.chatpage=cc.instantiate(this.chat),this.chatpage.parent=this.root();var a=this.chatpage.getComponent("Chat");a.init(this,e),a.base.x=a.base.y=0,this.ischat=!0}}},onClickEmoticon:function(){if(this.notReplay){if(this.ischat&&(this.chatpage.destroy(),this.ischat=!1),this.isemoticon)return this.emoticonpage.destroy(),this.isemoticon=!1;this.emoticonpage=cc.instantiate(this.emodlg),this.emoticonpage.parent=this.root();var e=this.emoticonpage.getComponent("Emoticon");e.init(this,!1),e.base.x=e.base.y=0,this.isemoticon=!0}},sendchat_event:function(e,t){var i=cc.global.chat[parseInt(e.msg)].phrase,a=t.getPlayer(e.userid);a&&a.showCallPlayer(i,e.msg);var s=t.getObserver(e.userid);s&&s.showCallPlayer(i,e.msg)},callplayer_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showCallPlayer(e.msg);var a=t.getObserver(e.userid);a&&a.showCallPlayer(e.msg,!1)},emoticon_event:function(e,t){var i=t.getPlayer(e.userid);i&&i.showEmoticon(e.msg);var a=t.getObserver(e.userid);a&&a.showEmoticon(e.msg)},missiondone_event:function(e,t){for(var i=0;i<cc.global.missions.length;i++)if(cc.global.missions[i].id==e.extdata.mission.id){cc.global.missions[i].done=!0,cc.global.missions[i].current=e.extdata.mission.current,cc.global.missions[i].new=!0;var a=cc.instantiate(t.msndone);a.getComponent("MissionDone").init(e.extdata.mission),a.parent=t.msndonelist;break}},onClickFindEmptyRoom:function(){},onClickJoinMatch:function(){cc.global.user.goldcoins>cc.global.curPlaywayScore?(cc.global.enter_observer_room=!0,this.onclickBack(),this.btn_enter&&(this.btn_enter.active=!1)):this.alert("Not Enough Coin.")},onClickChangePiece:function(){1==this.tgpcsbtn.children[0].active&&(this.tgpcsbtn.children[0].active=!1,this.tgpcsbtn.children[1].active=!0,this.togglePieceMode(!0)),1==this.tgpcsbtn.children[1].active&&(this.tgpcsbtn.children[0].active=!0,this.tgpcsbtn.children[1].active=!1,this.togglePieceMode(!1))},onclickBack:function(){if(1!=cc.global.curPlaywayScore){var e=this;if(this.notReplay)if(this.isGamePlaying&&"no"==cc.global.amObserve){if(this.turnSeat)return void this.alert("No your turn.");cc.global.audio.playVoiceSpeech("support/14_roomout"),this.checkConfirm("Are you sure to leave room? You will lose.",function(){e.socket().exec("leave",{})},null)}else this.socket().exec("leave",{});else this.exitPlay()}else this.exitPlay()},exitPlay:function(){var e=this;cc.global.watchReplayData.matchid=-1,cc.global.watchReplayData.onReplay=!1,cc.global.watchReplayData.replaySpeedX=1,cc.global.watchReplayData.gameroom={},cc.global.watchReplayData.commands={},this.replayTimer&&clearTimeout(this.replayTimer),null==this.exitTimer&&(this.exitTimer=setInterval(function(){e.finishAct&&!e.finishAct.active&&(e.returnToHall(),clearInterval(e.exitTimer),e.exitTimer=null)},500))},returnToHall:function(){this.loadding(),clearInterval(this.otherEventInvoker),cc.global.user.roomNo="",cc.global.user.roomInType="",cc.global.gamestatus="ready",cc.global.user.roomid="",cc.global.backToHall=!0,this.startGameTimer&&clearTimeout(this.startGameTimer),this.endGameTimer&&clearTimeout(this.endGameTimer),this.hideTimer(),this.cleanAllPlayers(),this.scene("hall",this)},chpre_event:function(e,t){t.closeOpenWin(),cc.global.openwin=cc.instantiate(t.roomrankdialog),cc.global.openwin.getComponent("RoomRankDialog").init(e.extdata),cc.global.openwin.parent=t.root(),t.notReplay||setTimeout(function(){null!=cc.global.openwin&&(cc.global.openwin.children[0].active=!1)},500)},on_clickHand:function(){if(1!=this.sendFlag&&"yes"!=cc.global.amObserve&&1!=this.isshowresult)if("b"!=this.nexttype||0!=this.turnSeat){if(1!=this.turnSeat&&"y"==this.nexttype){if(cc.sys.localStorage.setItem("tutorial_yut_shake",!0),cc.global.isOffline){e={type:"y",roomid:this.roomid,localturn:this.turnCount.local};return this.play_offline(e,cc.global.user.id),void(this.sendFlag=!0)}this.socket().exec("playyut",{extparams:{type:"y",roomid:this.roomid,localturn:this.turnCount.local}}),this.sendFlag=!0}}else{if(cc.global.isOffline){var e={roomid:this.roomid};return this.prebanker_offline(e,cc.global.user.id),void(this.sendFlag=!0)}this.socket().exec("prebanker",{extparams:{roomid:this.roomid}})}},on_clickPiece:function(e){this.listbox_yuts.active=!1;for(var t=0;t<10;t++)this.listbox_yuts.children[1].children[t].active=!1;if("yes"!=cc.global.amObserve&&1!=this.turnSeat&&"m"==this.nexttype&&1!=this.sendFlag){this.showHand(!1);for(t=0;t<5;t++)this.konier[0][t].children[1].children[0].active=!1;if(1<this.yutqueue.length){var i=0;for(t=0;t<this.yutqueue.length;t++){var a=this.yutqueue[t];this.cango(this.konier[0][e].getComponent("YutPiece").currentIdx,a)&&(this.listbox_yuts.children[1].children[i].getComponent("Yutbtn").setImg(a,e),i++)}if(0<i){this.listbox_yuts.active=!0;var s=this.konier[0][e].getPosition(),r=s.x,n=s.y+80;r<0?(this.listbox_yuts.anchorX=0,r+=20):(this.listbox_yuts.anchorX=1,r-=20),this.listbox_yuts.setPosition(r,n),this.listbox_yuts.scaleX=0,this.listbox_yuts.runAction(cc.scaleTo(.1,1));for(t=0;t<i;t++){a=this.yutqueue[t];this.listbox_yuts.children[1].children[t].active=!0}null==cc.sys.localStorage.getItem("tutorial_yut_btns")&&"no"==cc.global.amObserve&&this.notReplay?this.listbox_yuts.children[2].children[0].active=!0:this.listbox_yuts.children[2].children[0].active=!1}}else{if(cc.global.isOffline){var o={type:"m",id:e,yut:this.yutresult,roomid:this.roomid,localturn:this.turnCount.local};return this.play_offline(o,cc.global.user.id),void(this.sendFlag=!0)}this.socket().exec("playyut",{extparams:{type:"m",id:e,yut:this.yutresult,roomid:this.roomid,localturn:this.turnCount.local}}),this.sendFlag=!0}}},showHand:function(e){if(this.dillar&&this.dillar.children&&this.dillar.children[0]&&this.dillar.children[1]){if(!this.isGamePlaying)return this.dillar.active=!1,this.dillarpan[1].children[1].active=2==this.playerlist.length,void(this.dillarpan[0].children[1].active=!0);if(1==e){cc.global.audio.playEffectAud("shuffle"),this.dillar.active=!0,this.yutbars.active=!1;var t=this.isshowresult=0;if(this.dillar.children[0].children[0].active=!1,this.dillar.children[1].children[0].active=!1,1==this.turnSeat)t=1,this.dillarpan[1].children[1].active=!1,this.dillarpan[0].children[1].active=!0;else this.dillarpan[0].children[1].active=!1,this.dillarpan[1].children[1].active=!0,null==cc.sys.localStorage.getItem("tutorial_yut_shake")&&"no"==cc.global.amObserve&&this.notReplay?this.dillar.children[(this.boygirlidx[0]+1)%2].children[0].active=!0:this.dillar.children[(this.boygirlidx[0]+1)%2].children[0].active=!1;this.dillar.parent=this.dillarpan[t],this.dillar.setPosition(0,0),this.dillar.children[0].x=0,this.dillar.children[this.boygirlidx[t]].active=!1,this.dillar.children[(this.boygirlidx[t]+1)%2].active=!0,0==this.boygirlidx[t]?this.dillar.children[1].getComponent(cc.Animation).play("dillar2_shake"):this.dillar.children[0].getComponent(cc.Animation).play("dillar1_shake")}else this.dillar.children[0].getComponent(cc.Animation).stop(),this.dillar.children[1].getComponent(cc.Animation).stop(),this.dillar.active=!1}},showResult:function(e){var t=this;if(this.dillar&&this.dillar.children&&this.dillar.children[0]&&this.dillar.children[1]){if(!this.isGamePlaying)return this.isshowresult=0,this.dillar.children[0].getComponent(cc.Animation).stop(),this.dillar.children[1].getComponent(cc.Animation).stop(),this.dillar.active=!1,this.yutbars.active=!1,this.dillarpan[1].children[1].active=2==this.playerlist.length,void(this.dillarpan[0].children[1].active=!0);if(e){this.isshowresult=1,this.dillar.active=!0,this.yutbars.active=!1;var i=0;1==this.turnSeat?(i=1,this.dillarpan[1].children[1].active=!1,this.dillarpan[0].children[1].active=!0):(this.dillarpan[0].children[1].active=!1,this.dillarpan[1].children[1].active=!0),this.dillar.parent=this.dillarpan[i],this.dillar.setPosition(0,0),this.yutbars.parent=this.dillarpan[i],this.yutbars.setPosition(0,0),this.dillar.children[0].x=0,this.dillar.children[this.boygirlidx[i]].active=!1,this.dillar.children[(this.boygirlidx[i]+1)%2].active=!0,0==this.boygirlidx[i]?this.dillar.children[1].getComponent(cc.Animation).play("dillar2_throw"):this.dillar.children[0].getComponent(cc.Animation).play("dillar1_throw");var a=this,s=cc.sequence(cc.delayTime(.52),cc.callFunc(function(){a.yutbars.active=!0,a.fun_simulationYut(a.yutresult),t.dillar.active=!1;var e=cc.sequence(cc.delayTime(.2),cc.callFunc(function(){var e=cc.instantiate(a.yutbtn);e.getComponent("Yutbtn").init(a.listbox.childrenCount,a.yutresult,0,a),e.getComponent("Yutbtn").setImg(a.yutresult,-1),0==a.turnSeat?e.parent=a.listbox:e.parent=a.listbox1}));a.node.runAction(e)},this));this.node.runAction(s)}else this.isshowresult=0,this.dillar.children[0].getComponent(cc.Animation).stop(),this.dillar.children[1].getComponent(cc.Animation).stop(),this.dillarpan[0].children[1].active=!0,this.dillarpan[1].children[1].active=!0,this.dillar.active=!1,this.yutbars.active=!1}},on_clickyutbtn:function(e,t){if(this.listbox_yuts.active=!1,cc.global.isOffline){var i={type:"m",id:t,yut:this.yutresult,roomid:this.roomid,localturn:this.turnCount.local};return this.play_offline(i,cc.global.user.id),void(this.sendFlag=!0)}this.socket().exec("playyut",{extparams:{type:"m",id:t,yut:this.yutresult,roomid:this.roomid,localturn:this.turnCount.local}})},fun_checkpos:function(){for(var e=0;e<5;e++)this.konier[0][e].getComponent("YutPiece").showanimation(0);var t=0;for(e=0;e<5;e++){var i=this.konier[0][e].getComponent("YutPiece").currentIdx;if(100!=i){if(-1==i){if(0!=t)continue;t=1}for(var a=0;a<this.yutqueue.length;a++)if(this.cango(i,this.yutqueue[a])){null==cc.sys.localStorage.getItem("tutorial_yut_konimove")&&"no"==cc.global.amObserve&&this.notReplay?this.konier[0][e].children[1].children[0].active=!0:this.konier[0][e].children[1].children[0].active=!1,this.konier[0][e].getComponent("YutPiece").showanimation(1);break}}}},cango:function(e,t){return-1==e?0<t:-1!=this.indexPos[e][t]},move_Piece1:function(e,t,i,a,s,r){for(var n=0;n<5;n++)this.konier[0][n].getComponent("YutPiece").showanimation(0),this.konier[0][n].children[1].children[0].active=!1;this.cal_path(e,t,i,a,s,r);var o=[],l=this.konier[e][t].getComponent("YutPiece").currentIdx;if(-1==a||this.konier[e][t].getComponent("YutPiece").queuemove.length==Math.abs(s)){for(n=0;n<this.konier[e][t].getComponent("YutPiece").queuemove.length;n++){var c,h,d,u,p=this.konier[e][t].getComponent("YutPiece").queuemove[n];if(-1==p){cc.global.audio.playEffectAud("ready");for(var g=0,m=0;m<5;m++)-1==this.konier[e][m].getComponent("YutPiece").currentIdx&&g++;d=this.waiting_pos[e][4-g].x,u=this.waiting_pos[e][4-g].y,this.konier[e][t].getComponent("YutPiece").currentIdx=-1,o.push(cc.moveTo(.2,d,u));break}if(-1==l)c=this.konier[e][t].x,h=this.konier[e][t].y;else{if(l<0||28<l)return void this.fun_exception(s);c=this.board_pos[l].x,h=this.board_pos[l].y}if(100==p){var y=0;for(m=0;m<5;m++){100==this.konier[e][m].getComponent("YutPiece").currentIdx&&y++}d=this.out_pos[e][y].x,u=this.out_pos[e][y].y,o.push(cc.moveTo(.2,d,u)),this.konier[e][t].getComponent("YutPiece").currentIdx=100}else{if(p<0||28<p)return void this.fun_exception(s);d=this.board_pos[p].x,u=this.board_pos[p].y}var f=d-c,b=u-h;0<=p&&p<=28&&o.push(cc.moveBy(.2,f,b)),l=p}var v=this;if(o.push(cc.callFunc(function(){v.fun_endmovekoni(s)},this)),2<=o.length){var _=cc.sequence(o);cc.global.audio.playEffectAud("animal/Animal_move"),this.konier[e][t].runAction(_)}else this.fun_exception(s)}else this.fun_exception(s)},cal_path:function(e,t,i,a,s,r){var n=[],o=0;if(this.konier[e][t].getComponent("YutPiece").queuemove=[],i!=a&&0!=s)if(-1!=a||1!=r){if(0<s)if(-1==i)for(var l=1;l<=a;l++)n.push(l);else if(0==i)1==s&&n.push(a);else{if(i<0||28<i)return void this.fun_exception(s);for(l=1;l<=s;l++)o=this.indexPos[i][l],n.push(o);-1==a&&0==r&&n.push(a)}else-1==s?0==r&&-1==a&&(0==i?n.push(28):19==i&&n.push(18)):(0<=i&&i<=28&&(o=this.indexPos[i][-1]),-100==o&&(22==i?o=20==a?21:26:15==i?o=13==a?14:24:0==i&&(o=2==a?1:27==a?28:19)),n.push(o),0==r&&-1==a&&0==i&&n.push(18)),n.push(a);this.konier[e][t].getComponent("YutPiece").queuemove=n}else this.konier[e][t].getComponent("YutPiece").queuemove.push(-1)},cal_indexPos:function(){for(var e=0;e<29;e++)this.indexPos[e]=[];this.indexPos[0][-1]=-100,this.indexPos[0][-2]=-100,this.indexPos[0][1]=-100;for(e=2;e<=5;e++)this.indexPos[0][e]=-1;for(e=1;e<=4;e++)for(var t=-2;t<=5;t++)this.indexPos[e][t]=e+t;for(t=1;t<=5;t++)this.indexPos[5][t]=19+t;this.indexPos[5][-1]=4,this.indexPos[5][-2]=3;for(e=6;e<=9;e++)for(t=-2;t<=5;t++)this.indexPos[e][t]=e+t;this.indexPos[10][-2]=8,this.indexPos[10][-1]=9,this.indexPos[10][1]=25,this.indexPos[10][2]=26,this.indexPos[10][3]=22,this.indexPos[10][4]=27,this.indexPos[10][5]=28;for(e=11;e<=15;e++)for(t=-2;t<=5;t++)this.indexPos[e][t]=e+t;this.indexPos[15][5]=0,this.indexPos[15][-1]=-100,this.indexPos[15][-2]=-100;for(e=16;e<=19;e++)for(t=-2;t<=5;t++){var i=e+t;19<i&&(i=20==i?0:21==i?100:-1),this.indexPos[e][t]=i}this.indexPos[16][-2]=-100,this.indexPos[20][-2]=4,this.indexPos[20][-1]=5,this.indexPos[20][1]=21,this.indexPos[20][2]=22,this.indexPos[20][3]=23,this.indexPos[20][4]=24,this.indexPos[20][5]=15,this.indexPos[21][-2]=5,this.indexPos[21][-1]=20,this.indexPos[21][1]=22,this.indexPos[21][2]=23,this.indexPos[21][3]=24,this.indexPos[21][4]=15,this.indexPos[21][5]=16,this.indexPos[22][-2]=-100,this.indexPos[22][-1]=-100,this.indexPos[22][1]=27,this.indexPos[22][2]=28,this.indexPos[22][3]=0,this.indexPos[22][4]=100,this.indexPos[22][5]=-1,this.indexPos[23][-2]=21,this.indexPos[23][-1]=22,this.indexPos[23][1]=24,this.indexPos[23][2]=15,this.indexPos[23][3]=16,this.indexPos[23][4]=17,this.indexPos[23][5]=18,this.indexPos[24][-2]=22,this.indexPos[24][-1]=23,this.indexPos[24][1]=15,this.indexPos[24][2]=16,this.indexPos[24][3]=17,this.indexPos[24][4]=18,this.indexPos[24][5]=19,this.indexPos[25][-2]=9,this.indexPos[25][-1]=10,this.indexPos[25][1]=26,this.indexPos[25][2]=22,this.indexPos[25][3]=27,this.indexPos[25][4]=28,this.indexPos[25][5]=0,this.indexPos[26][-2]=10,this.indexPos[26][-1]=25,this.indexPos[26][1]=22,this.indexPos[26][2]=27,this.indexPos[26][3]=28,this.indexPos[26][4]=0,this.indexPos[26][5]=100,this.indexPos[27][-2]=-100,this.indexPos[27][-1]=22,this.indexPos[27][1]=28,this.indexPos[27][2]=0,this.indexPos[27][3]=100,this.indexPos[27][4]=-1,this.indexPos[27][5]=-1,this.indexPos[28][-2]=22,this.indexPos[28][-1]=27,this.indexPos[28][1]=0,this.indexPos[28][2]=100,this.indexPos[28][3]=-1,this.indexPos[28][4]=-1,this.indexPos[28][5]=-1},fun_endmovekoni:function(e){this.cntmovekonitmp++,this.cntmovekonitmp<this.cntmovekoni||this.cntmovekonitmp>this.cntmovekoni||(this.showResult(!1),this.cntmovekonitmp=0,this.cntmovekoni=0,this.fun_setLast(e))},fun_setLast:function(e){var t=[0,0];this.yutqueue=[];for(var i=0;i<2;i++)for(var a=0;a<5;a++){var s=this.saveidx[i][a];this.konier[i][a].getComponent("YutPiece").currentIdx=s,this.konier[i][a].getComponent("YutPiece").showanimation(0),100==s&&(this.konier[i][a].setPosition(this.out_pos[i][t[i]]),t[i]++)}for(i=0;i<2;i++){var r=0;for(a=4;0<=a;a--){-1==(s=this.saveidx[i][a])&&(this.konier[i][a].setPosition(this.waiting_pos[i][4-r]),r++)}}for(i=0;i<this.listbox.childrenCount;i++)if(this.listbox.children[i].getComponent("Yutbtn").val==e){this.listbox.removeChild(this.listbox.children[i]);break}for(i=0;i<this.listbox.childrenCount;i++)this.listbox.children[i].getComponent("Yutbtn").id=i;if(0==this.turnSeat&&"m"==this.nexttype){for(i=0;i<this.listbox.childrenCount;i++)this.yutqueue.push(this.listbox.children[i].getComponent("Yutbtn").val);this.yutresult=this.yutqueue[0],this.fun_checkpos()}for(i=0;i<this.listbox1.childrenCount;i++)if(this.listbox1.children[i].getComponent("Yutbtn").val==e){this.listbox1.removeChild(this.listbox1.children[i]);break}for(i=0;i<this.listbox1.childrenCount;i++)this.listbox1.children[i].getComponent("Yutbtn").id=i;this.set_multikoni()},set_multikoni:function(){for(var e=[],t=[],i=0;i<=30;i++)e[i]=0,t[i]=0;for(i=0;i<2;i++)for(var a=0;a<5;a++){-1!=(s=this.saveidx[i][a])&&100!=s&&e[s]++}for(i=0;i<2;i++)for(a=0;a<5;a++){var s;if(-1!=(s=this.saveidx[i][a])&&100!=s){var r=this.board_pos[s].x,n=this.board_pos[s].y;1==e[s]?this.konier[i][a].setPosition(r,n):2==e[s]?0==t[s]?this.konier[i][a].setPosition(r-23,n):this.konier[i][a].setPosition(r+23,n):3==e[s]?(0==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex),this.konier[i][a].setPosition(r,n+20)):1==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex+1),this.konier[i][a].setPosition(r-23,n-20)):2==t[s]&&(this.konier[i][a].setLocalZOrder(this.koni_zindex+1),this.konier[i][a].setPosition(r+23,n-20)),this.koni_zindex++):4==e[s]?(0==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex),this.konier[i][a].setPosition(r-23,n+20)):1==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex),this.konier[i][a].setPosition(r+23,n+20)):2==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex+1),this.konier[i][a].setPosition(r-23,n-20)):3==t[s]&&(this.konier[i][a].setLocalZOrder(this.koni_zindex+1),this.konier[i][a].setPosition(r+23,n-20)),this.koni_zindex++):5==e[s]?(0==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex),this.konier[i][a].setPosition(r-23,n+20)):1==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex),this.konier[i][a].setPosition(r+23,n+20)):2==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex+1),this.konier[i][a].setPosition(r-43,n-20)):3==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex+1),this.konier[i][a].setPosition(r,n-20)):4==t[s]&&(this.konier[i][a].setLocalZOrder(this.koni_zindex+1),this.konier[i][a].setPosition(r+43,n-20)),this.koni_zindex++):6==e[s]&&(0==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex),this.konier[i][a].setPosition(r-43,n+20)):1==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex),this.konier[i][a].setPosition(r,n+20)):2==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex),this.konier[i][a].setPosition(r+43,n+20)):3==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex+1),this.konier[i][a].setPosition(r-43,n-20)):4==t[s]?(this.konier[i][a].setLocalZOrder(this.koni_zindex+1),this.konier[i][a].setPosition(r,n-20)):5==t[s]&&(this.konier[i][a].setLocalZOrder(this.koni_zindex+1),this.konier[i][a].setPosition(r+43,n-20)),this.koni_zindex++),t[s]++}}},fun_exception:function(e){this.fun_setLast(e)},cal_matrixPos:function(){var e=this.matrixboard.width/5,t=this.matrixboard.height/5;this.board_pos[0]=cc.p(0-2.5*e,0-2.5*t);for(var i=1;i<=5;i++)this.board_pos[i]=cc.p(this.board_pos[i-1].x+e,this.board_pos[i-1].y);for(i=6;i<=10;i++)this.board_pos[i]=cc.p(this.board_pos[i-1].x,this.board_pos[i-1].y+t);for(i=11;i<=15;i++)this.board_pos[i]=cc.p(this.board_pos[i-1].x-e,this.board_pos[i-1].y);for(i=16;i<=19;i++)this.board_pos[i]=cc.p(this.board_pos[i-1].x,this.board_pos[i-1].y-t);var a=2.5*e/3,s=2.5*t/3;this.board_pos[20]=cc.p(this.board_pos[5].x-a,this.board_pos[5].y+s);for(i=21;i<=24;i++)this.board_pos[i]=cc.p(this.board_pos[i-1].x-a,this.board_pos[i-1].y+s);this.board_pos[25]=cc.p(this.board_pos[10].x-a,this.board_pos[10].y-s),this.board_pos[26]=cc.p(this.board_pos[25].x-a,this.board_pos[25].y-s),this.board_pos[27]=cc.p(this.board_pos[22].x-a,this.board_pos[22].y-s),this.board_pos[28]=cc.p(this.board_pos[27].x-a,this.board_pos[27].y-s);for(i=0;i<29;i++)this.board_pos[i].y-=10},fun_simulationYut:function(e){var t=[],i=[],a=[],s=[0,0,0,0];cc.global.audio.playEffectAud("takecard");for(var r=0;r<4;r++){var n=40*Math.random()+30,o=30*Math.random()+40;for(1==r?n*=-1:2==r?(n*=-1,o*=-1):3==r&&(o*=-1),t[r]=cc.p(n,o);;){var l=Math.floor(4*Math.random());if(0==s[l]){s[l]=1,i[r]=l;break}}var c=360*Math.random();a[r]=c}for(r=0;r<4;r++)this.yutbars.children[r].setPosition(0,0),this.yutbars.children[r].rotation=90*r;if(-2==e)this.yutbars.children[0].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("white_b"),this.yutbars.children[1].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("white_b"),this.yutbars.children[2].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("black"),this.yutbars.children[3].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("black");else if(-1==e)this.yutbars.children[0].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("white_b"),this.yutbars.children[1].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("black"),this.yutbars.children[2].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("black"),this.yutbars.children[3].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("black");else if(1==e)this.yutbars.children[0].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("white"),this.yutbars.children[1].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("black"),this.yutbars.children[2].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("black"),this.yutbars.children[3].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("black");else if(2==e){0==(h=Math.floor(2*Math.random()))?(this.yutbars.children[0].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("white"),this.yutbars.children[1].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("white")):(this.yutbars.children[0].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("white"),this.yutbars.children[1].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("white_b")),this.yutbars.children[2].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("black"),this.yutbars.children[3].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("black")}else if(3==e){var h=Math.floor(2*Math.random());this.yutbars.children[0].getComponent(cc.Sprite).spriteFrame=0==h?this.yut_tile.getSpriteFrame("white_b"):this.yut_tile.getSpriteFrame("white"),this.yutbars.children[1].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("white_b"),this.yutbars.children[2].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("white"),this.yutbars.children[3].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("black")}else if(4==e){cc.global.audio.playEffectAud("crowed");for(r=0;r<4;r++)this.yutbars.children[r].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("white")}else if(5==e){cc.global.audio.playEffectAud("crowed");for(r=0;r<4;r++)this.yutbars.children[r].getComponent(cc.Sprite).spriteFrame=this.yut_tile.getSpriteFrame("black")}for(r=0;r<4;r++)this.yutbars.children[r].setScale(2.5);for(r=0;r<4;r++)this.yutbars.children[r].runAction(cc.spawn(cc.scaleTo(.2,.8,.8),cc.rotateTo(.2,a[r]),cc.moveTo(.2,t[r])))},check_betup:function(e,t){var i=parseInt(e);if(0<i&&i>t.ratio){t.ratio=i,cc.global.audio.playEffectAud("charge"),t.showMultiAni();var a=t.panScore*i;t.roomdata.children[0].children[1].getComponent(cc.Label).string="("+t.numformat(a)+"pt)",t.roomdata.children[0].children[1].runAction(cc.sequence(cc.scaleTo(.2,1.4),cc.scaleTo(.2,1)))}},showMultiAni:function(){if(this.multi){var e=this;this.multi.active=!0;var t=this.multi.getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"play",!1),setTimeout(function(){e&&e.multi&&(e.multi.active=!1)},2e3)}},prebanker_offline:function(e,t){var i=this,a=0;if(isNaN(this.save_offlineYut))a=c.getYutResult(!1,cc.global.user.id);else for(;(a=c.getYutResult(!1,0))==this.save_offlineYut;);var s={command:"prebanker",event:"command",userid:t,msg:60,extmsg:c.hole,ratio:1,status:"playing",extdata:{timer:60,yutresult:a}};if(this.prebanker_event(s,this),isNaN(this.save_offlineYut))this.save_offlineYut=a,t==cc.global.user.id&&this.scheduleOnce(function(){i.prebanker_offline(a,0)},2);else{var r=cc.global.user.id;this.save_offlineYut<a&&(r=0);var n={command:"banker",event:"command",banker:r,timer:60};this.banker_event(n,this)}},play_offline:function(e,t){var i,a,s=cc.global.user.id;"y"==e.type?i=0!=e.testyut?c.getYutResult(!0,t,e.testyut):c.getYutResult(!0,t):(c.move_koni(t,e.id,e.yut),i=e.yut),s=c.check_next(),a=c.check_nextType();var r={command:"playyut",event:"command",room_id:this.roomid,userid:t,extdata:{yutresult:i,type:e.type,nexttype:a,timer:60,passcount:0,turncount:c.turncount,next:s,ratio:1,board:[{curgame:"yut",playuser:cc.global.user.id,koni:c.resultMatrix[0]},{curgame:"yut",playuser:0,koni:c.resultMatrix[1]}]},status:"playing"};this.playyut_event(r,this);for(var n=[0,0],o=0;o<2;o++)for(var l=0;l<5;l++)100==c.currentMatrix[o][l]&&n[o]++;5==n[0]&&this.finish_offline(0),5==n[1]&&this.finish_offline(1)},finish_offline:function(e){var t=this,i={command:"yutfinish",event:"command",room_id:this.roomid,title:"finish",players:[{curgame:"yut",userid:cc.global.user.id,gold:1e4,getout:!1,win:0},{curgame:"yut",userid:0,gold:1e4,getout:!1,win:0}]};i.players[e].win=2,this.isGamePlaying=!1,this.stopTurnTimerAll(),this.scheduleOnce(function(){t.allcards_event(i,t),c.init()},2)}}),cc._RF.pop()},{HHCommon:"HHCommon",YutEngine:"YutEngine"}],YutEngine:[function(e,t,i){"use strict";cc._RF.push(t,"8bae0RZJHdA4bweDrlZTytP","YutEngine"),t.exports=function(){this.data={},this.hole=3,this.realMatrix=[],this.currentMatrix=[],this.resultMatrix=[],this.pathMatrix=[],this.turncount=0,this.cntkoni=[],this.lastcount=[],this.result={},this.yutval=[[2,1],[2,1],[3,0],[3,0]],this.getYutval=[0,0,4,3,-2,3,2,-1,2,1,5],this.pos_result=[],this.yut_queue=[],this.killflg=!1,this.nexttype="y",this.nextplayer=cc.global.user.id,this.init=function(){this.turncount=0,this.killflg=!1,this.calc_pos_result();for(var e=0;e<2;e++)this.currentMatrix[e]=[-1,-1,-1,-1,-1],this.resultMatrix[e]=[0,0,0,0,0],this.pathMatrix[e]=[-1,-1,-1,-1,-1],this.yut_queue[e]=[]},this.getYutResult=function(e,t){for(var i=0,a=0,s=0;s<4;s++){var r=Math.floor(123*Math.random()*7)%2;i+=this.yutval[s][r]}i=this.getYutval[i];var n;return 0!=(n=2<arguments.length?parseInt(arguments[2]):i)&&n<6&&-2<=n&&(i=n),e&&(t!=cc.global.user.id&&(a=1),this.yut_queue[a].push(i),4<=i&&!this.killflg?this.nexttype="y":this.nexttype="m",this.nextplayer=t,this.check_possible_move(a)||(this.nexttype="y",this.nextplayer=0==a?0:cc.global.user.id,this.yut_queue[a]=[])),i},this.move_koni=function(e,t,i){this.turncount++;var a=0;e!=cc.global.user.id&&(a=1);var s=[];this.killflg=!1;for(var r=0;r<5;r++){var n=this.currentMatrix[a][r];100!=n&&-1!=n&&(this.currentMatrix[a][r]==this.currentMatrix[a][t]&&s.push(r))}-1==this.currentMatrix[a][t]&&s.push(t);var o=(a+1)%2;for(r=0;r<s.length;r++){var l=this.findtarget(a,s[r],i);if(this.setkonipath(e,t,i),100!=(this.currentMatrix[a][s[r]]=l))if(-2==l)this.currentMatrix[a][s[r]]=-1;else for(var c=0;c<5;c++){this.currentMatrix[o][c]==l&&(this.currentMatrix[o][c]=-1,this.pathMatrix[o][c]=-1,this.killflg=!0)}}this.convert_matrix();for(r=0;r<this.yut_queue[a].length;r++)if(this.yut_queue[a][r]==i){this.yut_queue[a].splice(r,1);break}if(1==this.killflg)return this.nexttype="y",void(this.nextplayer=e);0!=this.yut_queue[a].length&&this.check_possible_move(a)?(this.nexttype="m",this.nextplayer=e):(this.yut_queue[a]=[],this.nexttype="y",e==cc.global.user.id?this.nextplayer=0:this.nextplayer=cc.global.user.id)},this.play_trainer=function(){for(var e={type:"m",id:0,yut:1,roomid:"room",localturn:this.turncount},t=0;t<5;t++)for(var i=0;i<this.yut_queue[1].length;i++){var a=this.yut_queue[1][i];if(100==(r=this.findtarget(1,t,a)))return e.yut=a,e.id=t,e}for(t=0;t<5;t++)for(i=0;i<this.yut_queue[1].length;i++){a=this.yut_queue[1][i];if(-1!=(r=this.findtarget(1,t,a)))for(var s=0;s<5;s++)if(100!=this.currentMatrix[0][s]&&this.currentMatrix[0][s]==r)return e.yut=a,e.id=t,e}for(i=0;i<this.yut_queue[1].length;i++){if(-1==(a=this.yut_queue[1][i])||-2==a)for(t=0;t<5;t++){if(100!=this.currentMatrix[1][t]&&-1!=this.currentMatrix[1][t])if(0==(r=this.findtarget(1,t,a)))return e.yut=a,e.id=t,e}else if(1==a)for(t=0;t<5;t++)if(-1==this.currentMatrix[1][t])return e.yut=a,e.id=t,e}for(t=0;t<5;t++)if(100!=this.currentMatrix[1][t]&&-1!=this.currentMatrix[1][t])for(i=0;i<this.yut_queue[1].length;i++){a=this.yut_queue[1][i];if(0<=(r=this.findtarget(1,t,a)))return e.yut=a,e.id=t,e}for(t=0;t<5;t++)if(100!=this.currentMatrix[1][t])for(i=0;i<this.yut_queue[1].length;i++){a=this.yut_queue[1][i];if(0<=(r=this.findtarget(1,t,a)))return e.yut=a,e.id=t,e}for(t=0;t<5;t++)if(100!=this.currentMatrix[1][t])for(i=0;i<this.yut_queue[1].length;i++){var r;a=this.yut_queue[1][i];if(-1!=(r=this.findtarget(1,t,a)))return e.yut=a,e.id=t,e}},this.check_next=function(){return this.nextplayer},this.check_nextType=function(){return this.nexttype},this.calc_pos_result=function(){for(var e=0;e<29;e++)this.pos_result[e]=[];this.pos_result[0][-1]=-100,this.pos_result[0][-2]=-100,this.pos_result[0][1]=-100;for(e=2;e<=5;e++)this.pos_result[0][e]=-1;for(e=1;e<=4;e++)for(var t=-2;t<=5;t++)this.pos_result[e][t]=e+t;for(t=1;t<=5;t++)this.pos_result[5][t]=19+t;this.pos_result[5][-1]=4,this.pos_result[5][-2]=3;for(e=6;e<=9;e++)for(t=-2;t<=5;t++)this.pos_result[e][t]=e+t;this.pos_result[10][-2]=8,this.pos_result[10][-1]=9,this.pos_result[10][1]=25,this.pos_result[10][2]=26,this.pos_result[10][3]=22,this.pos_result[10][4]=27,this.pos_result[10][5]=28;for(e=11;e<=15;e++)for(t=-2;t<=5;t++)this.pos_result[e][t]=e+t;this.pos_result[15][5]=0,this.pos_result[15][-1]=-100,this.pos_result[15][-2]=-100;for(e=16;e<=19;e++)for(t=-2;t<=5;t++){var i=e+t;19<i&&(i=20==i?0:21==i?100:-1),this.pos_result[e][t]=i}this.pos_result[16][-2]=-100,this.pos_result[20][-2]=4,this.pos_result[20][-1]=5,this.pos_result[20][1]=21,this.pos_result[20][2]=22,this.pos_result[20][3]=23,this.pos_result[20][4]=24,this.pos_result[20][5]=15,this.pos_result[21][-2]=5,this.pos_result[21][-1]=20,this.pos_result[21][1]=22,this.pos_result[21][2]=23,this.pos_result[21][3]=24,this.pos_result[21][4]=15,this.pos_result[21][5]=16,this.pos_result[22][-2]=-100,this.pos_result[22][-1]=-100,this.pos_result[22][1]=27,this.pos_result[22][2]=28,this.pos_result[22][3]=0,this.pos_result[22][4]=100,this.pos_result[22][5]=-1,this.pos_result[23][-2]=21,this.pos_result[23][-1]=22,this.pos_result[23][1]=24,this.pos_result[23][2]=15,this.pos_result[23][3]=16,this.pos_result[23][4]=17,this.pos_result[23][5]=18,this.pos_result[24][-2]=22,this.pos_result[24][-1]=23,this.pos_result[24][1]=15,this.pos_result[24][2]=16,this.pos_result[24][3]=17,this.pos_result[24][4]=18,this.pos_result[24][5]=19,this.pos_result[25][-2]=9,this.pos_result[25][-1]=10,this.pos_result[25][1]=26,this.pos_result[25][2]=22,this.pos_result[25][3]=27,this.pos_result[25][4]=28,this.pos_result[25][5]=0,this.pos_result[26][-2]=10,this.pos_result[26][-1]=25,this.pos_result[26][1]=22,this.pos_result[26][2]=27,this.pos_result[26][3]=28,this.pos_result[26][4]=0,this.pos_result[26][5]=100,this.pos_result[27][-2]=-100,this.pos_result[27][-1]=22,this.pos_result[27][1]=28,this.pos_result[27][2]=0,this.pos_result[27][3]=100,this.pos_result[27][4]=-1,this.pos_result[27][5]=-1,this.pos_result[28][-2]=22,this.pos_result[28][-1]=27,this.pos_result[28][1]=0,this.pos_result[28][2]=100,this.pos_result[28][3]=-1,this.pos_result[28][4]=-1,this.pos_result[28][5]=-1},this.findtarget=function(e,t,i){var a=this.currentMatrix[e][t];if(100==a)return-1;if(-1==a)return i<0&&(i=-1),i;var s=this.pos_result[a][i];if(-100==s&&(15==a?s=4==this.pathMatrix[e][t]?15+i:25+i:16==a?s=4==this.pathMatrix[e][t]?16+i:24:22==a?s=2==this.pathMatrix[e][t]?27+i:22+i:27==a?s=1==this.pathMatrix[e][t]?21:26:0==a&&(1==i?s=100:-1==i?s=3<=this.pathMatrix[e][t]?19:1<=this.pathMatrix[e][t]?28:1:-2==i&&(s=3<=this.pathMatrix[e][t]?18:1<=this.pathMatrix[e][t]?27:2))),3==this.hole){if(28==s||18==s)return-2}else if(1==this.hole){if(28==s)return-2}else if(2==this.hole&&18==s)return-2;return s},this.convert_matrix=function(){for(var e=0;e<2;e++)for(var t=0;t<5;t++)this.resultMatrix[e][t]=this.currentMatrix[e][t]+1,100==this.currentMatrix[e][t]&&(this.resultMatrix[e][t]=30)},this.check_possible_move=function(e){for(var t=0;t<5;t++)if(100!=this.currentMatrix[e][t])for(var i=0;i<this.yut_queue[e].length;i++){var a=this.yut_queue[e][i];if(-1!=this.findtarget(e,t,a))return!0}return!1},this.setkonipath=function(e,t,i){var a=0;e!=cc.global.user.id&&(a=1);var s=this.currentMatrix[a][t],r=this.findtarget(a,t,i);100!=r&&-2!=r?0<i?10==s?this.pathMatrix[a][t]=2:22==s&&2!=this.pathMatrix[a][t]?this.pathMatrix[a][t]=1:11<=s&&s<=14?this.pathMatrix[a][t]=4:21!=s&&24!=s&&23!=s&&20!=s||15<=r&&r<=19&&(this.pathMatrix[a][t]=3):(22==s&&2!=this.pathMatrix[a][t]&&(this.pathMatrix[a][t]=-1),10==s&&(this.pathMatrix[a][t]=-1),-2==this.resultyut&&(23!=s&&11!=s&&25!=s||(this.pathMatrix[a][t]=-1),27==s&&2!=this.pathMatrix[a][t]&&(this.pathMatrix[a][t]=-1))):this.pathMatrix[a][t]=-1}},cc._RF.pop()},{}],YutPiece:[function(e,t,i){"use strict";cc._RF.push(t,"bc393Z/l+dJqqjtQsPRerW7","YutPiece"),cc.Class({extends:cc.Component,properties:{img1:{default:null,type:cc.Node},img2:{default:null,type:cc.Node},selectimg:{default:null,type:cc.Node},id:0,colorval:0,currentIdx:-1,path:-1,parent:null,wrs:0,queuemove:{default:[]}},init:function(e,t,i,a,s,r){this.id=e,this.colorval=t,this.currentIdx=i,this.path=a,this.selectable=s,this.parent=r,this.selectimg.active=!1,this.queuemove=[]},setPieceSize:function(e,t){this.node.width=e,this.node.height=t,this.img1.width=e,this.img1.height=t,this.img2.width=e,this.img2.height=t},initout:function(e,t,i,a){this.currentIdx=e,this.path=t,this.selectable=i,this.goout=a},onClick:function(){"yes"!=cc.global.amObserve&&(this.parent.turnSeat||(this.selectable&&1!=this.colorval?"m"==this.parent.nexttype&&(cc.global.audio.playEffectAud("hall_click_game"),this.parent.on_clickPiece(this.id),cc.sys.localStorage.setItem("tutorial_yut_konimove",!0)):this.parent.listbox_yuts.active=!1))},drawPiece:function(e){this.img1.active=0==e,this.img2.active=1==e},showanimation:function(e){this.selectable=e,(this.selectimg.active=e)?this.node.getComponent(cc.Animation).play():this.node.getComponent(cc.Animation).stop()},clickaction:function(e){var t=cc.scaleTo(.2,1.2),i=cc.scaleTo(.2,1);1==e?this.node.runAction(t):this.node.runAction(i)}}),cc._RF.pop()},{}],Yutbtn:[function(e,t,i){"use strict";cc._RF.push(t,"68a5esNJm1F1JMgudgV5bO7","Yutbtn"),cc.Class({extends:cc.Component,properties:{tiles:{default:null,type:cc.SpriteAtlas},id:0,val:0,clickable:0},init:function(e,t,i,a){this.id=e,this.val=t,this.parent=a,this.clickable=i},onClick:function(){"yes"!=cc.global.amObserve&&1==this.clickable&&0==this.parent.turnSeat&&(this.parent.yutresult=this.val,this.parent.on_clickyutbtn(this.id,this.koni_id),cc.sys.localStorage.setItem("tutorial_yut_btns",!0))},scale:function(e){},setImg:function(e,t){var i="yut_"+e;this.val=e,this.koni_id=t,this.node.getComponent(cc.Sprite).spriteFrame=this.tiles.getSpriteFrame(i)}}),cc._RF.pop()},{}],YutplayerBoard:[function(e,t,i){"use strict";cc._RF.push(t,"a9ac7TbtkxGvZZSqzQwGCwW","YutplayerBoard");var a=e("HHCommon");cc.Class({extends:a,properties:{countdown:{default:null,type:cc.Label},status:{default:null,type:cc.Label},tip:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.layoutForSeat()},startTimer:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode||!(3<e)){var t=this;t.stopTimer(),t.countdown.node.active=!0,t.countdown.string=e,t.timer||(t.timer=setInterval(function(){0<e?t.countdown&&(e--,t.countdown.string=e):t.stopTimer()},1e3))}},stopTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null,this.tip&&1==this.tip.active&&1==cc.global.curPlaywayScore&&this.parent.onclickBack()),this.countdown&&(this.countdown.node.active=!1)},setState:function(e){var t=this.getLanguageText("READY_0")+"?",i=this.getLanguageText("PREPARED_0");1!=cc.global.championMode&&2!=cc.global.championMode?(this.status.node.active=!0,t==(this.status.string=e)&&this.userdata.id==cc.global.user.id&&"no"==cc.global.amObserve?this.tip.active=!0:this.tip.active=!1):this.status.string=i},hideTip:function(){this.tip.active=!1},hideStatus:function(){this.stopTimer(),this.hideTip(),this.status.node.active=!1},layoutForSeat:function(){0==this.seatid||this.seatid},isReady:function(){return this.getLanguageText("PREPARED_0")==this.status.string},onClickReady:function(){this.parent&&this.parent.processReadyState()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],Yutplayer:[function(e,t,i){"use strict";cc._RF.push(t,"7ca84Ggmz9DBIJanWG5eiOI","Yutplayer");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},nickname:{default:null,type:cc.Label},goldcoin_base:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},betup:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},winorlose:{default:null,type:cc.Node},banker:{default:null,type:cc.Node},passCount:{default:null,type:cc.Label},userinformationpan:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.nickname.string=t.nickname,1==cc.global.championMode||cc.global.championMode,this.goldcoins.string=this.numformat(t.goldcoins),this.goldcoins.node.parent.active=!0,this.loadAvatar(t.avatarurl,t.gender),this.layoutForSeat()},speech:function(e){var t=this.userdata.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)},onClickDisInfo:function(){},updateCareer:function(e){},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},spendDiamondForLuck:function(e){this.updateBalance()},showCallPlayer:function(e,t){var i=this;this.hideCallPlayer(),cc.global.audio.playVoiceChatWithType(this.userdata.playcharacter,t),this.callplayer.active=!0,this.callplayer.children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onClickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userdata.id},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){cc.global.isOffline||(cc.global.user.id==this.userdata.id?this.parent.onClickEmoticon&&this.parent.onClickEmoticon():this.onClickCallPlayer())},layoutForSeat:function(){0==this.seatid?(this.winorlose.x=-120,this.callplayer.scaleX=1,this.callplayer.children[0].scaleX=1,this.userinformationpan.x=70,this.userinformationpan.anchorX=0,this.goldcoin_base.anchorX=0,this.nickname.node.anchorX=0,this.banker.x=-55,this.winorlose.x=260):1==this.seatid&&(this.winorlose.x=120,this.callplayer.scaleX=-1,this.callplayer.children[0].scaleX=-1,this.userinformationpan.x=-70,this.userinformationpan.anchorX=1,this.goldcoin_base.anchorX=1,this.nickname.node.anchorX=1,this.banker.x=55,this.winorlose.x=-260)},summary:function(e){var a=this;if(this.updateCareer(e),this.winorlose.getComponent(cc.Animation).play(),2==e.win){cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("win"),this.winorlose.children[1].getComponent(cc.Label).string="+"+this.numformat(e.exp),this.winorlose.children[2].getComponent(cc.Label).string="+"+this.numformat(e.score),e.orig_gold=e.gold-e.score,"diamond"==cc.global.user.selplayway&&(e.orig_gold=e.diamond-e.score);var t=cc.callFunc(function(e,t){t.orig_gold+Math.round(t.score/5)>("diamond"==cc.global.user.selplayway?t.diamond:t.gold)?"diamond"==cc.global.user.selplayway?t.orig_gold=t.diamond:t.orig_gold=t.gold:t.orig_gold=t.orig_gold+Math.round(t.score/5);var i=e.getComponent("Yutplayer").goldcoins.node;i.getComponent(cc.Label).string=a.numformat(t.orig_gold),i.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1)))},this,e),i=cc.sequence(cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t);this.node.runAction(i)}else cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("lose"),this.winorlose.children[1].getComponent(cc.Label).string="-"+this.numformat(Math.abs(e.exp)),this.winorlose.children[2].getComponent(cc.Label).string="-"+this.numformat(-1*e.score),this.goldcoins.string=this.numformat(e.gold)},showFuncStatus:function(){},showBanker:function(){this.banker.active=!0,2<=this.banker.children.length&&(this.banker.children[0].active=0==this.seatid,this.banker.children[1].active=0!=this.seatid)},hideBanker:function(){this.banker.active=!1},updatePassCount:function(e){if(this.passCount){var t=3-parseInt(e);if(0<=t){var i=this.getLanguageText("PASS_COUNT");this.passCount.string=i+": "+t}else{i=this.getLanguageText("NO_PASS_COUNT");this.passCount.string=i}}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],animalpiece1:[function(e,t,i){"use strict";cc._RF.push(t,"ed9bfMeSv9Gc6fjYkY1OqEz","animalpiece1"),cc.Class({extends:cc.Component,properties:{img:{default:null,type:cc.Node},outline:{default:null,type:cc.Node},tiles:{default:null,type:cc.SpriteAtlas},id:0,row:0,col:0,selected:0,dead:0},init:function(e,t,i,a,s,r){this.id=e,this.row=t,this.col=i,this.selected=a,this.dead=s,this.parent=r,this.node.scaleX=.8,this.node.scaleY=.8,this.node.zIndex=0,this.node.getComponent(cc.Animation).stop(),this.node.opacity=255,this.drawImage()},onClick:function(){1!=this.parent.tip_pan.active&&"yes"!=cc.global.amObserve&&0!=this.parent.isGamePlaying&&(this.parent.turnSeat||this.parent.sendFlag||(this.id<0?this.parent.on_clickTarget(this.row,this.col):(this.show_outline(!1),cc.global.audio.playEffectAud("animal/Animal_click"),this.parent.click_selfpiece(this.id,this.row,this.col))))},drawImage:function(){this.node.active=!0;var e="r";this.id<0&&(e="b"),e+=Math.abs(this.id),this.img.getComponent(cc.Sprite).spriteFrame=this.tiles.getSpriteFrame(e)},setGeometry:function(e,t,i){this.node.setPosition(i),this.node.width=e,this.node.height=t,this.node.children[0].width=e,this.node.children[0].height=t,this.node.children[1].width=e,this.node.children[1].height=t},move:function(e,t){this.row=e,this.col=t;var i=this.parent.matrix_pos[this.row][this.col],a=cc.moveTo(.2,i),s=cc.sequence(a,cc.callFunc(this.end_move.bind(this)));this.node.runAction(s),cc.global.audio.playEffectAud("animal/Animal_move")},move_kill:function(e,t){this.row=e,this.col=t;var i=this.parent.matrix_pos[this.row][this.col],a=cc.scaleTo(.1,1.2),s=cc.moveTo(.2,i),r=cc.scaleTo(.2,.8),n=cc.spawn(s,r),o=cc.sequence(a,cc.delayTime(.3),n,cc.callFunc(this.end_move.bind(this)));this.node.runAction(o);7!=Math.abs(this.id)?cc.global.audio.playEffectAud("animal/"+["","Elephant","Tiger","Wolf","Dog","Cat","Mouse"][Math.abs(this.id)]):cc.global.audio.playEffectAud("bomb")},end_move:function(){this.parent.fun_endmove()},kill_Piece:function(){this.node.getComponent(cc.Animation).stop(),this.node.opacity=255,this.node.scaleX=.5,this.node.scaleY=.5;var e=cc.sequence(cc.delayTime(.3),cc.callFunc(this.kill_Piece_end.bind(this)));this.node.runAction(e)},kill_Piece_end:function(){this.node.active=!1,this.dead=1},show_outline:function(e){e?this.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,.85),cc.scaleTo(.5,.8)))):(this.node.scaleX=this.node.scaleY=.8,this.node.stopAllActions())},show_flag:function(e){1==e?(this.node.stopAllActions(),this.node.scaleX=this.node.scaleY=.8,this.node.getComponent(cc.Animation).play("animal_blink")):(this.node.getComponent(cc.Animation).stop("animal_blink"),this.node.opacity=255)}}),cc._RF.pop()},{}],animalpiece:[function(e,t,i){"use strict";cc._RF.push(t,"34c6bZEZB1HAoGJAdSKHM7Y","animalpiece"),cc.Class({extends:cc.Component,properties:{img:{default:null,type:cc.Node},flag:{default:null,type:cc.Node},tiles:{default:null,type:cc.SpriteAtlas},id:0,row:0,col:0,selected:0,dead:0,isself:0},init:function(e,t,i,a,s,r,n){this.id=e,this.isself=t,this.row=i,this.col=a,this.selected=s,this.dead=r,this.parent=n,this.node.active=!0,this.node.scaleX=1,this.node.scaleY=1,this.drawImage()},onClick:function(){if(1!=this.parent.tip_pan.active&&"yes"!=cc.global.amObserve&&0!=this.parent.isGamePlaying&&!this.parent.turnSeat&&!this.parent.sendFlag)if(this.isself){if(!this.goflag)return;this.parent.on_clickTarget(this.row,this.col)}else cc.global.audio.playEffectAud("animal/Animal_click"),this.parent.click_selfpiece(this.id,this.row,this.col)},drawImage:function(){this.flag.active=!1,this.node.active=!0;var e="r";1==this.isself&&(e="b"),e+=this.id,this.img.getComponent(cc.Sprite).spriteFrame=this.tiles.getSpriteFrame(e),this.showFlag(!1)},setGeometry:function(e,t,i){this.node.setPosition(i),this.node.width=e,this.node.height=t,this.node.children[0].width=e,this.node.children[0].height=t},move:function(e,t){this.row=e,this.col=t;var i=this.parent.matrix_pos[this.row][this.col],a=cc.moveTo(.2,i),s=cc.sequence(a,cc.callFunc(this.end_move.bind(this)));this.node.runAction(s),cc.global.audio.playEffectAud("animal/Animal_move")},move_kill:function(e,t){this.row=e,this.col=t;var i=this.parent.matrix_pos[this.row][this.col],a=cc.scaleTo(.1,1.5),s=cc.moveTo(.2,i),r=cc.scaleTo(.2,1),n=cc.spawn(s,r),o=cc.sequence(a,cc.delayTime(.3),n,cc.callFunc(this.end_move.bind(this)));this.node.runAction(o);cc.global.audio.playEffectAud("animal/"+["","Elephant","Lion","Tiger","Pig","Wolf","Dog","Cat","Mouse"][this.id])},end_move:function(){this.parent.fun_endmove()},showFlag:function(e){this.flag.active=e,this.goflag=e},kill_Piece:function(){this.node.scaleX=.8,this.node.scaleY=.8;var e=cc.sequence(cc.delayTime(.3),cc.callFunc(this.kill_Piece_end.bind(this)));this.node.runAction(e)},kill_Piece_end:function(){this.node.active=!1,this.dead=1}}),cc._RF.pop()},{}],animalplayer1:[function(e,t,i){"use strict";cc._RF.push(t,"196b8PdocJMPJRRWSDIRDQ3","animalplayer1");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},nickname:{default:null,type:cc.Label},goldcoin_base:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},betup:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},winorlose:{default:null,type:cc.Node},banker:{default:null,type:cc.Node},passCount:{default:null,type:cc.Label},passCount1:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.nickname.string=t.nickname,1==cc.global.championMode||cc.global.championMode,this.goldcoins.string=this.numformat(t.goldcoins),this.goldcoins.node.parent.active=!0,this.loadAvatar(t.avatarurl,t.gender),this.layoutForSeat();for(i=0;i<3;i++)this.passCount1.children[i].opacity=255},speech:function(e){var t=this.userdata.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)},onClickDisInfo:function(){},updateCareer:function(e){},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},spendDiamondForLuck:function(e){this.updateBalance()},showCallPlayer:function(e,t){var i=this;this.hideCallPlayer(),cc.global.audio.playVoiceChatWithType(this.userdata.playcharacter,t),this.callplayer.active=!0,this.callplayer.children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onClickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userdata.id},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){1!=this.parent.tip_pan.active&&(cc.global.isOffline||(cc.global.user.id==this.userdata.id?this.parent.onClickEmoticon&&this.parent.onClickEmoticon():this.onClickCallPlayer()))},layoutForSeat:function(){0==this.seatid?(this.winorlose.x=140,this.callplayer.scaleX=1,this.callplayer.children[0].scaleX=1,this.banker.x=65):1==this.seatid&&(this.winorlose.x=-140,this.callplayer.scaleX=-1,this.callplayer.children[0].scaleX=-1,this.banker.x=-65)},summary:function(e){var a=this;if(this.updateCareer(e),this.winorlose.getComponent(cc.Animation).play(),2==e.win){cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("win"),this.winorlose.children[1].getComponent(cc.Label).string="+"+this.numformat(e.exp),this.winorlose.children[2].getComponent(cc.Label).string="+"+this.numformat(e.score),e.orig_gold=e.gold-e.score,"diamond"==cc.global.user.selplayway&&(e.orig_gold=e.diamond-e.score);var t=cc.callFunc(function(e,t){t.orig_gold+Math.round(t.score/5)>("diamond"==cc.global.user.selplayway?t.diamond:t.gold)?"diamond"==cc.global.user.selplayway?t.orig_gold=t.diamond:t.orig_gold=t.gold:t.orig_gold=t.orig_gold+Math.round(t.score/5);var i=e.getComponent("animalplayer1").goldcoins.node;i.getComponent(cc.Label).string=a.numformat(t.orig_gold),i.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1)))},this,e),i=cc.sequence(cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t);this.node.runAction(i)}else cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("lose"),this.winorlose.children[1].getComponent(cc.Label).string="-"+this.numformat(Math.abs(e.exp)),this.winorlose.children[2].getComponent(cc.Label).string="-"+this.numformat(-1*e.score),this.goldcoins.string=this.numformat(e.gold)},showFuncStatus:function(){},showBanker:function(){this.banker.active=!0,2<=this.banker.children.length&&(this.banker.children[0].active=0==this.seatid,this.banker.children[1].active=0!=this.seatid)},hideBanker:function(){this.banker.active=!1},updatePassCount:function(e){if(this.passCount){var t=3-parseInt(e);if(0<=t){var i=this.getLanguageText("PASS_COUNT");this.passCount.string=i+": "+t;for(var a=0;a<3;a++)a<Math.min(parseInt(e),3)?this.passCount1.children[a].opacity=100:this.passCount1.children[a].opacity=255}else{i=this.getLanguageText("NO_PASS_COUNT");this.passCount.string=i}}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],animalplayerBoard1:[function(e,t,i){"use strict";cc._RF.push(t,"a1f33K37dhDM6YHxWDZYD4t","animalplayerBoard1");var a=e("HHCommon");cc.Class({extends:a,properties:{countdown:{default:null,type:cc.Label},status:{default:null,type:cc.Label},tip:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.layoutForSeat()},startTimer:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode||!(3<e)){var t=this;t.stopTimer(),t.countdown.node.active=!0,t.countdown.string=e,t.timer||(t.timer=setInterval(function(){0<e?t.countdown&&(e--,t.countdown.string=e):t.stopTimer()},1e3))}},stopTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null,this.tip&&1==this.tip.active&&1==cc.global.curPlaywayScore&&this.parent.onclickBack()),this.countdown&&(this.countdown.node.active=!1)},setState:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode){this.status.node.active=!0,this.status.string=e;var t=this.getLanguageText("READY_0")+"?",i=this.getLanguageText("PREPARED_0");t==e&&this.userdata.id==cc.global.user.id&&"no"==cc.global.amObserve?this.tip.active=!0:this.tip.active=!1}else this.status.string=i},hideTip:function(){this.tip.active=!1},hideStatus:function(){this.stopTimer(),this.hideTip(),this.status.node.active=!1},layoutForSeat:function(){0==this.seatid||this.seatid},isReady:function(){return this.getLanguageText("PREPARED_0")==this.status.string},onClickReady:function(){this.parent&&this.parent.processReadyState()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],animalplayerBoard:[function(e,t,i){"use strict";cc._RF.push(t,"ea931LwRT1PQZI6bwiiL6dj","animalplayerBoard");var a=e("HHCommon");cc.Class({extends:a,properties:{countdown:{default:null,type:cc.Label},status:{default:null,type:cc.Label},tip:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.layoutForSeat()},startTimer:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode||!(3<e)){var t=this;t.stopTimer(),t.countdown.node.active=!0,t.countdown.string=e,t.timer||(t.timer=setInterval(function(){0<e?t.countdown&&(e--,t.countdown.string=e):t.stopTimer()},1e3))}},stopTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null,this.tip&&1==this.tip.active&&1==cc.global.curPlaywayScore&&this.parent.onclickBack()),this.countdown&&(this.countdown.node.active=!1)},setState:function(e){if(1!=cc.global.championMode&&2!=cc.global.championMode){this.status.node.active=!0,this.status.string=e;var t=this.getLanguageText("READY_0")+"?",i=this.getLanguageText("PREPARED_0");t==e&&this.userdata.id==cc.global.user.id&&"no"==cc.global.amObserve?this.tip.active=!0:this.tip.active=!1}else this.status.string=i},hideTip:function(){this.tip.active=!1},hideStatus:function(){this.stopTimer(),this.hideTip(),this.status.node.active=!1},layoutForSeat:function(){0==this.seatid||this.seatid},isReady:function(){return this.getLanguageText("PREPARED_0")==this.status.string},onClickReady:function(){this.parent&&this.parent.processReadyState()}}),cc._RF.pop()},{HHCommon:"HHCommon"}],animalplayer:[function(e,t,i){"use strict";cc._RF.push(t,"881f3Si1oNCx7+tWgEUo4IQ","animalplayer");var a=e("HHCommon");cc.Class({extends:a,properties:{avatar:{default:null,type:cc.Sprite},nickname:{default:null,type:cc.Label},goldcoin_base:{default:null,type:cc.Node},goldcoins:{default:null,type:cc.Label},betup:{default:null,type:cc.Node},emoticon:{default:null,type:cc.Node},callplayer:{default:null,type:cc.Node},winorlose:{default:null,type:cc.Node},banker:{default:null,type:cc.Node},passCount:{default:null,type:cc.Label},passCount1:{default:null,type:cc.Node},userinformationpan:{default:null,type:cc.Node}},init:function(e,t,i,a){this.parent=e,this.userdata=t,this.seatid=i,this.playerIdx=a,this.nickname.string=t.nickname,1==cc.global.championMode||cc.global.championMode,this.goldcoins.string=this.numformat(t.goldcoins),this.goldcoins.node.parent.active=!0,this.loadAvatar(t.avatarurl,t.gender),this.layoutForSeat();for(i=0;i<3;i++)this.passCount1.children[i].opacity=255},speech:function(e){var t=this.userdata.playcharacter;cc.global.audio.playVoiceSpeechWithType(t,e)},onClickDisInfo:function(){},updateCareer:function(e){},updateBalance:function(){this.goldcoins&&(this.goldcoins.string=this.numformat(parseInt(this.userdata.goldcoins)))},spendDiamondForLuck:function(e){this.updateBalance()},showCallPlayer:function(e,t){var i=this;this.hideCallPlayer(),cc.global.audio.playVoiceChatWithType(this.userdata.playcharacter,t),this.callplayer.active=!0,this.callplayer.children[0].getComponent(cc.Label).string=e,this.callPlayerTimer&&clearTimeout(this.callPlayerTimer),this.callPlayerTimer=setTimeout(function(){i&&i.callplayer&&(i.callplayer.active=!1)},2e3)},hideCallPlayer:function(){this.unschedule(this.hideCallPlayer),this.callplayer.active=!1},onClickCallPlayer:function(){if(this.ready()){var e=this.socket(),t={};if(null==this.lockcallplayer&&(this.lockcallplayer=!1),1==this.lockcallplayer)return;this.lockcallplayer=!0,t.extparams={callplayer:this.userdata.id},e.exec("callplayer",t);var i=this;setTimeout(function(){i.lockcallplayer=!1},2e3)}},onClickEmoticon:function(){1!=this.parent.tip_pan.active&&(cc.global.user.id==this.userdata.id?this.parent.onClickEmoticon&&this.parent.onClickEmoticon():this.onClickCallPlayer())},layoutForSeat:function(){0==this.seatid?(this.callplayer.scaleX=-1,this.callplayer.children[0].scaleX=-1,this.userinformationpan.x=-80,this.userinformationpan.anchorX=1,this.goldcoin_base.anchorX=1,this.nickname.node.anchorX=1,this.passCount1.anchorX=1,this.banker.x=65,this.winorlose.x=-300):1==this.seatid&&(this.callplayer.scaleX=1,this.callplayer.children[0].scaleX=1,this.userinformationpan.x=80,this.userinformationpan.anchorX=0,this.goldcoin_base.anchorX=0,this.nickname.node.anchorX=0,this.passCount1.anchorX=0,this.banker.x=-65,this.winorlose.x=300)},summary:function(e){var a=this;if(this.updateCareer(e),this.winorlose.getComponent(cc.Animation).play(),2==e.win){cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("win"),this.winorlose.children[1].getComponent(cc.Label).string="+"+this.numformat(e.exp),this.winorlose.children[2].getComponent(cc.Label).string="+"+this.numformat(e.score),e.orig_gold=e.gold-e.score,"diamond"==cc.global.user.selplayway&&(e.orig_gold=e.diamond-e.score);var t=cc.callFunc(function(e,t){t.orig_gold+Math.round(t.score/5)>("diamond"==cc.global.user.selplayway?t.diamond:t.gold)?"diamond"==cc.global.user.selplayway?t.orig_gold=t.diamond:t.orig_gold=t.gold:t.orig_gold=t.orig_gold+Math.round(t.score/5);var i=e.getComponent("animalplayer").goldcoins.node;i.getComponent(cc.Label).string=a.numformat(t.orig_gold),i.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1)))},this,e),i=cc.sequence(cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t,cc.delayTime(.2),t);this.node.runAction(i)}else cc.global.user.id==this.userdata.id&&cc.global.audio.playSummaryAud("lose"),this.winorlose.children[1].getComponent(cc.Label).string="-"+this.numformat(Math.abs(e.exp)),this.winorlose.children[2].getComponent(cc.Label).string="-"+this.numformat(-1*e.score),this.goldcoins.string=this.numformat(e.gold)},showFuncStatus:function(){},showBanker:function(){this.banker.active=!0,2<=this.banker.children.length&&(this.banker.children[0].active=0==this.seatid,this.banker.children[1].active=0!=this.seatid)},hideBanker:function(){this.banker.active=!1},updatePassCount:function(e){if(this.passCount){var t=3-parseInt(e);if(0<=t){var i=this.getLanguageText("PASS_COUNT");if(this.passCount.string=i+": "+t,0==this.seatid)for(var a=0;a<3;a++)a<Math.min(parseInt(e),3)?this.passCount1.children[a].opacity=100:this.passCount1.children[a].opacity=255;else for(a=2;0<=a;a--)this.passCount1.children[a].opacity=t<=a?100:255}else{i=this.getLanguageText("NO_PASS_COUNT");this.passCount.string=i}}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],emptybutton1:[function(e,t,i){"use strict";cc._RF.push(t,"5af45FQ9J1HKLN8QHIvowhD","emptybutton1"),cc.Class({extends:cc.Component,properties:{id:-1,row:0,col:0,img:{default:null,type:cc.Node},flag:{default:null,type:cc.Node}},init:function(e,t,i,a){this.id=e,this.row=t,this.col=i,this.parent=a,this.drawImage(!0);for(var s=2;s<=4;s++)this.node.children[s].setPosition(cc.p(0,0)),this.node.children[s].active=!1,this.node.children[s].opacity=255;this.flag.opacity=0},setGeometry:function(e,t,i){this.node.setPosition(i),this.node.width=e-5,this.node.height=t-5,this.img.width=e,this.img.height=t,this.flag.width=e,this.flag.height=t},onClick:function(){this.node.getComponent(cc.Animation).stop(),1!=this.parent.tip_pan.active&&"yes"!=cc.global.amObserve&&0!=this.parent.isGamePlaying&&(this.parent.turnSeat||0!=this.id&&100!=this.id||this.parent.on_clickEmpty(this.row,this.col))},click_animation:function(){for(var e=2;e<=4;e++)this.node.children[e].active=!0;this.img.active=!1,this.node.getComponent(cc.Animation).play("click_box"),cc.global.audio.playEffectAud("animal/click_box")},show_flag:function(e){for(var t=2;t<=4;t++)this.node.children[t].active=!1;1==e?this.node.getComponent(cc.Animation).play("empty_blink"):(this.node.getComponent(cc.Animation).stop(),this.flag.opacity=0)},drawImage:function(e){this.node.active=!0,this.node.getComponent(cc.Animation).stop(),this.flag.opacity=0,this.img.active=e;for(var t=2;t<=4;t++)this.node.children[t].setPosition(cc.p(0,0)),this.node.children[t].active=!1,this.node.children[t].opacity=255}}),cc._RF.pop()},{}],emptybutton:[function(e,t,i){"use strict";cc._RF.push(t,"72555/CTwdBa7VKEYdoTCL+","emptybutton"),cc.Class({extends:cc.Component,properties:{id:-1,row:0,col:0,img:{default:null,type:cc.Node},flag:{default:null,type:cc.Node},tiles:{default:null,type:cc.SpriteAtlas},track:{default:null,type:cc.Node}},init:function(e,t,i,a){this.id=e,this.row=t,this.col=i,this.parent=a,this.flag.active=!1,this.goflag=!1,this.drawImage()},setGeometry:function(e,t,i){this.node.setPosition(i),this.node.width=e-5,this.node.height=t-5,this.img.width=e,this.img.height=t},onClick:function(){1!=this.parent.tip_pan.active&&"yes"!=cc.global.amObserve&&0!=this.parent.isGamePlaying&&(this.parent.turnSeat||this.goflag&&this.parent.on_clickTarget(this.row,this.col))},drawImage:function(){var e;10==this.id?e="empty":11==this.id?e="trag":12==this.id?e="water":13==this.id&&(e="star",1<this.row&&(e="star1")),this.img.getComponent(cc.Sprite).spriteFrame=this.tiles.getSpriteFrame(e)},showFlag:function(e){this.flag.active=e,this.goflag=e},showTrack:function(e){this.track.active=e}}),cc._RF.pop()},{}],hookrope:[function(e,t,i){"use strict";cc._RF.push(t,"65b3d4/MeJDPJMsGCaAcsbb","hookrope");var a=e("HHCommon");cc.Class({extends:a,properties:{hook:{default:null,type:cc.Node},rope:{default:null,type:cc.Node},leftnode:{default:null,type:cc.Node},hashold:0,hasdig:0,numhold:-1,idhold:-1,dh:5,type:""},onLoad:function(){this.leftnode=cc.instantiate(this.hook.children[1]),this.leftnode.active=!1,this.collisionCount=0,this.collideCount=0},setParent:function(e){this.parent=e},dig:function(){this.hasdig=1,this.dh=5,this.getComponent(cc.Animation).pause("hookrope_rotate")},update:function(e){var t=this;if(this.parent){if(!this.parent.isGamePlaying)return this.hasdig=0,this.rope.height=10,this.hashold=0,this.numhold=-1,this.idhold=-1,this.getComponent(cc.Animation).resume("hookrope_rotate"),this.parent.miner_wait(),this.leftnode.active=!1,this.hook.children[0].rotation=0,void(this.hook.children[1].rotation=0);if(0!=this.hasdig){this.rope.height+=this.dh*this.hasdig;var i=Math.cos(this.node.rotation*Math.PI/180)*this.rope.height,a=Math.sin(this.node.rotation*Math.PI/180)*this.rope.height;if((560<Math.abs(i)||650<Math.abs(a))&&1==this.hasdig&&(this.hasdig=-1,this.parent.miner_pull()),this.hashold&&(this.leftnode.x+=this.dh*Math.sin(this.node.rotation*Math.PI/180),this.leftnode.y+=this.dh*Math.cos(this.node.rotation*Math.PI/180)),this.rope.height<=10){if(this.hasdig=0,this.rope.height=10,this.hook.children[0].rotation=0,this.hook.children[1].rotation=0,this.hashold&&0<=this.numhold){var s=this.socket(),r={};if("mouse"!=this.type&&"gemmouse"!=this.type)var n=this.parent.mine[this.numhold].getComponent("mineobject").worth;else n=this.parent.mine[this.numhold].getComponent("SusliksMove").worth;r.extparams={id:this.numhold,score:n,roomid:cc.global.extparams.roomid},cc.global.isOffline?(this.parent.myscore+=n,setTimeout(function(){t.parent.score_label.string=t.numformat(t.parent.myscore)},2e3)):s.exec("rtscored",r),cc.global.audio.playEffectAud("onet/match"),this.collideCount=0,this.parent.fun_destroymine(this.numhold),this.leftnode.active=!1}this.hashold=0,this.numhold=-1,this.idhold=-1,this.getComponent(cc.Animation).resume("hookrope_rotate"),this.parent.miner_wait()}}}},collide_object:function(t,e,i){if("explosive"==i){this.parent.mine[t].getComponent(cc.Animation).play("bomb_explosive"),this.parent.miner_pull(),this.collideCount=0,this.hashold=0,this.hasdig=-1;var a=this;this.parent.mine[t].getComponent(cc.Animation).on("finished",function(e){a.parent.mine[t].destroy()},a)}else{this.hook.children[0].rotation=20,this.hook.children[1].rotation=-20,this.hasdig=-1,this.hashold=1,this.numhold=t,this.dh=e,this.type=i,this.dh<=2?this.parent.miner_lift_gold():this.parent.miner_pull(),this.leftnode.rotation=this.hook.children[1].rotation+this.node.rotation,this.leftnode.parent=this.parent.background;var s=this.rope.height*Math.sin(this.node.rotation*Math.PI/180)*-1-10*Math.cos(this.node.rotation*Math.PI/180),r=this.rope.height*Math.cos(this.node.rotation*Math.PI/180)*-1+195+10*Math.sin(this.node.rotation*Math.PI/180);this.leftnode.setPosition(s,r),this.leftnode.active=!0}}}),cc._RF.pop()},{HHCommon:"HHCommon"}],init:[function(t,e,i){"use strict";cc._RF.push(e,"18153RN7ZVGmJ00McHGQmfl","init"),cc.Class({extends:cc.Component,properties:{_progress:0,_splash:null,_isLoading:!1,main:{default:null,type:cc.Node},loaddingPrefab:{default:null,type:cc.Prefab},alertPrefab:{default:null,type:cc.Prefab},confirmDlgPrefab:{default:null,type:cc.Prefab},createRoomDlgPrefab:{default:null,type:cc.Prefab},inviteDlgPrefab:{default:null,type:cc.Prefab},toastPrefab:{default:null,type:cc.Prefab},commonAtlas:{default:null,type:cc.SpriteAtlas},interactive_emo:{default:null,type:cc.Prefab},newsNotify:{default:null,type:cc.Prefab},avatarAtlas:cc.SpriteAtlas,pokerAtlas1:cc.SpriteAtlas,pokerAtlas2:cc.SpriteAtlas,gameIcons:{default:[],type:cc.SpriteFrame}},onLoad:function(){this.initMgr()},start:function(){},parseToken:function(){var e=window.location.href,t=e.indexOf("token="),i=e.indexOf("&userid="),a=e.indexOf("&game=");this.reqToken=e.slice(t+6,i),this.reqUsername=e.slice(i+8,a),this.rungame=e.slice(a+6,e.length)},initMgr:function(){cc.global.routes={},cc.global.event={},cc.vv={},cc.global.seckey="hhgame",cc.global.gamestatus="none",cc.global.unzipMsg=!1,cc.global.turnIndex=-1,cc.global.loadding=this.loaddingPrefab,cc.global.dialog=this.alertPrefab,cc.global.confirmdlg=this.confirmDlgPrefab,cc.global.inviteDlgPrefab=this.inviteDlgPrefab,cc.global.toastPrefab=this.toastPrefab,cc.global.newsNotify=this.newsNotify,cc.global.commonAtlas=this.commonAtlas,cc.global.avatarAtlas=this.avatarAtlas,cc.global.pokerAtlas1=this.pokerAtlas1,cc.global.pokerAtlas2=this.pokerAtlas2,cc.global.gameIcons=this.gameIcons,cc.global.is3=!1,cc.global.last4=!0,cc.global.replayState={curPage:0,listData:0,enterReplay:!1},cc.global.curplaywayCond=-1;var e=t("socket.io");window.io=new e,cc.Button.prototype.touchEndedClone=cc.Button.prototype._onTouchEnded,cc.Button.prototype._soundOn=!0,cc.Button.prototype.setSoundEffect=function(e){this._soundOn=e}}}),cc._RF.pop()},{"socket.io":"socket.io"}],logindialog:[function(e,t,i){"use strict";cc._RF.push(t,"b76ecdflkFMpbE7jO6bZA5F","logindialog");var a=e("HHCommon");cc.Class({extends:a,properties:{},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})},onCloseClick:function(){var e=this.getCommon("common");null!=e&&e.loginFormPool.put(e.dialog)}}),cc._RF.pop()},{HHCommon:"HHCommon"}],login:[function(a,e,t){"use strict";cc._RF.push(e,"b1e61wc385A/JqODqBnTWMh","login");var i=a("HHCommon");cc.Class({extends:i,properties:{username:{default:null,type:cc.EditBox},password:cc.EditBox,cid:{default:null,type:cc.Label},loginbtn:{default:null,type:cc.Node},loddingdlg:{default:null,type:cc.Node},closebtn:cc.Node,toggleSound:cc.Node,toggleData:cc.Node,togglePassword:cc.Node,orgvesionbtn:cc.Node,train_btn:cc.Node,btnGroup:cc.Node,realname:cc.EditBox,birthday:cc.EditBox,passwodconfirm:cc.EditBox,toastNode:{default:null,type:cc.Node}},onLoad:function(){cc.global.isTestGame;this.user_name="",this.user_token="",this.user_cid="",this.user_realname="",this.user_birthday="",this.fromcallback=!1,cc.global.isOpen=!0,this.orientation=1,this.loddingdlg.active=!1,this.loginbtn.active=!0,this.toastNode.active=!1,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.androidInterface={},cc.androidInterface.onBatteryChanged=function(e){cc.global.batery=e,null!=cc.global.ononBatteryChanged&&cc.global.onBatteryChanged(e)},cc.sys.isNative&&jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","initBatteryCallback","()V");var e=cc.sys.localStorage.getItem("bgm_on");null==e?(e=!1,cc.sys.localStorage.setItem("bgm_on",JSON.stringify(!1))):e=this.parse(e),this.bgm_on=e;var t=cc.sys.localStorage.getItem("sfx_on1");null==t?(t=!0,cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(!0))):t=this.parse(t),this.sfx_on=t,this.onClickSound(),this.onClickDataSave();var i=cc.sys.localStorage.getItem("save_password");if(null==i?(i=!1,cc.sys.localStorage.setItem("save_password",JSON.stringify(!1))):i=this.parse(i),this.save_password=i,this.onSavePassword(),cc.global.forceClosed){this.loddingdlg.active=!1,this.loginbtn.active=!0;var a="Error.";switch(cc.global.forceCloseMsg){case"Hacking":case"Tricky":a="Error.";break;case"Kicked":break;case"Hacker":case"Tricker":a="Error.";break;default:a=cc.global.forceCloseMsg?cc.global.forceCloseMsg:a}cc.global.forceClosed=!1,cc.global.autologin<5&&"Hacking"!=cc.global.forceCloseMsg||(this.alert(a),cc.global.autologin=0)}cc.global.isOffline&&this.onClickOffline(),this.prevBirthday=""},start:function(){this.onClickCid()},onDestroy:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},onBatteryInfo:function(e){(null==e||e<0||100<e)&&(e=50),cc.global.batery=e},onKeyDown:function(e){switch(e.keyCode){case cc.KEY.escape:case cc.KEY.back:return void(null!=cc.global.openwin?this.closeOpenWin():1==this.closebtn.active&&this.onClickExit())}},parseToken:function(){if(window&&window.location){var e=window.location.href;if(e){var t=e.indexOf("token="),i=e.indexOf("&userid="),a=e.indexOf("&cid=");-1!=t&&-1!=i&&(this.user_token=e.slice(t+6,i).replace("\n",""),this.user_name=0<=a?e.slice(i+8,a).replace("\n",""):e.slice(i+8).replace("\n",""),this.user_cid=0<=a?e.slice(a+5).replace("\n",""):"")}}},showLoading:function(e){this.loddingdlg.active=e,this.loginbtn.active=!e,this.closebtn.active=!e},loginWithMyFriend:function(){cc.sys.isMobile?(cc.androidInterface.callbackLogin||(cc.androidInterface.callbackLogin=this.callbackLogin,cc.androidInterface.context=this),jsb.reflection.callStaticMethod("org.cocos2dx.javascript.LoginController","processNativeLogin","()V"),this.fromcallback=!0):this.alert("Error.")},onClickLogin1:function(){cc.global.isOffline=!1;var e=a("ServerConfig");cc.global.http=a("HTTP"),cc.global.http.baseURL=e.baseURL,cc.global.http.wsURL=e.wsURL,cc.global.http.avatarURL=e.avatarURL,cc.sys.isMobile&&(cc.global.http.baseURL=e.baseURL3g,cc.global.http.wsURL=e.wsURL3g,cc.global.http.avatarURL=e.avatarURL3g),this.onClickLogin(null,cc.global.game_version)},onClickCid:function(){if(cc.sys.isNative){var e=cc.sys.localStorage.getItem("username");null!=e&&""!=e&&(this.username.string=e);var t=cc.sys.localStorage.getItem("password");this.save_password||(t=""),null!=t&&""!=t&&(this.password.string=t),cc.androidInterface.callbackCid||(cc.androidInterface.callbackCid=this.callbackCid,cc.androidInterface.context=this),jsb.reflection.callStaticMethod("org.cocos2dx.javascript.LoginController","requestCID","()V")}else""==this.user_cid&&this.parseToken(),this.cid&&(this.cid.string=this.user_cid),this.username&&(this.username.string=this.user_name),this.password&&(this.password.string=this.user_token)},onClickLogin:function(e,t){cc.global.isOffline=!1;var i=a("ServerConfig");if(t&&parseInt(t)?(cc.global.http.baseURL=i.baseURL1,cc.global.http.wsURL=i.wsURL1,cc.sys.isMobile&&(cc.global.http.baseURL=i.baseURL3g1,cc.global.http.wsURL=i.wsURL3g1),cc.global.game_version=1):(cc.global.http.baseURL=i.baseURL,cc.global.http.wsURL=i.wsURL,cc.sys.isMobile&&(cc.global.http.baseURL=i.baseURL3g,cc.global.http.wsURL=i.wsURL3g),cc.global.game_version=0),cc.global.isTestGame?(this.user_name="bigstar",this.user_token="19890110"):cc.sys.isMobile||""==this.username.string&&""==this.password.string&&this.parseToken(),this.user_name=this.username.string,this.user_token=this.password.string,null==this.user_name||null==this.user_token||""==this.user_name||""==this.user_token)return console.log(this.user_name),console.log(this.user_token),void this.alert("Input information.");cc.sys.localStorage.setItem("username",this.user_name),this.save_password&&cc.sys.localStorage.setItem("password",this.user_token),this.fromcallback=!0;var s=this;this.showLoading(!0);cc.global.http.httpPost("/auth/login",{username:this.user_name,token:this.user_token,cid:this.user_cid,mobile:cc.sys.isMobile&&!cc.global.isTestGame?"1":"0"},function(e){if(!0,null==e){var t=s.getLanguageText("ERROR_RESPONSE_TIME_0");cc.sys.localStorage.setItem("user_name",this.reqUsername),s.fromcallback?s.alert(t):s.loginWithMyFriend()}else{var i;if("00"==(i=JSON.parse(e)).code)return cc.global.heartbeat=i.heartbeat?i.heartbeat:0,cc.global.heartbeat_interval=i.heartbeat_interval?i.heartbeat_interval:5,cc.global.holiday={},cc.global.holiday.banner=i.holiday_banner,cc.global.holiday.banner_label=i.holiday_banner_label,cc.global.holiday.msg_title=i.holiday_msg_title,cc.global.holiday.msg_content=i.holiday_msg_content,cc.global.isadmin=i.isadmin1,cc.global.ofc_player=i.ofc_player,cc.global.free_bonus_interval=i.free_bonus_interval,cc.global.free_bonus_amount=i.free_bonus_amount,i.server_version&&"2.0"==i.server_version?cc.global.game_version=1:cc.global.game_version=0,void(null!=(i=i.list)&&null!=i.token&&null!=i.player&&(s.reset(i,s.rungame),s.initVersionData(),s.initGames(i.games),s.connect(function(){var e=s.getLanguageText("ERROR_RESPONSE_TIME_0");s.showLoading(!1),s.alert(e)})));if(s.showLoading(!1),s.fromcallback)if("03"==i.code)s.alert(i.msg),cc.global.isOpen=!1,cc.global.openTime=s.reviseTimezone(i.open_time),cc.global.closeTime=s.reviseTimezone(i.close_time),cc.global.logintime=s.reviseTimezone(i.server_time),cc.global.goods_type=i.goodstype,cc.global.goods_list=i.goodslist,cc.global.serverTimerInverval&&clearInterval(cc.global.serverTimerInverval),cc.global.serverTimerInverval=setInterval(function(){cc.global.logintime+=1e3,cc.global.serverDateTime=s.getDateFromTimestamp(cc.global.logintime)},1e3);else{var a=s.getLanguageText("ERROR_CODE_0")+" : "+i.code;i.msg&&(a=i.msg),s.alert(a)}else s.loginWithMyFriend()}},function(e){if(!0,s.showLoading(!1),s.fromcallback){var t=s.getLanguageText("ERROR_RESPONSE_TIME_0");s.alert(t)}else s.loginWithMyFriend()})},callbackCid:function(e){console.log("khj","callback cid = "+e);var t=cc.androidInterface.context;t.user_cid=e,setTimeout(function(){t.cid.string=e},100)},callbackLogin:function(e,t,i){var a=cc.androidInterface.context;a.user_name=e?e.replace("\n",""):"",a.user_token=t?t.replace("\n",""):"",a.user_cid=i||"",cc.sys.localStorage.setItem("username",a.user_name),cc.sys.localStorage.setItem("password",a.user_token),a.onClickLogin(null,cc.global.game_version)},login:function(){if(this.loddingdlg.active=!0,this.loginbtn.active=!1,this.closebtn.active=!1,null!=this.user_name.string?(this.reqUsername=this.user_name.string,this.reqToken="111",cc.sys.localStorage.setItem("user_name",this.reqUsername),this.rungame="lobby"):this.parseToken(),""==this.reqUsername||""==this.reqToken)return this.alert("Input user information."),this.loddingdlg.active=!1,this.loginbtn.active=!0,void(this.closebtn.active=!0);var t=this;this.connect(function(){var e=t.getLanguageText("ERROR_RESPONSE_TIME_0");t.alert(e),t.loddingdlg.active=!1,t.loginbtn.active=!0,t.closebtn.active=!0})},onClickDataSave:function(e,t){null!=e&&(this.bgm_on=!this.bgm_on,cc.sys.localStorage.setItem("bgm_on",JSON.stringify(this.bgm_on))),this.bgm_on?(cc.global.audio.resumeAll(),cc.global.audio.playHallBgm(),this.toggleData.children[0].children[1].active=!0):(cc.global.audio.pauseAll(),this.toggleData.children[0].children[1].active=!1)},onClickSound:function(e,t){null!=e&&(this.sfx_on=!this.sfx_on,cc.sys.localStorage.setItem("sfx_on1",JSON.stringify(this.sfx_on))),this.sfx_on?this.toggleSound.children[0].children[1].active=!0:this.toggleSound.children[0].children[1].active=!1},onSavePassword:function(e,t){null!=e&&(this.save_password=!this.save_password,cc.sys.localStorage.setItem("save_password",JSON.stringify(this.save_password))),this.save_password?this.togglePassword.children[0].children[1].active=!0:this.togglePassword.children[0].children[1].active=!1},onClickOffline:function(){this.node.cleanup(),cc.global.autoOffline=!1,this.loadding(),cc.global.isOffline=!0,cc.global.socket=window.io;var i=this;cc.loader.loadRes("config/offline-user",cc.TextAsset,function(e,t){i.closeloadding(),null==e&&(t.logintime=(new Date).getTime(),i.reset(t,i.rungame),i.initGames(t.games),i.scene("hall"))})},switchRegAndLogin:function(e){this.btnGroup&&3<this.btnGroup.children.length&&(this.btnGroup.children[0].active=!e,this.btnGroup.children[1].active=!e,this.btnGroup.children[2].active=e,this.btnGroup.children[3].active=e),this.realname.node.active=e,this.birthday.node.active=e,this.passwodconfirm.node.active=e,this.toggleData.parent.active=!e},onClickRegister:function(){this.switchRegAndLogin(!0)},onClickRefreshUsername:function(){var e=this.cid.string;if(""!=e){this.loadding();var s=this;cc.global.http.httpPost("/auth/get_userid",{cid:e},function(e){if(s.closeloadding(),null==e){var t=s.getLanguageText("ERROR_RESPONSE_TIME_0");s.alert(t)}else{var i=JSON.parse(e);if("00"==i.code)s.username.string=i.userid;else{var a=s.getLanguageText("ERROR_CODE_0");i.msg&&(a=i.msg),s.alert(a)}}},function(e){var t=s.getLanguageText("ERROR_RESPONSE_TIME_0");s.closeloadding(),s.alert(t)})}else this.alert("Can not get cid.")},isLunar:function(e){var t=!1;return e%4==0&&(t=!0),e%100==0&&(t=!1),e%400==0&&(t=!0),t},isValidBirthday:function(e){if("string"!=typeof e)return 1;if(10!=e.length)return 1;for(var t=0,i=0,a=0,s=[0,31,28,31,30,31,30,31,31,30,31,30,31],r=0;r<e.length;r++)if(r<4){if(e[r]<"0"||"9"<e[r])return 1;t=10*t+parseInt(e[r])}else if(4==r||7==r){if("-"!=e[r])return 1}else if(5==r||6==r){if(e[r]<"0"||"9"<e[r])return 1;i=10*i+parseInt(e[r])}else if(8==r||9==r){if(e[r]<"0"||"9"<e[r])return 1;a=10*a+parseInt(e[r])}return t<=1900||2100<t?2:i<1||12<i?3:(this.isLunar(t)&&(s[2]=29),a<1||a>s[i]?4:100)},checkEditBirthday:function(e){var t=""+this.birthday.string,i="",a=t.length;if(a<this.prevBirthday.length)this.prevBirthday=t;else{for(var s=0;s<a;s++)t[s]<"0"||"9"<t[s]||(4==(i+=t[s]).length&&(i+="-","-"),7==i.length&&(i+="-","-"));this.birthday.string=i,this.prevBirthday=i}},onRegOk:function(){this.hideToast();var e=this.realname.string,t=""+this.birthday.string,i=this.passwodconfirm.string,a=this.username.string,s=this.cid.string,r=this.password.string;if(""!=a&&""!=r&&""!=e&&""!=t&&""!=i){var n=this.isValidBirthday(t);if(100==n)if(r==i){this.loadding();var o=this;cc.global.http.httpPost("/auth/register",{cid:s,userid:a,username:e,password:r,birthday:t},function(e){if(o.closeloadding(),null==e){var t=o.getLanguageText("ERROR_RESPONSE_TIME_0");o.alert(t)}else{var i=JSON.parse(e);if("00"==i.code)o.alert("Success in register."),o.switchRegAndLogin(!1);else{var a=o.getLanguageText("ERROR_CODE_0");i.msg&&(a=i.msg),o.alert(a)}}},function(e){var t=o.getLanguageText("ERROR_RESPONSE_TIME_0");o.closeloadding(),o.alert(t)})}else this.showToast("No match password.");else 1==n?this.showToast("Invalid birthday.\nInput in the correct format as 2000-01-01."):2==n?this.showToast("Invalid birthday(year)."):3==n?this.showToast("Invalid birthday(month)."):4==n&&this.showToast("Invalid birthday(day).")}else this.showToast("Input information.")},onRegCancel:function(){this.hideToast(),this.switchRegAndLogin(!1)},onClickLanguage:function(){var a=this;this.closeOpenWin();var e=cc.find("Canvas/LanguageDialog");null!=e?e.active=!0:cc.loader.loadRes("prefab/main/LanguageDialog",cc.Prefab,function(e,t){var i=cc.instantiate(t);cc.find("Canvas").addChild(i),i.getComponent("LanguageDialog").init(a)})},showToast:function(e){this.toastNode.active=!0,this.toastNode.getComponent(cc.Label).string=e,this.toastNode.scaleX=0,this.toastNode.scaleY=0;var t=cc.scaleTo(.1,1),i=cc.scaleTo(.05,.95),a=cc.scaleTo(.05,1),s=cc.scaleTo(.05,.95),r=cc.scaleTo(.05,1),n=cc.sequence(t,i,a,s,r);this.toastNode.runAction(n)},hideToast:function(){this.toastNode.cleanup(),this.toastNode.getComponent(cc.Label).string="",this.toastNode.active=!1}}),cc._RF.pop()},{HHCommon:"HHCommon",HTTP:"HTTP",ServerConfig:"ServerConfig"}],mineobject:[function(e,t,i){"use strict";cc._RF.push(t,"e1b0eSCRVBOW7emnl9K1hLg","mineobject");var a=e("HHCommon");cc.Class({extends:a,properties:{tiles:{default:null,type:cc.SpriteAtlas},num:0,objectType:null,worth:0,liftSpeed:0,dh:0,collisonid:1},init:function(e,t,i,a,s){this.num=e,this.objectType=t,this.worth=i,this.liftSpeed=a,this.parent=s},onCollisionEnter:function(e,t){if(1!=e.collisonid&&"hook"==e.node.name&&-1!=e.node.parent.getComponent("hookrope").hasdig&&(e.node.parent.getComponent("hookrope").collideCount++,!(1<e.node.parent.getComponent("hookrope").collideCount))){cc.global.audio.playEffectAud("get_card"),"explosive"==this.objectType&&cc.global.audio.playEffectAud("bomb"),e.node.parent.getComponent("hookrope").collide_object(this.num,this.liftSpeed,this.objectType),this.node.rotation=e.node.parent.rotation;var i=this.node.height;"gold"==this.objectType&&(i*=this.node.scaleY),this.node.x=(e.node.y-i/2-10)*Math.sin(this.node.rotation*Math.PI/180),this.node.y=(e.node.y-i/2-10)*Math.cos(this.node.rotation*Math.PI/180)+195,this.dh=this.liftSpeed}},update:function(e){var t=Math.cos(this.node.rotation*Math.PI/180)*this.dh,i=Math.sin(this.node.rotation*Math.PI/180)*this.dh;this.node.x+=i,this.node.y+=t}}),cc._RF.pop()},{HHCommon:"HHCommon"}],playersend:[function(e,t,i){"use strict";cc._RF.push(t,"b098b9dHaJDY43tzXiC7SN3","playersend");var a=e("HHCommon");cc.Class({extends:a,properties:{mysendgraph:{default:null,type:cc.Node},graph:{default:null,type:cc.Node},pieceImg:{default:null,type:cc.Node},pieceAtlas:{default:null,type:cc.SpriteAtlas},sendmode:{default:1,type:cc.Integer}},init:function(e,t,i,a){this.isGoHidden=!1,this.parent=e,this.engine=t,this.playerData=i,this.sending=a,this.sendingBlockData=void 0,this.other_info=this.engine.getOtherEnginePlayer(this.playerData.userid),this.initTowerPieces(),this.drawsendpiece()},initTowerPieces:function(){for(var e=0;e<this.engine.data.boardWidth;e++)for(var t=0;t<this.sending[e].length;t++){var i=cc.instantiate(this.pieceImg);i.parent=this.graph,i.getComponent(cc.Sprite).spriteFrame=this.pieceAtlas.getSpriteFrame(this.sending[e][t]),i.setPosition(this.pieceImg.width*e,-this.pieceImg.height*t),0<this.sending[e][t]?i.active=!0:i.active=!1}},hide:function(){this.graph&&0!=this.sending.length&&0!=this.sending[0].length&&("no"==cc.global.amObserve&&this.other_info.userid==cc.global.user.id&&(this.engine.data.tsPSCT++,this.engine.newPiece(this.other_info)),this.engine.addFullLines(this.other_info,this.sending),"FINISHED"==this.playerData.state?this.engine.data.trainMode||(this.engine.cleanTower(this.parent.getPlayerBoard(this.other_info.userid).tower,this.other_info),this.engine.drawMainTower(this.parent.getPlayerBoard(this.other_info.userid).tower,this.other_info)):this.parent.drawGame(),this.mysendgraph.active=!1)},removeSelf:function(){this.node&&(this.node.removeFromParent(!0),this.node.destroy())},drawsendpiece:function(){if(this.sending&&this.sending.length){var e=cc.callFunc(this.afterSend,this,null),t=this.parent.sendroot.width-this.parent.selfboard.width,i=1==this.parent.orientation?this.parent.sendroot.width*Math.min(.81,cc.global.narrowContentRatio):t;2==this.sendmode&&(i=1==this.parent.orientation?-1*this.parent.receiveroot.width*Math.min(.81,cc.global.narrowContentRatio):-1*t),this.mysendgraph.runAction(cc.sequence(cc.moveBy(1.5,i,0),cc.delayTime(.5),e))}},afterSend:function(e,t){this.engine&&(this.engine.data.trainMode||"yes"==cc.global.amObserve?(this.hide(),this.removeSelf()):this.sendingBlockData&&"no"==cc.global.amObserve&&(this.isGoHidden=!0))},update:function(){"FINISHED"==this.playerData.state?(this.hide(),this.removeSelf()):this.isGoHidden&&"no"==cc.global.amObserve&&(this.isGoHidden=!1,this.hide(),this.socket().exec("ke",{extparams:{tc:"9/"+this.sendingBlockData+"/"+this.parent.myRound}}),this.removeSelf())}}),cc._RF.pop()},{HHCommon:"HHCommon"}],"socket.io":[function(e,t,i){"use strict";cc._RF.push(t,"99b2eNLO4hCOKWi+khM4Cbe","socket.io");var s=e("zlib"),r=e("buffer");cc.Class({extends:cc.Component,properties:{piracy:!1},connect:function(e,t){var a=this;return a.logScrObj=t,null!=cc.global&&null!=cc.global.user||t.onError(),cc.global.forceClosed||(this.ws=new WebSocket(e+"?username="+cc.global.user.username+"&token="+cc.global.authorization)),this.ws.binaryType="arraybuffer",this.ws.onopen=function(e){""!=cc.global.user.roomid?(t.closeOpenWin(),cc.global.gamestatus="ready",t.preload({},t)):t.scene("hall",t),cc.global.pingInterval&&(clearInterval(cc.global.pingInterval),cc.global.pingInterval=null),cc.global.heartbeat&&0<cc.global.heartbeat&&a.startHeartbeat()},this.ws.onmessage=function(e){if(cc.global.lastactivetime=cc.global.logintime,a.lastRecieveTime=Date.now(),e.data.constructor===String)a.onMessage(e.data);else{var t=r.Buffer.from(e.data,0,e.data.length),i=s.gunzipSync(t).toString("utf8");a.onMessage(i)}},this.ws.onerror=function(e){a.error()},this.ws.onclose=function(e){cc.global.forceClosed=!0,cc.global.pingInterval&&(clearInterval(cc.global.pingInterval),cc.global.pingInterval=null);var t=setInterval(function(){cc.switchscene||(clearInterval(t),cc.switchscene=!0,cc.director.preloadScene("login",function(e){e?cc.switchscene=!1:cc.director.loadScene("login",function(){cc.current_scene="login",cc.switchscene=!1})}))},100)},this},onMessage:function(e){if(e&&"p"==e.substr(0,1)){var t=e.split(",");if(2==t.length&&!isNaN(t[1])){var i=cc.global.heartbeat_interval;cc.global.heartbeat_interval=parseInt(t[1]),cc.global.heartbeat_interval<2&&(cc.global.heartbeat_interval=2),20<cc.global.heartbeat_interval&&(cc.global.heartbeat_interval=20),cc.global.heartbeat_interval!=i&&this.startHeartbeat()}}else{if("Kicked"==e||"Hacking"==e)return cc.global.forceCloseMsg=e,this.ws.close(),void(this.piracy=!0);var a=this.parse(e);null!=a&&null!=a.event&&null!=cc.global.event[a.event]&&cc.global.event[a.event](a)}},startHeartbeat:function(){if(!cc.global.isOffline){var e=this;e.lastRecieveTime=Date.now(),e.lastSendTime=Date.now(),cc.global.pingInterval&&clearInterval(cc.global.pingInterval);var t=cc.global.heartbeat_interval?1e3*parseInt(cc.global.heartbeat_interval):5e3;cc.global.pingInterval=setInterval(function(){e.ws.readyState===WebSocket.OPEN&&t<Date.now()-e.lastRecieveTime&&"hall"!=cc.current_scene&&"login"!=cc.current_scene&&"onet"!=cc.current_scene&&"tetris"!=cc.current_scene&&"basket"!=cc.current_scene&&"miner"!=cc.current_scene?e.ping():e.ws.readyState===WebSocket.OPEN&&15e3<Date.now()-e.lastSendTime&&"hall"!=cc.current_scene&&"hall"!=cc.current_scene&&"login"!=cc.current_scene&&e.ping()},1e3)}},ping:function(){cc.global.isOffline||(this.lastSendTime=Date.now(),this.ws.send("ping"))},on:function(e,t){cc.global.event[e]=t},compress:function(e,i){if(e.length<100)i(e);else{for(var t=new Uint8Array(e.length),a=0;a<e.length;a++)t[a]=e.charCodeAt(a);s.gzip(t,function(e,t){if(e)throw e;i(t)})}},send:function(){if(!cc.global.isOffline&&this.ws.readyState===WebSocket.OPEN&&0<arguments.length){for(var e="",t=arguments.length-1,i=0;i<t;i++)e+=arguments[i]+"\n";e+=arguments[t];this.lastSendTime=Date.now(),this.ws.send(e)}},exec:function(e,t){if((a=this).ws&&a.ws.readyState===WebSocket.OPEN){t.command=e;var i=JSON.stringify(t),a=this;this.lastSendTime=Date.now(),a.ws.send(i)}},emit:function(e,t){var i={};i.extparams={data:t},this.exec(e,i)},disconnect:function(){null!=this.ws&&this.ws.close()},parse:function(t){try{return JSON.parse(t)}catch(e){return t}},error:function(){null!=this.logScrObj&&this.logScrObj.closeloadding(this.logScrObj.loaddingDialog)}}),cc._RF.pop()},{buffer:6,zlib:5}]},{},["ArcheryTimer","ArrayList","Audio","AvatarDialog","Background","Base64","Base64ExtPlugin","BigRecordItem","BitmapFont","BoardCallStatus","Card","CardExchange","CardInfo","Character","ChargeDialog","ChargeItem","Chat","ChatItem","ChessBegin","ChessEngine","ChessPiece","ChessPlayer","ChessPlayerBoard","ConfirmDialog","ContentAdapter","CreateOrJoinDialog","DIZHUCardAnalyzer","DIZHUSelCardsEngine","DailyRewardDlg","Deck","DeclarePanel","DizhuBegin","DizhuButton","DizhuDataBind","DizhuPlayerRender","DizhuSummaryDetail","Emoticon","EventStop","FFABegin","FFACardAnalyzer","FFADataBind","FFAPlayerBoardRender","FFAPlayerRender","FFASelCardsEngine","FFASummaryDetail","FFAWinCards","FIVEBegin","FIVEButton","FIVEDataBind","FIVEPlayerBoardRender","FIVEPlayerRender","FIVESummaryDetail","FiveDeclareCard","GameCanvas","GameHall1","GameLiveRow","GameOpenTimer","GamePlayHisDialog","GamePlayHisRow","GameRecordItem","GameRecordRow","GameSelect","GameTimer","HHCard","HHCommon","HHDialog","HHTimer","HTTP","HallDialog","HelpDialog","KoniBegin","KoniEngine","KoniPiece","KoniPieceHint","KoniPlayer","KoniPlayerBoard","LabelArray","LanguageDialog","LiveDialog","LoadingLogic","LocalizationManager","Localize","LocalizeImg","MissionDialog","MissionDone","MissionItem","NewTimer","NewsDialog","NewsItem","NewsRankItem","NotifyButton","NotifyTabButton","OFCBegin","OFCButton","OFCDataBind","OFCPlayerBoardRender","OFCPlayerRender","OFCSummaryDetail","Observer","OnetBegin","OnetPlayer","OnetPlayerBoard","OnetTile","OnetTileCross","PlayerRowItem","PojinDeclare","PurchaseNumber","RankDialog","RankItem","RankRewardItem","RecordDialog","RewardHistory","RoomInfo","RoomType","ServerConfig","SettingDialog","TetrisBegin","TetrisBetUp","TetrisEngine","TetrisPlayer","TetrisPlayerBoard","ThemeSelectDialog","ThrownCards","ToastCtrl","Tooltip","TurnTimer","VIPStatus","WebView","init","login","logindialog","playersend","socket.io","GameIcon","AnimalBegin1","AnimalEngine1","animalpiece1","animalplayer1","animalplayerBoard1","emptybutton1","AnimalBegin","animalpiece","animalplayer","animalplayerBoard","emptybutton","ArcheryBegin","ArcheryBeginTrain","ArcheryEngine","ArcheryPlayer","ArcheryPlayerBoard","BasketBegin","BasketPlayer","Constants","PointHistory","BasketBall","Basketry","BasketryShape","Net","Slot","BackWall","BallLayer","Floor","FrontWall","Wall","IntCounter","Space3d","Perspective3d","Vector3d","FtkBegin","FtkButton","FtkCardAnalyzer","FtkDataBind","FtkPlayerRender","FtkSelCardsEngine","FtkSummaryDetail","MinerBegin","MinerBetUp","SusliksMove","hookrope","mineobject","PadukBegin","PadukEngine","PadukPiece","PadukPlayer","PadukPlayerBoard","PopstarBegin","PopstarBegin1","PopstarEngine","PopstarPiece","PopstarPlayer","PopstarPlayerBoard","Emptybutton3","ThreekBegin","ThreekPiece","Threekplayer","ThreekplayerBoard","YutBegin","YutEngine","YutPiece","Yutbtn","Yutplayer","YutplayerBoard"]);